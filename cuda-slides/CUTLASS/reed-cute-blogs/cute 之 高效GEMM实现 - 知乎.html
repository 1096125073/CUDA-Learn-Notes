<!DOCTYPE html>
<!-- saved from url=(0038)https://zhuanlan.zhihu.com/p/675308830 -->
<html lang="zh" data-hairline="true" class="itcauecng" data-theme="light" data-darkreader-mode="dynamic" data-darkreader-scheme="dark" data-darkreader-proxy-injected="true" data-rh="data-theme"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><style class="darkreader darkreader--fallback" media="screen"></style><style class="darkreader darkreader--text" media="screen"></style><style class="darkreader darkreader--invert" media="screen">.jfk-bubble.gtx-bubble, .captcheck_answer_label > input + img, span#closed_text > img[src^="https://www.gstatic.com/images/branding/googlelogo"], span[data-href^="https://www.hcaptcha.com/"] > #icon, ::-webkit-calendar-picker-indicator, img.Wirisformula {
    filter: invert(100%) hue-rotate(180deg) contrast(90%) !important;
}</style><style class="darkreader darkreader--inline" media="screen">[data-darkreader-inline-bgcolor] {
  background-color: var(--darkreader-inline-bgcolor) !important;
}
[data-darkreader-inline-bgimage] {
  background-image: var(--darkreader-inline-bgimage) !important;
}
[data-darkreader-inline-border] {
  border-color: var(--darkreader-inline-border) !important;
}
[data-darkreader-inline-border-bottom] {
  border-bottom-color: var(--darkreader-inline-border-bottom) !important;
}
[data-darkreader-inline-border-left] {
  border-left-color: var(--darkreader-inline-border-left) !important;
}
[data-darkreader-inline-border-right] {
  border-right-color: var(--darkreader-inline-border-right) !important;
}
[data-darkreader-inline-border-top] {
  border-top-color: var(--darkreader-inline-border-top) !important;
}
[data-darkreader-inline-boxshadow] {
  box-shadow: var(--darkreader-inline-boxshadow) !important;
}
[data-darkreader-inline-color] {
  color: var(--darkreader-inline-color) !important;
}
[data-darkreader-inline-fill] {
  fill: var(--darkreader-inline-fill) !important;
}
[data-darkreader-inline-stroke] {
  stroke: var(--darkreader-inline-stroke) !important;
}
[data-darkreader-inline-outline] {
  outline-color: var(--darkreader-inline-outline) !important;
}
[data-darkreader-inline-stopcolor] {
  stop-color: var(--darkreader-inline-stopcolor) !important;
}
[data-darkreader-inline-bg] {
  background: var(--darkreader-inline-bg) !important;
}
[data-darkreader-inline-invert] {
    filter: invert(100%) hue-rotate(180deg);
}</style><style class="darkreader darkreader--variables" media="screen">:root {
   --darkreader-neutral-background: #131516;
   --darkreader-neutral-text: #d8d4cf;
   --darkreader-selection-background: #004daa;
   --darkreader-selection-text: #e8e6e3;
}</style><style class="darkreader darkreader--root-vars" media="screen"></style><style class="darkreader darkreader--user-agent" media="screen">@layer {
html {
    background-color: #181a1b !important;
}
html {
    color-scheme: dark !important;
}
iframe {
    color-scheme: initial;
}
html, body {
    background-color: #181a1b;
}
html, body {
    border-color: #736b5e;
    color: #e8e6e3;
}
a {
    color: #3391ff;
}
table {
    border-color: #545b5e;
}
mark {
    color: #e8e6e3;
}
::placeholder {
    color: #b2aba1;
}
input:-webkit-autofill,
textarea:-webkit-autofill,
select:-webkit-autofill {
    background-color: #404400 !important;
    color: #e8e6e3 !important;
}
::selection {
    background-color: #004daa !important;
    color: #e8e6e3 !important;
}
::-moz-selection {
    background-color: #004daa !important;
    color: #e8e6e3 !important;
}
}</style><title>cute 之 高效GEMM实现 - 知乎</title><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="renderer" content="webkit"><meta name="force-rendering" content="webkit"><meta http-equiv="X-UA-Compatible" content="IE=10,chrome=1"><meta name="google-site-verification" content="FTeR0c8arOPKh8c5DYh_9uu98_zJbaWw53J-Sch9MTg"><meta data-rh="true" name="keywords" content="GPU 通用计算,人工智能,高性能计算"><meta data-rh="true" name="description" content="前面的文章我们介绍了cute中的 Layout抽象、Tensor抽象、MMA抽象、Copy抽象、Swizzle抽象和流水线技术。本文将组合利用这些抽象和技术形成高效的矩阵乘法。为了更好地实现高效的矩阵乘法，本文从多个维度介绍了高…"><meta data-rh="true" property="og:title" content="cute 之 高效GEMM实现"><meta data-rh="true" property="og:url" content="https://zhuanlan.zhihu.com/p/675308830"><meta data-rh="true" property="og:description" content="前面的文章我们介绍了cute中的 Layout抽象、Tensor抽象、MMA抽象、Copy抽象、Swizzle抽象和流水线技术。本文将组合利用这些抽象和技术形成高效的矩阵乘法。为了更好地实现高效的矩阵乘法，本文从多个维度介绍了高…"><meta data-rh="true" property="og:image" content="https://pica.zhimg.com/v2-145b8f31c7cf00c4608350d53b9646eb_720w.jpg?source=172ae18b"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="og:site_name" content="知乎专栏"><link data-rh="true" rel="apple-touch-icon" href="https://static.zhihu.com/heifetz/assets/apple-touch-icon-152.81060cab.png"><link data-rh="true" rel="apple-touch-icon" href="https://static.zhihu.com/heifetz/assets/apple-touch-icon-152.81060cab.png" sizes="152x152"><link data-rh="true" rel="apple-touch-icon" href="https://static.zhihu.com/heifetz/assets/apple-touch-icon-120.d5793cac.png" sizes="120x120"><link data-rh="true" rel="apple-touch-icon" href="https://static.zhihu.com/heifetz/assets/apple-touch-icon-76.7abf3393.png" sizes="76x76"><link data-rh="true" rel="apple-touch-icon" href="https://static.zhihu.com/heifetz/assets/apple-touch-icon-60.362a8eac.png" sizes="60x60"><link crossorigin="" rel="shortcut icon" type="image/x-icon" href="https://static.zhihu.com/heifetz/favicon.ico"><link crossorigin="" rel="search" type="application/opensearchdescription+xml" href="https://static.zhihu.com/heifetz/search.xml" title="知乎"><link rel="dns-prefetch" href="https://static.zhimg.com/"><link rel="dns-prefetch" href="https://pica.zhimg.com/"><link rel="dns-prefetch" href="https://picx.zhimg.com/"><link rel="dns-prefetch" href="https://pic1.zhimg.com/"><link rel="dns-prefetch" href="https://pic2.zhimg.com/"><link rel="dns-prefetch" href="https://pic3.zhimg.com/"><link rel="dns-prefetch" href="https://pic4.zhimg.com/"><link rel="dns-prefetch" href="https://static.zhihu.com/"><style data-emotion-css="9mvwt1">:root{--zhc-padding-horizontal:20px;--zhc-padding-vertical:16px;--zhc-notification-top:75px;--app-padding:16px;--app-header-height:52px;--app-max-width:640px;--app-width:1000px;--app-font-size:15px;}</style><style class="darkreader darkreader--sync" media="screen"></style><script nonce="" data-web-reporter-config="{&quot;platform&quot;:&quot;web&quot;,&quot;project&quot;:&quot;heifetz&quot;}">!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e=e||self).webReporter={})}(this,function(e){"use strict";var t={},n=!1,o=function(){var e,o,r,a,i;return n||(e=document.querySelector("script[data-web-reporter-config]"),o=e&&e.dataset.webReporterConfig||"{}",r=JSON.parse(o),a=r.platform,i=r.project,t={platform:a,project:i},n=!0),t};function r(e){return a(function(){return localStorage.getItem(e)})()}function a(e){return function(){try{return e.apply(void 0,arguments)}catch(e){}}}var i=a(function(e,t){var n={platform:"web",project:o().project,clientTimestamp:+new Date};!function(e,t,n){"1"===r("weber:logenabled")&&console.log("[web-reporter]%o",{type:e,base:t,data:n})}(e,n,t),function(e,t){var n=btoa(JSON.stringify(t));if("undefined"!=typeof Blob&&window.navigator&&window.navigator.sendBeacon){var o=new Blob([n],{type:"text/plain"});navigator.sendBeacon(e,o)}else{var r=new XMLHttpRequest;r.open("POST",e),r.withCredentials=!1,r.setRequestHeader("Content-Type","text/plain;charset=UTF-8"),r.send(n)}}(r("weber:api")||"https://apm.zhihu.com/collector/web_json",{type:e,base:n,data:t})});e.report=i,Object.defineProperty(e,"__esModule",{value:!0})});
</script><link href="./cute 之 高效GEMM实现 - 知乎_files/1907.216a26f4.3a30d0c778e087df9648.css" crossorigin="" rel="stylesheet"><style class="darkreader darkreader--sync" media="screen"></style><link href="./cute 之 高效GEMM实现 - 知乎_files/column.216a26f4.c878ff8b92c3fa3efa99.css" crossorigin="" rel="stylesheet"><style class="darkreader darkreader--sync" media="screen"></style><link rel="stylesheet" type="text/css" href="./cute 之 高效GEMM实现 - 知乎_files/user-hover-card.216a26f4.0e3930e2ffc649f7ed8b.css" crossorigin="anonymous"><style class="darkreader darkreader--sync" media="screen"></style><link rel="stylesheet" type="text/css" href="./cute 之 高效GEMM实现 - 知乎_files/GoodsRecommendGoodsCardList.216a26f4.d95ce79191cdf8d7ac28.css" crossorigin="anonymous"><style class="darkreader darkreader--sync" media="screen"></style><link rel="stylesheet" type="text/css" href="./cute 之 高效GEMM实现 - 知乎_files/5622.216a26f4.1e15728ac16988f41b23.css" crossorigin="anonymous"><style class="darkreader darkreader--sync" media="screen"></style><link rel="stylesheet" type="text/css" href="./cute 之 高效GEMM实现 - 知乎_files/report_modals.216a26f4.370935343bb8c3bca346.css" crossorigin="anonymous"><style class="darkreader darkreader--sync" media="screen"></style><link rel="stylesheet" type="text/css" href="./cute 之 高效GEMM实现 - 知乎_files/632.216a26f4.b3e609d82ae4a031d7a1.css" crossorigin="anonymous"><style class="darkreader darkreader--sync" media="screen"></style><link rel="stylesheet" type="text/css" href="./cute 之 高效GEMM实现 - 知乎_files/ECommerceAd.216a26f4.c90979d08ed65b86fc8f.css" crossorigin="anonymous"><style class="darkreader darkreader--sync" media="screen"></style><link rel="stylesheet" type="text/css" href="./cute 之 高效GEMM实现 - 知乎_files/1468.216a26f4.101bb14a2c1d8d20b744.css" crossorigin="anonymous"><style class="darkreader darkreader--sync" media="screen"></style><link rel="stylesheet" type="text/css" href="./cute 之 高效GEMM实现 - 知乎_files/EditableV2.216a26f4.6c9301eaad8df7e50cb2.css" crossorigin="anonymous"><style class="darkreader darkreader--sync" media="screen"></style><script nonce="">!function(){"use strict";!function(e,n){var r=[];function t(e){return function(){r.push([e,arguments])}}n.Raven={captureException:t("captureException"),captureMessage:t("captureMessage"),captureBreadcrumb:t("captureBreadcrumb")};var a,o,c,i,s,u="undefined"!=typeof DOMError;function d(e){var n=e instanceof Error||e instanceof ErrorEvent||u&&e instanceof DOMError||e instanceof DOMException;Raven.captureException(n?e:new Error(e.message||e.reason))}n.addEventListener("unhandledrejection",d),n.addEventListener("error",d,!0),a=e.src,o=e,c=function(){r.forEach(function(e){var n;(n=Raven)[e[0]].apply(n,e[1])}),n.removeEventListener("unhandledrejection",d),n.removeEventListener("error",d,!0)},i=document.head||document.getElementsByTagName("head")[0],(s=document.createElement("script")).crossOrigin=o.crossOrigin,s.dataset.sentryConfig=o["data-sentry-config"],s.onload=c,s.src=a,i.appendChild(s)}({"defer":true,"crossOrigin":"anonymous","src":"https://unpkg.zhimg.com/@cfe/sentry-script@1.3.1/dist/init.js","data-sentry-config":"{\"dsn\":\"https://2d8d764432cc4f6fb3bc78ab9528299d@crash2.zhihu.com/1224\",\"sampleRate\":0.1,\"release\":\"1460-273bc90e\",\"ignoreErrorNames\":[\"NetworkError\",\"SecurityError\"],\"ignoreErrorsPreset\":\"ReactApp\",\"tags\":{\"app_name\":\"heifetz\"}}"},window)}();
</script><meta name="darkreader" content="dc4d7355ac414537b0f678422c953019"><style class="darkreader darkreader--override" media="screen">.vimvixen-hint {
    background-color: #7b5300 !important;
    border-color: #d8b013 !important;
    color: #f3e8c8 !important;
}
#vimvixen-console-frame {
    color-scheme: light !important;
}
::placeholder {
    opacity: 0.5 !important;
}
#edge-translate-panel-body,
.MuiTypography-body1,
.nfe-quote-text {
    color: var(--darkreader-neutral-text) !important;
}
gr-main-header {
    background-color: #0f3a48 !important;
}
.tou-z65h9k,
.tou-mignzq,
.tou-1b6i2ox,
.tou-lnqlqk {
    background-color: var(--darkreader-neutral-background) !important;
}
.tou-75mvi {
    background-color: #032029 !important;
}
.tou-ta9e87,
.tou-1w3fhi0,
.tou-1b8t2us,
.tou-py7lfi,
.tou-1lpmd9d,
.tou-1frrtv8,
.tou-17ezmgn {
    background-color: #0a0a0a !important;
}
.tou-uknfeu {
    background-color: #231603 !important;
}
.tou-6i3zyv {
    background-color: #19576c !important;
}
div.mermaid-viewer-control-panel .btn {
    background-color: var(--darkreader-neutral-background);
    fill: var(--darkreader-neutral-text);
}
svg g rect.er {
    fill: var(--darkreader-neutral-background) !important;
}
svg g rect.er.entityBox {
    fill: var(--darkreader-neutral-background) !important;
}
svg g rect.er.attributeBoxOdd {
    fill: var(--darkreader-neutral-background) !important;
}
svg g rect.er.attributeBoxEven {
    fill: var(--darkreader-selection-background);
    fill-opacity: 0.8 !important;
}
svg rect.er.relationshipLabelBox {
    fill: var(--darkreader-neutral-background) !important;
}
svg g g.nodes rect,
svg g g.nodes polygon {
    fill: var(--darkreader-neutral-background) !important;
}
svg g rect.task {
    fill: var(--darkreader-selection-background) !important;
}
svg line.messageLine0,
svg line.messageLine1 {
    stroke: var(--darkreader-neutral-text) !important;
}
div.mermaid .actor {
    fill: var(--darkreader-neutral-background) !important;
}
mitid-authenticators-code-app > .code-app-container {
    background-color: white !important;
    padding-top: 1rem;
}
iframe#unpaywall[src$="unpaywall.html"] {
    color-scheme: light !important;
}
embed[type="application/pdf"][src="about:blank"] { filter: invert(100%) contrast(90%); }</style><script crossorigin="anonymous" data-sentry-config="{&quot;dsn&quot;:&quot;https://2d8d764432cc4f6fb3bc78ab9528299d@crash2.zhihu.com/1224&quot;,&quot;sampleRate&quot;:0.1,&quot;release&quot;:&quot;1460-273bc90e&quot;,&quot;ignoreErrorNames&quot;:[&quot;NetworkError&quot;,&quot;SecurityError&quot;],&quot;ignoreErrorsPreset&quot;:&quot;ReactApp&quot;,&quot;tags&quot;:{&quot;app_name&quot;:&quot;heifetz&quot;}}" src="./cute 之 高效GEMM实现 - 知乎_files/init.js"></script><style data-emotion-css="55n9hh">.css-55n9hh{position:fixed;top:0;right:0;left:0;z-index:101;display:none;height:2px;pointer-events:none;background:#1772F6;-webkit-transform:translateX(-100%);-ms-transform:translateX(-100%);transform:translateX(-100%);}</style><style class="darkreader darkreader--sync" media="screen"></style><style data-emotion-css="1l12z7y">.css-1l12z7y{box-shadow:0px 16px 32px rgba(0,0,0,0.04);}</style><style class="darkreader darkreader--sync" media="screen"></style><style data-emotion-css="1hlrcxk">.css-1hlrcxk{-webkit-transition-property:fill;transition-property:fill;-webkit-transition-duration:0.25s;transition-duration:0.25s;-webkit-transition-timing-function:ease-in;transition-timing-function:ease-in;}</style><style class="darkreader darkreader--sync" media="screen"></style><style data-emotion-css="icip60">.css-icip60{border-radius:2px;}</style><style class="darkreader darkreader--sync" media="screen"></style><style data-emotion-css="fnnb9l">.css-fnnb9l{box-sizing:border-box;margin:0;min-width:0;max-width:100%;height:auto;background-color:#ffffff;width:30px;height:30px;border-radius:2px;}</style><style class="darkreader darkreader--sync" media="screen"></style><style data-emotion-css="78p1r9">.css-78p1r9{box-sizing:border-box;margin:0;min-width:0;margin-left:auto;margin-right:auto;max-width:690px;margin-top:0;}@media screen and (min-width:40em){.css-78p1r9{margin-top:1em;}}</style><style class="darkreader darkreader--sync" media="screen"></style><style data-emotion-css="tjq515">.css-tjq515{position:relative;padding-bottom:54%;height:0;border-radius:inherit;}</style><style class="darkreader darkreader--sync" media="screen"></style><style data-emotion-css="1arczt3">.css-1arczt3{box-sizing:border-box;margin:0;min-width:0;position:relative;padding-bottom:54%;height:0;border-radius:inherit;}</style><style class="darkreader darkreader--sync" media="screen"></style><style data-emotion-css="1ld0bim">.css-1ld0bim{position:absolute;top:0;left:0;width:100%;height:100%;border-radius:inherit;}</style><style class="darkreader darkreader--sync" media="screen"></style><style data-emotion-css="uodor8">.css-uodor8{border-radius:50%;}</style><style class="darkreader darkreader--sync" media="screen"></style><style data-emotion-css="1syywx2">.css-1syywx2{box-sizing:border-box;margin:0;min-width:0;max-width:100%;height:auto;background-color:#ffffff;width:38px;height:38px;border-radius:50%;}</style><style class="darkreader darkreader--sync" media="screen"></style><style data-emotion-css="1cd9gw4">.css-1cd9gw4{margin-left:.3em;}</style><style class="darkreader darkreader--sync" media="screen"></style><style data-emotion-css="4gq0sj">.css-4gq0sj{box-sizing:border-box;margin:0;min-width:0;color:#09408e;display:inline-block;margin-left:.3em;}</style><style class="darkreader darkreader--sync" media="screen"></style><style data-emotion-css="1ldqog6">.css-1ldqog6{-webkit-transform:scale(1.1);-ms-transform:scale(1.1);transform:scale(1.1);}</style><style class="darkreader darkreader--sync" media="screen"></style><style data-emotion-css="z4ujak">.css-z4ujak{color:#8491a5;}</style><style class="darkreader darkreader--sync" media="screen"></style><style data-emotion-css="1od93p9">.css-1od93p9{margin-top:16px;position:relative;}</style><style class="darkreader darkreader--sync" media="screen"></style><style data-emotion-css="376mun">.css-376mun{position:relative;display:inline;}</style><style class="darkreader darkreader--sync" media="screen"></style><style data-emotion-css="1dlndns">.css-1dlndns{position:absolute;left:NaNpx;top:0;}</style><style class="darkreader darkreader--sync" media="screen"></style><style data-emotion-css="ldd79s">.css-ldd79s{box-sizing:border-box;margin:0;min-width:0;position:absolute;left:NaNpx;top:0;}</style><style class="darkreader darkreader--sync" media="screen"></style><style data-emotion-css="dg64xe">.css-dg64xe .FileLinkCard{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;background-color:rgba(248,248,250,0.88);border-radius:12px;box-sizing:border-box;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;margin:1em auto;max-width:100%;overflow:hidden;padding:12px;position:relative;width:390px;}.css-dg64xe .FileLinkCard-icon{-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;height:30px;width:30px;}.css-dg64xe .FileLinkCard-info{margin-left:12px;}.css-dg64xe .FileLinkCard-name{color:#191B1F;font-size:15px;font-weight:500;line-height:21px;display:-webkit-box;text-overflow:ellipsis;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:2;}.css-dg64xe .FileLinkCard-meta{color:#9196a1;font-size:12px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;line-height:14px;margin-top:5px;}.css-dg64xe .FileLinkCard-source{white-space:pre;}.css-dg64xe img[data-uncomfortable]{content:url(data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%20344.88888888888886%20194%22%3E%3CforeignObject%20width%3D%22344.88888888888886%22%20height%3D%22194%22%3E%0A%20%20%20%20%20%20%3Cdiv%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxhtml%22%20style%3D%22font-size%3A%2013px%3B%20font-family%3A%20-apple-system%2C%20BlinkMacSystemFont%2C%20Microsoft%20YaHei%2C%20sans-serif%3B%20color%3A%20%23fff%3B%20width%3A100%25%3B%20height%3A194px%3B%22%3E%0A%20%20%20%20%20%20%20%20%3Cdiv%20style%3D%22display%3A%20flex%3B%20flex-direction%3A%20column%3B%20align-items%3A%20center%3B%20justify-content%3A%20center%3B%20height%3A%20100%25%3B%22%3E%0A%20%20%20%20%20%20%20%20%20%20%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%2218%22%20height%3D%2218%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22currentColor%22%3E%3Cpath%20d%3D%22M8%203.65a7%207%200%2000-1.353.128.65.65%200%2011-.25-1.275A8.3%208.3%200%20018%202.35c2.387%200%204.172.954%205.357%202.125C14.511%205.615%2015.15%207.022%2015.15%208c0%20.621-.257%201.391-.699%202.134a7.076%207.076%200%2001-1.403%201.68l.495.46a.65.65%200%2011-.886.951l-.998-.929a.645.645%200%2001-.104-.097L9.73%2010.501a.647.647%200%2001-.29.301%203.15%203.15%200%2001-4.313-4.094.647.647%200%2001.234-.275L3.908%205.08a5.774%205.774%200%2000-1.283%201.522C2.282%207.198%202.15%207.707%202.15%208c0%20.522.41%201.616%201.407%202.6.965.954%202.43%201.75%204.443%201.75.468%200%20.905-.043%201.311-.12a.65.65%200%2001.243%201.277A8.322%208.322%200%20018%2013.65c-2.387%200-4.172-.954-5.357-2.125C1.49%2010.385.85%208.978.85%208c0-.598.238-1.333.648-2.046A7.054%207.054%200%20012.95%204.188l-.547-.509a.65.65%200%2011.886-.951l8.8%208.194a5.793%205.793%200%20001.244-1.453c.372-.624.516-1.163.516-1.469%200-.522-.41-1.616-1.407-2.6-.965-.954-2.43-1.75-4.443-1.75zM6.29%207.296a1.85%201.85%200%20002.534%202.36l-2.535-2.36zM8%204.85a.65.65%200%20100%201.3%201.85%201.85%200%20011.843%201.694.65.65%200%20101.296-.11A3.15%203.15%200%20008%204.85z%22%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%3E%3C%2Fpath%3E%3C%2Fsvg%3E%0A%20%20%20%20%20%20%20%20%20%20%3Cdiv%20style%3D%22margin%3A%20.6em%200%201.2em%22%3E%E8%AF%A5%E5%9B%BE%E7%89%87%E6%9C%89%E5%8F%AF%E8%83%BD%E4%BC%9A%E5%BC%95%E8%B5%B7%E4%B8%8D%E9%80%82%3C%2Fdiv%3E%0A%20%20%20%20%20%20%20%20%20%20%3Cbutton%20style%3D%22padding%3A%204px%201em%3B%20font-size%3A%201.1em%3B%20color%3A%20inherit%3B%20background%3A%20none%3B%20border%3A%201px%20solid%20rgba%28255%2C255%2C255%2C.5%29%3B%20border-radius%3A%209999px%3B%22%3E%E7%BB%A7%E7%BB%AD%E6%9F%A5%E7%9C%8B%3C%2Fbutton%3E%0A%20%20%20%20%20%20%20%20%3C%2Fdiv%3E%0A%20%20%20%20%20%20%3C%2Fdiv%3E%0A%20%20%20%20%3C%2FforeignObject%3E%3C%2Fsvg%3E);width:100%;height:194px;background:url(https://pic1.zhimg.com/v2-cf70d0759d787c70091857151c1cad4a.jpeg) no-repeat rgba(191,191,191,0.7);background-size:cover;cursor:pointer!important;}.css-dg64xe img.content_image[data-size="normal"],.css-dg64xe img.origin_image[data-size="normal"]{width:100%;max-width:100%;}.css-dg64xe img.content_image[data-size="small"],.css-dg64xe img.origin_image[data-size="small"]{width:320px;max-width:100%;}</style><style class="darkreader darkreader--sync" media="screen"></style><style data-emotion-css="1vqsdx1">.css-1vqsdx1 .LinkCard.new{position:relative;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;box-sizing:border-box;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;width:390px;min-height:84px;border-radius:8px;max-width:100%;overflow:hidden;margin:16px auto;padding:12px 12px 9px 12px;background-color:#f8f8fa;}.css-1vqsdx1 .LinkCard.new,.css-1vqsdx1 .LinkCard.new:hover{-webkit-text-decoration:none;text-decoration:none;border:none !important;color:inherit !important;}.css-1vqsdx1 .LinkCard.new .LinkCard-contents{display:block;-webkit-flex:1 1 auto;-ms-flex:1 1 auto;flex:1 1 auto;position:relative;}.css-1vqsdx1 .LinkCard.new .LinkCard-contents .loading{height:14px;background:#ebeced;border-radius:7px;}.css-1vqsdx1 .LinkCard.new .LinkCard-contents.withTitle{margin-bottom:3px;}.css-1vqsdx1 .LinkCard.new .LinkCard-title{display:-webkit-box;font-size:15px;font-weight:500;line-height:1.4;margin-bottom:2px;color:#191B1F;text-overflow:ellipsis;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:1;}.css-1vqsdx1 .LinkCard.new .LinkCard-title.two-line{line-height:20px;display:-webkit-box;text-overflow:ellipsis;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:2;}.css-1vqsdx1 .LinkCard.new .LinkCard-title.loading{margin-bottom:8px;width:80%;}.css-1vqsdx1 .LinkCard.new .LinkCard-title.loading.withTitle{margin-bottom:6px;}.css-1vqsdx1 .LinkCard.new .LinkCard-title.loadingTitle{margin-bottom:5px;}.css-1vqsdx1 .LinkCard.new .LinkCard-excerpt{display:-webkit-box;text-overflow:ellipsis;font-size:13px;line-height:18px;color:#9196a1;margin-bottom:4px;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:1;}.css-1vqsdx1 .LinkCard.new .LinkCard-excerpt .LinkCard-author{color:#373a40;}.css-1vqsdx1 .LinkCard.new .LinkCard-desc{display:-webkit-box;font-size:13px;height:18px;line-height:18px;color:#9196a1;word-break:break-all;text-overflow:ellipsis;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:1;}.css-1vqsdx1 .LinkCard.new .LinkCard-desc .LinkCard-tag,.css-1vqsdx1 .LinkCard.new .LinkCard-desc .tag{display:inline-block;font-size:11px;margin-left:8px;padding:0 4px;border-radius:3px;background:rgba(196,199,206,0.3);}.css-1vqsdx1 .LinkCard.new .LinkCard-desc.loading{width:40%;}.css-1vqsdx1 .LinkCard.new .LinkCard-desc svg{margin-right:2px;}.css-1vqsdx1 .LinkCard.new .LinkCard-image{-webkit-flex:0 0 auto;-ms-flex:0 0 auto;flex:0 0 auto;background-color:#ebeced;background-size:cover;background-position:center;position:relative;display:block;width:60px;height:60px;margin-left:20px;object-fit:cover;border-radius:inherit;overflow:hidden;}.css-1vqsdx1 .LinkCard.new .LinkCard-image.LinkCard-image--default{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;background-color:#ebeced;color:#c4c7ce;}.css-1vqsdx1 .LinkCard.new .LinkCard-image.LinkCard-image--default svg{color:#9196a1;}.css-1vqsdx1 .LinkCard.new .LinkCard-image img{width:100%;height:100%;object-fit:cover;}.css-1vqsdx1 .LinkCard.new .LinkCard-image .LinkCard-image--video{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;position:absolute;top:50%;left:50%;-webkit-transform:translateX(-50%) translateY(-50%);-ms-transform:translateX(-50%) translateY(-50%);transform:translateX(-50%) translateY(-50%);width:24px;height:24px;border-radius:12px;background:rgba(255,255,255,0.9);pointer-events:none;}.css-1vqsdx1 .LinkCard.new .LinkCard-image .LinkCard-image--video svg{color:#373a40;}.css-1vqsdx1 .LinkCard.new .LinkCard-richText .text{color:#373a40;}.css-1vqsdx1 .LinkCard.new .LinkCard-richText .bold{font-weight:600;}.css-1vqsdx1 .LinkCard.new .LinkCard-richText .tag{margin-left:4px;}.css-1vqsdx1 .LinkCard.old{position:relative;display:block;margin:1em auto;width:390px;box-sizing:border-box;border-radius:12px;max-width:100%;overflow:hidden;}.css-1vqsdx1 .LinkCard.old,.css-1vqsdx1 .LinkCard.old:hover{-webkit-text-decoration:none;text-decoration:none;border:none !important;color:inherit !important;}.css-1vqsdx1 .LinkCard-ecommerceLoadingCard{position:relative;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;padding:12px;border-radius:inherit;height:80px;box-sizing:border-box;background:rgba(248,248,250,0.88);color:#c4c7ce;}.css-1vqsdx1 .LinkCard-ecommerceLoadingCardAvatarWrapper{width:60px;height:60px;background:#ebeced;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;border-radius:6px;margin-right:10px;}.css-1vqsdx1 .LinkCard-ecommerceLoadingCardNetwork{width:20px;height:20px;}.css-1vqsdx1 .LinkCard-ecommerceLoadingCardLoadingbar{height:60px;-webkit-flex:1;-ms-flex:1;flex:1;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}.css-1vqsdx1 .LinkCard-ecommerceLoadingCardLoadingbar span{height:16px;display:inline-block;background:#ebeced;}.css-1vqsdx1 .LinkCard-ecommerceLoadingCardLoadingbar span:nth-of-type(1){width:60px;margin-bottom:4px;}.css-1vqsdx1 .LinkCard-ecommerceLoadingCardLoadingbar span:nth-of-type(2){width:127px;}</style><style class="darkreader darkreader--sync" media="screen"></style><style data-emotion-css="yxro2d">.css-yxro2d .LinkCard.old{position:relative;display:block;margin:1em auto;width:390px;box-sizing:border-box;border-radius:12px;max-width:100%;overflow:hidden;}.css-yxro2d .LinkCard.old,.css-yxro2d .LinkCard.old:hover{-webkit-text-decoration:none;text-decoration:none;border:none !important;color:inherit !important;}.css-yxro2d .LinkCard-ecommerceLoadingCard{position:relative;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;padding:12px;border-radius:inherit;height:80px;box-sizing:border-box;background:rgba(248,248,250,0.88);color:#c4c7ce;}.css-yxro2d .LinkCard-ecommerceLoadingCardAvatarWrapper{width:60px;height:60px;background:#ebeced;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;border-radius:6px;margin-right:10px;}.css-yxro2d .LinkCard-ecommerceLoadingCardNetwork{width:20px;height:20px;}.css-yxro2d .LinkCard-ecommerceLoadingCardLoadingbar{height:60px;-webkit-flex:1;-ms-flex:1;flex:1;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}.css-yxro2d .LinkCard-ecommerceLoadingCardLoadingbar span{height:16px;display:inline-block;background:#ebeced;}.css-yxro2d .LinkCard-ecommerceLoadingCardLoadingbar span:nth-of-type(1){width:60px;margin-bottom:4px;}.css-yxro2d .LinkCard-ecommerceLoadingCardLoadingbar span:nth-of-type(2){width:127px;}.css-yxro2d .LinkCard.new{position:relative;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;box-sizing:border-box;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;width:390px;min-height:84px;border-radius:8px;max-width:100%;overflow:hidden;margin:16px auto;padding:12px 12px 9px 12px;background-color:#f8f8fa;}.css-yxro2d .LinkCard.new,.css-yxro2d .LinkCard.new:hover{-webkit-text-decoration:none;text-decoration:none;border:none !important;color:inherit !important;}.css-yxro2d .LinkCard.new .LinkCard-contents{display:block;-webkit-flex:1 1 auto;-ms-flex:1 1 auto;flex:1 1 auto;position:relative;}.css-yxro2d .LinkCard.new .LinkCard-contents .loading{height:14px;background:#ebeced;border-radius:7px;}.css-yxro2d .LinkCard.new .LinkCard-contents.withTitle{margin-bottom:3px;}.css-yxro2d .LinkCard.new .LinkCard-title{display:-webkit-box;font-size:15px;font-weight:500;line-height:1.4;margin-bottom:2px;color:#191B1F;text-overflow:ellipsis;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:1;}.css-yxro2d .LinkCard.new .LinkCard-title.two-line{line-height:20px;display:-webkit-box;text-overflow:ellipsis;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:2;}.css-yxro2d .LinkCard.new .LinkCard-title.loading{margin-bottom:8px;width:80%;}.css-yxro2d .LinkCard.new .LinkCard-title.loading.withTitle{margin-bottom:6px;}.css-yxro2d .LinkCard.new .LinkCard-title.loadingTitle{margin-bottom:5px;}.css-yxro2d .LinkCard.new .LinkCard-excerpt{display:-webkit-box;text-overflow:ellipsis;font-size:13px;line-height:18px;color:#9196a1;margin-bottom:4px;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:1;}.css-yxro2d .LinkCard.new .LinkCard-excerpt .LinkCard-author{color:#373a40;}.css-yxro2d .LinkCard.new .LinkCard-desc{display:-webkit-box;font-size:13px;height:18px;line-height:18px;color:#9196a1;word-break:break-all;text-overflow:ellipsis;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:1;}.css-yxro2d .LinkCard.new .LinkCard-desc .LinkCard-tag,.css-yxro2d .LinkCard.new .LinkCard-desc .tag{display:inline-block;font-size:11px;margin-left:8px;padding:0 4px;border-radius:3px;background:rgba(196,199,206,0.3);}.css-yxro2d .LinkCard.new .LinkCard-desc.loading{width:40%;}.css-yxro2d .LinkCard.new .LinkCard-desc svg{margin-right:2px;}.css-yxro2d .LinkCard.new .LinkCard-image{-webkit-flex:0 0 auto;-ms-flex:0 0 auto;flex:0 0 auto;background-color:#ebeced;background-size:cover;background-position:center;position:relative;display:block;width:60px;height:60px;margin-left:20px;object-fit:cover;border-radius:inherit;overflow:hidden;}.css-yxro2d .LinkCard.new .LinkCard-image.LinkCard-image--default{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;background-color:#ebeced;color:#c4c7ce;}.css-yxro2d .LinkCard.new .LinkCard-image.LinkCard-image--default svg{color:#9196a1;}.css-yxro2d .LinkCard.new .LinkCard-image img{width:100%;height:100%;object-fit:cover;}.css-yxro2d .LinkCard.new .LinkCard-image .LinkCard-image--video{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;position:absolute;top:50%;left:50%;-webkit-transform:translateX(-50%) translateY(-50%);-ms-transform:translateX(-50%) translateY(-50%);transform:translateX(-50%) translateY(-50%);width:24px;height:24px;border-radius:12px;background:rgba(255,255,255,0.9);pointer-events:none;}.css-yxro2d .LinkCard.new .LinkCard-image .LinkCard-image--video svg{color:#373a40;}.css-yxro2d .LinkCard.new .LinkCard-richText .text{color:#373a40;}.css-yxro2d .LinkCard.new .LinkCard-richText .bold{font-weight:600;}.css-yxro2d .LinkCard.new .LinkCard-richText .tag{margin-left:4px;}.css-yxro2d .FileLinkCard{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;background-color:rgba(248,248,250,0.88);border-radius:12px;box-sizing:border-box;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;margin:1em auto;max-width:100%;overflow:hidden;padding:12px;position:relative;width:390px;}.css-yxro2d .FileLinkCard-icon{-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;height:30px;width:30px;}.css-yxro2d .FileLinkCard-info{margin-left:12px;}.css-yxro2d .FileLinkCard-name{color:#191B1F;font-size:15px;font-weight:500;line-height:21px;display:-webkit-box;text-overflow:ellipsis;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:2;}.css-yxro2d .FileLinkCard-meta{color:#9196a1;font-size:12px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;line-height:14px;margin-top:5px;}.css-yxro2d .FileLinkCard-source{white-space:pre;}.css-yxro2d img[data-uncomfortable]{content:url(data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%20344.88888888888886%20194%22%3E%3CforeignObject%20width%3D%22344.88888888888886%22%20height%3D%22194%22%3E%0A%20%20%20%20%20%20%3Cdiv%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxhtml%22%20style%3D%22font-size%3A%2013px%3B%20font-family%3A%20-apple-system%2C%20BlinkMacSystemFont%2C%20Microsoft%20YaHei%2C%20sans-serif%3B%20color%3A%20%23fff%3B%20width%3A100%25%3B%20height%3A194px%3B%22%3E%0A%20%20%20%20%20%20%20%20%3Cdiv%20style%3D%22display%3A%20flex%3B%20flex-direction%3A%20column%3B%20align-items%3A%20center%3B%20justify-content%3A%20center%3B%20height%3A%20100%25%3B%22%3E%0A%20%20%20%20%20%20%20%20%20%20%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%2218%22%20height%3D%2218%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22currentColor%22%3E%3Cpath%20d%3D%22M8%203.65a7%207%200%2000-1.353.128.65.65%200%2011-.25-1.275A8.3%208.3%200%20018%202.35c2.387%200%204.172.954%205.357%202.125C14.511%205.615%2015.15%207.022%2015.15%208c0%20.621-.257%201.391-.699%202.134a7.076%207.076%200%2001-1.403%201.68l.495.46a.65.65%200%2011-.886.951l-.998-.929a.645.645%200%2001-.104-.097L9.73%2010.501a.647.647%200%2001-.29.301%203.15%203.15%200%2001-4.313-4.094.647.647%200%2001.234-.275L3.908%205.08a5.774%205.774%200%2000-1.283%201.522C2.282%207.198%202.15%207.707%202.15%208c0%20.522.41%201.616%201.407%202.6.965.954%202.43%201.75%204.443%201.75.468%200%20.905-.043%201.311-.12a.65.65%200%2001.243%201.277A8.322%208.322%200%20018%2013.65c-2.387%200-4.172-.954-5.357-2.125C1.49%2010.385.85%208.978.85%208c0-.598.238-1.333.648-2.046A7.054%207.054%200%20012.95%204.188l-.547-.509a.65.65%200%2011.886-.951l8.8%208.194a5.793%205.793%200%20001.244-1.453c.372-.624.516-1.163.516-1.469%200-.522-.41-1.616-1.407-2.6-.965-.954-2.43-1.75-4.443-1.75zM6.29%207.296a1.85%201.85%200%20002.534%202.36l-2.535-2.36zM8%204.85a.65.65%200%20100%201.3%201.85%201.85%200%20011.843%201.694.65.65%200%20101.296-.11A3.15%203.15%200%20008%204.85z%22%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%3E%3C%2Fpath%3E%3C%2Fsvg%3E%0A%20%20%20%20%20%20%20%20%20%20%3Cdiv%20style%3D%22margin%3A%20.6em%200%201.2em%22%3E%E8%AF%A5%E5%9B%BE%E7%89%87%E6%9C%89%E5%8F%AF%E8%83%BD%E4%BC%9A%E5%BC%95%E8%B5%B7%E4%B8%8D%E9%80%82%3C%2Fdiv%3E%0A%20%20%20%20%20%20%20%20%20%20%3Cbutton%20style%3D%22padding%3A%204px%201em%3B%20font-size%3A%201.1em%3B%20color%3A%20inherit%3B%20background%3A%20none%3B%20border%3A%201px%20solid%20rgba%28255%2C255%2C255%2C.5%29%3B%20border-radius%3A%209999px%3B%22%3E%E7%BB%A7%E7%BB%AD%E6%9F%A5%E7%9C%8B%3C%2Fbutton%3E%0A%20%20%20%20%20%20%20%20%3C%2Fdiv%3E%0A%20%20%20%20%20%20%3C%2Fdiv%3E%0A%20%20%20%20%3C%2FforeignObject%3E%3C%2Fsvg%3E);width:100%;height:194px;background:url(https://pic1.zhimg.com/v2-cf70d0759d787c70091857151c1cad4a.jpeg) no-repeat rgba(191,191,191,0.7);background-size:cover;cursor:pointer!important;}.css-yxro2d img.content_image[data-size="normal"],.css-yxro2d img.origin_image[data-size="normal"]{width:100%;max-width:100%;}.css-yxro2d img.content_image[data-size="small"],.css-yxro2d img.origin_image[data-size="small"]{width:320px;max-width:100%;}</style><style class="darkreader darkreader--sync" media="screen"></style><style data-emotion-css="1ygg4xu animation-1yvu044">.css-1ygg4xu{word-break:break-word;line-height:1.6;}.css-1ygg4xu > [data-first-child]{margin-top:0;}.css-1ygg4xu > :last-child{margin-bottom:0;}.css-1ygg4xu h1,.css-1ygg4xu h2{clear:left;margin-top:calc((1.4em * 2) / 1.2);margin-bottom:calc(1.4em / 1.2);font-size:1.2em;line-height:1.5;font-weight:600;}.css-1ygg4xu h3,.css-1ygg4xu h4,.css-1ygg4xu h5,.css-1ygg4xu h6{clear:left;margin-top:calc((1.4em * 1.5) / 1.1);margin-bottom:calc(1.4em / 1.1);font-size:1.1em;line-height:1.5;font-weight:600;}.css-1ygg4xu u{-webkit-text-decoration:none;text-decoration:none;border-bottom:1px solid #373a40;}.css-1ygg4xu b{font-weight:600;}.css-1ygg4xu sup{font-size:0.8em;}.css-1ygg4xu sup[data-draft-type='reference']{color:#09408e;}.css-1ygg4xu a:focus{outline:none;-webkit-transition:box-shadow 0.3s;transition:box-shadow 0.3s;}html[data-focus-visible] .css-1ygg4xu a:focus{box-shadow:0 0 0 2px #ffffff,0 0 0 4px rgba(23,114,246,0.3);}.css-1ygg4xu a.ztext-link,.css-1ygg4xu a.internal,.css-1ygg4xu a.external{-webkit-text-decoration:none;text-decoration:none;cursor:pointer;border-bottom:1px solid #81858f;}.css-1ygg4xu a.ztext-link:hover,.css-1ygg4xu a.internal:hover,.css-1ygg4xu a.external:hover{color:#09408e;border-bottom:1px solid #09408e;}.css-1ygg4xu a.ztext-link > .ellipsis::after,.css-1ygg4xu a.internal > .ellipsis::after,.css-1ygg4xu a.external > .ellipsis::after{content:'...';}.css-1ygg4xu a.ztext-link > .invisible,.css-1ygg4xu a.internal > .invisible,.css-1ygg4xu a.external > .invisible{font:0/0 a;color:transparent;text-shadow:none;background-color:transparent;}.css-1ygg4xu a.ztext-link u,.css-1ygg4xu a.internal u,.css-1ygg4xu a.external u{border:none;}.css-1ygg4xu a.member_mention{color:#09408e;}.css-1ygg4xu a.member_mention:hover{border-bottom:1px solid #09408e;}.css-1ygg4xu a.UserLink-link{color:#09408e;}.css-1ygg4xu a.UserLink-link:hover{border-bottom:1px solid #09408e;}.css-1ygg4xu p{margin:1.4em 0;}.css-1ygg4xu p.ztext-empty-paragraph{margin:calc((2.8em- (1.4em * 2 + 1.6em)) / 2) 0;}.css-1ygg4xu p.ztext-empty-paragraph + .ztext-empty-paragraph{margin:1.4em 0;}.css-1ygg4xu hr{margin:4em auto;width:240px;max-width:100%;border:none;border-top:1px solid #c4c7ce;}.css-1ygg4xu img[eeimg]{max-width:100%;vertical-align:middle;}.css-1ygg4xu img[eeimg="1"]{margin:0 3px;max-width:calc(100% - 6px);display:inline-block;}.css-1ygg4xu img[eeimg="2"]{margin:1.4em auto;display:block;}.css-1ygg4xu blockquote{margin:1.4em 0;padding-left:1em;color:#535861;border-left:3px solid #c4c7ce;}.css-1ygg4xu ol,.css-1ygg4xu ul{margin:1.4em 0;padding:0;width:100%;}.css-1ygg4xu ol ol,.css-1ygg4xu ul ol,.css-1ygg4xu ol ul,.css-1ygg4xu ul ul{margin:0;}.css-1ygg4xu ol li::before,.css-1ygg4xu ul li::before{width:1em;}.css-1ygg4xu ol > ol,.css-1ygg4xu ul > ol,.css-1ygg4xu ol > ul,.css-1ygg4xu ul > ul{padding-left:1em;box-sizing:border-box;}.css-1ygg4xu ul>li{display:table;width:100%;list-style:none;}.css-1ygg4xu ul>li::before{display:table-cell;content:'•  ';white-space:pre;}.css-1ygg4xu ol{counter-reset:ol;}.css-1ygg4xu ol > li{display:table;width:100%;list-style:none;}.css-1ygg4xu ol > li::before{display:table-cell;text-align:right;counter-increment:ol;content:counter(ol) '. ';white-space:pre;}.css-1ygg4xu ol ol{counter-reset:ol2;}.css-1ygg4xu ol ol li::before{counter-increment:ol2;content:counter(ol2) '. ';}.css-1ygg4xu ol ol ol{counter-reset:ol3;}.css-1ygg4xu ol ol ol li::before{counter-increment:ol3;content:counter(ol3) '. ';}.css-1ygg4xu ol ol ol ol{counter-reset:ol4;}.css-1ygg4xu ol ol ol ol li::before{counter-increment:ol4;content:counter(ol4) '. ';}.css-1ygg4xu figure{margin:1.4em 0;}.css-1ygg4xu figure .content_image,.css-1ygg4xu figure .origin_image{margin:0 auto;}.css-1ygg4xu figure figcaption{margin-top:calc(0.6em / 0.9);padding:0 1em;font-size:0.9em;line-height:1.5;text-align:center;color:#9196a1;}.css-1ygg4xu figure + figure{margin-top:calc(1.4em * 1.6);}.css-1ygg4xu figure[data-size='small'],.css-1ygg4xu figure:not([data-size]) > [data-size='small']{clear:both;}.css-1ygg4xu figure[data-size='left'],.css-1ygg4xu figure:not([data-size]) > [data-size='left']{float:left;margin:0 20px 20px 0;max-width:33%;}.css-1ygg4xu figure[data-size='right'],.css-1ygg4xu figure:not([data-size]) > [data-size='right']{float:right;margin:0 0 20px 20px;max-width:33%;}.css-1ygg4xu figure[data-size='collapse']{margin-bottom:0;}.css-1ygg4xu figure[data-size='collapse'] + figure{margin-top:0;}.css-1ygg4xu .content_image,.css-1ygg4xu .origin_image{display:block;max-width:100%;height:auto;margin:1.4em auto;}.css-1ygg4xu .content_image[data-size='small'],.css-1ygg4xu .origin_image[data-size='small']{max-width:40%;}.css-1ygg4xu .content_image.zh-lightbox-thumb,.css-1ygg4xu .origin_image.zh-lightbox-thumb{cursor:-webkit-zoom-in;cursor:-moz-zoom-in;cursor:zoom-in;}.css-1ygg4xu code{margin:0 2px;padding:3px 4px;border-radius:3px;font-family:Menlo,Monaco,Consolas,'Andale Mono','lucida console','Courier New',monospace;font-size:0.9em;background-color:#f8f8fa;}.css-1ygg4xu pre{margin:1.4em 0;padding:calc(0.8em / 0.9);font-size:0.9em;word-break:initial;word-wrap:initial;white-space:pre;overflow:auto;-webkit-overflow-scrolling:touch;background:#f8f8fa;border-radius:4px;}.css-1ygg4xu pre code{margin:0;padding:0;font-size:inherit;border-radius:0;background-color:inherit;}.css-1ygg4xu li pre{white-space:pre-wrap;}.css-1ygg4xu table[data-draft-type='table']{border-collapse:collapse;font-size:15px;margin:1.4em auto;max-width:100%;table-layout:fixed;text-align:left;width:100%;}.css-1ygg4xu table[data-draft-type='table'][data-size='small']{min-width:260px;width:40%;}.css-1ygg4xu table[data-draft-type='table'][data-row-style='striped'] tr:nth-of-type(2n + 1){background:#f8f8fa;}.css-1ygg4xu table[data-draft-type='table'] td,.css-1ygg4xu table[data-draft-type='table'] th{border:1px solid #c4c7ce;line-height:24px;height:24px;padding:3px 12px;}.css-1ygg4xu table[data-draft-type='table'] th{background:#ebeced;color:#191B1F;font-weight:500;}.css-1ygg4xu .video-box,.css-1ygg4xu .link-box{position:relative;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;margin:1.4em 0;overflow:auto;white-space:normal;cursor:pointer;border:solid 1px #ebeced;border-radius:4px;}.css-1ygg4xu .lazy[data-lazy-status]{background-color:#f8f8fa;}.css-1ygg4xu .lazy[data-lazy-status="ok"]{background-color:transparent;-webkit-animation:animation-1yvu044 0.5s ease-in;animation:animation-1yvu044 0.5s ease-in;}.css-1ygg4xu .highlight{margin:1em 0;}.css-1ygg4xu .highlight pre{margin:0;}.css-1ygg4xu .highlight .hll{background-color:#f8f8fa;}.css-1ygg4xu .highlight .c{font-style:italic;color:#9196a1;}.css-1ygg4xu .highlight .err{color:#D95350;}.css-1ygg4xu .highlight .k{font-weight:600;}.css-1ygg4xu .highlight .o{font-weight:600;}.css-1ygg4xu .highlight .cm{font-style:italic;color:#9196a1;}.css-1ygg4xu .highlight .cp{font-weight:600;color:#9196a1;}.css-1ygg4xu .highlight .c1{font-style:italic;color:#9196a1;}.css-1ygg4xu .highlight .cs{font-style:italic;font-weight:600;color:#9196a1;}.css-1ygg4xu .highlight .gd{color:#F05159;}.css-1ygg4xu .highlight .ge{font-style:italic;}.css-1ygg4xu .highlight .gr{color:#D95350;}.css-1ygg4xu .highlight .gh{color:#9196a1;}.css-1ygg4xu .highlight .gi{color:#12b370;}.css-1ygg4xu .highlight .go{color:#81858f;}.css-1ygg4xu .highlight .gp{color:#535861;}.css-1ygg4xu .highlight .gs{font-weight:600;}.css-1ygg4xu .highlight .gu{color:#9196a1;}.css-1ygg4xu .highlight .gt{color:#D95350;}.css-1ygg4xu .highlight .kc{font-weight:600;}.css-1ygg4xu .highlight .kd{font-weight:600;}.css-1ygg4xu .highlight .kn{font-weight:600;}.css-1ygg4xu .highlight .kp{font-weight:600;}.css-1ygg4xu .highlight .kr{font-weight:600;}.css-1ygg4xu .highlight .kt{font-weight:600;color:#09408e;}.css-1ygg4xu .highlight .m{color:#1772F6;}.css-1ygg4xu .highlight .s{color:#D95350;}.css-1ygg4xu .highlight .na{color:#1772F6;}.css-1ygg4xu .highlight .nb{color:#1772F6;}.css-1ygg4xu .highlight .nc{font-weight:600;color:#09408e;}.css-1ygg4xu .highlight .no{color:#1772F6;}.css-1ygg4xu .highlight .ni{color:#6A5FF3;}.css-1ygg4xu .highlight .ne{font-weight:600;color:#D95350;}.css-1ygg4xu .highlight .nf{font-weight:600;color:#D95350;}.css-1ygg4xu .highlight .nn{color:#535861;}.css-1ygg4xu .highlight .nt{color:#09408e;}.css-1ygg4xu .highlight .nv{color:#1772F6;}.css-1ygg4xu .highlight .ow{font-weight:600;}.css-1ygg4xu .highlight .w{color:#adb0b7;}.css-1ygg4xu .highlight .mf{color:#1772F6;}.css-1ygg4xu .highlight .mh{color:#1772F6;}.css-1ygg4xu .highlight .mi{color:#1772F6;}.css-1ygg4xu .highlight .mo{color:#1772F6;}.css-1ygg4xu .highlight .sb{color:#D95350;}.css-1ygg4xu .highlight .sc{color:#D95350;}.css-1ygg4xu .highlight .sd{color:#D95350;}.css-1ygg4xu .highlight .s2{color:#D95350;}.css-1ygg4xu .highlight .se{color:#D95350;}.css-1ygg4xu .highlight .sh{color:#D95350;}.css-1ygg4xu .highlight .si{color:#D95350;}.css-1ygg4xu .highlight .sx{color:#D95350;}.css-1ygg4xu .highlight .sr{color:#A5542F;}.css-1ygg4xu .highlight .s1{color:#D95350;}.css-1ygg4xu .highlight .ss{color:#D95350;}.css-1ygg4xu .highlight .bp{color:#9196a1;}.css-1ygg4xu .highlight .vc{color:#1772F6;}.css-1ygg4xu .highlight .vg{color:#1772F6;}.css-1ygg4xu .highlight .vi{color:#1772F6;}.css-1ygg4xu .highlight .il{color:#1772F6;}.css-1ygg4xu .highlight::-webkit-scrollbar{width:6px;height:6px;}.css-1ygg4xu .highlight::-webkit-scrollbar-thumb:horizontal{background-color:rgba(25,27,31,0.5);border-radius:6px;}.css-1ygg4xu .highlight::-webkit-scrollbar-thumb:horizontal:hover{background-color:rgba(25,27,31,0.6);}.css-1ygg4xu .LinkCard.old{position:relative;display:block;margin:1em auto;width:390px;box-sizing:border-box;border-radius:12px;max-width:100%;overflow:hidden;}.css-1ygg4xu .LinkCard.old,.css-1ygg4xu .LinkCard.old:hover{-webkit-text-decoration:none;text-decoration:none;border:none !important;color:inherit !important;}.css-1ygg4xu .LinkCard-ecommerceLoadingCard{position:relative;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;padding:12px;border-radius:inherit;height:80px;box-sizing:border-box;background:rgba(248,248,250,0.88);color:#c4c7ce;}.css-1ygg4xu .LinkCard-ecommerceLoadingCardAvatarWrapper{width:60px;height:60px;background:#ebeced;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;border-radius:6px;margin-right:10px;}.css-1ygg4xu .LinkCard-ecommerceLoadingCardNetwork{width:20px;height:20px;}.css-1ygg4xu .LinkCard-ecommerceLoadingCardLoadingbar{height:60px;-webkit-flex:1;-ms-flex:1;flex:1;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}.css-1ygg4xu .LinkCard-ecommerceLoadingCardLoadingbar span{height:16px;display:inline-block;background:#ebeced;}.css-1ygg4xu .LinkCard-ecommerceLoadingCardLoadingbar span:nth-of-type(1){width:60px;margin-bottom:4px;}.css-1ygg4xu .LinkCard-ecommerceLoadingCardLoadingbar span:nth-of-type(2){width:127px;}.css-1ygg4xu .LinkCard.new{position:relative;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;box-sizing:border-box;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;width:390px;min-height:84px;border-radius:8px;max-width:100%;overflow:hidden;margin:16px auto;padding:12px 12px 9px 12px;background-color:#f8f8fa;}.css-1ygg4xu .LinkCard.new,.css-1ygg4xu .LinkCard.new:hover{-webkit-text-decoration:none;text-decoration:none;border:none !important;color:inherit !important;}.css-1ygg4xu .LinkCard.new .LinkCard-contents{display:block;-webkit-flex:1 1 auto;-ms-flex:1 1 auto;flex:1 1 auto;position:relative;}.css-1ygg4xu .LinkCard.new .LinkCard-contents .loading{height:14px;background:#ebeced;border-radius:7px;}.css-1ygg4xu .LinkCard.new .LinkCard-contents.withTitle{margin-bottom:3px;}.css-1ygg4xu .LinkCard.new .LinkCard-title{display:-webkit-box;font-size:15px;font-weight:500;line-height:1.4;margin-bottom:2px;color:#191B1F;text-overflow:ellipsis;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:1;}.css-1ygg4xu .LinkCard.new .LinkCard-title.two-line{line-height:20px;display:-webkit-box;text-overflow:ellipsis;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:2;}.css-1ygg4xu .LinkCard.new .LinkCard-title.loading{margin-bottom:8px;width:80%;}.css-1ygg4xu .LinkCard.new .LinkCard-title.loading.withTitle{margin-bottom:6px;}.css-1ygg4xu .LinkCard.new .LinkCard-title.loadingTitle{margin-bottom:5px;}.css-1ygg4xu .LinkCard.new .LinkCard-excerpt{display:-webkit-box;text-overflow:ellipsis;font-size:13px;line-height:18px;color:#9196a1;margin-bottom:4px;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:1;}.css-1ygg4xu .LinkCard.new .LinkCard-excerpt .LinkCard-author{color:#373a40;}.css-1ygg4xu .LinkCard.new .LinkCard-desc{display:-webkit-box;font-size:13px;height:18px;line-height:18px;color:#9196a1;word-break:break-all;text-overflow:ellipsis;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:1;}.css-1ygg4xu .LinkCard.new .LinkCard-desc .LinkCard-tag,.css-1ygg4xu .LinkCard.new .LinkCard-desc .tag{display:inline-block;font-size:11px;margin-left:8px;padding:0 4px;border-radius:3px;background:rgba(196,199,206,0.3);}.css-1ygg4xu .LinkCard.new .LinkCard-desc.loading{width:40%;}.css-1ygg4xu .LinkCard.new .LinkCard-desc svg{margin-right:2px;}.css-1ygg4xu .LinkCard.new .LinkCard-image{-webkit-flex:0 0 auto;-ms-flex:0 0 auto;flex:0 0 auto;background-color:#ebeced;background-size:cover;background-position:center;position:relative;display:block;width:60px;height:60px;margin-left:20px;object-fit:cover;border-radius:inherit;overflow:hidden;}.css-1ygg4xu .LinkCard.new .LinkCard-image.LinkCard-image--default{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;background-color:#ebeced;color:#c4c7ce;}.css-1ygg4xu .LinkCard.new .LinkCard-image.LinkCard-image--default svg{color:#9196a1;}.css-1ygg4xu .LinkCard.new .LinkCard-image img{width:100%;height:100%;object-fit:cover;}.css-1ygg4xu .LinkCard.new .LinkCard-image .LinkCard-image--video{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;position:absolute;top:50%;left:50%;-webkit-transform:translateX(-50%) translateY(-50%);-ms-transform:translateX(-50%) translateY(-50%);transform:translateX(-50%) translateY(-50%);width:24px;height:24px;border-radius:12px;background:rgba(255,255,255,0.9);pointer-events:none;}.css-1ygg4xu .LinkCard.new .LinkCard-image .LinkCard-image--video svg{color:#373a40;}.css-1ygg4xu .LinkCard.new .LinkCard-richText .text{color:#373a40;}.css-1ygg4xu .LinkCard.new .LinkCard-richText .bold{font-weight:600;}.css-1ygg4xu .LinkCard.new .LinkCard-richText .tag{margin-left:4px;}.css-1ygg4xu .FileLinkCard{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;background-color:rgba(248,248,250,0.88);border-radius:12px;box-sizing:border-box;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;margin:1em auto;max-width:100%;overflow:hidden;padding:12px;position:relative;width:390px;}.css-1ygg4xu .FileLinkCard-icon{-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;height:30px;width:30px;}.css-1ygg4xu .FileLinkCard-info{margin-left:12px;}.css-1ygg4xu .FileLinkCard-name{color:#191B1F;font-size:15px;font-weight:500;line-height:21px;display:-webkit-box;text-overflow:ellipsis;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:2;}.css-1ygg4xu .FileLinkCard-meta{color:#9196a1;font-size:12px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;line-height:14px;margin-top:5px;}.css-1ygg4xu .FileLinkCard-source{white-space:pre;}.css-1ygg4xu img[data-uncomfortable]{content:url(data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%20344.88888888888886%20194%22%3E%3CforeignObject%20width%3D%22344.88888888888886%22%20height%3D%22194%22%3E%0A%20%20%20%20%20%20%3Cdiv%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxhtml%22%20style%3D%22font-size%3A%2013px%3B%20font-family%3A%20-apple-system%2C%20BlinkMacSystemFont%2C%20Microsoft%20YaHei%2C%20sans-serif%3B%20color%3A%20%23fff%3B%20width%3A100%25%3B%20height%3A194px%3B%22%3E%0A%20%20%20%20%20%20%20%20%3Cdiv%20style%3D%22display%3A%20flex%3B%20flex-direction%3A%20column%3B%20align-items%3A%20center%3B%20justify-content%3A%20center%3B%20height%3A%20100%25%3B%22%3E%0A%20%20%20%20%20%20%20%20%20%20%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%2218%22%20height%3D%2218%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22currentColor%22%3E%3Cpath%20d%3D%22M8%203.65a7%207%200%2000-1.353.128.65.65%200%2011-.25-1.275A8.3%208.3%200%20018%202.35c2.387%200%204.172.954%205.357%202.125C14.511%205.615%2015.15%207.022%2015.15%208c0%20.621-.257%201.391-.699%202.134a7.076%207.076%200%2001-1.403%201.68l.495.46a.65.65%200%2011-.886.951l-.998-.929a.645.645%200%2001-.104-.097L9.73%2010.501a.647.647%200%2001-.29.301%203.15%203.15%200%2001-4.313-4.094.647.647%200%2001.234-.275L3.908%205.08a5.774%205.774%200%2000-1.283%201.522C2.282%207.198%202.15%207.707%202.15%208c0%20.522.41%201.616%201.407%202.6.965.954%202.43%201.75%204.443%201.75.468%200%20.905-.043%201.311-.12a.65.65%200%2001.243%201.277A8.322%208.322%200%20018%2013.65c-2.387%200-4.172-.954-5.357-2.125C1.49%2010.385.85%208.978.85%208c0-.598.238-1.333.648-2.046A7.054%207.054%200%20012.95%204.188l-.547-.509a.65.65%200%2011.886-.951l8.8%208.194a5.793%205.793%200%20001.244-1.453c.372-.624.516-1.163.516-1.469%200-.522-.41-1.616-1.407-2.6-.965-.954-2.43-1.75-4.443-1.75zM6.29%207.296a1.85%201.85%200%20002.534%202.36l-2.535-2.36zM8%204.85a.65.65%200%20100%201.3%201.85%201.85%200%20011.843%201.694.65.65%200%20101.296-.11A3.15%203.15%200%20008%204.85z%22%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%3E%3C%2Fpath%3E%3C%2Fsvg%3E%0A%20%20%20%20%20%20%20%20%20%20%3Cdiv%20style%3D%22margin%3A%20.6em%200%201.2em%22%3E%E8%AF%A5%E5%9B%BE%E7%89%87%E6%9C%89%E5%8F%AF%E8%83%BD%E4%BC%9A%E5%BC%95%E8%B5%B7%E4%B8%8D%E9%80%82%3C%2Fdiv%3E%0A%20%20%20%20%20%20%20%20%20%20%3Cbutton%20style%3D%22padding%3A%204px%201em%3B%20font-size%3A%201.1em%3B%20color%3A%20inherit%3B%20background%3A%20none%3B%20border%3A%201px%20solid%20rgba%28255%2C255%2C255%2C.5%29%3B%20border-radius%3A%209999px%3B%22%3E%E7%BB%A7%E7%BB%AD%E6%9F%A5%E7%9C%8B%3C%2Fbutton%3E%0A%20%20%20%20%20%20%20%20%3C%2Fdiv%3E%0A%20%20%20%20%20%20%3C%2Fdiv%3E%0A%20%20%20%20%3C%2FforeignObject%3E%3C%2Fsvg%3E);width:100%;height:194px;background:url(https://pic1.zhimg.com/v2-cf70d0759d787c70091857151c1cad4a.jpeg) no-repeat rgba(191,191,191,0.7);background-size:cover;cursor:pointer!important;}.css-1ygg4xu img.content_image[data-size="normal"],.css-1ygg4xu img.origin_image[data-size="normal"]{width:100%;max-width:100%;}.css-1ygg4xu img.content_image[data-size="small"],.css-1ygg4xu img.origin_image[data-size="small"]{width:320px;max-width:100%;}@-webkit-keyframes animation-1yvu044{from{opacity:0;}to{opacity:1;}}@keyframes animation-1yvu044{from{opacity:0;}to{opacity:1;}}</style><style class="darkreader darkreader--sync" media="screen"></style><style data-emotion-css="ch8ocw">.css-ch8ocw{position:relative;display:inline-block;height:30px;padding:0 12px;font-size:14px;line-height:30px;color:#1772F6;vertical-align:top;border-radius:100px;background:rgba(23,114,246,0.1);}.css-ch8ocw:hover{background-color:rgba(23,114,246,0.15);}</style><style class="darkreader darkreader--sync" media="screen"></style><style data-emotion-css="1xlfegr">.css-1xlfegr{background:transparent;box-shadow:none;}</style><style class="darkreader darkreader--sync" media="screen"></style><style data-emotion-css="1gomreu">.css-1gomreu{position:relative;display:inline-block;}</style><style class="darkreader darkreader--sync" media="screen"></style><style data-emotion-css="1u7r5c9">.css-1u7r5c9{box-sizing:border-box;margin:0;min-width:0;max-width:100%;height:auto;background-color:#ffffff;width:40px;height:40px;border-radius:50%;}</style><style class="darkreader darkreader--sync" media="screen"></style><style type="text/css">.Marquee_module_marquee__218919a6 {
  overflow: hidden;
}

.Marquee_module_marqueeText__218919a6 {
  position: relative;
  transition: all 0.5s ease-in-out;
}
.Marquee_module_noAnimation__218919a6 {
  transition: none;
}

.Marquee_module_marqueeItem__218919a6 {
  display: flex;
  align-items: center;
  flex-wrap: nowrap;
  overflow: hidden;
  flex: 1;
}
</style><style class="darkreader darkreader--sync" media="screen"></style><style data-emotion="css"></style><style class="darkreader darkreader--sync" media="screen"></style></head><body class="WhiteBg-body PostIndex-body Body--isAppleDevice" aria-basefontsize="16" data-rh="class"><a id="ariaTipText" role="pagedescription" aria-label="欢迎进入 cute 之 高效GEMM实现 - 知乎,盲人用户使用操作智能引导，请按快捷键Ctrl+Alt+R；阅读详细操作说明请按快捷键Ctrl+Alt+问号键。" aria-atomic="true" href="javascript:void(0)" class="skipAutoFix" style="width: 1px; height: 1px;"><img src="https://zhuanlan.zhihu.com/p/675308830" style="width:1px !important;height:1px !important;position:absolute;top:0;"></a><div id="root"><div class="App"><div class="LoadingBar  css-55n9hh"></div><div><span style="position:absolute;top:-10000px;left:-10000px" role="log" aria-live="assertive"></span></div><main role="main" class="App-main"><div class="Post-content" data-zop-usertoken="{&quot;userToken&quot;:&quot;qyjdef&quot;}" data-zop="{&quot;authorName&quot;:&quot;reed&quot;,&quot;itemId&quot;:675308830,&quot;title&quot;:&quot;cute 之 高效GEMM实现&quot;,&quot;type&quot;:&quot;article&quot;}" data-za-detail-view-path-module="PostItem" data-za-extra-module="{&quot;card&quot;:{&quot;content&quot;:{&quot;type&quot;:&quot;Post&quot;,&quot;token&quot;:&quot;675308830&quot;}}}"><div class="ColumnPageHeader-Wrapper"><div><div class="Sticky ColumnPageHeader css-1l12z7y"><div class="ColumnPageHeader-content"><a href="https://www.zhihu.com/" aria-label="知乎"><svg viewBox="0 0 64 30" fill="#1772F6" width="64" height="30" class="css-1hlrcxk" data-darkreader-inline-fill="" style="--darkreader-inline-fill: #0751bc;"><path d="M29.05 4.582H16.733V25.94h3.018l.403 2.572 4.081-2.572h4.815V4.582zm-5.207 18.69l-2.396 1.509-.235-1.508h-1.724V7.233h6.78v16.04h-2.425zM14.46 14.191H9.982c0-.471.033-.954.039-1.458v-5.5h5.106V5.935a1.352 1.352 0 0 0-.404-.957 1.378 1.378 0 0 0-.968-.396H5.783c.028-.088.056-.177.084-.255.274-.82 1.153-3.326 1.153-3.326a4.262 4.262 0 0 0-2.413.698c-.57.4-.912.682-1.371 1.946-.532 1.453-.997 2.856-1.31 3.693C1.444 8.674.28 11.025.28 11.025a5.85 5.85 0 0 0 2.52-.61c1.119-.593 1.679-1.502 2.054-2.883l.09-.3h2.334v5.5c0 .5-.045.982-.073 1.46h-4.12c-.71 0-1.39.278-1.893.775a2.638 2.638 0 0 0-.783 1.874h6.527a17.717 17.717 0 0 1-.778 3.649 16.796 16.796 0 0 1-3.012 5.273A33.104 33.104 0 0 1 0 28.74s3.13 1.175 5.425-.954c1.388-1.292 2.631-3.814 3.23-5.727a28.09 28.09 0 0 0 1.12-5.229h5.967v-1.37a1.254 1.254 0 0 0-.373-.899 1.279 1.279 0 0 0-.909-.37z"></path><path d="M11.27 19.675l-2.312 1.491 5.038 7.458a6.905 6.905 0 0 0 .672-2.218 3.15 3.15 0 0 0-.28-2.168l-3.118-4.563zM51.449 15.195V5.842c4.181-.205 7.988-.405 9.438-.483l.851-.05c.387-.399.885-2.395.689-3.021-.073-.25-.213-.666-.638-.555a33.279 33.279 0 0 1-4.277.727c-2.766.321-3.97.404-7.804.682-6.718.487-12.709.72-12.709.72a2.518 2.518 0 0 0 .788 1.834 2.567 2.567 0 0 0 1.883.706c2.278-.095 5.598-.25 8.996-.41v9.203h-12.78c0 .703.281 1.377.783 1.874a2.69 2.69 0 0 0 1.892.777h10.105v7.075c0 .887-.464 1.192-1.231 1.214h-3.92a4.15 4.15 0 0 0 .837 1.544 4.2 4.2 0 0 0 1.403 1.067 6.215 6.215 0 0 0 2.71.277c1.36-.066 2.967-.826 2.967-3.57v-7.607h11.28c.342 0 .67-.135.91-.374.242-.239.378-.563.378-.902v-1.375H51.449z"></path><path d="M42.614 8.873a2.304 2.304 0 0 0-1.508-.926 2.334 2.334 0 0 0-1.727.405l-.376.272 4.255 5.85 2.24-1.62-2.884-3.98zM57.35 8.68l-3.125 4.097 2.24 1.663 4.517-5.927-.375-.277a2.32 2.32 0 0 0-1.722-.452 2.327 2.327 0 0 0-1.536.896z"></path></svg></a><i class="ColumnPageHeader-Line"></i><div class="ColumnPageHeader-Title"><div class="ColumnPageHeader-TitleName"><span class="ColumnPageHeader-TitleMeta">首发于</span><a class="ColumnLink ColumnPageHeader-TitleColumn" href="https://www.zhihu.com/column/c_1696937812497235968">CUDA高性能编程</a></div></div><div class="ColumnPageHeader-Button"><div class="Popover"><button title="更多" id="Popover1-toggle" aria-haspopup="true" aria-expanded="false" type="button" class="Button ColumnPageHeader-MenuToggler FEfUrdfMIKpQDJDqkjte Button--plain fEPKGkUK5jyc4fUuT0QP"><svg width="24" height="24" viewBox="0 0 24 24" class="Zi Zi--Dots" fill="currentColor" data-darkreader-inline-fill="" style="--darkreader-inline-fill: currentColor;"><path d="M6 10.5a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3ZM10.5 12a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0ZM16.5 12a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0Z"></path></svg></button></div><button type="button" class="Button ColumnPageHeader-WriteButton FEfUrdfMIKpQDJDqkjte Button--blue JmYzaky7MEPMFcJDLNMG"><svg width="24" height="24" viewBox="0 0 24 24" class="Zi Zi--EditSurround" fill="currentColor" data-darkreader-inline-fill="" style="--darkreader-inline-fill: currentColor;"><path d="M4.352 6.804A2.554 2.554 0 0 1 6.905 4.25h6.072a.875.875 0 0 0 0-1.75H6.905a4.304 4.304 0 0 0-4.303 4.304v10.142a4.304 4.304 0 0 0 4.303 4.304h10.143a4.304 4.304 0 0 0 4.304-4.304v-6.071a.875.875 0 0 0-1.75 0v6.071a2.554 2.554 0 0 1-2.554 2.554H6.905a2.554 2.554 0 0 1-2.553-2.554V6.804Z"></path><path d="M20.595 4.731a.875.875 0 1 0-1.237-1.237l-7.763 7.762a.875.875 0 1 0 1.238 1.238l7.762-7.763Z"></path></svg>写文章</button></div></div><div class="ColumnPageHeader-profile"><div class="Popover AppHeader-menu"><button id="Popover4-toggle" aria-haspopup="true" aria-expanded="false" type="button" class="Button AppHeader-profileEntry FEfUrdfMIKpQDJDqkjte Button--plain fEPKGkUK5jyc4fUuT0QP"><img class="Avatar AppHeader-profileAvatar css-fnnb9l" src="./cute 之 高效GEMM实现 - 知乎_files/v2-c58ab06f0991ecef82f9d358f471cfd3_l.jpg" srcset="https://picx.zhimg.com/v2-c58ab06f0991ecef82f9d358f471cfd3_l.jpg?source=32738c0c 2x" alt="点击打开DefTruth的主页"></button></div><div class="Popover ddLajxN_Q0AuobBZjX9m AppHeaderProfileMenu-creatorHintPopover"><div class="AppHeaderProfileMenu-creatorHintToggler" id="Popover5-toggle" aria-haspopup="true" aria-expanded="false"></div></div></div></div></div></div><div class="css-78p1r9"><div class="css-1arczt3"><div class="css-1ld0bim"><span style="box-sizing: border-box; display: block; overflow: hidden; width: initial; height: initial; background: none; opacity: 1; border: 0px; margin: 0px; padding: 0px; --darkreader-inline-bgimage: none; --darkreader-inline-bgcolor: initial; --darkreader-inline-border-top: 0px; --darkreader-inline-border-right: 0px; --darkreader-inline-border-bottom: 0px; --darkreader-inline-border-left: 0px;" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left=""><picture><source type="image/avif" srcset="https://pica.zhimg.com/70/v2-145b8f31c7cf00c4608350d53b9646eb_1440w.avis?source=172ae18b&amp;biz_tag=Post 1x, https://pica.zhimg.com/70/v2-145b8f31c7cf00c4608350d53b9646eb_1440w.avis?source=172ae18b&amp;biz_tag=Post 2x" src="https://pica.zhimg.com/70/v2-145b8f31c7cf00c4608350d53b9646eb_1440w.avis?source=172ae18b&amp;biz_tag=Post"><source type="image/webp" srcset="https://pica.zhimg.com/70/v2-145b8f31c7cf00c4608350d53b9646eb_1440w.awebp?source=172ae18b&amp;biz_tag=Post 1x, https://pica.zhimg.com/70/v2-145b8f31c7cf00c4608350d53b9646eb_1440w.awebp?source=172ae18b&amp;biz_tag=Post 2x" src="https://pica.zhimg.com/70/v2-145b8f31c7cf00c4608350d53b9646eb_1440w.awebp?source=172ae18b&amp;biz_tag=Post"><img alt="cute 之 高效GEMM实现" decoding="async" style="position: absolute; inset: 0px; box-sizing: border-box; padding: 0px; border: none; margin: auto; display: block; width: 0px; height: 0px; min-width: 100%; max-width: 100%; min-height: 100%; max-height: 100%; --darkreader-inline-border-top: none; --darkreader-inline-border-right: none; --darkreader-inline-border-bottom: none; --darkreader-inline-border-left: none;" width="100%" src="./cute 之 高效GEMM实现 - 知乎_files/v2-145b8f31c7cf00c4608350d53b9646eb_1440w.image" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="" srcset="https://pica.zhimg.com/70/v2-145b8f31c7cf00c4608350d53b9646eb_1440w.image?source=172ae18b&amp;biz_tag=Post 1x, https://pica.zhimg.com/70/v2-145b8f31c7cf00c4608350d53b9646eb_1440w.image?source=172ae18b&amp;biz_tag=Post 2x"></picture></span></div></div></div><article class="Post-Main Post-NormalMain" tabindex="-1"><header class="Post-Header"><h1 class="Post-Title">cute 之 高效GEMM实现</h1><div class="Post-Author"><div class="AuthorInfo" itemprop="author" itemscope="" itemtype="http://schema.org/Person"><div class="AuthorInfo"><meta itemprop="name" content="reed"><meta itemprop="image" content="https://picx.zhimg.com/v2-e9c299bcbb6d098601ce529e9a358d82_l.jpg?source=172ae18b"><meta itemprop="url" content="https://www.zhihu.com/people/reed-84-49"><meta itemprop="zhihu:followerCount"><span class="UserLink AuthorInfo-avatarWrapper"><div class="css-1gomreu"><a href="https://www.zhihu.com/people/reed-84-49" target="_blank" class="UserLink-link" data-za-detail-view-element_name="User"><img class="Avatar AuthorInfo-avatar css-1syywx2" src="./cute 之 高效GEMM实现 - 知乎_files/v2-e9c299bcbb6d098601ce529e9a358d82_l.jpg" srcset="https://picx.zhimg.com/v2-e9c299bcbb6d098601ce529e9a358d82_l.jpg?source=172ae18b 2x" alt="reed"></a></div></span><div class="AuthorInfo-content"><div class="AuthorInfo-head"><span class="UserLink AuthorInfo-name"><div class="css-1gomreu"><a href="https://www.zhihu.com/people/reed-84-49" target="_blank" class="UserLink-link" data-za-detail-view-element_name="User">reed</a></div><a href="https://www.zhihu.com/question/48510028" target="_blank" class="css-4gq0sj" aria-label="中国科学院大学 理学博士" data-tooltip="中国科学院大学 理学博士"><span style="display:inline-flex;align-items:center">​<svg width="18" height="18" fill="none" viewBox="0 0 24 24" class="ZDI ZDI--BadgeCertNewStrokeLightFill24 css-1ldqog6"><path fill="#fff" d="M12 2c-2.02.05-1.86 1.2-3.38 1.83-1.48.61-2.33-.26-3.69 1.1-1.39 1.47-.46 2.17-1.1 3.69C3.2 10.14 2.05 9.98 2 12c.05 2.02 1.2 1.86 1.83 3.38.63 1.52-.3 2.22 1.1 3.69 1.36 1.35 2.21.49 3.69 1.1 1.52.63 1.36 1.78 3.38 1.83 2.02-.05 1.86-1.2 3.38-1.83 1.48-.61 2.33.26 3.69-1.1 1.39-1.47.46-2.16 1.1-3.69.63-1.52 1.78-1.36 1.83-3.38-.05-2.02-1.2-1.86-1.83-3.38-.63-1.52.3-2.22-1.1-3.69-1.36-1.35-2.21-.49-3.69-1.1C13.86 3.2 14.02 2.05 12 2Z" style="fill: rgb(255, 255, 255); fill-opacity: 1; --darkreader-inline-fill: #e8e6e3;" data-darkreader-inline-fill=""></path><path fill="url(#id-106203557-a)" fill-rule="evenodd" d="M3 12c0 1.449 1.035 1.251 1.755 2.997s-.144 2.34.882 3.366c1.026 1.026 1.62.153 3.366.882C10.749 19.965 10.551 21 12 21c1.449 0 1.251-1.035 2.997-1.755s2.34.144 3.366-.882c1.026-1.026.153-1.62.882-3.366C19.965 13.251 21 13.44 21 12c0-1.449-1.035-1.251-1.755-2.997s.144-2.34-.882-3.366c-1.026-1.026-1.62-.153-3.366-.882C13.251 4.035 13.449 3 12 3c-1.449 0-1.251 1.035-2.997 1.755s-2.34-.144-3.366.882c-1.026 1.026-.153 1.62-.882 3.366C4.035 10.749 3 10.551 3 12Z" clip-rule="evenodd"></path><path fill="#fff" fill-rule="evenodd" d="m10.003 15.355-2.37-2.699s-.413-.634.217-1.226c.63-.591 1.195-.197 1.195-.197l1.758 1.92 4.226-4.439s.597-.313 1.17.178c.572.49.243 1.244.243 1.244s-3.12 3.472-4.839 5.204c-.881.837-1.6.015-1.6.015Z" clip-rule="evenodd" style="fill: rgb(255, 255, 255); fill-opacity: 1; --darkreader-inline-fill: #e8e6e3;" data-darkreader-inline-fill=""></path><defs><lineargradient id="id-106203557-a" x1="5.7" x2="15.6" y1="5.7" y2="19.2" gradientUnits="userSpaceOnUse"><stop stop-color="#47D3FF" style="stop-color: rgb(71, 211, 255); stop-opacity: 1; --darkreader-inline-stopcolor: #4bd4ff;" data-darkreader-inline-stopcolor=""></stop><stop offset="1" stop-color="#4A7DFF" style="--darkreader-inline-stopcolor: #002da0;" data-darkreader-inline-stopcolor=""></stop></lineargradient></defs></svg></span></a></span></div><div class="AuthorInfo-detail"><div class="AuthorInfo-badge"><div class="ztext AuthorInfo-badgeText css-0">中国科学院大学 理学博士</div></div></div></div></div></div><button type="button" class="Button FollowButton FEfUrdfMIKpQDJDqkjte Button--primary Button--grey epMJl0lFQuYbC7jrwr_o ZdfrHW7Ef5ZjwFiiBJuS">已关注</button></div><div class="LabelContainer-wrapper"><div class="LabelContainer css-36m2wi"><div><div class="css-vphnkw" style="cursor: pointer;"><div class="css-4rl99m"><div class="css-140fcia">创作声明：内容包含虚构创作</div></div><svg width="26" height="26" viewBox="0 0 24 24" fill="#09408e" class="Zi Zi--ArrowDown css-ouwgqw" data-darkreader-inline-fill="" style="--darkreader-inline-fill: #7abbf7;"><path fill-rule="evenodd" d="M17.776 10.517a.875.875 0 0 1-.248 1.212l-5.05 3.335a.875.875 0 0 1-.964 0L6.47 11.73a.875.875 0 1 1 .965-1.46l4.56 3.015 4.568-3.016a.875.875 0 0 1 1.212.248Z" clip-rule="evenodd"></path></svg></div></div></div></div><div><div class="css-dvccr2"><div class="css-1lr85n">炼金术士、Micro 等 136 人赞同了该文章</div></div></div><span class="css-z4ujak"></span></header><div class="Post-RichTextContainer"><div class="css-1od93p9"><div class="css-376mun"><div class="css-l44lgl"><div class="css-n0s5iy"><div class="css-s1xz2x"><div><div class="Catalog isCatalogV2 css-17v5fjs" data-za-detail-view-name="正文"><div class="css-8kjoqe"><div class="css-1e6hvbc"><div class="css-zkfaav"><span style="display: inline-flex; align-items: center;">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="ZDI ZDI--Catalog24" fill="currentColor" data-darkreader-inline-fill="" style="--darkreader-inline-fill: currentColor;"><path d="M10 5a1 1 0 011-1h10a1 1 0 110 2H11a1 1 0 01-1-1zm4 6a1 1 0 100 2h7a1 1 0 100-2h-7zm0 7a1 1 0 100 2h7a1 1 0 100-2h-7zm-8.335.25a.915.915 0 01-.915-.915V12.75H10a.75.75 0 000-1.5H4.75V6.665c0-.505.41-.915.915-.915H7a.75.75 0 000-1.5H5.665A2.415 2.415 0 003.25 6.665v10.67a2.415 2.415 0 002.415 2.415H10a.75.75 0 000-1.5H5.665z"></path></svg></span><div class="css-5287jj">目录</div></div><div class="css-1ifd8ga">收起</div></div></div><div class="css-vm33ny"><div class="Catalog-content css-a3sv8e"><div class="Catalog-FirstLevelTitle Catalog-Title css-lvmdsl"><div data-catalog-target-id="h_675308830_0" data-za-detail-view-id="9745" data-za-detail-view-action="Click" data-za-detail-view-name="正文" class="css-byi3it"><div class="css-nj7ofv">计算高效</div></div></div><div class="Catalog-FirstLevelTitle Catalog-Title css-lvmdsl"><div data-catalog-target-id="h_675308830_1" data-za-detail-view-id="9745" data-za-detail-view-action="Click" data-za-detail-view-name="正文" class="css-byi3it"><div class="css-nj7ofv">访存高效</div></div></div><div class="Catalog-FirstLevelTitle Catalog-Title css-lvmdsl"><div data-catalog-target-id="h_675308830_2" data-za-detail-view-id="9745" data-za-detail-view-action="Click" data-za-detail-view-name="正文" class="css-byi3it"><div class="css-nj7ofv">算法高效</div></div></div><div class="Catalog-FirstLevelTitle Catalog-Title css-lvmdsl"><div data-catalog-target-id="h_675308830_3" data-za-detail-view-id="9745" data-za-detail-view-action="Click" data-za-detail-view-name="正文" class="css-byi3it"><div class="css-nj7ofv">尾阶段高效（Epilogue）</div></div></div><div class="Catalog-FirstLevelTitle Catalog-Title css-lvmdsl"><div data-catalog-target-id="h_675308830_4" data-za-detail-view-id="9745" data-za-detail-view-action="Click" data-za-detail-view-name="正文" class="css-byi3it"><div class="css-nj7ofv">试验设置和结果</div></div></div><div class="Catalog-FirstLevelTitle Catalog-Title css-lvmdsl"><div data-catalog-target-id="h_675308830_5" data-za-detail-view-id="9745" data-za-detail-view-action="Click" data-za-detail-view-name="正文" class="css-byi3it"><div class="css-nj7ofv">总结和讨论</div></div></div><div class="Catalog-SecondLevelTitle Catalog-Title css-1nds53c"><div data-catalog-target-id="h_675308830_6" data-za-detail-view-id="9745" data-za-detail-view-action="Click" data-za-detail-view-name="正文" class="css-h0sxub"><div class="css-nj7ofv">启发式算法</div></div></div><div class="Catalog-SecondLevelTitle Catalog-Title css-1nds53c"><div data-catalog-target-id="h_675308830_7" data-za-detail-view-id="9745" data-za-detail-view-action="Click" data-za-detail-view-name="正文" class="css-h0sxub"><div class="css-nj7ofv">参数相容性</div></div></div><div class="Catalog-SecondLevelTitle Catalog-Title css-1nds53c"><div data-catalog-target-id="h_675308830_8" data-za-detail-view-id="9745" data-za-detail-view-action="Click" data-za-detail-view-name="正文" class="css-h0sxub"><div class="css-nj7ofv">其它方面</div></div></div><div class="Catalog-SecondLevelTitle Catalog-Title css-1nds53c"><div data-catalog-target-id="h_675308830_9" data-za-detail-view-id="9745" data-za-detail-view-action="Click" data-za-detail-view-name="正文" class="css-h0sxub"><div class="css-nj7ofv">总结</div></div></div><div class="Catalog-FirstLevelTitle Catalog-Title css-lvmdsl"><div data-catalog-target-id="h_675308830_10" data-za-detail-view-id="9745" data-za-detail-view-action="Click" data-za-detail-view-name="正文" class="css-byi3it"><div class="css-nj7ofv">参考</div></div></div></div></div></div></div></div></div></div><div class="RichText ztext Post-RichText css-1ygg4xu" options="[object Object]"><p data-first-child="" data-pid="u4_NTx4z">前面的文章我们介绍了cute中的<a href="https://zhuanlan.zhihu.com/p/661182311" class="internal" data-za-detail-view-id="1043">Layout抽象</a>、<a href="https://zhuanlan.zhihu.com/p/663093816" class="internal" data-za-detail-view-id="1043">Tensor抽象</a>、<a href="https://zhuanlan.zhihu.com/p/663092747" class="internal" data-za-detail-view-id="1043">MMA抽象</a>、<a href="https://zhuanlan.zhihu.com/p/666232173" class="internal" data-za-detail-view-id="1043">Copy抽象</a>、<a href="https://zhuanlan.zhihu.com/p/671419093" class="internal" data-za-detail-view-id="1043">Swizzle抽象</a>和<a href="https://zhuanlan.zhihu.com/p/665082713" class="internal" data-za-detail-view-id="1043">流水线技术</a>。本文将组合利用这些抽象和技术形成高效的矩阵乘法。为了更好地实现高效的矩阵乘法，本文从多个维度介绍了高效的实现方法。在文章结构上，本文首先介绍了计算高效，然后介绍了访存高效，再后介绍了算法高效，最后介绍了尾阶段高效。我们基于这些高效方案利用cute实现了高效的矩阵乘法，并和cuBLAS、cuBLASLt进行了性能对比，对比结果表明我们的实现达到了SOTA水平。文章最后讨论了搜索kernel的启发式算法和参数相容性问题并对文章进行了总结。</p><h2 id="h_675308830_0" data-into-catalog-status="">计算高效</h2><p data-pid="8DQMY6NZ">GEMM中的核心计算部分是块状的矩阵乘法，针对输入为半精度类型（half precision），Accumulator为半精度类型的计算任务，Ampere架构提供了Tensor Core上的如下计算指令</p><ul><li data-pid="f9dQruFm"><code>mma.sync.aligned.m16n8k8.row.col.f16.f16.f16.f16</code></li><li data-pid="QFgEOfBo"><code>mma.sync.aligned.m16n8k16.row.col.f16.f16.f16.f16</code>， </li></ul><p data-pid="7q6EJ7FK">cute将这两条指令抽象为MMA_Operation：</p><ul><li data-pid="gckBzpnJ"><code>SM80_16x8x8_F16F16F16F16_TN</code>和</li><li data-pid="_eIldKVV"><code>SM80_16x8x16_F16F16F16F16_TN</code>，</li></ul><p data-pid="chT_8cf7">当我们的问题规格较大时，我们尽可能选用计算量更大的指令，这样同一条指令产生的计算任务就更多，可以减少指令数目，提升调度效率。</p><p data-pid="FY9mczL8">选定计算指令之后，我们便可以通过MMA_Traits，如图1，在MMA_Operation的基础上补充上后续计算所需要的其它信息，如矩阵计算的形状、该指令所需要的协作线程（此处为32线程）、A、B矩阵的寄存器Layout分布情况。有了MMA_Traits之后，我们便可以将其进一步封装为MMA_Atom，其利用Traits提供的信息，提供数据划分所需要的信息和Operation的执行功能。MMA_Atom描述了矩阵计算的原子能力（单条指令的计算能力，最小能力），我们通过增加更多的线程、每个线程做多次任务则可以将计算的规格增大，如此则有了TiledMMA，TiledMMA针对每一个线程则被分裂为ThrMMA，TiledMMA和ThrMMA利用MMA_Atom提供的信息，能够实现对矩阵块的划分。调用相应的cute::gemm函数即可以完成矩阵乘法计算。</p><figure data-size="normal"><noscript><img src="https://pic4.zhimg.com/v2-0182682744b1a9f77a1adf63ae473873_b.jpg" data-size="normal" data-rawwidth="1587" data-rawheight="2114" class="origin_image zh-lightbox-thumb" width="1587" data-original="https://pic4.zhimg.com/v2-0182682744b1a9f77a1adf63ae473873_r.jpg"/></noscript><div><img src="./cute 之 高效GEMM实现 - 知乎_files/v2-0182682744b1a9f77a1adf63ae473873_1440w.webp" data-size="normal" data-rawwidth="1587" data-rawheight="2114" class="origin_image zh-lightbox-thumb lazy" width="1587" data-original="https://pic4.zhimg.com/v2-0182682744b1a9f77a1adf63ae473873_r.jpg" data-actualsrc="https://pic4.zhimg.com/v2-0182682744b1a9f77a1adf63ae473873_b.jpg" data-original-token="v2-d10f297a1220cca836229a7146daaf67" height="2114" data-lazy-status="ok"></div><figcaption>Figure 1. MMA能力层次和各层的主要功能</figcaption></figure><p data-pid="e-E_6gqy">此时，我们便可以得到如下主机端代码</p><div class="highlight"><pre><code class="language-cpp">  <span class="k">using</span> <span class="n">mma_op</span> <span class="o">=</span> <span class="n">SM80_16x8x16_F16F16F16F16_TN</span><span class="p">;</span>
  <span class="k">using</span> <span class="n">mma_traits</span> <span class="o">=</span> <span class="n">MMA_Traits</span><span class="o">&lt;</span><span class="n">mma_op</span><span class="o">&gt;</span><span class="p">;</span>
  <span class="k">using</span> <span class="n">mma_atom</span> <span class="o">=</span> <span class="n">MMA_Atom</span><span class="o">&lt;</span><span class="n">mma_traits</span><span class="o">&gt;</span><span class="p">;</span>

  <span class="k">static</span> <span class="k">constexpr</span> <span class="kt">int</span> <span class="n">kMmaEURepeatM</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
  <span class="k">static</span> <span class="k">constexpr</span> <span class="kt">int</span> <span class="n">kMmaEURepeatN</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
  <span class="k">static</span> <span class="k">constexpr</span> <span class="kt">int</span> <span class="n">kMmaEURepeatK</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>

  <span class="k">static</span> <span class="k">constexpr</span> <span class="kt">int</span> <span class="n">kMmaVRepeatM</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
  <span class="k">static</span> <span class="k">constexpr</span> <span class="kt">int</span> <span class="n">kMmaVRepeatN</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
  <span class="k">static</span> <span class="k">constexpr</span> <span class="kt">int</span> <span class="n">kMmaVRepeatK</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>

  <span class="k">using</span> <span class="n">MMA_EU_RepeatT</span> <span class="o">=</span> <span class="k">decltype</span><span class="p">(</span><span class="n">make_layout</span><span class="p">(</span><span class="n">make_shape</span><span class="p">(</span>
      <span class="n">Int</span><span class="o">&lt;</span><span class="n">kMmaEURepeatM</span><span class="o">&gt;</span><span class="p">{},</span> <span class="n">Int</span><span class="o">&lt;</span><span class="n">kMmaEURepeatN</span><span class="o">&gt;</span><span class="p">{},</span> <span class="n">Int</span><span class="o">&lt;</span><span class="n">kMmaEURepeatK</span><span class="o">&gt;</span><span class="p">{})));</span>
  <span class="k">using</span> <span class="n">MMA_V_RepeatT</span> <span class="o">=</span> <span class="k">decltype</span><span class="p">(</span><span class="n">make_layout</span><span class="p">(</span><span class="n">make_shape</span><span class="p">(</span>
      <span class="n">Int</span><span class="o">&lt;</span><span class="n">kMmaVRepeatM</span><span class="o">&gt;</span><span class="p">{},</span> <span class="n">Int</span><span class="o">&lt;</span><span class="n">kMmaVRepeatN</span><span class="o">&gt;</span><span class="p">{},</span> <span class="n">Int</span><span class="o">&lt;</span><span class="n">kMmaVRepeatK</span><span class="o">&gt;</span><span class="p">{})));</span>

  <span class="k">using</span> <span class="n">MMA</span> <span class="o">=</span>
      <span class="k">decltype</span><span class="p">(</span><span class="n">make_tiled_mma</span><span class="p">(</span><span class="n">mma_atom</span><span class="p">{},</span> <span class="n">MMA_EU_RepeatT</span><span class="p">{},</span> <span class="n">MMA_V_RepeatT</span><span class="p">{}));</span>
</code></pre></div><p data-pid="DCqTznoF">其中前三行选择了MMA指令形成了Atom能力，然后定义了对该Atom能力的重复方法（包括线程重复和寄存器重复），它们分别形成各自重复的Layout，然后利用<code>make_tile_mma</code>接口形成更大块的矩阵乘法描述。设备端的代码如下：</p><div class="highlight"><pre><code class="language-cpp">  <span class="n">TiledMMA</span> <span class="n">tiled_mma</span><span class="p">;</span>
  <span class="k">auto</span> <span class="n">thr_mma</span> <span class="o">=</span> <span class="n">tiled_mma</span><span class="p">.</span><span class="n">get_slice</span><span class="p">(</span><span class="n">idx</span><span class="p">);</span>
  <span class="k">auto</span> <span class="n">tCrA</span> <span class="o">=</span> <span class="n">thr_mma</span><span class="p">.</span><span class="n">partition_fragment_A</span><span class="p">(</span><span class="n">gA</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="mi">0</span><span class="p">));</span>  <span class="c1">// (MMA, MMA_M, MMA_K)
</span><span class="c1"></span>  <span class="k">auto</span> <span class="n">tCrB</span> <span class="o">=</span> <span class="n">thr_mma</span><span class="p">.</span><span class="n">partition_fragment_B</span><span class="p">(</span><span class="n">gB</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="mi">0</span><span class="p">));</span>  <span class="c1">// (MMA, MMA_N, MMA_K)
</span><span class="c1"></span>  <span class="k">auto</span> <span class="n">tCrD</span> <span class="o">=</span> <span class="n">thr_mma</span><span class="p">.</span><span class="n">partition_fragment_C</span><span class="p">(</span><span class="n">gD</span><span class="p">);</span>           <span class="c1">// (MMA, MMA_M, MMA_N)
</span></code></pre></div><p data-pid="KoqZSQXd">将TileMMA提供线程号，则获得具体线程的数据划分能力，对给定的数据块进行划分，得到线程级的数据描述。</p><figure data-size="normal"><noscript><img src="https://pic1.zhimg.com/v2-fe899d28c68547b8175472b018113e04_b.jpg" data-size="normal" data-rawwidth="2235" data-rawheight="1933" class="origin_image zh-lightbox-thumb" width="2235" data-original="https://pic1.zhimg.com/v2-fe899d28c68547b8175472b018113e04_r.jpg"/></noscript><div><img src="data:image/svg+xml;utf8,&lt;svg xmlns=&#39;http://www.w3.org/2000/svg&#39; width=&#39;2235&#39; height=&#39;1933&#39;&gt;&lt;/svg&gt;" data-size="normal" data-rawwidth="2235" data-rawheight="1933" class="origin_image zh-lightbox-thumb lazy" width="2235" data-original="https://pic1.zhimg.com/v2-fe899d28c68547b8175472b018113e04_r.jpg" data-actualsrc="https://pic1.zhimg.com/v2-fe899d28c68547b8175472b018113e04_b.jpg" data-original-token="v2-ff7bf4c0a1d3e4119e4f77c2c4fd57a8"></div><figcaption>Figure 2. partition_A/B/C逻辑示意图</figcaption></figure><p data-pid="JFBnVqRT">如图2所示，其展示了ThrMMA提供的partition_A/B/C和partition_fragment_A/B/C函数的计算逻辑，给定一个静态大小的Tensor TileB（被划分维度为Int&lt;&gt;编译时常量），则thr_mma可以对其进行划分，其中划分的逻辑为：以TileMMA中描述的矩阵大小对目标Tensor进行周期性平铺，对高亮的部分进行选取形成新的矩阵，其中第一个维度为TiledMMA中单个线程的数据描述，第二个维度和第三个维度为行方向和列方向需要重复的次数。如果TileB的维度比两维高，则高出的部分继承到N,K维度之后。类似地，A/C的划分采用同样的逻辑。</p><h2 id="h_675308830_1" data-into-catalog-status="">访存高效</h2><p data-pid="CdIgkDWg">整个GEMM计算体系中数据的在到达Tensor Core进行计算之前需要包含：全局内存到共享内存，共享内存到寄存器，在流水线章节我们介绍过全局内存到共享内存的异步拷贝方法，和共享内存到寄存器的ldmatrix指令。在cute中，针对全局内存到共享内存，我们和选择MMA能力类似，选择cute已经定义好的抽象能力即可，此处我们选择<code>SM80_CP_ASYNC_CACHEGLOBAL</code>Copy_Operation，该指令可以实现全局内存到共享内存到异步拷贝，同时CACHEGLOBAL指示了数据只在L2做Cache，对L1则做bypass。于是我们可以形成如下主机端代码： </p><div class="highlight"><pre><code class="language-cpp">  <span class="k">using</span> <span class="n">g2s_copy_op</span> <span class="o">=</span> <span class="n">SM80_CP_ASYNC_CACHEGLOBAL</span><span class="o">&lt;</span><span class="n">cute</span><span class="o">::</span><span class="n">uint128_t</span><span class="o">&gt;</span><span class="p">;</span>
  <span class="k">using</span> <span class="n">g2s_copy_traits</span> <span class="o">=</span> <span class="n">Copy_Traits</span><span class="o">&lt;</span><span class="n">g2s_copy_op</span><span class="o">&gt;</span><span class="p">;</span>
  <span class="k">using</span> <span class="n">g2s_copy_atom</span> <span class="o">=</span> <span class="n">Copy_Atom</span><span class="o">&lt;</span><span class="n">g2s_copy_traits</span><span class="p">,</span> <span class="n">T</span><span class="o">&gt;</span><span class="p">;</span>

  <span class="k">using</span> <span class="n">G2SCopyA</span> <span class="o">=</span>
      <span class="k">decltype</span><span class="p">(</span><span class="n">make_tiled_copy</span><span class="p">(</span><span class="n">g2s_copy_atom</span><span class="p">{},</span>
                               <span class="n">make_layout</span><span class="p">(</span><span class="n">make_shape</span><span class="p">(</span><span class="n">Int</span><span class="o">&lt;</span><span class="mi">32</span><span class="o">&gt;</span><span class="p">{},</span> <span class="n">Int</span><span class="o">&lt;</span><span class="mi">4</span><span class="o">&gt;</span><span class="p">{}),</span>
                                           <span class="n">make_stride</span><span class="p">(</span><span class="n">Int</span><span class="o">&lt;</span><span class="mi">4</span><span class="o">&gt;</span><span class="p">{},</span> <span class="n">Int</span><span class="o">&lt;</span><span class="mi">1</span><span class="o">&gt;</span><span class="p">{})),</span>
                               <span class="n">make_layout</span><span class="p">(</span><span class="n">make_shape</span><span class="p">(</span><span class="n">Int</span><span class="o">&lt;</span><span class="mi">1</span><span class="o">&gt;</span><span class="p">{},</span> <span class="n">Int</span><span class="o">&lt;</span><span class="mi">8</span><span class="o">&gt;</span><span class="p">{}))));</span>
  <span class="k">using</span> <span class="n">G2SCopyB</span> <span class="o">=</span> <span class="n">G2SCopyA</span><span class="p">;</span>
</code></pre></div><p data-pid="FX2EHqZC">和MMA时的make_tiled_mma类似，Copy抽象提供了make_tile_copy能力，其通过制定线程和数据的重复方法将Atom能力扩展到块状能力。数据拷贝时可以区分AB矩阵的不同拷贝方法，我们此处选用同样的Copy能力。设备端代码如下</p><div class="highlight"><pre><code class="language-cpp">  <span class="n">G2SCopyA</span> <span class="n">g2s_tiled_copy_a</span><span class="p">;</span>
  <span class="k">auto</span> <span class="n">g2s_thr_copy_a</span> <span class="o">=</span> <span class="n">g2s_tiled_copy_a</span><span class="p">.</span><span class="n">get_slice</span><span class="p">(</span><span class="n">idx</span><span class="p">);</span>
  <span class="k">auto</span> <span class="n">tAgA_copy</span> <span class="o">=</span> <span class="n">g2s_thr_copy_a</span><span class="p">.</span><span class="n">partition_S</span><span class="p">(</span><span class="n">gA</span><span class="p">);</span>  <span class="c1">// (CPY, CPY_M, CPY_K, k)
</span><span class="c1"></span>  <span class="k">auto</span> <span class="n">tAsA_copy</span> <span class="o">=</span>
      <span class="n">g2s_thr_copy_a</span><span class="p">.</span><span class="n">partition_D</span><span class="p">(</span><span class="n">sA</span><span class="p">);</span>  <span class="c1">// (CPY, CPY_M, CPY_K, kStage)
</span></code></pre></div><p data-pid="7Jq9xRZq">和图1中的MMA层级类似，Copy时先将TileCopy通过指定线程号得到线程级的Copy能力抽象ThrCopy。也和图2中的MMA划分类似，ThrCopy抽象提供了partiton_S/D函数，其实现将大块的矩阵划分到线程维度上。经过partition_S/D划分的数据维度为(E, M, K)，E表示该线程要做的数据大小（包含分布），M、K表示由于给定的被划分的块需要在纵轴和横轴上需要重复的次数。如果被划分的Tile的维度大于2，则多出的维度附加到（，M，K）维度之后。</p><p data-pid="LTjvlWJE">对于共享内存到寄存器的拷贝，cute提供了对ldmatrix指令的封装，主机端代码和设备端代码分别如下：</p><div class="highlight"><pre><code class="language-cpp">  <span class="c1">// shared memory to register copy
</span><span class="c1"></span>  <span class="k">using</span> <span class="n">s2r_copy_op</span> <span class="o">=</span> <span class="n">SM75_U32x4_LDSM_N</span><span class="p">;</span>
  <span class="k">using</span> <span class="n">s2r_copy_traits</span> <span class="o">=</span> <span class="n">Copy_Traits</span><span class="o">&lt;</span><span class="n">s2r_copy_op</span><span class="o">&gt;</span><span class="p">;</span>
  <span class="k">using</span> <span class="n">s2r_copy_atom</span> <span class="o">=</span> <span class="n">Copy_Atom</span><span class="o">&lt;</span><span class="n">s2r_copy_traits</span><span class="p">,</span> <span class="n">T</span><span class="o">&gt;</span><span class="p">;</span>

  <span class="k">using</span> <span class="n">S2RCopyAtomA</span> <span class="o">=</span> <span class="n">s2r_copy_atom</span><span class="p">;</span>
  <span class="k">using</span> <span class="n">S2RCopyAtomB</span> <span class="o">=</span> <span class="n">s2r_copy_atom</span><span class="p">;</span>
</code></pre></div><p data-pid="f4yQVr0w">设备端代码：</p><div class="highlight"><pre><code class="language-cpp">  <span class="k">auto</span> <span class="n">s2r_tiled_copy_a</span> <span class="o">=</span> <span class="n">make_tiled_copy_A</span><span class="p">(</span><span class="n">S2RCopyAtomA</span><span class="p">{},</span> <span class="n">tiled_mma</span><span class="p">);</span>
  <span class="k">auto</span> <span class="n">s2r_thr_copy_a</span> <span class="o">=</span> <span class="n">s2r_tiled_copy_a</span><span class="p">.</span><span class="n">get_slice</span><span class="p">(</span><span class="n">idx</span><span class="p">);</span>
  <span class="k">auto</span> <span class="n">tAsA</span> <span class="o">=</span> <span class="n">s2r_thr_copy_a</span><span class="p">.</span><span class="n">partition_S</span><span class="p">(</span><span class="n">sA</span><span class="p">);</span>  <span class="c1">// (CPY, CPY_M, CPY_K, kStage)
</span><span class="c1"></span>  <span class="k">auto</span> <span class="n">tCrA_view</span> <span class="o">=</span> <span class="n">s2r_thr_copy_a</span><span class="p">.</span><span class="n">retile_D</span><span class="p">(</span><span class="n">tCrA</span><span class="p">);</span>  <span class="c1">// (CPY, CPY_M, CPY_K)
</span></code></pre></div><p data-pid="uAEd_J-B">其中主机端选择ldmatrix指令的x4模式，形成Atom抽象，设备端通过<code>make_tiled_copy_A</code>函数借助tiled_mma抽象出共享内存到寄存的TileCopy。前面的全局内存到共享内存TileCopy不同的是，这里直接利用tiled_mma的信息形成块状拷贝，原因是TiledMMA包含了计算所需要的数据描述，所以对于以它作为目标的Copy而言，tiled_mma自然也是精准描述这部分数据的，所以就不需要用户额外制定Copy_Atom到TileCopy的信息，而是之间从MMA能力中获得，其一定程度上可以避免了独立设置的不一致性问题。由于MMA时已经声明了寄存器存储空间，此处直接对其进行线程级小块的retile即可，不再是大块到小块的partition。</p><h2 id="h_675308830_2" data-into-catalog-status="">算法高效</h2><p data-pid="QYV8QwAp">前面两个章节介绍了计算的高效和访存的高效，如何将这两个步骤组合起来也是GEMM性能的关键要素，这部分我们成为算法的高效。其主要包含两个部分：1. 分块；2. 流水线。这两部分内容我们在简单GEMM实现和流水线中都有介绍，我们此处就不再赘述。对于分块部分，我们主机端和设备端的代码如下：</p><div class="highlight"><pre><code class="language-cpp">  <span class="k">static</span> <span class="k">constexpr</span> <span class="kt">int</span> <span class="n">kTileM</span> <span class="o">=</span> <span class="n">kTileM_</span><span class="p">;</span>
  <span class="k">static</span> <span class="k">constexpr</span> <span class="kt">int</span> <span class="n">kTileN</span> <span class="o">=</span> <span class="n">kTileN_</span><span class="p">;</span>
  <span class="k">static</span> <span class="k">constexpr</span> <span class="kt">int</span> <span class="n">kTileK</span> <span class="o">=</span> <span class="n">kTileK_</span><span class="p">;</span>
  <span class="k">static</span> <span class="k">constexpr</span> <span class="kt">int</span> <span class="n">kStage</span> <span class="o">=</span> <span class="n">kStage_</span><span class="p">;</span>
</code></pre></div><p data-pid="NAAW7BWS">设备端：</p><div class="highlight"><pre><code class="language-cpp">  <span class="c1">// slice the tensor to small one which is used for current thread block.
</span><span class="c1"></span>  <span class="n">Tensor</span> <span class="n">gA</span> <span class="o">=</span> <span class="n">local_tile</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">make_tile</span><span class="p">(</span><span class="n">Int</span><span class="o">&lt;</span><span class="n">kTileM</span><span class="o">&gt;</span><span class="p">{},</span> <span class="n">Int</span><span class="o">&lt;</span><span class="n">kTileK</span><span class="o">&gt;</span><span class="p">{}),</span>
                         <span class="n">make_coord</span><span class="p">(</span><span class="n">iy</span><span class="p">,</span> <span class="n">_</span><span class="p">));</span>  <span class="c1">// (kTileM, kTileK, k)
</span><span class="c1"></span>  <span class="n">Tensor</span> <span class="n">gB</span> <span class="o">=</span> <span class="n">local_tile</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">make_tile</span><span class="p">(</span><span class="n">Int</span><span class="o">&lt;</span><span class="n">kTileN</span><span class="o">&gt;</span><span class="p">{},</span> <span class="n">Int</span><span class="o">&lt;</span><span class="n">kTileK</span><span class="o">&gt;</span><span class="p">{}),</span>
                         <span class="n">make_coord</span><span class="p">(</span><span class="n">ix</span><span class="p">,</span> <span class="n">_</span><span class="p">));</span>  <span class="c1">// (kTileN, kTileK, k)
</span><span class="c1"></span>  <span class="n">Tensor</span> <span class="n">gD</span> <span class="o">=</span> <span class="n">local_tile</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">make_tile</span><span class="p">(</span><span class="n">Int</span><span class="o">&lt;</span><span class="n">kTileM</span><span class="o">&gt;</span><span class="p">{},</span> <span class="n">Int</span><span class="o">&lt;</span><span class="n">kTileN</span><span class="o">&gt;</span><span class="p">{}),</span>
                         <span class="n">make_coord</span><span class="p">(</span><span class="n">iy</span><span class="p">,</span> <span class="n">ix</span><span class="p">));</span>  <span class="c1">// (kTileM, kTileN)
</span><span class="c1"></span>
  <span class="c1">// shared memory
</span><span class="c1"></span>  <span class="k">auto</span> <span class="n">sA</span> <span class="o">=</span> <span class="n">make_tensor</span><span class="p">(</span><span class="n">make_smem_ptr</span><span class="p">(</span><span class="n">Ashm</span><span class="p">),</span>
                        <span class="n">SmemLayoutA</span><span class="p">{});</span>  <span class="c1">// (kTileM, kTileK, kStage)
</span><span class="c1"></span>  <span class="k">auto</span> <span class="n">sB</span> <span class="o">=</span> <span class="n">make_tensor</span><span class="p">(</span><span class="n">make_smem_ptr</span><span class="p">(</span><span class="n">Bshm</span><span class="p">),</span>
                        <span class="n">SmemLayoutB</span><span class="p">{});</span>  <span class="c1">// (kTileN, kTileK, kStage)
</span></code></pre></div><p data-pid="AAyB64Ii">分别定义了分块的大小和设备端如何通过Tensor抽象和local_tile将矩阵进行分块。</p><p data-pid="KE8_3OO0">流水线方面，为了做multi stage流水线，需要在共享内存分配时指定流水线级数，同时设备端需要做必要的数据加载和计算重叠方案。主机端代码如下</p><div class="highlight"><pre><code class="language-cpp">  <span class="k">static</span> <span class="k">constexpr</span> <span class="kt">int</span> <span class="n">kShmLoadSwizzleM</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
  <span class="k">static</span> <span class="k">constexpr</span> <span class="kt">int</span> <span class="n">kShmLoadSwizzleS</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
  <span class="k">static</span> <span class="k">constexpr</span> <span class="kt">int</span> <span class="n">kShmLoadSwizzleB</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>

  <span class="k">using</span> <span class="n">SmemLayoutAtom</span> <span class="o">=</span> <span class="k">decltype</span><span class="p">(</span><span class="n">composition</span><span class="p">(</span>
      <span class="n">Swizzle</span><span class="o">&lt;</span><span class="n">kShmLoadSwizzleB</span><span class="p">,</span> <span class="n">kShmLoadSwizzleM</span><span class="p">,</span> <span class="n">kShmLoadSwizzleS</span><span class="o">&gt;</span><span class="p">{},</span>
      <span class="n">make_layout</span><span class="p">(</span><span class="n">make_shape</span><span class="p">(</span><span class="n">Int</span><span class="o">&lt;</span><span class="mi">8</span><span class="o">&gt;</span><span class="p">{},</span> <span class="n">Int</span><span class="o">&lt;</span><span class="n">kTileK</span><span class="o">&gt;</span><span class="p">{}),</span>
                  <span class="n">make_stride</span><span class="p">(</span><span class="n">Int</span><span class="o">&lt;</span><span class="n">kTileK</span><span class="o">&gt;</span><span class="p">{},</span> <span class="n">Int</span><span class="o">&lt;</span><span class="mi">1</span><span class="o">&gt;</span><span class="p">{}))));</span>
  <span class="k">using</span> <span class="n">SmemLayoutA</span> <span class="o">=</span> <span class="k">decltype</span><span class="p">(</span>
      <span class="n">tile_to_shape</span><span class="p">(</span><span class="n">SmemLayoutAtom</span><span class="p">{},</span>
                    <span class="n">make_shape</span><span class="p">(</span><span class="n">Int</span><span class="o">&lt;</span><span class="n">kTileM</span><span class="o">&gt;</span><span class="p">{},</span> <span class="n">Int</span><span class="o">&lt;</span><span class="n">kTileK</span><span class="o">&gt;</span><span class="p">{},</span> <span class="n">Int</span><span class="o">&lt;</span><span class="n">kStage</span><span class="o">&gt;</span><span class="p">{})));</span>
  <span class="k">using</span> <span class="n">SmemLayoutB</span> <span class="o">=</span> <span class="k">decltype</span><span class="p">(</span>
      <span class="n">tile_to_shape</span><span class="p">(</span><span class="n">SmemLayoutAtom</span><span class="p">{},</span>
                    <span class="n">make_shape</span><span class="p">(</span><span class="n">Int</span><span class="o">&lt;</span><span class="n">kTileN</span><span class="o">&gt;</span><span class="p">{},</span> <span class="n">Int</span><span class="o">&lt;</span><span class="n">kTileK</span><span class="o">&gt;</span><span class="p">{},</span> <span class="n">Int</span><span class="o">&lt;</span><span class="n">kStage</span><span class="o">&gt;</span><span class="p">{})));</span>
</code></pre></div><p data-pid="OHH3jyAb">其定义了共享内存的Layout，其中Swizzle用来避免bank conflict，其详细介绍可以参考前序文章cute之Siwzzle抽象，其中kStage表示流水线的级数。</p><p data-pid="Wm1RlqAK">核心设备端代码由两个for循环组成，具体如下，</p><div class="highlight"><pre><code class="language-cpp">  <span class="c1">// loop over k: i. load tile, ii. mma
</span><span class="c1"></span>  <span class="kt">int</span> <span class="n">ntile</span> <span class="o">=</span> <span class="n">k</span> <span class="o">/</span> <span class="n">kTileK</span><span class="p">;</span>
<span class="cp">#pragma unroll 1
</span><span class="cp"></span>  <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">itile</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">itile</span> <span class="o">&lt;</span> <span class="n">ntile</span><span class="p">;</span> <span class="o">++</span><span class="n">itile</span><span class="p">)</span> <span class="p">{</span>
    <span class="kt">int</span> <span class="n">nk</span> <span class="o">=</span> <span class="n">size</span><span class="o">&lt;</span><span class="mi">2</span><span class="o">&gt;</span><span class="p">(</span><span class="n">tCrA</span><span class="p">);</span>

<span class="cp">#pragma unroll
</span><span class="cp"></span>    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">ik</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">ik</span> <span class="o">&lt;</span> <span class="n">nk</span><span class="p">;</span> <span class="o">++</span><span class="n">ik</span><span class="p">)</span> <span class="p">{</span>
      <span class="kt">int</span> <span class="n">ik_next</span> <span class="o">=</span> <span class="p">(</span><span class="n">ik</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">nk</span><span class="p">;</span>

      <span class="k">if</span> <span class="p">(</span><span class="n">ik</span> <span class="o">==</span> <span class="n">nk</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">cp_async_wait</span><span class="o">&lt;</span><span class="n">kStage</span> <span class="o">-</span> <span class="mi">2</span><span class="o">&gt;</span><span class="p">();</span>
        <span class="n">__syncthreads</span><span class="p">();</span>

        <span class="n">ismem_read</span> <span class="o">=</span> <span class="p">(</span><span class="n">ismem_read</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">kStage</span><span class="p">;</span>
      <span class="p">}</span>

      <span class="c1">// shm -&gt; reg s[itile][ik + 1] -&gt; r[ik + 1]
</span><span class="c1"></span>      <span class="n">cute</span><span class="o">::</span><span class="n">copy</span><span class="p">(</span><span class="n">s2r_tiled_copy_a</span><span class="p">,</span> <span class="n">tAsA</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">ik_next</span><span class="p">,</span> <span class="n">ismem_read</span><span class="p">),</span>
                 <span class="n">tCrA_view</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">ik_next</span><span class="p">));</span>
      <span class="n">cute</span><span class="o">::</span><span class="n">copy</span><span class="p">(</span><span class="n">s2r_tiled_copy_b</span><span class="p">,</span> <span class="n">tBsB</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">ik_next</span><span class="p">,</span> <span class="n">ismem_read</span><span class="p">),</span>
                 <span class="n">tCrB_view</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">ik_next</span><span class="p">));</span>

      <span class="k">if</span> <span class="p">(</span><span class="n">ik</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">itile_to_read</span> <span class="o">&lt;</span> <span class="n">ntile</span><span class="p">)</span> <span class="p">{</span>
          <span class="n">cute</span><span class="o">::</span><span class="n">copy</span><span class="p">(</span><span class="n">g2s_tiled_copy_a</span><span class="p">,</span> <span class="n">tAgA_copy</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">itile_to_read</span><span class="p">),</span> <span class="n">tAsA_copy</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">ismem_write</span><span class="p">));</span>
          <span class="n">cute</span><span class="o">::</span><span class="n">copy</span><span class="p">(</span><span class="n">g2s_tiled_copy_b</span><span class="p">,</span> <span class="n">tBgB_copy</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">itile_to_read</span><span class="p">),</span> <span class="n">tBsB_copy</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">ismem_write</span><span class="p">));</span>

          <span class="o">++</span><span class="n">itile_to_read</span><span class="p">;</span>
          <span class="n">ismem_write</span> <span class="o">=</span> <span class="p">(</span><span class="n">ismem_write</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">kStage</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="n">cp_async_fence</span><span class="p">();</span>
      <span class="p">}</span>

      <span class="n">cute</span><span class="o">::</span><span class="n">gemm</span><span class="p">(</span><span class="n">tiled_mma</span><span class="p">,</span> <span class="n">tCrD</span><span class="p">,</span> <span class="n">tCrA</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">ik</span><span class="p">),</span> <span class="n">tCrB</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">ik</span><span class="p">),</span> <span class="n">tCrD</span><span class="p">);</span>
    <span class="p">}</span>  <span class="c1">// for ik
</span><span class="c1"></span>  <span class="p">}</span>    <span class="c1">// itile
</span></code></pre></div><p data-pid="KVEc4AAu">外层循环对Tile做循环，内层循环对Tile内做k循环，同时在ik == 0 和 ik == nk -1的时候发射了后kStage-1的Tile的全局内层到共享内存的数据加载和针对即将读取的共享内存的数据同步。</p><h2 id="h_675308830_3" data-into-catalog-status="">尾阶段高效（Epilogue）</h2><p data-pid="EYhvQAg-">通过上面的计算、加载、算法，我们便可以得到矩阵乘之后的块状的数据，这些数据表示为线程内寄存器，由于数据存储，将这些数据存储出去并不平凡，如图3所示，如果将寄存器数据直接写出，则在全局地址空间中会产生内存地址的不连续，这将导致存储时需要更多的内存事务，并且不能使用向量化存储指令（STG.128）。</p><figure data-size="normal"><noscript><img src="https://pic4.zhimg.com/v2-ddece7971d1161bbf7c7fa8022859993_b.jpg" data-size="normal" data-rawwidth="4333" data-rawheight="1819" class="origin_image zh-lightbox-thumb" width="4333" data-original="https://pic4.zhimg.com/v2-ddece7971d1161bbf7c7fa8022859993_r.jpg"/></noscript><div><img src="data:image/svg+xml;utf8,&lt;svg xmlns=&#39;http://www.w3.org/2000/svg&#39; width=&#39;4333&#39; height=&#39;1819&#39;&gt;&lt;/svg&gt;" data-size="normal" data-rawwidth="4333" data-rawheight="1819" class="origin_image zh-lightbox-thumb lazy" width="4333" data-original="https://pic4.zhimg.com/v2-ddece7971d1161bbf7c7fa8022859993_r.jpg" data-actualsrc="https://pic4.zhimg.com/v2-ddece7971d1161bbf7c7fa8022859993_b.jpg" data-original-token="v2-fc06bf3c88dec25a069880ca4f7510ad"></div><figcaption>Figure 3. 寄存器堆直接存储至全局内存引入的不连续</figcaption></figure><p data-pid="piW0d2iQ">针对这个问题，cute中（实质为cutlass中），专门提供了Epilogue来通过共享内存作为中间媒介。先将寄存器数据存储到共享内存，然后再从共享内存中以更连续、更高位宽的形式存储到全局内存中去。PACT'20 Fireiron文章有对该问题的详细探讨，可以参考之。</p><figure data-size="normal"><noscript><img src="https://pic2.zhimg.com/v2-6fdb9b250a3c8a7cca64b251f83275c5_b.jpg" data-size="normal" data-rawwidth="2397" data-rawheight="3030" class="origin_image zh-lightbox-thumb" width="2397" data-original="https://pic2.zhimg.com/v2-6fdb9b250a3c8a7cca64b251f83275c5_r.jpg"/></noscript><div><img src="data:image/svg+xml;utf8,&lt;svg xmlns=&#39;http://www.w3.org/2000/svg&#39; width=&#39;2397&#39; height=&#39;3030&#39;&gt;&lt;/svg&gt;" data-size="normal" data-rawwidth="2397" data-rawheight="3030" class="origin_image zh-lightbox-thumb lazy" width="2397" data-original="https://pic2.zhimg.com/v2-6fdb9b250a3c8a7cca64b251f83275c5_r.jpg" data-actualsrc="https://pic2.zhimg.com/v2-6fdb9b250a3c8a7cca64b251f83275c5_b.jpg" data-original-token="v2-6afdc9ebda8a0f64c995531d42a44ef8"></div><figcaption>Figure 4. Epilogue中Accumulator寄存器通过共享内存实现到全局内存的数据搬运</figcaption></figure><p data-pid="n_aiQUnr">本文通过共享内存实现高效的TileC的存储，具体代码可以参考github上的实现，整体过程如图4所示。</p><h2 id="h_675308830_4" data-into-catalog-status="">试验设置和结果</h2><p data-pid="veYG4-51">根据上面介绍的优化方法，我们利用cute实现了高效的Multi-Stage GEMM，代码地址为<a href="https://link.zhihu.com/?target=https%3A//github.com/reed-lau/cute-gemm" class=" external" target="_blank" rel="nofollow noreferrer"><span class="invisible">https://</span><span class="visible">github.com/reed-lau/cut</span><span class="invisible">e-gemm</span><span class="ellipsis"></span></a>。我们针对具体业务中使用的问题规格进行了性能测试。具体地问题规格为：M=81920, N=256, K=256, 其中A矩阵为行优先，B矩阵为列优先，C矩阵为行优先，输入输出和计算数据类型均为half。测试环境方面，显卡为NVIDIA GeForce RTX 3090，操作系统为Ubuntu 20.04.6 LTS，NVidia驱动版本为535.113.01，NVCC编译器版本为V11.7.64。我们对比了cuBLAS和cuBLASLt的调优的kernel，其cuBLAS和cuBLASLt版本号为111001。我们使用cuBLASLt的启发式方法选择尽可能多的kernel进行对比。</p><p data-pid="yeqNaZoI">使用Nsight Compute对kernel运行时间进行精准的测量，同时为了避免L2 Cache缓存数据对效率评估对影响，我们主动设置--cache-control=all选项来保证在进行kernel profiling的时候清空历史cache数据，通过设置--clock-control=base选项来锁定GPU运行的频率，避免动态调频对性能测量的影响。</p><p data-pid="kTPeaCk7">cuBLASLt经过启发式算法选出5个kernel，针对上面提到的问题规格进行了11次试验， 我们统计了这11次的均值、方差和中位数，结果如下表格：</p><table data-draft-node="block" data-draft-type="table" data-size="normal" data-row-style="normal"><tbody><tr><th>所属库</th><th>kernel名称</th><th>均值(us)</th><th>方差(us)</th><th>中位数(us)</th></tr><tr><th>our-impl</th><td>gemm_multi_stage</td><td>130.1</td><td>0.4</td><td>130.1</td></tr><tr><th>cuBLAS</th><td>ampere_h1688gemm_128x128_ldg8_stages_32x1_tn</td><td>153.4</td><td>2</td><td>154.1</td></tr><tr><th>cuBLASLt</th><td>ampere_h16816gemm_128x64_ldg8_tn</td><td>154.0</td><td>0.5</td><td>154.1</td></tr><tr><th>cuBLASLt</th><td>ampere_h16816gemm_256x128_ldg8_stages_32x3_tn</td><td>154.2</td><td>0.6</td><td>154.2</td></tr><tr><th>cuBLASLt</th><td>ampere_h1688gemm_128x128_ldg8_stages_32x1_tn</td><td>153.4</td><td>2</td><td>154.1</td></tr><tr><th>cuBLASLt</th><td>ampere_h1688gemm_128x128_ldg8_tn</td><td>136.5</td><td>0.7</td><td>136.5</td></tr><tr><th>cuBLASLt</th><td>cutlass_80_tensorop_h16816gemm_128x256_32x3_tn_align2</td><td>183.4</td><td>0.7</td><td>183.4</td></tr></tbody></table><p data-pid="6C9fIasy">表格中的数据可以看出均值和中位数相当，所以测量结果相对稳定。我们看到我们的实现为130.1 us，cuBLAS和cuBLASLt的最好结果为136.5us。针对该问题规格，我们的实现达到了SOTA的结果。</p><h2 id="h_675308830_5" data-into-catalog-status="">总结和讨论</h2><h3 id="h_675308830_6" data-into-catalog-status="">启发式算法</h3><p data-pid="_z2ighLh">回顾前文或者代码，我们不难发现代码中的很多参数是可以调整的，如矩阵分块的大小kTileM、kTileN、kTileK，流水线级数kStage等。针对不同的问题规格适当的调整这些参数能得到更好的效果。逻辑上，我们可以用理论计算来设计公式实现不同问题规模对这些参数的选择；我们也可以对不同的问题规格进行一些离线的穷举试验，分析这些参数维度空间中的分布数据，分析这些数据得到不同问题规格和这些优化参数的映射关系，归纳出特定的启发式算法，使得我们给定一个问题时能够选择出一个不错的kernel。本文只针对一个特定的case做优化，所以不涉及这部分内容，甚至可以直接参考cuBLAS选中的kernel对这些参数的设置情况。</p><h3 id="h_675308830_7" data-into-catalog-status="">参数相容性</h3><p data-pid="fVrBtGNr">前面的代码介绍，我们发现无论是MMA还是Copy每一个操作都需要设置很多参数，这些参数有的是描述layout，有的是描述线程数，有的描述寄存器重复，有的是描述计算块的大小。这些参数并不是完全自由的，它们之间会存在某种约束，这种约束可以是共享内存大小、可以是寄存器多少、可以是线程块大小、可以是划分方法，这是我们调优时调整参数需要考虑的。</p><h3 id="h_675308830_8" data-into-catalog-status="">其它方面</h3><p data-pid="c7zXXJw7">CUDA优化还有很多方面，如在流水线章节的最后部分我们介绍的提升L2命中率的Thread Block Swizzle方法，本文中的N维度不大，所以并没有使能；设置<code>__launch_bounds__</code>给编译器提供更多的优化提示本文也并未探究。本文的实现没有考虑数据地址非对齐和Tile非整除情形，这些在实际使用时都是有限制或者需要考虑的。同时cutlass的核心部分也已借助cute进行了collective和epilogue的抽象，我们也可以使用它来实现我们的矩阵计算，并且它们有更好的通用性。</p><h3 id="h_675308830_9" data-into-catalog-status="">总结</h3><p data-pid="EOngn4ID">本文从计算高效、访存高效、算法高效、尾阶段高效这几个方面介绍了矩阵乘的高效实现方法。并且对核心代码进行了细致的解读。文章针对特定case将本文实现和cuBLAS、cuBLASLt进行了对比，实验结果表明，使用cute实现的GEMM方法可以达到SOTA的效果。</p><p data-pid="_YuHIA93">掌握cute的Layout、Tensor、MMA、Copy抽象可以帮助我们快速的构建矩阵计算能力，我们可以借助这种能力更高效的解决其它更复杂的问题（如Flash Attention）。</p><p data-pid="64xoMav8">这是该cute系列的最后一篇，希望该系列文章能够帮助大家快速掌握cute。后续我将再选个topic和大家共同探讨高性能计算、高性能系统，希望我们很快又能见面。</p><h2 id="h_675308830_10" data-into-catalog-status="">参考</h2><p data-pid="pFWUiTFv"><a href="https://link.zhihu.com/?target=https%3A//dl.acm.org/doi/10.1145/3410463.3414632" class=" wrap external" target="_blank" rel="nofollow noreferrer">PACT'20 Fireiron</a></p><p data-pid="6xqkQrf4"><a href="https://link.zhihu.com/?target=https%3A//github.com/NVIDIA/cutlass/blob/main/include/cutlass/epilogue/collective/sm70_epilogue_vectorized.hpp" class=" wrap external" target="_blank" rel="nofollow noreferrer">NVidia cutlass Epilogue</a></p></div></div></div></div><div role="button" tabindex="0" class="ContentItem-time">编辑于 2024-03-06 18:28<!-- -->・IP 属地北京</div><div class="Reward"><div><div class="Reward-tagline">「真诚赞赏，手留余香」</div><button class="Reward-rewardBtn">赞赏</button></div><div class="Reward-countZero">还没有人赞赏，快来当第一个赞赏的人吧！</div></div><div class="Post-topicsAndReviewer"><div class="TopicList Post-Topics"><div class="Tag Topic css-ch8ocw" data-za-detail-view-path-module="TopicItem" data-za-extra-module="{&quot;card&quot;:{&quot;content&quot;:{&quot;type&quot;:&quot;Topic&quot;,&quot;token&quot;:&quot;19570902&quot;}}}"><span class="Tag-content"><a class="TopicLink" href="https://www.zhihu.com/topic/19570902" target="_blank"><div class="css-1gomreu">GPU 通用计算</div></a></span></div><div class="Tag Topic css-ch8ocw" data-za-detail-view-path-module="TopicItem" data-za-extra-module="{&quot;card&quot;:{&quot;content&quot;:{&quot;type&quot;:&quot;Topic&quot;,&quot;token&quot;:&quot;19551275&quot;}}}"><span class="Tag-content"><a class="TopicLink" href="https://www.zhihu.com/topic/19551275" target="_blank"><div class="css-1gomreu">人工智能</div></a></span></div><div class="Tag Topic css-ch8ocw" data-za-detail-view-path-module="TopicItem" data-za-extra-module="{&quot;card&quot;:{&quot;content&quot;:{&quot;type&quot;:&quot;Topic&quot;,&quot;token&quot;:&quot;19608622&quot;}}}"><span class="Tag-content"><a class="TopicLink" href="https://www.zhihu.com/topic/19608622" target="_blank"><div class="css-1gomreu">高性能计算</div></a></span></div></div></div><div><div class="Sticky RichContent-actions is-fixed is-bottom" style="width: 1718.86px; bottom: 0px; left: 514.429px;"><div class="ContentItem-actions" data-za-detail-view-path-module="BottomBar" data-za-extra-module="{&quot;card&quot;:{&quot;content&quot;:{&quot;type&quot;:&quot;Post&quot;,&quot;id&quot;:&quot;675308830&quot;,&quot;token&quot;:&quot;675308830&quot;}}}"><span><button aria-label="已赞同 136 " aria-live="polite" type="button" class="Button VoteButton VoteButton--up is-active FEfUrdfMIKpQDJDqkjte"><span style="display:inline-flex;align-items:center">​<svg width="10" height="10" viewBox="0 0 24 24" class="Zi Zi--TriangleUp VoteButton-TriangleUp" fill="currentColor" data-darkreader-inline-fill="" style="--darkreader-inline-fill: currentColor;"><path fill-rule="evenodd" d="M13.792 3.681c-.781-1.406-2.803-1.406-3.584 0l-7.79 14.023c-.76 1.367.228 3.046 1.791 3.046h15.582c1.563 0 2.55-1.68 1.791-3.046l-7.79-14.023Z" clip-rule="evenodd"></path></svg></span>已赞同 136</button><button aria-label="反对" aria-live="polite" type="button" class="Button VoteButton VoteButton--down FEfUrdfMIKpQDJDqkjte"><span style="display:inline-flex;align-items:center">​<svg width="10" height="10" viewBox="0 0 24 24" class="Zi Zi--TriangleDown" fill="currentColor" data-darkreader-inline-fill="" style="--darkreader-inline-fill: currentColor;"><path fill-rule="evenodd" d="M13.792 20.319c-.781 1.406-2.803 1.406-3.584 0L2.418 6.296c-.76-1.367.228-3.046 1.791-3.046h15.582c1.563 0 2.55 1.68 1.791 3.046l-7.79 14.023Z" clip-rule="evenodd"></path></svg></span></button></span><button type="button" class="Button BottomActions-CommentBtn FEfUrdfMIKpQDJDqkjte Button--plain Button--withIcon Button--withLabel fEPKGkUK5jyc4fUuT0QP B46v1Ak6Gj5sL2JTS4PY RuuQ6TOh2cRzJr6WlyQp"><span style="display:inline-flex;align-items:center">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="Zi Zi--Comment Button-zi t2ntD6J1DemdOdvh5FB4" fill="currentColor" data-darkreader-inline-fill="" style="--darkreader-inline-fill: currentColor;"><path fill-rule="evenodd" d="M12 2.75a9.25 9.25 0 1 0 4.737 17.197l2.643.817a1 1 0 0 0 1.25-1.25l-.8-2.588A9.25 9.25 0 0 0 12 2.75Z" clip-rule="evenodd"></path></svg></span>36 条评论</button><div class="Popover ShareMenu"><div class="ShareMenu-toggler" id="Popover2-toggle" aria-haspopup="true" aria-expanded="false"><button type="button" class="Button FEfUrdfMIKpQDJDqkjte Button--plain Button--withIcon Button--withLabel fEPKGkUK5jyc4fUuT0QP B46v1Ak6Gj5sL2JTS4PY RuuQ6TOh2cRzJr6WlyQp"><span style="display:inline-flex;align-items:center">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="Zi Zi--Share Button-zi t2ntD6J1DemdOdvh5FB4" fill="currentColor" data-darkreader-inline-fill="" style="--darkreader-inline-fill: currentColor;"><path d="M19.47 1.914a.8.8 0 0 1 1.204.778l-1.872 16.386a.9.9 0 0 1-1.204.743l-4.615-1.692a.7.7 0 0 0-.831.28l-1.927 3.02c-.43.674-1.474.369-1.474-.43v-3.865a.8.8 0 0 1 .179-.504l5.808-7.148a.595.595 0 0 0-.897-.781l-5.93 6.354a1.1 1.1 0 0 1-1.258.252L2.57 13.46a.8.8 0 0 1-.08-1.415l16.98-10.13Z"></path></svg></span>分享</button></div></div><button aria-live="polite" type="button" class="Button ContentItem-action FEfUrdfMIKpQDJDqkjte Button--plain Button--withIcon Button--withLabel fEPKGkUK5jyc4fUuT0QP B46v1Ak6Gj5sL2JTS4PY RuuQ6TOh2cRzJr6WlyQp"><span style="display:inline-flex;align-items:center">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="Zi Zi--Heart Button-zi t2ntD6J1DemdOdvh5FB4" fill="currentColor" data-darkreader-inline-fill="" style="--darkreader-inline-fill: currentColor;"><path fill-rule="evenodd" d="M12.004 4.934c1.015-.944 2.484-1.618 3.98-1.618 3.48 0 6.53 3.265 6.15 7.614-.11 1.254-.686 2.55-1.458 3.753-.778 1.215-1.79 2.392-2.845 3.419-1.054 1.028-2.168 1.923-3.161 2.566a9.96 9.96 0 0 1-1.41.777c-.418.182-.862.32-1.268.32s-.848-.137-1.267-.317a9.918 9.918 0 0 1-1.407-.771c-.992-.64-2.103-1.53-3.156-2.555-1.052-1.024-2.062-2.2-2.84-3.417-.77-1.208-1.346-2.51-1.456-3.775-.38-4.349 2.67-7.614 6.15-7.614 1.484 0 2.983.673 3.988 1.618Z" clip-rule="evenodd"></path></svg></span>取消喜欢</button><button type="button" class="Button FEfUrdfMIKpQDJDqkjte Button--plain Button--withIcon Button--withLabel fEPKGkUK5jyc4fUuT0QP B46v1Ak6Gj5sL2JTS4PY RuuQ6TOh2cRzJr6WlyQp"><span style="display:inline-flex;align-items:center">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="Zi Zi--Star Button-zi t2ntD6J1DemdOdvh5FB4" fill="currentColor" data-darkreader-inline-fill="" style="--darkreader-inline-fill: currentColor;"><path d="M10.484 3.307c.673-1.168 2.358-1.168 3.032 0l2.377 4.122a.25.25 0 0 0 .165.12l4.655.987c1.319.28 1.84 1.882.937 2.884l-3.186 3.535a.25.25 0 0 0-.063.193l.5 4.733c.142 1.34-1.222 2.33-2.453 1.782l-4.346-1.938a.25.25 0 0 0-.204 0l-4.346 1.938c-1.231.549-2.595-.442-2.453-1.782l.5-4.733a.25.25 0 0 0-.064-.193L2.35 11.42c-.903-1.002-.382-2.604.937-2.884l4.655-.987a.25.25 0 0 0 .164-.12l2.378-4.122Z"></path></svg></span>收藏</button><button type="button" class="Button ContentItem-action FEfUrdfMIKpQDJDqkjte Button--plain Button--withIcon Button--withLabel fEPKGkUK5jyc4fUuT0QP B46v1Ak6Gj5sL2JTS4PY RuuQ6TOh2cRzJr6WlyQp"><span style="display:inline-flex;align-items:center">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="Zi Zi--Deliver Button-zi t2ntD6J1DemdOdvh5FB4" fill="currentColor" data-darkreader-inline-fill="" style="--darkreader-inline-fill: currentColor;"><g fill-rule="evenodd" clip-rule="evenodd"><path d="M7.821 12a.75.75 0 0 1 .75-.75h6.857a.75.75 0 0 1 0 1.5H8.571a.75.75 0 0 1-.75-.75ZM8.965 8a.75.75 0 0 1 .75-.75h4.571a.75.75 0 0 1 0 1.5H9.715a.75.75 0 0 1-.75-.75Z"></path><path d="M7.527 3.15a2.35 2.35 0 0 0-2.309 1.91L3.165 15.84a.85.85 0 0 0-.015.16v2.5a2.35 2.35 0 0 0 2.35 2.35h13a2.35 2.35 0 0 0 2.35-2.35V16a.848.848 0 0 0-.015-.16L18.78 5.06a2.35 2.35 0 0 0-2.308-1.91H7.527Zm0 1.7a.65.65 0 0 0-.639.528l-1.88 9.872h13.984l-1.88-9.872a.65.65 0 0 0-.64-.528H7.528Z"></path></g></svg></span>申请转载</button><div class="Post-ActionMenuButton"><div class="Popover"><div id="Popover3-toggle" aria-haspopup="true" aria-expanded="false"><button type="button" class="Button FEfUrdfMIKpQDJDqkjte Button--plain Button--withIcon Button--iconOnly fEPKGkUK5jyc4fUuT0QP B46v1Ak6Gj5sL2JTS4PY hIwDV_tcL6XN1HprrnAq"><span style="display:inline-flex;align-items:center">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="Zi Zi--Dots Button-zi t2ntD6J1DemdOdvh5FB4" fill="currentColor" data-darkreader-inline-fill="" style="--darkreader-inline-fill: currentColor;"><path d="M6 10.5a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3ZM10.5 12a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0ZM16.5 12a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0Z"></path></svg></span></button></div></div></div></div></div><div class="Sticky--holder" style="position: static; inset: auto auto 0px 0px; display: block; float: none; margin: 0px 0px 10px; height: 53.7143px;"></div></div></article><div class="Post-Sub Post-NormalSub"><div style="overflow: unset;" data-za-detail-view-path-module="CommentList" data-za-extra-module="{}"><div class="Comments-container css-plbgu"><div class="css-79elbk"><div><div class="css-1fo89v5"><img class="Avatar css-m4psdq" src="./cute 之 高效GEMM实现 - 知乎_files/v2-c58ab06f0991ecef82f9d358f471cfd3_l.jpg" srcset="https://picx.zhimg.com/v2-c58ab06f0991ecef82f9d358f471cfd3_l.jpg?source=32738c0c 2x"><div class="css-14zbeoe"><div class="css-i6bazn"><div class="css-0"><div class="InputLike css-1rl4wxv Editable"><div class="Dropzone Editable-content RichText RichText--editable RichText--clearBoth ztext" style="min-height: 38px;"><div class="DraftEditor-root"><div class="public-DraftEditorPlaceholder-root"><div class="public-DraftEditorPlaceholder-inner" id="placeholder-7s559" style="white-space: pre-wrap;">理性发言，友善互动</div></div><div class="DraftEditor-editorContainer"><div aria-describedby="placeholder-7s559" class="notranslate public-DraftEditor-content" contenteditable="true" spellcheck="true" tabindex="0" style="outline: none; user-select: text; white-space: pre-wrap; overflow-wrap: break-word; --darkreader-inline-outline: initial;" data-darkreader-inline-outline="" role="textbox"><div data-contents="true"><div class="Editable-unstyled" data-block="true" data-editor="7s559" data-offset-key="dfvl-0-0"><div data-offset-key="dfvl-0-0" class="public-DraftStyleDefault-block public-DraftStyleDefault-ltr"><span data-offset-key="dfvl-0-0"><br data-text="true"></span></div></div></div></div></div></div></div><div></div><input multiple="" type="file" accept="image/webp,image/jpg,image/jpeg,image/png,image/gif" style="display: none;"></div></div></div></div></div></div><div class="css-u76jt1"><div class="css-1onritu"><div class="css-r4op92"><div class="css-1k10w8f">36 条评论</div></div><div class="css-59erns"></div><div class="css-97fdvh"><div class="css-m0zh86">默认</div><div class="css-1fjr6cy">最新</div></div></div><div class="css-840pn3"><div class="css-18ld3w0"><div data-id="10793294074"><div class="css-jp43l4"><div class="css-1jll2aj"><div class="css-1gomreu"><a href="https://www.zhihu.com/people/14091c290a93cc461d29b1f09818096a" target="_blank" class="css-1dxejhk"><img class="Avatar css-1ljippv" src="./cute 之 高效GEMM实现 - 知乎_files/v2-0ad0297df34d517e6bfbc39ea0029e72_l.jpg" srcset="https://picx.zhimg.com/v2-0ad0297df34d517e6bfbc39ea0029e72_l.jpg?source=06d4cd63 2x" alt="jin.hao1" loading="lazy"></a></div></div><div class="css-14nvvry"><div class="css-z0cc58"><div class="css-swj9d4"><div class="css-1tww9qq"><div class="css-1gomreu"><a href="https://www.zhihu.com/people/14091c290a93cc461d29b1f09818096a" target="_blank" class="css-10u695f">jin.hao1</a></div><div class="css-1qe0v6x"><div class="css-1ssbn0c"></div></div></div></div><svg width="16" height="16" viewBox="0 0 24 24" class="ZDI ZDI--Dots24 css-zgte1c" fill="currentColor" data-darkreader-inline-fill="" style="--darkreader-inline-fill: currentColor;"><path d="M6 10.5a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3ZM10.5 12a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0ZM16.5 12a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0Z"></path></svg></div><div class="CommentContent css-1jpzztt"><p>以TileMMA中描述的矩阵大小对目标Tensor进行周期性平铺，对高亮的部分进行选取形成新的矩阵，其中第一个维度为TiledMMA中单个线程的数据描述，第二个维度和第三个维度为行方向和列方向需要重复的次数。<br>---- 这个描述不对吧，ThrMMA.tiled_fragment_B()是单线程负责的数据分布，这个分布的第一维应该是Atom计算中的数据分布(2,2)，对应的fragment_A的第一维为(2,2,2)，第二维则是同一线程在M方向迭代Atom的次数。</p></div><div class="css-140jo2"><div class="css-1a5a57m"><div class="css-x1xlu5"><span class="css-12cl38p">02-04</span><span> · </span><span class="css-ntkn7q" href="">IP 属地中国香港</span></div></div><div class="css-18opwoy"><button type="button" class="Button Button--plain Button--withIcon Button--withLabel css-1ij6qqc"><span style="display: inline-flex; align-items: center;">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="ZDI ZDI--ChatBubbleFill24 css-15ro776" fill="currentColor" data-darkreader-inline-fill="" style="--darkreader-inline-fill: currentColor;"><path fill-rule="evenodd" d="M12 2.75a9.25 9.25 0 1 0 4.737 17.197l2.643.817a1 1 0 0 0 1.25-1.25l-.8-2.588A9.25 9.25 0 0 0 12 2.75Z" clip-rule="evenodd"></path></svg></span>回复</button><button type="button" class="Button Button--plain Button--grey Button--withIcon Button--withLabel css-1vd72tl" style="transform: none;"><span style="display: inline-flex; align-items: center;">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="ZDI ZDI--HeartFill24 css-15ro776" fill="currentColor" data-darkreader-inline-fill="" style="--darkreader-inline-fill: currentColor;"><path fill-rule="evenodd" d="M12.004 4.934c1.015-.944 2.484-1.618 3.98-1.618 3.48 0 6.53 3.265 6.15 7.614-.11 1.254-.686 2.55-1.458 3.753-.778 1.215-1.79 2.392-2.845 3.419-1.054 1.028-2.168 1.923-3.161 2.566a9.96 9.96 0 0 1-1.41.777c-.418.182-.862.32-1.268.32s-.848-.137-1.267-.317a9.918 9.918 0 0 1-1.407-.771c-.992-.64-2.103-1.53-3.156-2.555-1.052-1.024-2.062-2.2-2.84-3.417-.77-1.208-1.346-2.51-1.456-3.775-.38-4.349 2.67-7.614 6.15-7.614 1.484 0 2.983.673 3.988 1.618Z" clip-rule="evenodd"></path></svg></span>4</button></div></div></div></div><div data-id="10826050289"><div class="css-1kwt8l8"><div class="css-1jll2aj"><div class="css-1gomreu"><a href="https://www.zhihu.com/people/e2a454f2ee65517b226819ec7ca455ed" target="_blank" class="css-1dxejhk"><img class="Avatar css-1ljippv" src="./cute 之 高效GEMM实现 - 知乎_files/v2-abed1a8c04700ba7d72b45195223e0ff_l.jpg" srcset="https://pica.zhimg.com/v2-abed1a8c04700ba7d72b45195223e0ff_l.jpg?source=06d4cd63 2x" alt="春日的阳光" loading="lazy"></a></div></div><div class="css-14nvvry"><div class="css-z0cc58"><div class="css-swj9d4"><div class="css-1tww9qq"><div class="css-1gomreu"><a href="https://www.zhihu.com/people/e2a454f2ee65517b226819ec7ca455ed" target="_blank" class="css-10u695f">春日的阳光</a></div><div class="css-1qe0v6x"><div class="css-1ssbn0c"></div><span class="css-8v0dsd" href="">关注我的人</span></div></div></div><svg width="16" height="16" viewBox="0 0 24 24" class="ZDI ZDI--Dots24 css-zgte1c" fill="currentColor" data-darkreader-inline-fill="" style="--darkreader-inline-fill: currentColor;"><path d="M6 10.5a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3ZM10.5 12a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0ZM16.5 12a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0Z"></path></svg></div><div class="CommentContent css-1jpzztt"><p>和你有同样的疑问，A的MMA是(2,2,2)，B的MMA是(2,2)，C的MMA是(2,2)，MMA因该是Atom中每个线程的数据分布。 </p></div><div class="css-140jo2"><div class="css-1a5a57m"><div class="css-x1xlu5"><span class="css-12cl38p">03-14</span><span> · </span><span class="css-ntkn7q" href="">IP 属地北京</span></div></div><div class="css-18opwoy"><button type="button" class="Button Button--plain Button--withIcon Button--withLabel css-1ij6qqc"><span style="display: inline-flex; align-items: center;">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="ZDI ZDI--ChatBubbleFill24 css-15ro776" fill="currentColor" data-darkreader-inline-fill="" style="--darkreader-inline-fill: currentColor;"><path fill-rule="evenodd" d="M12 2.75a9.25 9.25 0 1 0 4.737 17.197l2.643.817a1 1 0 0 0 1.25-1.25l-.8-2.588A9.25 9.25 0 0 0 12 2.75Z" clip-rule="evenodd"></path></svg></span>回复</button><button type="button" class="Button Button--plain Button--grey Button--withIcon Button--withLabel css-1vd72tl" style="transform: none;"><span style="display: inline-flex; align-items: center;">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="ZDI ZDI--HeartFill24 css-15ro776" fill="currentColor" data-darkreader-inline-fill="" style="--darkreader-inline-fill: currentColor;"><path fill-rule="evenodd" d="M12.004 4.934c1.015-.944 2.484-1.618 3.98-1.618 3.48 0 6.53 3.265 6.15 7.614-.11 1.254-.686 2.55-1.458 3.753-.778 1.215-1.79 2.392-2.845 3.419-1.054 1.028-2.168 1.923-3.161 2.566a9.96 9.96 0 0 1-1.41.777c-.418.182-.862.32-1.268.32s-.848-.137-1.267-.317a9.918 9.918 0 0 1-1.407-.771c-.992-.64-2.103-1.53-3.156-2.555-1.052-1.024-2.062-2.2-2.84-3.417-.77-1.208-1.346-2.51-1.456-3.775-.38-4.349 2.67-7.614 6.15-7.614 1.484 0 2.983.673 3.988 1.618Z" clip-rule="evenodd"></path></svg></span>1</button></div></div></div></div></div></div><div data-id="10764620654"><div class="css-jp43l4"><div class="css-1jll2aj"><div class="css-1gomreu"><a href="https://www.zhihu.com/people/236dedf0a4bc04040b68aea7e2e6e06a" target="_blank" class="css-1dxejhk"><img class="Avatar css-1ljippv" src="./cute 之 高效GEMM实现 - 知乎_files/v2-8700f69f73463e7575b7a58c7ccc95e2_l.jpg" srcset="https://picx.zhimg.com/v2-8700f69f73463e7575b7a58c7ccc95e2_l.jpg?source=06d4cd63 2x" alt="zzk again" loading="lazy"></a></div></div><div class="css-14nvvry"><div class="css-z0cc58"><div class="css-swj9d4"><div class="css-1tww9qq"><div class="css-1gomreu"><a href="https://www.zhihu.com/people/236dedf0a4bc04040b68aea7e2e6e06a" target="_blank" class="css-10u695f">zzk again</a></div><div class="css-1qe0v6x"><div class="css-1ssbn0c"></div><span class="css-8v0dsd" href="">我关注的人</span></div></div></div><svg width="16" height="16" viewBox="0 0 24 24" class="ZDI ZDI--Dots24 css-zgte1c" fill="currentColor" data-darkreader-inline-fill="" style="--darkreader-inline-fill: currentColor;"><path d="M6 10.5a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3ZM10.5 12a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0ZM16.5 12a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0Z"></path></svg></div><div class="CommentContent css-1jpzztt">reed哥牛逼！</div><div class="css-140jo2"><div class="css-1a5a57m"><div class="css-x1xlu5"><span class="css-12cl38p">2023-12-30</span><span> · </span><span class="css-ntkn7q" href="">IP 属地北京</span></div></div><div class="css-18opwoy"><button type="button" class="Button Button--plain Button--withIcon Button--withLabel css-1ij6qqc"><span style="display: inline-flex; align-items: center;">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="ZDI ZDI--ChatBubbleFill24 css-15ro776" fill="currentColor" data-darkreader-inline-fill="" style="--darkreader-inline-fill: currentColor;"><path fill-rule="evenodd" d="M12 2.75a9.25 9.25 0 1 0 4.737 17.197l2.643.817a1 1 0 0 0 1.25-1.25l-.8-2.588A9.25 9.25 0 0 0 12 2.75Z" clip-rule="evenodd"></path></svg></span>回复</button><button type="button" class="Button Button--plain Button--grey Button--withIcon Button--withLabel css-1vd72tl" style="transform: none;"><span style="display: inline-flex; align-items: center;">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="ZDI ZDI--HeartFill24 css-15ro776" fill="currentColor" data-darkreader-inline-fill="" style="--darkreader-inline-fill: currentColor;"><path fill-rule="evenodd" d="M12.004 4.934c1.015-.944 2.484-1.618 3.98-1.618 3.48 0 6.53 3.265 6.15 7.614-.11 1.254-.686 2.55-1.458 3.753-.778 1.215-1.79 2.392-2.845 3.419-1.054 1.028-2.168 1.923-3.161 2.566a9.96 9.96 0 0 1-1.41.777c-.418.182-.862.32-1.268.32s-.848-.137-1.267-.317a9.918 9.918 0 0 1-1.407-.771c-.992-.64-2.103-1.53-3.156-2.555-1.052-1.024-2.062-2.2-2.84-3.417-.77-1.208-1.346-2.51-1.456-3.775-.38-4.349 2.67-7.614 6.15-7.614 1.484 0 2.983.673 3.988 1.618Z" clip-rule="evenodd"></path></svg></span>3</button></div></div></div></div></div><div data-id="10764068632"><div class="css-jp43l4"><div class="css-1jll2aj"><div class="css-1gomreu"><a href="https://www.zhihu.com/people/017b2d200363c00301a5a34150755c94" target="_blank" class="css-1dxejhk"><img class="Avatar css-1ljippv" src="./cute 之 高效GEMM实现 - 知乎_files/v2-850d19a2c869da7a7cb87217a441808a_l.jpg" srcset="https://picx.zhimg.com/v2-850d19a2c869da7a7cb87217a441808a_l.jpg?source=06d4cd63 2x" alt="jianyang" loading="lazy"></a></div></div><div class="css-14nvvry"><div class="css-z0cc58"><div class="css-swj9d4"><div class="css-1tww9qq"><div class="css-1gomreu"><a href="https://www.zhihu.com/people/017b2d200363c00301a5a34150755c94" target="_blank" class="css-10u695f">jianyang</a></div><div class="css-1qe0v6x"><div class="css-1ssbn0c"></div><span class="css-8v0dsd" href="">我关注的人</span></div></div></div><svg width="16" height="16" viewBox="0 0 24 24" class="ZDI ZDI--Dots24 css-zgte1c" fill="currentColor" data-darkreader-inline-fill="" style="--darkreader-inline-fill: currentColor;"><path d="M6 10.5a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3ZM10.5 12a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0ZM16.5 12a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0Z"></path></svg></div><div class="CommentContent css-1jpzztt"><p>厉害，欢迎到国产GPU平台</p></div><div class="css-140jo2"><div class="css-1a5a57m"><div class="css-x1xlu5"><span class="css-12cl38p">2023-12-30</span><span> · </span><span class="css-ntkn7q" href="">IP 属地上海</span></div></div><div class="css-18opwoy"><button type="button" class="Button Button--plain Button--withIcon Button--withLabel css-1ij6qqc"><span style="display: inline-flex; align-items: center;">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="ZDI ZDI--ChatBubbleFill24 css-15ro776" fill="currentColor" data-darkreader-inline-fill="" style="--darkreader-inline-fill: currentColor;"><path fill-rule="evenodd" d="M12 2.75a9.25 9.25 0 1 0 4.737 17.197l2.643.817a1 1 0 0 0 1.25-1.25l-.8-2.588A9.25 9.25 0 0 0 12 2.75Z" clip-rule="evenodd"></path></svg></span>回复</button><button type="button" class="Button Button--plain Button--grey Button--withIcon Button--withLabel css-1vd72tl" style="transform: none;"><span style="display: inline-flex; align-items: center;">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="ZDI ZDI--HeartFill24 css-15ro776" fill="currentColor" data-darkreader-inline-fill="" style="--darkreader-inline-fill: currentColor;"><path fill-rule="evenodd" d="M12.004 4.934c1.015-.944 2.484-1.618 3.98-1.618 3.48 0 6.53 3.265 6.15 7.614-.11 1.254-.686 2.55-1.458 3.753-.778 1.215-1.79 2.392-2.845 3.419-1.054 1.028-2.168 1.923-3.161 2.566a9.96 9.96 0 0 1-1.41.777c-.418.182-.862.32-1.268.32s-.848-.137-1.267-.317a9.918 9.918 0 0 1-1.407-.771c-.992-.64-2.103-1.53-3.156-2.555-1.052-1.024-2.062-2.2-2.84-3.417-.77-1.208-1.346-2.51-1.456-3.775-.38-4.349 2.67-7.614 6.15-7.614 1.484 0 2.983.673 3.988 1.618Z" clip-rule="evenodd"></path></svg></span>1</button></div></div></div></div></div><div data-id="10764193866"><div class="css-jp43l4"><div class="css-1jll2aj"><div class="css-1gomreu"><a href="https://www.zhihu.com/people/c7b06cc769715827502ab4123047c84a" target="_blank" class="css-1dxejhk"><img class="Avatar css-1ljippv" src="./cute 之 高效GEMM实现 - 知乎_files/v2-1231a8cd57f352e5b361b06518f0954c_l.jpg" srcset="https://picx.zhimg.com/v2-1231a8cd57f352e5b361b06518f0954c_l.jpg?source=06d4cd63 2x" alt="Ther" loading="lazy"></a></div></div><div class="css-14nvvry"><div class="css-z0cc58"><div class="css-swj9d4"><div class="css-1tww9qq"><div class="css-1gomreu"><a href="https://www.zhihu.com/people/c7b06cc769715827502ab4123047c84a" target="_blank" class="css-10u695f">Ther</a></div><div class="css-1qe0v6x"><div class="css-1ssbn0c"></div><span class="css-8v0dsd" href="">关注我的人</span></div></div></div><svg width="16" height="16" viewBox="0 0 24 24" class="ZDI ZDI--Dots24 css-zgte1c" fill="currentColor" data-darkreader-inline-fill="" style="--darkreader-inline-fill: currentColor;"><path d="M6 10.5a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3ZM10.5 12a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0ZM16.5 12a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0Z"></path></svg></div><div class="CommentContent css-1jpzztt">大佬太强了</div><div class="css-140jo2"><div class="css-1a5a57m"><div class="css-x1xlu5"><span class="css-12cl38p">2023-12-30</span><span> · </span><span class="css-ntkn7q" href="">IP 属地北京</span></div></div><div class="css-18opwoy"><button type="button" class="Button Button--plain Button--withIcon Button--withLabel css-1ij6qqc"><span style="display: inline-flex; align-items: center;">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="ZDI ZDI--ChatBubbleFill24 css-15ro776" fill="currentColor" data-darkreader-inline-fill="" style="--darkreader-inline-fill: currentColor;"><path fill-rule="evenodd" d="M12 2.75a9.25 9.25 0 1 0 4.737 17.197l2.643.817a1 1 0 0 0 1.25-1.25l-.8-2.588A9.25 9.25 0 0 0 12 2.75Z" clip-rule="evenodd"></path></svg></span>回复</button><button type="button" class="Button Button--plain Button--grey Button--withIcon Button--withLabel css-1vd72tl" style="transform: none;"><span style="display: inline-flex; align-items: center;">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="ZDI ZDI--HeartFill24 css-15ro776" fill="currentColor" data-darkreader-inline-fill="" style="--darkreader-inline-fill: currentColor;"><path fill-rule="evenodd" d="M12.004 4.934c1.015-.944 2.484-1.618 3.98-1.618 3.48 0 6.53 3.265 6.15 7.614-.11 1.254-.686 2.55-1.458 3.753-.778 1.215-1.79 2.392-2.845 3.419-1.054 1.028-2.168 1.923-3.161 2.566a9.96 9.96 0 0 1-1.41.777c-.418.182-.862.32-1.268.32s-.848-.137-1.267-.317a9.918 9.918 0 0 1-1.407-.771c-.992-.64-2.103-1.53-3.156-2.555-1.052-1.024-2.062-2.2-2.84-3.417-.77-1.208-1.346-2.51-1.456-3.775-.38-4.349 2.67-7.614 6.15-7.614 1.484 0 2.983.673 3.988 1.618Z" clip-rule="evenodd"></path></svg></span>1</button></div></div></div></div></div><div data-id="10763924513"><div class="css-jp43l4"><div class="css-1jll2aj"><div class="css-1gomreu"><a href="https://www.zhihu.com/people/56918a2f80cf9eecaf7000a7c9a34a2e" target="_blank" class="css-1dxejhk"><img class="Avatar css-1ljippv" src="./cute 之 高效GEMM实现 - 知乎_files/v2-81bfd204da5f1d28228020baabe5ecdb_l.jpg" srcset="https://picx.zhimg.com/v2-81bfd204da5f1d28228020baabe5ecdb_l.jpg?source=06d4cd63 2x" alt="二球" loading="lazy"></a></div></div><div class="css-14nvvry"><div class="css-z0cc58"><div class="css-swj9d4"><div class="css-1tww9qq"><div class="css-1gomreu"><a href="https://www.zhihu.com/people/56918a2f80cf9eecaf7000a7c9a34a2e" target="_blank" class="css-10u695f">二球</a></div><div class="css-1qe0v6x"><div class="css-1ssbn0c"></div><span class="css-8v0dsd" href="">我关注的人</span><img src="./cute 之 高效GEMM实现 - 知乎_files/v2-4812630bc27d642f7cafcd6cdeca3d7a.jpg" class="css-1pj8qrb"></div></div></div><svg width="16" height="16" viewBox="0 0 24 24" class="ZDI ZDI--Dots24 css-zgte1c" fill="currentColor" data-darkreader-inline-fill="" style="--darkreader-inline-fill: currentColor;"><path d="M6 10.5a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3ZM10.5 12a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0ZM16.5 12a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0Z"></path></svg></div><div class="CommentContent css-1jpzztt">先赞后看<img src="./cute 之 高效GEMM实现 - 知乎_files/v2-419a1a3ed02b7cfadc20af558aabc897.png" class="sticker" alt="[赞同]"></div><div class="css-140jo2"><div class="css-1a5a57m"><div class="css-x1xlu5"><span class="css-12cl38p">2023-12-30</span><span> · </span><span class="css-ntkn7q" href="">IP 属地陕西</span></div></div><div class="css-18opwoy"><button type="button" class="Button Button--plain Button--withIcon Button--withLabel css-1ij6qqc"><span style="display: inline-flex; align-items: center;">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="ZDI ZDI--ChatBubbleFill24 css-15ro776" fill="currentColor" data-darkreader-inline-fill="" style="--darkreader-inline-fill: currentColor;"><path fill-rule="evenodd" d="M12 2.75a9.25 9.25 0 1 0 4.737 17.197l2.643.817a1 1 0 0 0 1.25-1.25l-.8-2.588A9.25 9.25 0 0 0 12 2.75Z" clip-rule="evenodd"></path></svg></span>回复</button><button type="button" class="Button Button--plain Button--grey Button--withIcon Button--withLabel css-1vd72tl" style="transform: none;"><span style="display: inline-flex; align-items: center;">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="ZDI ZDI--HeartFill24 css-15ro776" fill="currentColor" data-darkreader-inline-fill="" style="--darkreader-inline-fill: currentColor;"><path fill-rule="evenodd" d="M12.004 4.934c1.015-.944 2.484-1.618 3.98-1.618 3.48 0 6.53 3.265 6.15 7.614-.11 1.254-.686 2.55-1.458 3.753-.778 1.215-1.79 2.392-2.845 3.419-1.054 1.028-2.168 1.923-3.161 2.566a9.96 9.96 0 0 1-1.41.777c-.418.182-.862.32-1.268.32s-.848-.137-1.267-.317a9.918 9.918 0 0 1-1.407-.771c-.992-.64-2.103-1.53-3.156-2.555-1.052-1.024-2.062-2.2-2.84-3.417-.77-1.208-1.346-2.51-1.456-3.775-.38-4.349 2.67-7.614 6.15-7.614 1.484 0 2.983.673 3.988 1.618Z" clip-rule="evenodd"></path></svg></span>2</button></div></div></div></div></div><div data-id="10767345076"><div class="css-jp43l4"><div class="css-1jll2aj"><div class="css-1gomreu"><a href="https://www.zhihu.com/people/717f1ab0f2d680f0f4cd7ccda4dca65c" target="_blank" class="css-1dxejhk"><img class="Avatar css-1ljippv" src="./cute 之 高效GEMM实现 - 知乎_files/v2-05810e0f3f69c9fbe1c24b62ec43e5a7_l.jpg" srcset="https://picx.zhimg.com/v2-05810e0f3f69c9fbe1c24b62ec43e5a7_l.jpg?source=06d4cd63 2x" alt="Logician" loading="lazy"></a></div></div><div class="css-14nvvry"><div class="css-z0cc58"><div class="css-swj9d4"><div class="css-1tww9qq"><div class="css-1gomreu"><a href="https://www.zhihu.com/people/717f1ab0f2d680f0f4cd7ccda4dca65c" target="_blank" class="css-10u695f">Logician</a></div><div class="css-1qe0v6x"><div class="css-1ssbn0c"></div></div></div></div><svg width="16" height="16" viewBox="0 0 24 24" class="ZDI ZDI--Dots24 css-zgte1c" fill="currentColor" data-darkreader-inline-fill="" style="--darkreader-inline-fill: currentColor;"><path d="M6 10.5a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3ZM10.5 12a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0ZM16.5 12a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0Z"></path></svg></div><div class="CommentContent css-1jpzztt">学习cutlass就指着老哥了</div><div class="css-140jo2"><div class="css-1a5a57m"><div class="css-x1xlu5"><span class="css-12cl38p">01-04</span><span> · </span><span class="css-ntkn7q" href="">IP 属地美国</span></div></div><div class="css-18opwoy"><button type="button" class="Button Button--plain Button--withIcon Button--withLabel css-1ij6qqc"><span style="display: inline-flex; align-items: center;">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="ZDI ZDI--ChatBubbleFill24 css-15ro776" fill="currentColor" data-darkreader-inline-fill="" style="--darkreader-inline-fill: currentColor;"><path fill-rule="evenodd" d="M12 2.75a9.25 9.25 0 1 0 4.737 17.197l2.643.817a1 1 0 0 0 1.25-1.25l-.8-2.588A9.25 9.25 0 0 0 12 2.75Z" clip-rule="evenodd"></path></svg></span>回复</button><button type="button" class="Button Button--plain Button--grey Button--withIcon Button--withLabel css-1vd72tl" style="transform: none;"><span style="display: inline-flex; align-items: center;">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="ZDI ZDI--HeartFill24 css-15ro776" fill="currentColor" data-darkreader-inline-fill="" style="--darkreader-inline-fill: currentColor;"><path fill-rule="evenodd" d="M12.004 4.934c1.015-.944 2.484-1.618 3.98-1.618 3.48 0 6.53 3.265 6.15 7.614-.11 1.254-.686 2.55-1.458 3.753-.778 1.215-1.79 2.392-2.845 3.419-1.054 1.028-2.168 1.923-3.161 2.566a9.96 9.96 0 0 1-1.41.777c-.418.182-.862.32-1.268.32s-.848-.137-1.267-.317a9.918 9.918 0 0 1-1.407-.771c-.992-.64-2.103-1.53-3.156-2.555-1.052-1.024-2.062-2.2-2.84-3.417-.77-1.208-1.346-2.51-1.456-3.775-.38-4.349 2.67-7.614 6.15-7.614 1.484 0 2.983.673 3.988 1.618Z" clip-rule="evenodd"></path></svg></span>2</button></div></div></div></div></div><div data-id="10767010897"><div class="css-jp43l4"><div class="css-1jll2aj"><div class="css-1gomreu"><a href="https://www.zhihu.com/people/95bd12cb27f7e137adb94cbf23ded36f" target="_blank" class="css-1dxejhk"><img class="Avatar css-1ljippv" src="./cute 之 高效GEMM实现 - 知乎_files/v2-7697fa8532fee39d03154edf1fb765b4_l.jpg" srcset="https://picx.zhimg.com/v2-7697fa8532fee39d03154edf1fb765b4_l.jpg?source=06d4cd63 2x" alt="科研败犬丶" loading="lazy"></a></div></div><div class="css-14nvvry"><div class="css-z0cc58"><div class="css-swj9d4"><div class="css-1tww9qq"><div class="css-1gomreu"><a href="https://www.zhihu.com/people/95bd12cb27f7e137adb94cbf23ded36f" target="_blank" class="css-10u695f">科研败犬丶</a></div><div class="css-1qe0v6x"><div class="css-1ssbn0c"></div><span class="css-8v0dsd" href="">我关注的人</span></div></div></div><svg width="16" height="16" viewBox="0 0 24 24" class="ZDI ZDI--Dots24 css-zgte1c" fill="currentColor" data-darkreader-inline-fill="" style="--darkreader-inline-fill: currentColor;"><path d="M6 10.5a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3ZM10.5 12a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0ZM16.5 12a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0Z"></path></svg></div><div class="CommentContent css-1jpzztt"><p>reed哥牛逼！</p><p></p></div><div class="css-140jo2"><div class="css-1a5a57m"><div class="css-x1xlu5"><span class="css-12cl38p">01-03</span><span> · </span><span class="css-ntkn7q" href="">IP 属地广东</span></div></div><div class="css-18opwoy"><button type="button" class="Button Button--plain Button--withIcon Button--withLabel css-1ij6qqc"><span style="display: inline-flex; align-items: center;">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="ZDI ZDI--ChatBubbleFill24 css-15ro776" fill="currentColor" data-darkreader-inline-fill="" style="--darkreader-inline-fill: currentColor;"><path fill-rule="evenodd" d="M12 2.75a9.25 9.25 0 1 0 4.737 17.197l2.643.817a1 1 0 0 0 1.25-1.25l-.8-2.588A9.25 9.25 0 0 0 12 2.75Z" clip-rule="evenodd"></path></svg></span>回复</button><button type="button" class="Button Button--plain Button--grey Button--withIcon Button--withLabel css-1vd72tl" style="transform: none;"><span style="display: inline-flex; align-items: center;">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="ZDI ZDI--HeartFill24 css-15ro776" fill="currentColor" data-darkreader-inline-fill="" style="--darkreader-inline-fill: currentColor;"><path fill-rule="evenodd" d="M12.004 4.934c1.015-.944 2.484-1.618 3.98-1.618 3.48 0 6.53 3.265 6.15 7.614-.11 1.254-.686 2.55-1.458 3.753-.778 1.215-1.79 2.392-2.845 3.419-1.054 1.028-2.168 1.923-3.161 2.566a9.96 9.96 0 0 1-1.41.777c-.418.182-.862.32-1.268.32s-.848-.137-1.267-.317a9.918 9.918 0 0 1-1.407-.771c-.992-.64-2.103-1.53-3.156-2.555-1.052-1.024-2.062-2.2-2.84-3.417-.77-1.208-1.346-2.51-1.456-3.775-.38-4.349 2.67-7.614 6.15-7.614 1.484 0 2.983.673 3.988 1.618Z" clip-rule="evenodd"></path></svg></span>1</button></div></div></div></div></div><div data-id="10820009235"><div class="css-jp43l4"><div class="css-1jll2aj"><div class="css-1gomreu"><a href="https://www.zhihu.com/people/40e1493a99ed2507f107fb1607b34e90" target="_blank" class="css-1dxejhk"><img class="Avatar css-1ljippv" src="./cute 之 高效GEMM实现 - 知乎_files/v2-abed1a8c04700ba7d72b45195223e0ff_l(1).jpg" srcset="https://picx.zhimg.com/v2-abed1a8c04700ba7d72b45195223e0ff_l.jpg?source=06d4cd63 2x" alt="你似乎很急啊" loading="lazy"></a></div></div><div class="css-14nvvry"><div class="css-z0cc58"><div class="css-swj9d4"><div class="css-1tww9qq"><div class="css-1gomreu"><a href="https://www.zhihu.com/people/40e1493a99ed2507f107fb1607b34e90" target="_blank" class="css-10u695f">你似乎很急啊</a></div><div class="css-1qe0v6x"><div class="css-1ssbn0c"></div></div></div></div><svg width="16" height="16" viewBox="0 0 24 24" class="ZDI ZDI--Dots24 css-zgte1c" fill="currentColor" data-darkreader-inline-fill="" style="--darkreader-inline-fill: currentColor;"><path d="M6 10.5a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3ZM10.5 12a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0ZM16.5 12a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0Z"></path></svg></div><div class="CommentContent css-1jpzztt"><p>reed老师写得很好，有个码错的词可以改一下；<br>


"对于共享内存到全局内存到拷贝，cute提供了对ldmatrix指令的封装，主机端代码和设备端代码分别如下：
"<br><br>
改成<br><br>

"对于共享内存到寄存器的拷贝，cute提供了对ldmatrix指令的封装，主机端代码和设备端代码分别如下："</p></div><div class="css-140jo2"><div class="css-1a5a57m"><div class="css-x1xlu5"><span class="css-12cl38p">03-06</span><span> · </span><span class="css-ntkn7q" href="">IP 属地中国香港</span></div></div><div class="css-18opwoy"><button type="button" class="Button Button--plain Button--withIcon Button--withLabel css-1ij6qqc"><span style="display: inline-flex; align-items: center;">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="ZDI ZDI--ChatBubbleFill24 css-15ro776" fill="currentColor" data-darkreader-inline-fill="" style="--darkreader-inline-fill: currentColor;"><path fill-rule="evenodd" d="M12 2.75a9.25 9.25 0 1 0 4.737 17.197l2.643.817a1 1 0 0 0 1.25-1.25l-.8-2.588A9.25 9.25 0 0 0 12 2.75Z" clip-rule="evenodd"></path></svg></span>回复</button><button type="button" class="Button Button--plain Button--grey Button--withIcon Button--withLabel css-1vd72tl" style="transform: none;"><span style="display: inline-flex; align-items: center;">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="ZDI ZDI--HeartFill24 css-15ro776" fill="currentColor" data-darkreader-inline-fill="" style="--darkreader-inline-fill: currentColor;"><path fill-rule="evenodd" d="M12.004 4.934c1.015-.944 2.484-1.618 3.98-1.618 3.48 0 6.53 3.265 6.15 7.614-.11 1.254-.686 2.55-1.458 3.753-.778 1.215-1.79 2.392-2.845 3.419-1.054 1.028-2.168 1.923-3.161 2.566a9.96 9.96 0 0 1-1.41.777c-.418.182-.862.32-1.268.32s-.848-.137-1.267-.317a9.918 9.918 0 0 1-1.407-.771c-.992-.64-2.103-1.53-3.156-2.555-1.052-1.024-2.062-2.2-2.84-3.417-.77-1.208-1.346-2.51-1.456-3.775-.38-4.349 2.67-7.614 6.15-7.614 1.484 0 2.983.673 3.988 1.618Z" clip-rule="evenodd"></path></svg></span>1</button></div></div></div></div><div data-id="10820012754"><div class="css-1kwt8l8"><div class="css-1jll2aj"><div class="css-1gomreu"><a href="https://www.zhihu.com/people/2600b0313c76a175aa9e09a235382b79" target="_blank" class="css-1dxejhk"><img class="Avatar css-1ljippv" src="./cute 之 高效GEMM实现 - 知乎_files/v2-e9c299bcbb6d098601ce529e9a358d82_l(1).jpg" srcset="https://picx.zhimg.com/v2-e9c299bcbb6d098601ce529e9a358d82_l.jpg?source=06d4cd63 2x" alt="reed" loading="lazy"></a></div></div><div class="css-14nvvry"><div class="css-z0cc58"><div class="css-swj9d4"><div class="css-1tww9qq"><div class="css-1gomreu"><a href="https://www.zhihu.com/people/2600b0313c76a175aa9e09a235382b79" target="_blank" class="css-10u695f">reed</a></div><div class="css-1qe0v6x"><div class="css-1ssbn0c"></div><span class="css-8v0dsd" href="">作者</span><span class="css-18biwo">​<svg viewBox="0 0 24 24" class="css-paut93" width="18" height="18"><defs><lineargradient id="biz-badges-blue" x1="0" y1="0" x2="100%" y2="73.32%"><stop offset="15%" stop-color="#47D3FF" data-darkreader-inline-stopcolor="" style="--darkreader-inline-stopcolor: #007ba1;"></stop><stop offset="81.54%" stop-color="#4A7DFF" data-darkreader-inline-stopcolor="" style="--darkreader-inline-stopcolor: #002da0;"></stop></lineargradient></defs><svg viewBox="0 0 24 24" x="-3" y="-3" fill="#ffffff" width="30" height="30" data-darkreader-inline-fill="" style="--darkreader-inline-fill: #e8e6e3;"><path d="M3.56231227,13.8535307 C2.40051305,12.768677 2.41398885,11.0669203 3.59484487,9.99979213 L3.59222085,9.99654885 C4.26730143,9.45036719 4.79446755,8.21005186 4.7184197,7.34453784 L4.72305873,7.34412719 C4.66942824,5.75539997 5.8824188,4.56066914 7.47188965,4.64242381 L7.47229112,4.6386236 C8.33515314,4.72977993 9.58467253,4.22534048 10.1426329,3.55925173 L10.1462611,3.56228565 C11.2316055,2.40008701 12.9353108,2.41394456 14.0015072,3.59634088 L14.0047263,3.59374004 C14.5498229,4.26841874 15.7896857,4.79521622 16.6545744,4.71844347 L16.6549836,4.72304294 C18.245027,4.66894057 19.4396947,5.88213996 19.3575031,7.47241135 L19.3623099,7.47292747 C19.2704388,8.3358681 19.7742711,9.58421483 20.4407199,10.1424506 L20.437686,10.1460789 C21.5997217,11.2312209 21.5860695,12.9345218 20.4042441,14.0007396 L20.4072865,14.0045125 C19.7325967,14.5495925 19.2055209,15.7896954 19.2815865,16.6561959 L19.2770449,16.6565978 C19.3315454,18.2453037 18.1173775,19.4393568 16.5274188,19.3571512 L16.5269029,19.3619539 C15.6647098,19.270083 14.415408,19.7741709 13.8573671,20.4403558 L13.8537409,20.4373235 C12.76842,21.5995708 11.0650432,21.5864553 9.99899434,20.4039226 L9.99527367,20.406923 C9.45025436,19.7323399 8.21017638,19.2051872 7.34461983,19.2812352 L7.344304,19.2776405 C5.75448683,19.3312904 4.55977145,18.1170085 4.64254978,16.527117 L4.63769921,16.5265942 C4.72957031,15.6644394 4.22547659,14.4151814 3.55928015,13.8571569 L3.56231227,13.8535307 Z"></path></svg><path d="M2.63951518,13.3895441 C3.70763333,14.2842292 4.44777637,16.1226061 4.30075305,17.5023312 L4.32211542,17.3063047 C4.17509209,18.6910561 5.17786655,19.7063729 6.5613937,19.5844846 L6.364106,19.6008202 C7.75140298,19.4789319 9.57474349,20.2554985 10.4468305,21.3349009 L10.3224262,21.1803415 C11.1982831,22.2647703 12.6257916,22.2723098 13.5167278,21.2079863 L13.3898102,21.3600325 C14.2845162,20.2919393 16.1229361,19.5518136 17.5026934,19.6988334 L17.3054057,19.6774716 C18.6914461,19.8244915 19.7067866,18.8217404 19.5836389,17.4395022 L19.6012314,17.6367853 C19.4793403,16.2482641 20.255925,14.4249662 21.3353526,13.5528995 L21.1807897,13.677301 C22.2639871,12.8014646 22.2727834,11.3739894 21.2084351,10.483074 L21.3604848,10.6099886 C20.2923667,9.71530351 19.5522236,7.87818322 19.6992469,6.49720154 L19.6778846,6.69448464 C19.8249079,5.30847665 18.8221335,4.2944164 17.4386063,4.41630468 L17.635894,4.39871256 C16.248597,4.52185742 14.4252565,3.74529084 13.5531695,2.66588842 L13.6775738,2.81919121 C12.8017169,1.73601905 11.3742084,1.72722299 10.4832722,2.79154644 L10.6101898,2.63950024 C9.71548377,3.70759343 7.87706394,4.44771919 6.49730661,4.30195588 L6.69459432,4.32206116 C5.30855394,4.17504128 4.29447,5.17904888 4.41636114,6.56128713 L4.3987686,6.36400404 C4.52065973,7.75126861 3.74407501,9.57456653 2.66464737,10.4478898 L2.81921035,10.3222318 C1.73601288,11.1993248 1.72721662,12.6255433 2.79156494,13.5164587 L2.63951518,13.3895441 Z" fill="url(#biz-badges-blue)"></path><svg width="12" height="12" viewBox="0 0 24 24" fill="#fff" x="6" y="6" class="Zi Zi--Check" data-darkreader-inline-fill="" style="--darkreader-inline-fill: #e8e6e3;"><path fill-rule="evenodd" d="M21.864 5.347a1.25 1.25 0 0 1 .04 1.767L10.976 18.537a1.35 1.35 0 0 1-1.965-.014L2.584 11.6a1.25 1.25 0 0 1 1.832-1.702l5.598 6.029L20.096 5.386a1.25 1.25 0 0 1 1.767-.04Z" clip-rule="evenodd"></path></svg></svg></span></div></div></div><svg width="16" height="16" viewBox="0 0 24 24" class="ZDI ZDI--Dots24 css-zgte1c" fill="currentColor" data-darkreader-inline-fill="" style="--darkreader-inline-fill: currentColor;"><path d="M6 10.5a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3ZM10.5 12a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0ZM16.5 12a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0Z"></path></svg></div><div class="CommentContent css-1jpzztt">done</div><div class="css-140jo2"><div class="css-1a5a57m"><div class="css-x1xlu5"><span class="css-12cl38p">03-06</span><span> · </span><span class="css-ntkn7q" href="">IP 属地北京</span></div></div><div class="css-18opwoy"><button type="button" class="Button Button--plain Button--withIcon Button--withLabel css-1ij6qqc"><span style="display: inline-flex; align-items: center;">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="ZDI ZDI--ChatBubbleFill24 css-15ro776" fill="currentColor" data-darkreader-inline-fill="" style="--darkreader-inline-fill: currentColor;"><path fill-rule="evenodd" d="M12 2.75a9.25 9.25 0 1 0 4.737 17.197l2.643.817a1 1 0 0 0 1.25-1.25l-.8-2.588A9.25 9.25 0 0 0 12 2.75Z" clip-rule="evenodd"></path></svg></span>回复</button><button type="button" class="Button Button--plain Button--grey Button--withIcon Button--withLabel css-1vd72tl" style="transform: none;"><span style="display: inline-flex; align-items: center;">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="ZDI ZDI--HeartFill24 css-15ro776" fill="currentColor" data-darkreader-inline-fill="" style="--darkreader-inline-fill: currentColor;"><path fill-rule="evenodd" d="M12.004 4.934c1.015-.944 2.484-1.618 3.98-1.618 3.48 0 6.53 3.265 6.15 7.614-.11 1.254-.686 2.55-1.458 3.753-.778 1.215-1.79 2.392-2.845 3.419-1.054 1.028-2.168 1.923-3.161 2.566a9.96 9.96 0 0 1-1.41.777c-.418.182-.862.32-1.268.32s-.848-.137-1.267-.317a9.918 9.918 0 0 1-1.407-.771c-.992-.64-2.103-1.53-3.156-2.555-1.052-1.024-2.062-2.2-2.84-3.417-.77-1.208-1.346-2.51-1.456-3.775-.38-4.349 2.67-7.614 6.15-7.614 1.484 0 2.983.673 3.988 1.618Z" clip-rule="evenodd"></path></svg></span>喜欢</button></div></div></div></div></div></div><div data-id="10814780341"><div class="css-jp43l4"><div class="css-1jll2aj"><div class="css-1gomreu"><a href="https://www.zhihu.com/people/ec29edc4f52be1f1069c15cef95f20e1" target="_blank" class="css-1dxejhk"><img class="Avatar css-1ljippv" src="./cute 之 高效GEMM实现 - 知乎_files/v2-c28a7cfe802897d9c8b95c13675e2d57_l.jpg" srcset="https://pic1.zhimg.com/v2-c28a7cfe802897d9c8b95c13675e2d57_l.jpg?source=06d4cd63 2x" alt="亦行知" loading="lazy"></a></div></div><div class="css-14nvvry"><div class="css-z0cc58"><div class="css-swj9d4"><div class="css-1tww9qq"><div class="css-1gomreu"><a href="https://www.zhihu.com/people/ec29edc4f52be1f1069c15cef95f20e1" target="_blank" class="css-10u695f">亦行知</a></div><div class="css-1qe0v6x"><div class="css-1ssbn0c"></div></div></div></div><svg width="16" height="16" viewBox="0 0 24 24" class="ZDI ZDI--Dots24 css-zgte1c" fill="currentColor" data-darkreader-inline-fill="" style="--darkreader-inline-fill: currentColor;"><path d="M6 10.5a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3ZM10.5 12a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0ZM16.5 12a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0Z"></path></svg></div><div class="CommentContent css-1jpzztt"><p>感谢reed佬精彩的文章. 但我阅读了CuTe所有文档,一直有个疑惑, 对于TileMMA线程布局设置,我使用print_latex打印, 看到A矩阵数据分布在0~31、32~63线程, 那线程id64~127的两个warp不占有任何A矩阵的数据么? 同样B矩阵也分布在2个warp的线程(0~31、64~95), 但C矩阵数据分布在完整的4个warp内(0~127), 我目前的理解是所有线程都占有A、B、C矩阵的部分数据,只是print_latex打印不出来. 如果有人可以解答我将不胜感激!</p></div><div class="css-140jo2"><div class="css-1a5a57m"><div class="css-x1xlu5"><span class="css-12cl38p">02-29</span><span> · </span><span class="css-ntkn7q" href="">IP 属地浙江</span></div></div><div class="css-18opwoy"><button type="button" class="Button Button--plain Button--withIcon Button--withLabel css-1ij6qqc"><span style="display: inline-flex; align-items: center;">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="ZDI ZDI--ChatBubbleFill24 css-15ro776" fill="currentColor" data-darkreader-inline-fill="" style="--darkreader-inline-fill: currentColor;"><path fill-rule="evenodd" d="M12 2.75a9.25 9.25 0 1 0 4.737 17.197l2.643.817a1 1 0 0 0 1.25-1.25l-.8-2.588A9.25 9.25 0 0 0 12 2.75Z" clip-rule="evenodd"></path></svg></span>回复</button><button type="button" class="Button Button--plain Button--grey Button--withIcon Button--withLabel css-1vd72tl" style="transform: none;"><span style="display: inline-flex; align-items: center;">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="ZDI ZDI--HeartFill24 css-15ro776" fill="currentColor" data-darkreader-inline-fill="" style="--darkreader-inline-fill: currentColor;"><path fill-rule="evenodd" d="M12.004 4.934c1.015-.944 2.484-1.618 3.98-1.618 3.48 0 6.53 3.265 6.15 7.614-.11 1.254-.686 2.55-1.458 3.753-.778 1.215-1.79 2.392-2.845 3.419-1.054 1.028-2.168 1.923-3.161 2.566a9.96 9.96 0 0 1-1.41.777c-.418.182-.862.32-1.268.32s-.848-.137-1.267-.317a9.918 9.918 0 0 1-1.407-.771c-.992-.64-2.103-1.53-3.156-2.555-1.052-1.024-2.062-2.2-2.84-3.417-.77-1.208-1.346-2.51-1.456-3.775-.38-4.349 2.67-7.614 6.15-7.614 1.484 0 2.983.673 3.988 1.618Z" clip-rule="evenodd"></path></svg></span>1</button></div></div></div></div><div data-id="10867809317"><div class="css-1kwt8l8"><div class="css-1jll2aj"><div class="css-1gomreu"><a href="https://www.zhihu.com/people/9d2018dbe462ec42133548e932ff0009" target="_blank" class="css-1dxejhk"><img class="Avatar css-1ljippv" src="./cute 之 高效GEMM实现 - 知乎_files/v2-1f99608a3a72b447908fe09a7b8a64bb_l.jpg" srcset="https://picx.zhimg.com/v2-1f99608a3a72b447908fe09a7b8a64bb_l.jpg?source=06d4cd63 2x" alt="小明教主" loading="lazy"></a></div></div><div class="css-14nvvry"><div class="css-z0cc58"><div class="css-swj9d4"><div class="css-1tww9qq"><div class="css-1gomreu"><a href="https://www.zhihu.com/people/9d2018dbe462ec42133548e932ff0009" target="_blank" class="css-10u695f">小明教主</a></div><div class="css-1qe0v6x"><div class="css-1ssbn0c"></div></div></div></div><svg width="16" height="16" viewBox="0 0 24 24" class="ZDI ZDI--Dots24 css-zgte1c" fill="currentColor" data-darkreader-inline-fill="" style="--darkreader-inline-fill: currentColor;"><path d="M6 10.5a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3ZM10.5 12a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0ZM16.5 12a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0Z"></path></svg></div><div class="CommentContent css-1jpzztt">确实是，两个线程读同一个数据，图没法画出来</div><div class="css-140jo2"><div class="css-1a5a57m"><div class="css-x1xlu5"><span class="css-12cl38p">05-02</span><span> · </span><span class="css-ntkn7q" href="">IP 属地加拿大</span></div></div><div class="css-18opwoy"><button type="button" class="Button Button--plain Button--withIcon Button--withLabel css-1ij6qqc"><span style="display: inline-flex; align-items: center;">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="ZDI ZDI--ChatBubbleFill24 css-15ro776" fill="currentColor" data-darkreader-inline-fill="" style="--darkreader-inline-fill: currentColor;"><path fill-rule="evenodd" d="M12 2.75a9.25 9.25 0 1 0 4.737 17.197l2.643.817a1 1 0 0 0 1.25-1.25l-.8-2.588A9.25 9.25 0 0 0 12 2.75Z" clip-rule="evenodd"></path></svg></span>回复</button><button type="button" class="Button Button--plain Button--grey Button--withIcon Button--withLabel css-1vd72tl" style="transform: none;"><span style="display: inline-flex; align-items: center;">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="ZDI ZDI--HeartFill24 css-15ro776" fill="currentColor" data-darkreader-inline-fill="" style="--darkreader-inline-fill: currentColor;"><path fill-rule="evenodd" d="M12.004 4.934c1.015-.944 2.484-1.618 3.98-1.618 3.48 0 6.53 3.265 6.15 7.614-.11 1.254-.686 2.55-1.458 3.753-.778 1.215-1.79 2.392-2.845 3.419-1.054 1.028-2.168 1.923-3.161 2.566a9.96 9.96 0 0 1-1.41.777c-.418.182-.862.32-1.268.32s-.848-.137-1.267-.317a9.918 9.918 0 0 1-1.407-.771c-.992-.64-2.103-1.53-3.156-2.555-1.052-1.024-2.062-2.2-2.84-3.417-.77-1.208-1.346-2.51-1.456-3.775-.38-4.349 2.67-7.614 6.15-7.614 1.484 0 2.983.673 3.988 1.618Z" clip-rule="evenodd"></path></svg></span>喜欢</button></div></div></div></div></div></div><div data-id="10794994892"><div class="css-jp43l4"><div class="css-1jll2aj"><div class="css-1gomreu"><a href="https://www.zhihu.com/people/6028ea084373e7298ab0cbb69dd92fd0" target="_blank" class="css-1dxejhk"><img class="Avatar css-1ljippv" src="./cute 之 高效GEMM实现 - 知乎_files/v2-abed1a8c04700ba7d72b45195223e0ff_l(1).jpg" srcset="https://picx.zhimg.com/v2-abed1a8c04700ba7d72b45195223e0ff_l.jpg?source=06d4cd63 2x" alt="小飞侠" loading="lazy"></a></div></div><div class="css-14nvvry"><div class="css-z0cc58"><div class="css-swj9d4"><div class="css-1tww9qq"><div class="css-1gomreu"><a href="https://www.zhihu.com/people/6028ea084373e7298ab0cbb69dd92fd0" target="_blank" class="css-10u695f">小飞侠</a></div><div class="css-1qe0v6x"><div class="css-1ssbn0c"></div></div></div></div><svg width="16" height="16" viewBox="0 0 24 24" class="ZDI ZDI--Dots24 css-zgte1c" fill="currentColor" data-darkreader-inline-fill="" style="--darkreader-inline-fill: currentColor;"><path d="M6 10.5a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3ZM10.5 12a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0ZM16.5 12a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0Z"></path></svg></div><div class="CommentContent css-1jpzztt"><p>请教个问题：<br>  using MMA =<br>      decltype(make_tiled_mma(mma_atom{}, MMA_EU_RepeatT{}, MMA_V_RepeatT{}));<br>// MMA_V_RepeatT代表的寄存器重复是什么意思？</p></div><div class="css-140jo2"><div class="css-1a5a57m"><div class="css-x1xlu5"><span class="css-12cl38p">02-05</span><span> · </span><span class="css-ntkn7q" href="">IP 属地上海</span></div></div><div class="css-18opwoy"><button type="button" class="Button Button--plain Button--withIcon Button--withLabel css-1ij6qqc"><span style="display: inline-flex; align-items: center;">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="ZDI ZDI--ChatBubbleFill24 css-15ro776" fill="currentColor" data-darkreader-inline-fill="" style="--darkreader-inline-fill: currentColor;"><path fill-rule="evenodd" d="M12 2.75a9.25 9.25 0 1 0 4.737 17.197l2.643.817a1 1 0 0 0 1.25-1.25l-.8-2.588A9.25 9.25 0 0 0 12 2.75Z" clip-rule="evenodd"></path></svg></span>回复</button><button type="button" class="Button Button--plain Button--grey Button--withIcon Button--withLabel css-1vd72tl" style="transform: none;"><span style="display: inline-flex; align-items: center;">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="ZDI ZDI--HeartFill24 css-15ro776" fill="currentColor" data-darkreader-inline-fill="" style="--darkreader-inline-fill: currentColor;"><path fill-rule="evenodd" d="M12.004 4.934c1.015-.944 2.484-1.618 3.98-1.618 3.48 0 6.53 3.265 6.15 7.614-.11 1.254-.686 2.55-1.458 3.753-.778 1.215-1.79 2.392-2.845 3.419-1.054 1.028-2.168 1.923-3.161 2.566a9.96 9.96 0 0 1-1.41.777c-.418.182-.862.32-1.268.32s-.848-.137-1.267-.317a9.918 9.918 0 0 1-1.407-.771c-.992-.64-2.103-1.53-3.156-2.555-1.052-1.024-2.062-2.2-2.84-3.417-.77-1.208-1.346-2.51-1.456-3.775-.38-4.349 2.67-7.614 6.15-7.614 1.484 0 2.983.673 3.988 1.618Z" clip-rule="evenodd"></path></svg></span>1</button></div></div></div></div></div><div></div></div></div><div class="css-wu78cf"><div class="css-vurnku">点击查看全部评论</div><svg width="24" height="24" viewBox="0 0 24 24" class="ZDI ZDI--ArrowRightSmall24" fill="currentColor" data-darkreader-inline-fill="" style="--darkreader-inline-fill: currentColor;"><path fill-rule="evenodd" d="M10.518 6.224a.875.875 0 0 1 1.212.248l3.335 5.05a.875.875 0 0 1 0 .964l-3.334 5.043a.875.875 0 0 1-1.46-.965l3.015-4.56-3.016-4.568a.875.875 0 0 1 .248-1.212Z" clip-rule="evenodd"></path></svg></div></div><div class="css-l8iyjs"></div><div class="css-kt4t4n" style="position: relative; box-shadow: 0px 0px;" data-darkreader-inline-boxshadow=""><div><div class="css-59erns"><img class="Avatar css-m4psdq" src="./cute 之 高效GEMM实现 - 知乎_files/v2-c58ab06f0991ecef82f9d358f471cfd3_l.jpg" srcset="https://picx.zhimg.com/v2-c58ab06f0991ecef82f9d358f471cfd3_l.jpg?source=32738c0c 2x"><div class="css-14zbeoe"><div class="css-i6bazn"><div class="css-1ryozpy"><div class="InputLike css-1rl4wxv Editable"><div class="Dropzone Editable-content RichText RichText--editable RichText--clearBoth ztext" style="min-height: 38px;"><div class="DraftEditor-root"><div class="public-DraftEditorPlaceholder-root"><div class="public-DraftEditorPlaceholder-inner" id="placeholder-7dljb" style="white-space: pre-wrap;">理性发言，友善互动</div></div><div class="DraftEditor-editorContainer"><div aria-describedby="placeholder-7dljb" class="notranslate public-DraftEditor-content" contenteditable="true" role="textbox" spellcheck="true" tabindex="0" style="outline: none; user-select: text; white-space: pre-wrap; overflow-wrap: break-word; --darkreader-inline-outline: initial;" data-darkreader-inline-outline=""><div data-contents="true"><div class="Editable-unstyled" data-block="true" data-editor="7dljb" data-offset-key="c5sk2-0-0"><div data-offset-key="c5sk2-0-0" class="public-DraftStyleDefault-block public-DraftStyleDefault-ltr"><span data-offset-key="c5sk2-0-0"><br data-text="true"></span></div></div></div></div></div></div></div><div></div><input multiple="" type="file" accept="image/webp,image/jpg,image/jpeg,image/png,image/gif" style="display: none;"></div></div></div></div></div></div></div><div></div></div></div></div><div class="PostIndex-Contributions" data-za-detail-view-path-module="ColumnList" data-za-detail-view-path-module_name="文章被以下专栏收录" data-za-extra-module="{}"><h3 class="BlockTitle">文章被以下专栏收录</h3><ul><div class="ContentItem Column-ColumnItem"><div class="ContentItem-main"><div class="ContentItem-image"><a class="ColumnLink" href="https://www.zhihu.com/column/c_1696937812497235968"><div class="css-1gomreu"><img class="Avatar css-1u7r5c9" src="./cute 之 高效GEMM实现 - 知乎_files/4b70deef7_l.jpg" srcset="https://picx.zhimg.com/4b70deef7_l.jpg?source=172ae18b 2x" alt="CUDA高性能编程"></div></a></div><div class="ContentItem-head"><h2 class="ContentItem-title"><span><a class="ColumnLink ColumnItem-Title" href="https://www.zhihu.com/column/c_1696937812497235968"><div class="css-1gomreu">CUDA高性能编程</div></a></span></h2><div class="ContentItem-meta">高性能计算中CUDA软硬件体系</div></div></div></div></ul></div><div role="complementary" aria-label="推荐阅读" class="Recommendations-Main" style="width: 1719px;"><h3 class="BlockTitle Recommendations-BlockTitle">推荐阅读</h3><ul class="Recommendations-List"><button class="PagingButton PagingButton-Previous" disabled="" data-za-detail-view-path-module="Unknown" data-za-detail-view-path-module_name="推荐阅读" data-za-extra-module="{}"><svg width="40" height="40" viewBox="0 0 24 24" fill="#d3d3d3" class="Zi Zi--ArrowLeft" data-darkreader-inline-fill="" style="--darkreader-inline-fill: #313537;"><path fill-rule="evenodd" d="M14.609 6.322c.349.335.36.889.026 1.237l-4.253 4.438 4.254 4.444a.875.875 0 1 1-1.264 1.21l-4.834-5.05a.875.875 0 0 1 0-1.21l4.834-5.043a.875.875 0 0 1 1.237-.026Z" clip-rule="evenodd"></path></svg></button><a href="https://zhuanlan.zhihu.com/p/379422670" class="PostItem"><div><img src="./cute 之 高效GEMM实现 - 知乎_files/v2-61ececc78594c06b435cd8afaf1f3c10_250x0.jpg" srcset="https://picx.zhimg.com/v2-61ececc78594c06b435cd8afaf1f3c10_qhd.jpg?source=172ae18b 2x" class="PostItem-TitleImage" alt="程序切片技术"><h1 class="PostItem-Title">程序切片技术</h1><div class="PostItem-Footer"><span>施猛</span><span class="PostItem-FooterTitle"></span></div></div></a><a href="https://zhuanlan.zhihu.com/p/76037757" class="PostItem"><div><img src="./cute 之 高效GEMM实现 - 知乎_files/v2-ed10528ae8f7a534359d1a6624d8ea37_250x0.jpg" srcset="https://pica.zhimg.com/v2-ed10528ae8f7a534359d1a6624d8ea37_qhd.jpg?source=172ae18b 2x" class="PostItem-TitleImage" alt="【Houdini】将模型数据转入贴图存储的方法"><h1 class="PostItem-Title">【Houdini】将模型数据转入贴图存储的方法</h1><div class="PostItem-Footer"><span>漫云</span><span class="PostItem-FooterTitle">发表于迈向节点</span></div></div></a><a href="https://zhuanlan.zhihu.com/p/527429591" class="PostItem"><div><img src="./cute 之 高效GEMM实现 - 知乎_files/v2-b09c1cfb26a50b9f7ee956870b5eb027_250x0.jpg" srcset="https://pica.zhimg.com/v2-b09c1cfb26a50b9f7ee956870b5eb027_qhd.jpg?source=172ae18b 2x" class="PostItem-TitleImage" alt="LTspice如何导入模型"><h1 class="PostItem-Title">LTspice如何导入模型</h1><div class="PostItem-Footer"><span>月下v秋风</span><span class="PostItem-FooterTitle"></span></div></div></a><a href="https://zhuanlan.zhihu.com/p/456700600" class="PostItem"><div><img src="./cute 之 高效GEMM实现 - 知乎_files/v2-222bef44cedc9d3ec47825b08a9f8cc8_250x0.jpg" srcset="https://picx.zhimg.com/v2-222bef44cedc9d3ec47825b08a9f8cc8_qhd.jpg?source=172ae18b 2x" class="PostItem-TitleImage" alt="知识图普嵌入技术的极简教程：KGE以及如何计算它们"><h1 class="PostItem-Title">知识图普嵌入技术的极简教程：KGE以及如何计算它们</h1><div class="PostItem-Footer"><span>deeph...</span><span class="PostItem-FooterTitle">发表于deeph...</span></div></div></a><button class="PagingButton PagingButton-Next" data-za-detail-view-path-module="Unknown" data-za-detail-view-path-module_name="推荐阅读" data-za-extra-module="{}"><svg width="40" height="40" viewBox="0 0 24 24" fill="#d3d3d3" class="Zi Zi--ArrowRight" data-darkreader-inline-fill="" style="--darkreader-inline-fill: #313537;"><path fill-rule="evenodd" d="M10.518 6.224a.875.875 0 0 1 1.212.248l3.335 5.05a.875.875 0 0 1 0 .964l-3.334 5.043a.875.875 0 0 1-1.46-.965l3.015-4.56-3.016-4.568a.875.875 0 0 1 .248-1.212Z" clip-rule="evenodd"></path></svg></button></ul></div></div></div></main><div role="complementary"><div class="CornerButtons"><div class="CornerAnimayedFlex CornerAnimayedFlex--hidden"><button data-tooltip="回到顶部" data-tooltip-position="left" data-tooltip-will-hide-on-click="true" aria-label="回到顶部" type="button" class="Button CornerButton Button--plain css-4lspwd"><svg width="24" height="24" viewBox="0 0 24 24" aria-hidden="true" class="Zi Zi--BackToTop" fill="currentColor" data-darkreader-inline-fill="" style="--darkreader-inline-fill: currentColor;"><path fill-rule="evenodd" d="M13.204 3.107a1.75 1.75 0 0 0-2.408 0L3.806 9.73c-1.148 1.088-.378 3.02 1.204 3.02h2.24V20c0 .966.784 1.75 1.75 1.75h6A1.75 1.75 0 0 0 16.75 20v-7.25h2.24c1.582 0 2.353-1.932 1.204-3.02l-6.99-6.623Z" clip-rule="evenodd"></path></svg></button></div></div></div></div></div><script id="js-clientConfig" type="text/json">{"fetchRoot":{"www":"https:\u002F\u002Fwww.zhihu.com","api":"https:\u002F\u002Fapi.zhihu.com","lens":"https:\u002F\u002Flens.zhihu.com","zhida":"https:\u002F\u002Fzhida.zhihu.com","zhuanlan":"https:\u002F\u002Fzhuanlan.zhihu.com\u002Fapi\u002F","walletpay":"https:\u002F\u002Fwalletpay.zhihu.com","captcha":"https:\u002F\u002Fcaptcha.zhihu.com","vzuu":"https:\u002F\u002Fv.vzuu.com","openapi":"https:\u002F\u002Fopenapi.zhihu.com","svip":"https:\u002F\u002Fsvip.zhihu.com"},"host":"zhihu.com","protocol":"https:","wwwHost":"www.zhihu.com","videoHost":"video.zhihu.com","zhuanlanHost":"zhuanlan.zhihu.com","allowSignUp":true,"refreshValidityPeriod":"30","release":"1460-273bc90e","currentEntry":"column","isMobileEntry":false,"apollo":{"env":"prod","globalSilence":"","ncgModeSign":"3f8e56febda4fb3bbea72e379d76de1e","topstory_rec_adp":"1","topstory_hot_adp":"1","editor_adapt_native":"0","editor_auto_rotate":"0","enable_request_filter":"1","content_publish_pin":"0","content_publish_answer":"1","content_publish_question":"1","content_publish_article":"1","content_publish_zvideo":"1","balanceModalSign":"ChYHAcB5ihJECkAFnhDAYmdhsTWVJoNc","reportBackendPublishError":"1","dynamic_font_schema":"1","enable_vzuu_login":"on","test_canary":"member|0-100,1-0","use_new_player":"member|0-100,1-0","player_vendor":"member|0-100,1-0,2-0","use_hevc":"member|0-0,1-100","upload_use_signature":"member|0-0,1-100","use_backdrop_blur":"member|0-0,1-100","article_title_imagex":"member|0-0,1-100","play_station":"member|0-0,1-100","use_cached_supported_countries":"device|1-100,0-0","contentItem_cover_imagex":"member|0-0,1-100","use_qrcode_login_v2":"device|1-100,0-0"}}</script><script id="js-initialData" type="text/json">{"initialState":{"common":{"ask":{},"cities":{"cityData":[]}},"loading":{"global":{"count":0},"local":{"env\u002FgetIpinfo\u002F":false,"article\u002Fget\u002F":false,"brand\u002FgetUrl\u002F":false,"article\u002FloadPostSearchEntity\u002F":false}},"entities":{"users":{"d4901200cbf4b641d3bc073c37356443":{"uid":783097360782868500,"userType":"people","id":"d4901200cbf4b641d3bc073c37356443"},"reed-84-49":{"isFollowed":false,"avatarUrlTemplate":"https:\u002F\u002Fpicx.zhimg.com\u002Fv2-e9c299bcbb6d098601ce529e9a358d82.jpg?source=172ae18b","uid":"1064511094718017536","userType":"people","isFollowing":true,"urlToken":"reed-84-49","id":"2600b0313c76a175aa9e09a235382b79","description":"https:\u002F\u002Freed-lau.github.io","name":"reed","isAdvertiser":false,"headline":"从科学计算到高性能计算系统","gender":1,"url":"\u002Fpeople\u002F2600b0313c76a175aa9e09a235382b79","avatarUrl":"https:\u002F\u002Fpicx.zhimg.com\u002Fv2-e9c299bcbb6d098601ce529e9a358d82_l.jpg?source=172ae18b","isOrg":false,"type":"people","badge":[{"type":"identity","topics":[],"description":"中国科学院大学 理学博士"}],"badgeV2":{"title":"中国科学院大学 理学博士","mergedBadges":[{"type":"identity","detailType":"identity","title":"认证","description":"中国科学院大学 理学博士","url":"https:\u002F\u002Fzhuanlan.zhihu.com\u002Fp\u002F96956163","sources":[],"icon":"","nightIcon":""}],"detailBadges":[{"type":"identity","detailType":"identity_people","title":"已认证的个人","description":"中国科学院大学 理学博士","url":"https:\u002F\u002Fzhuanlan.zhihu.com\u002Fp\u002F96956163","sources":[],"icon":"https:\u002F\u002Fpicx.zhimg.com\u002Fv2-2ddc5cc683982648f6f123616fb4ec09_l.png?source=32738c0c","nightIcon":"https:\u002F\u002Fpicx.zhimg.com\u002Fv2-2ddc5cc683982648f6f123616fb4ec09_l.png?source=32738c0c"}],"icon":"https:\u002F\u002Fpicx.zhimg.com\u002Fv2-2ddc5cc683982648f6f123616fb4ec09_l.png?source=32738c0c","nightIcon":"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-2ddc5cc683982648f6f123616fb4ec09_l.png?source=32738c0c"},"exposedMedal":{"medalId":"972477022068568064","medalName":"备受瞩目","avatarUrl":"https:\u002F\u002Fpicx.zhimg.com\u002Fv2-6da117205088242db9cd82e48b28640d_r.png?source=172ae18b","miniAvatarUrl":"https:\u002F\u002Fpicx.zhimg.com\u002Fv2-6da117205088242db9cd82e48b28640d_l.png?source=172ae18b","description":"被 1000 个人关注","medalAvatarFrame":""}}},"questions":{},"answers":{},"articles":{"675308830":{"entityWords":[{"name":"ldmatrix指令","mention":"ldmatrix指令","matchorder":1,"begin":8727,"end":8737,"entityid":2026589972578818800,"isBookMark":false,"link":{"linkType":0,"linkUrl":"","docType":"","topicToken":""},"entityClass":"OtherTerm","score":0.002440170249894791,"attachedInfoBytes":"sgJjCg5sZG1hdHJpeOaMh+S7pBIJT3RoZXJUZXJtGJdEIKFEKAE1Q+sfOzoHYXJ0aWNsZUCvtrfn+5r5jxxIAFIkMTAwYmU1ODctMWJkNy00YmZkLTkzNTEtNzg2NGMyN2ZmNzg08gLUAQokMTAwYmU1ODctMWJkNy00YmZkLTkzNTEtNzg2NGMyN2ZmNzg0GgdhcnRpY2xlIgkyMzgxOTg2MDI6DmxkbWF0cml45oyH5LukQK+2t+f7mvmPHEgAUhJhaV9lbnRpdHlfcmVjYWxsZXJdQ+sfO2JjCg5sZG1hdHJpeOaMh+S7pBIJT3RoZXJUZXJtGJdEIKFEKAE1Q+sfOzoHYXJ0aWNsZUCvtrfn+5r5jxxIAFIkMTAwYmU1ODctMWJkNy00YmZkLTkzNTEtNzg2NGMyN2ZmNzg0","isOnAB":false,"isNatural":1,"isDelete":false,"contentType":"","contentId":"","contentToken":""},{"name":"TileCopy","mention":"TileCopy","matchorder":1,"begin":12735,"end":12743,"entityid":5230645614843183000,"isBookMark":false,"link":{"linkType":0,"linkUrl":"","docType":"","topicToken":""},"entityClass":"Unknown","score":0.001420728890428602,"attachedInfoBytes":"sgJbCghUaWxlQ29weRIHVW5rbm93bhi\u002FYyDHYygBNcA3ujo6B2FydGljbGVApYK71ZOPv8tISABSJDEwMGJlNTg3LTFiZDctNGJmZC05MzUxLTc4NjRjMjdmZjc4NPICxgEKJDEwMGJlNTg3LTFiZDctNGJmZC05MzUxLTc4NjRjMjdmZjc4NBoHYXJ0aWNsZSIJMjM4MTk4NjAyOghUaWxlQ29weUClgrvVk4+\u002Fy0hIAlISYWlfZW50aXR5X3JlY2FsbGVyXcA3ujpiWwoIVGlsZUNvcHkSB1Vua25vd24Yv2Mgx2MoATXAN7o6OgdhcnRpY2xlQKWCu9WTj7\u002FLSEgAUiQxMDBiZTU4Ny0xYmQ3LTRiZmQtOTM1MS03ODY0YzI3ZmY3ODQ=","isOnAB":false,"isNatural":1,"isDelete":false,"contentType":"","contentId":"","contentToken":""},{"name":"ThrCopy","mention":"ThrCopy","matchorder":1,"begin":12764,"end":12771,"entityid":6790675823725177000,"isBookMark":false,"link":{"linkType":0,"linkUrl":"","docType":"","topicToken":""},"entityClass":"Unknown","score":0.0011454128626661314,"attachedInfoBytes":"sgJaCgdUaHJDb3B5EgdVbmtub3duGNxjIONjKAE1riGWOjoHYXJ0aWNsZUCgzuOP7vXUnl5IAFIkMTAwYmU1ODctMWJkNy00YmZkLTkzNTEtNzg2NGMyN2ZmNzg08gLEAQokMTAwYmU1ODctMWJkNy00YmZkLTkzNTEtNzg2NGMyN2ZmNzg0GgdhcnRpY2xlIgkyMzgxOTg2MDI6B1RockNvcHlAoM7jj+711J5eSANSEmFpX2VudGl0eV9yZWNhbGxlcl2uIZY6YloKB1RockNvcHkSB1Vua25vd24Y3GMg42MoATWuIZY6OgdhcnRpY2xlQKDO44\u002Fu9dSeXkgAUiQxMDBiZTU4Ny0xYmQ3LTRiZmQtOTM1MS03ODY0YzI3ZmY3ODQ=","isOnAB":false,"isNatural":1,"isDelete":false,"contentType":"","contentId":"","contentToken":""},{"name":"MMA_Operation","mention":"MMA_Operation","matchorder":1,"begin":1098,"end":1111,"entityid":-2676263205973891600,"isBookMark":false,"link":{"linkType":0,"linkUrl":"","docType":"","topicToken":""},"entityClass":"Unknown","score":0.0012915910059759506,"attachedInfoBytes":"sgJhCg1NTUFfT3BlcmF0aW9uEgdVbmtub3duGMoIINcIKAE1mkqpOjoHYXJ0aWNsZUDrzenTspmA7toBSABSJDEwMGJlNTg3LTFiZDctNGJmZC05MzUxLTc4NjRjMjdmZjc4NPIC0gEKJDEwMGJlNTg3LTFiZDctNGJmZC05MzUxLTc4NjRjMjdmZjc4NBoHYXJ0aWNsZSIJMjM4MTk4NjAyOg1NTUFfT3BlcmF0aW9uQOvN6dOymYDu2gFIBFISYWlfZW50aXR5X3JlY2FsbGVyXZpKqTpiYQoNTU1BX09wZXJhdGlvbhIHVW5rbm93bhjKCCDXCCgBNZpKqTo6B2FydGljbGVA683p07KZgO7aAUgAUiQxMDBiZTU4Ny0xYmQ3LTRiZmQtOTM1MS03ODY0YzI3ZmY3ODQ=","isOnAB":false,"isNatural":1,"isDelete":false,"contentType":"","contentId":"","contentToken":""},{"name":"启发式方法","mention":"启发式方法","matchorder":1,"begin":33446,"end":33451,"entityid":-2888388098864144000,"isBookMark":false,"link":{"linkType":0,"linkUrl":"","docType":"","topicToken":""},"entityClass":"Unknown","score":0.0008785949117394859,"attachedInfoBytes":"sgJlCg\u002FlkK\u002Flj5HlvI\u002Fmlrnms5USB1Vua25vd24YpoUCIKuFAigBNYJRZjo6B2FydGljbGVA4sTyjb3KmPXXAUgAUiQxMDBiZTU4Ny0xYmQ3LTRiZmQtOTM1MS03ODY0YzI3ZmY3ODTyAt0BCiQxMDBiZTU4Ny0xYmQ3LTRiZmQtOTM1MS03ODY0YzI3ZmY3ODQaB2FydGljbGUiCTIzODE5ODYwMjoP5ZCv5Y+R5byP5pa55rOVQOLE8o29ypj11wFIBVIXYmFpZHUtYmFpa2UtaXRlbS1yZWNhbGxdglFmOmJlCg\u002FlkK\u002Flj5HlvI\u002Fmlrnms5USB1Vua25vd24YpoUCIKuFAigBNYJRZjo6B2FydGljbGVA4sTyjb3KmPXXAUgAUiQxMDBiZTU4Ny0xYmQ3LTRiZmQtOTM1MS03ODY0YzI3ZmY3ODQ=","isOnAB":false,"isNatural":1,"isDelete":false,"contentType":"","contentId":"","contentToken":""},{"name":"CPY_M","mention":"CPY_M","matchorder":4,"begin":12305,"end":12310,"entityid":-1743097508685504800,"isBookMark":false,"link":{"linkType":0,"linkUrl":"","docType":"","topicToken":""},"entityClass":"Math","score":0.0006710702129636564,"attachedInfoBytes":"sgJWCgVDUFlfTRIETWF0aBiRYCCWYCgENcLqLzo6B2FydGljbGVAwr26z9HB0efnAUgAUiQxMDBiZTU4Ny0xYmQ3LTRiZmQtOTM1MS03ODY0YzI3ZmY3ODTyAr8BCiQxMDBiZTU4Ny0xYmQ3LTRiZmQtOTM1MS03ODY0YzI3ZmY3ODQaB2FydGljbGUiCTIzODE5ODYwMjoFQ1BZX01Awr26z9HB0efnAUgGUhJhaV9lbnRpdHlfcmVjYWxsZXJdwuovOmJWCgVDUFlfTRIETWF0aBiRYCCWYCgENcLqLzo6B2FydGljbGVAwr26z9HB0efnAUgAUiQxMDBiZTU4Ny0xYmQ3LTRiZmQtOTM1MS03ODY0YzI3ZmY3ODQ=","isOnAB":false,"isNatural":1,"isDelete":false,"contentType":"","contentId":"","contentToken":""},{"name":"Nsight Compute","mention":"Nsight Compute","matchorder":1,"begin":33498,"end":33512,"entityid":-4523522063486539300,"isBookMark":false,"link":{"linkType":0,"linkUrl":"","docType":"","topicToken":""},"entityClass":"Unknown","score":0.0016389984793040713,"attachedInfoBytes":"sgJkCg5Oc2lnaHQgQ29tcHV0ZRIHVW5rbm93bhjahQIg6IUCKAE1qtPWOjoHYXJ0aWNsZUCF1fiB5pTOnMEBSABSJDEwMGJlNTg3LTFiZDctNGJmZC05MzUxLTc4NjRjMjdmZjc4NPIC1gEKJDEwMGJlNTg3LTFiZDctNGJmZC05MzUxLTc4NjRjMjdmZjc4NBoHYXJ0aWNsZSIJMjM4MTk4NjAyOg5Oc2lnaHQgQ29tcHV0ZUCF1fiB5pTOnMEBSAlSEmFpX2VudGl0eV9yZWNhbGxlcl2q09Y6YmQKDk5zaWdodCBDb21wdXRlEgdVbmtub3duGNqFAiDohQIoATWq09Y6OgdhcnRpY2xlQIXV+IHmlM6cwQFIAFIkMTAwYmU1ODctMWJkNy00YmZkLTkzNTEtNzg2NGMyN2ZmNzg0","isOnAB":false,"isNatural":1,"isDelete":false,"contentType":"","contentId":"","contentToken":""},{"name":"GEMM实现","mention":"GEMM实现","matchorder":1,"begin":15984,"end":15990,"entityid":-2705464051335758000,"isBookMark":false,"link":{"linkType":0,"linkUrl":"","docType":"","topicToken":""},"entityClass":"Unknown","score":0.0013827033445724113,"attachedInfoBytes":"sgJeCgpHRU1N5a6e546wEgdVbmtub3duGPB8IPZ8KAE10zu1OjoHYXJ0aWNsZUDWgKzc+NiQutoBSABSJDEwMGJlNTg3LTFiZDctNGJmZC05MzUxLTc4NjRjMjdmZjc4NPICzAEKJDEwMGJlNTg3LTFiZDctNGJmZC05MzUxLTc4NjRjMjdmZjc4NBoHYXJ0aWNsZSIJMjM4MTk4NjAyOgpHRU1N5a6e546wQNaArNz42JC62gFIClISYWlfZW50aXR5X3JlY2FsbGVyXdM7tTpiXgoKR0VNTeWunueOsBIHVW5rbm93bhjwfCD2fCgBNdM7tTo6B2FydGljbGVA1oCs3PjYkLraAUgAUiQxMDBiZTU4Ny0xYmQ3LTRiZmQtOTM1MS03ODY0YzI3ZmY3ODQ=","isOnAB":false,"isNatural":1,"isDelete":false,"contentType":"","contentId":"","contentToken":""},{"name":"Atom能力","mention":"Atom能力","matchorder":1,"begin":5982,"end":5988,"entityid":-5451755413506268000,"isBookMark":false,"link":{"linkType":0,"linkUrl":"","docType":"","topicToken":""},"entityClass":"Unknown","score":0.0009188805147150314,"attachedInfoBytes":"sgJeCgpBdG9t6IO95YqbEgdVbmtub3duGN4uIOQuKAE1B+FwOjoHYXJ0aWNsZUCwyZW94Kreq7QBSABSJDEwMGJlNTg3LTFiZDctNGJmZC05MzUxLTc4NjRjMjdmZjc4NPICzAEKJDEwMGJlNTg3LTFiZDctNGJmZC05MzUxLTc4NjRjMjdmZjc4NBoHYXJ0aWNsZSIJMjM4MTk4NjAyOgpBdG9t6IO95YqbQLDJlb3gqt6rtAFIDFISYWlfZW50aXR5X3JlY2FsbGVyXQfhcDpiXgoKQXRvbeiDveWKmxIHVW5rbm93bhjeLiDkLigBNQfhcDo6B2FydGljbGVAsMmVveCq3qu0AUgAUiQxMDBiZTU4Ny0xYmQ3LTRiZmQtOTM1MS03ODY0YzI3ZmY3ODQ=","isOnAB":false,"isNatural":1,"isDelete":false,"contentType":"","contentId":"","contentToken":""},{"name":"高性能计算","mention":"高性能计算","matchorder":1,"begin":36133,"end":36138,"entityid":3730533166549070000,"isBookMark":false,"link":{"linkType":0,"linkUrl":"","docType":"","topicToken":""},"entityClass":"Unknown","score":0.0007319772365343702,"attachedInfoBytes":"sgJkCg\u002Fpq5jmgKfog73orqHnrpcSB1Vua25vd24YpZoCIKqaAigBNSniPzo6B2FydGljbGVA8eHht+WE4eIzSABSJDEwMGJlNTg3LTFiZDctNGJmZC05MzUxLTc4NjRjMjdmZjc4NPIC2wEKJDEwMGJlNTg3LTFiZDctNGJmZC05MzUxLTc4NjRjMjdmZjc4NBoHYXJ0aWNsZSIJMjM4MTk4NjAyOg\u002Fpq5jmgKfog73orqHnrpdA8eHht+WE4eIzSA1SF2JhaWR1LWJhaWtlLWl0ZW0tcmVjYWxsXSniPzpiZAoP6auY5oCn6IO96K6h566XEgdVbmtub3duGKWaAiCqmgIoATUp4j86OgdhcnRpY2xlQPHh4bflhOHiM0gAUiQxMDBiZTU4Ny0xYmQ3LTRiZmQtOTM1MS03ODY0YzI3ZmY3ODQ=","isOnAB":false,"isNatural":1,"isDelete":false,"contentType":"","contentId":"","contentToken":""},{"name":"Thread Block Swizzle","mention":"Thread Block Swizzle","matchorder":1,"begin":35543,"end":35563,"entityid":7690626454282748000,"isBookMark":false,"link":{"linkType":0,"linkUrl":"","docType":"","topicToken":""},"entityClass":"Unknown","score":0.0016314356864980117,"attachedInfoBytes":"sgJpChRUaHJlYWQgQmxvY2sgU3dpenpsZRIHVW5rbm93bhjXlQIg65UCKAE15tXVOjoHYXJ0aWNsZUDi\u002FPqdt4Cm3WpIAFIkMTAwYmU1ODctMWJkNy00YmZkLTkzNTEtNzg2NGMyN2ZmNzg08gLgAQokMTAwYmU1ODctMWJkNy00YmZkLTkzNTEtNzg2NGMyN2ZmNzg0GgdhcnRpY2xlIgkyMzgxOTg2MDI6FFRocmVhZCBCbG9jayBTd2l6emxlQOL8+p23gKbdakgPUhJhaV9lbnRpdHlfcmVjYWxsZXJd5tXVOmJpChRUaHJlYWQgQmxvY2sgU3dpenpsZRIHVW5rbm93bhjXlQIg65UCKAE15tXVOjoHYXJ0aWNsZUDi\u002FPqdt4Cm3WpIAFIkMTAwYmU1ODctMWJkNy00YmZkLTkzNTEtNzg2NGMyN2ZmNzg0","isOnAB":false,"isNatural":1,"isDelete":false,"contentType":"","contentId":"","contentToken":""},{"name":"Ampere架构","mention":"Ampere架构","matchorder":1,"begin":836,"end":844,"entityid":-3949315032937445000,"isBookMark":false,"link":{"linkType":0,"linkUrl":"","docType":"","topicToken":""},"entityClass":"Unknown","score":0.0015959872809883091,"attachedInfoBytes":"sgJgCgxBbXBlcmXmnrbmnoQSB1Vua25vd24YxAYgzAYoATVyMNE6OgdhcnRpY2xlQMaTnZ3u3M2YyQFIAFIkMTAwYmU1ODctMWJkNy00YmZkLTkzNTEtNzg2NGMyN2ZmNzg08gLQAQokMTAwYmU1ODctMWJkNy00YmZkLTkzNTEtNzg2NGMyN2ZmNzg0GgdhcnRpY2xlIgkyMzgxOTg2MDI6DEFtcGVyZeaetuaehEDGk52d7tzNmMkBSBBSEmFpX2VudGl0eV9yZWNhbGxlcl1yMNE6YmAKDEFtcGVyZeaetuaehBIHVW5rbm93bhjEBiDMBigBNXIw0To6B2FydGljbGVAxpOdne7czZjJAUgAUiQxMDBiZTU4Ny0xYmQ3LTRiZmQtOTM1MS03ODY0YzI3ZmY3ODQ=","isOnAB":false,"isNatural":1,"isDelete":false,"contentType":"","contentId":"","contentToken":""},{"name":"SOTA","mention":"SOTA","matchorder":1,"begin":679,"end":683,"entityid":4257878735496999400,"isBookMark":false,"link":{"linkType":0,"linkUrl":"","docType":"","topicToken":""},"entityClass":"Unknown","score":0.0012776355314955412,"attachedInfoBytes":"sgJXCgRTT1RBEgdVbmtub3duGKcFIKsFKAE1VnanOjoHYXJ0aWNsZUD+4vOv6cTBiztIAFIkMTAwYmU1ODctMWJkNy00YmZkLTkzNTEtNzg2NGMyN2ZmNzg08gK+AQokMTAwYmU1ODctMWJkNy00YmZkLTkzNTEtNzg2NGMyN2ZmNzg0GgdhcnRpY2xlIgkyMzgxOTg2MDI6BFNPVEFA\u002FuLzr+nEwYs7SBFSEmFpX2VudGl0eV9yZWNhbGxlcl1Wdqc6YlcKBFNPVEESB1Vua25vd24YpwUgqwUoATVWdqc6OgdhcnRpY2xlQP7i86\u002FpxMGLO0gAUiQxMDBiZTU4Ny0xYmQ3LTRiZmQtOTM1MS03ODY0YzI3ZmY3ODQ=","isOnAB":false,"isNatural":1,"isDelete":false,"contentType":"","contentId":"","contentToken":""},{"name":"NVCC","mention":"NVCC","matchorder":1,"begin":33356,"end":33360,"entityid":7865242937746958000,"isBookMark":false,"link":{"linkType":0,"linkUrl":"","docType":"","topicToken":""},"entityClass":"Unknown","score":0.0008875246186619695,"attachedInfoBytes":"sgJZCgROVkNDEgdVbmtub3duGMyEAiDQhAIoATXFqGg6OgdhcnRpY2xlQP3OuoT7mL2TbUgAUiQxMDBiZTU4Ny0xYmQ3LTRiZmQtOTM1MS03ODY0YzI3ZmY3ODTyAsABCiQxMDBiZTU4Ny0xYmQ3LTRiZmQtOTM1MS03ODY0YzI3ZmY3ODQaB2FydGljbGUiCTIzODE5ODYwMjoETlZDQ0D9zrqE+5i9k21IElISYWlfZW50aXR5X3JlY2FsbGVyXcWoaDpiWQoETlZDQxIHVW5rbm93bhjMhAIg0IQCKAE1xahoOjoHYXJ0aWNsZUD9zrqE+5i9k21IAFIkMTAwYmU1ODctMWJkNy00YmZkLTkzNTEtNzg2NGMyN2ZmNzg0","isOnAB":false,"isNatural":1,"isDelete":false,"contentType":"","contentId":"","contentToken":""},{"name":"启发式算法","mention":"启发式算法","matchorder":1,"begin":702,"end":707,"entityid":7739965806825502000,"isBookMark":false,"link":{"linkType":0,"linkUrl":"","docType":"","topicToken":""},"entityClass":"Math","score":0.0008548724726492041,"attachedInfoBytes":"sgJfCg\u002FlkK\u002Flj5HlvI\u002Fnrpfms5USBE1hdGgYvgUgwwUoATWFGWA6OgdhcnRpY2xlQL\u002Fng8zKvPi0a0gAUiQxMDBiZTU4Ny0xYmQ3LTRiZmQtOTM1MS03ODY0YzI3ZmY3ODTyAtEBCiQxMDBiZTU4Ny0xYmQ3LTRiZmQtOTM1MS03ODY0YzI3ZmY3ODQaB2FydGljbGUiCTIzODE5ODYwMjoP5ZCv5Y+R5byP566X5rOVQL\u002Fng8zKvPi0a0gTUhJhaV9lbnRpdHlfcmVjYWxsZXJdhRlgOmJfCg\u002FlkK\u002Flj5HlvI\u002Fnrpfms5USBE1hdGgYvgUgwwUoATWFGWA6OgdhcnRpY2xlQL\u002Fng8zKvPi0a0gAUiQxMDBiZTU4Ny0xYmQ3LTRiZmQtOTM1MS03ODY0YzI3ZmY3ODQ=","isOnAB":false,"isNatural":1,"isDelete":false,"contentType":"","contentId":"","contentToken":""},{"name":"矩阵乘法","mention":"矩阵乘法","matchorder":1,"begin":525,"end":529,"entityid":-8973652458672455000,"isBookMark":false,"link":{"linkType":0,"linkUrl":"","docType":"","topicToken":""},"entityClass":"Math","score":0.0007643592275199118,"attachedInfoBytes":"sgJdCgznn6npmLXkuZjms5USBE1hdGgYjQQgkQQoATVIX0g6OgdhcnRpY2xlQImFkvih1Mu7gwFIAFIkMTAwYmU1ODctMWJkNy00YmZkLTkzNTEtNzg2NGMyN2ZmNzg08gLNAQokMTAwYmU1ODctMWJkNy00YmZkLTkzNTEtNzg2NGMyN2ZmNzg0GgdhcnRpY2xlIgkyMzgxOTg2MDI6DOefqemYteS5mOazlUCJhZL4odTLu4MBSBRSEmFpX2VudGl0eV9yZWNhbGxlcl1IX0g6Yl0KDOefqemYteS5mOazlRIETWF0aBiNBCCRBCgBNUhfSDo6B2FydGljbGVAiYWS+KHUy7uDAUgAUiQxMDBiZTU4Ny0xYmQ3LTRiZmQtOTM1MS03ODY0YzI3ZmY3ODQ=","isOnAB":false,"isNatural":1,"isDelete":false,"contentType":"","contentId":"","contentToken":""},{"name":"reg s","mention":"reg s","matchorder":1,"begin":26797,"end":26802,"entityid":-4302629767972656000,"isBookMark":false,"link":{"linkType":0,"linkUrl":"","docType":"","topicToken":""},"entityClass":"Medical","score":0.0010789259059701128,"attachedInfoBytes":"sgJbCgVyZWcgcxIHTWVkaWNhbBit0QEgstEBKAE1v2qNOjoHYXJ0aWNsZUDI2N+\u002F26D\u002FpMQBSABSJDEwMGJlNTg3LTFiZDctNGJmZC05MzUxLTc4NjRjMjdmZjc4NPICxAEKJDEwMGJlNTg3LTFiZDctNGJmZC05MzUxLTc4NjRjMjdmZjc4NBoHYXJ0aWNsZSIJMjM4MTk4NjAyOgVyZWcgc0DI2N+\u002F26D\u002FpMQBSBVSEmFpX2VudGl0eV9yZWNhbGxlcl2\u002Fao06YlsKBXJlZyBzEgdNZWRpY2FsGK3RASCy0QEoATW\u002Fao06OgdhcnRpY2xlQMjY37\u002FboP+kxAFIAFIkMTAwYmU1ODctMWJkNy00YmZkLTkzNTEtNzg2NGMyN2ZmNzg0","isOnAB":false,"isNatural":1,"isDelete":false,"contentType":"","contentId":"","contentToken":""},{"name":"Cache","mention":"Cache","matchorder":1,"begin":8893,"end":8898,"entityid":-3826170157102600700,"isBookMark":false,"link":{"linkType":0,"linkUrl":"","docType":"","topicToken":""},"entityClass":"Unknown","score":0.0005678769761572541,"attachedInfoBytes":"sgJZCgVDYWNoZRIHVW5rbm93bhi9RSDCRSgBNZTdFDo6B2FydGljbGVAqd3LvbnQrfPKAUgAUiQxMDBiZTU4Ny0xYmQ3LTRiZmQtOTM1MS03ODY0YzI3ZmY3ODTyAsIBCiQxMDBiZTU4Ny0xYmQ3LTRiZmQtOTM1MS03ODY0YzI3ZmY3ODQaB2FydGljbGUiCTIzODE5ODYwMjoFQ2FjaGVAqd3LvbnQrfPKAUgWUhJhaV9lbnRpdHlfcmVjYWxsZXJdlN0UOmJZCgVDYWNoZRIHVW5rbm93bhi9RSDCRSgBNZTdFDo6B2FydGljbGVAqd3LvbnQrfPKAUgAUiQxMDBiZTU4Ny0xYmQ3LTRiZmQtOTM1MS03ODY0YzI3ZmY3ODQ=","isOnAB":false,"isNatural":1,"isDelete":false,"contentType":"","contentId":"","contentToken":""},{"name":"CUDA","mention":"CUDA","matchorder":1,"begin":35505,"end":35509,"entityid":8339630888016387000,"isBookMark":false,"link":{"linkType":0,"linkUrl":"","docType":"","topicToken":""},"entityClass":"Unknown","score":0.0009354792294809372,"attachedInfoBytes":"sgJZCgRDVURBEgdVbmtub3duGLGVAiC1lQIoATXzOnU6OgdhcnRpY2xlQOq13vC3w5Tec0gAUiQxMDBiZTU4Ny0xYmQ3LTRiZmQtOTM1MS03ODY0YzI3ZmY3ODTyAsABCiQxMDBiZTU4Ny0xYmQ3LTRiZmQtOTM1MS03ODY0YzI3ZmY3ODQaB2FydGljbGUiCTIzODE5ODYwMjoEQ1VEQUDqtd7wt8OU3nNIGFISYWlfZW50aXR5X3JlY2FsbGVyXfM6dTpiWQoEQ1VEQRIHVW5rbm93bhixlQIgtZUCKAE18zp1OjoHYXJ0aWNsZUDqtd7wt8OU3nNIAFIkMTAwYmU1ODctMWJkNy00YmZkLTkzNTEtNzg2NGMyN2ZmNzg0","isOnAB":false,"isNatural":1,"isDelete":false,"contentType":"","contentId":"","contentToken":""},{"name":"gemm函数","mention":"gemm函数","matchorder":1,"begin":1738,"end":1744,"entityid":-1853790738948398600,"isBookMark":false,"link":{"linkType":0,"linkUrl":"","docType":"","topicToken":""},"entityClass":"Math","score":0.0008790081644330788,"attachedInfoBytes":"sgJbCgpnZW1t5Ye95pWwEgRNYXRoGMoNINANKAE1PW1mOjoHYXJ0aWNsZUCGw8no0OSAo+YBSABSJDEwMGJlNTg3LTFiZDctNGJmZC05MzUxLTc4NjRjMjdmZjc4NPICyQEKJDEwMGJlNTg3LTFiZDctNGJmZC05MzUxLTc4NjRjMjdmZjc4NBoHYXJ0aWNsZSIJMjM4MTk4NjAyOgpnZW1t5Ye95pWwQIbDyejQ5ICj5gFIGVISYWlfZW50aXR5X3JlY2FsbGVyXT1tZjpiWwoKZ2VtbeWHveaVsBIETWF0aBjKDSDQDSgBNT1tZjo6B2FydGljbGVAhsPJ6NDkgKPmAUgAUiQxMDBiZTU4Ny0xYmQ3LTRiZmQtOTM1MS03ODY0YzI3ZmY3ODQ=","isOnAB":false,"isNatural":1,"isDelete":false,"contentType":"","contentId":"","contentToken":""},{"name":"L2 Cache","mention":"L2 Cache","matchorder":1,"begin":33537,"end":33545,"entityid":6275136322270253000,"isBookMark":false,"link":{"linkType":0,"linkUrl":"","docType":"","topicToken":""},"entityClass":"Unknown","score":0.0008937882900575955,"attachedInfoBytes":"sgJdCghMMiBDYWNoZRIHVW5rbm93bhiBhgIgiYYCKAE1Hk1qOjoHYXJ0aWNsZUDJnMfwzufwildIAFIkMTAwYmU1ODctMWJkNy00YmZkLTkzNTEtNzg2NGMyN2ZmNzg08gLIAQokMTAwYmU1ODctMWJkNy00YmZkLTkzNTEtNzg2NGMyN2ZmNzg0GgdhcnRpY2xlIgkyMzgxOTg2MDI6CEwyIENhY2hlQMmcx\u002FDO5\u002FCKV0gaUhJhaV9lbnRpdHlfcmVjYWxsZXJdHk1qOmJdCghMMiBDYWNoZRIHVW5rbm93bhiBhgIgiYYCKAE1Hk1qOjoHYXJ0aWNsZUDJnMfwzufwildIAFIkMTAwYmU1ODctMWJkNy00YmZkLTkzNTEtNzg2NGMyN2ZmNzg0","isOnAB":false,"isNatural":1,"isDelete":false,"contentType":"","contentId":"","contentToken":""},{"name":"设备端代码","mention":"设备端代码","matchorder":1,"begin":11592,"end":11597,"entityid":249912808020105440,"isBookMark":false,"link":{"linkType":0,"linkUrl":"","docType":"","topicToken":""},"entityClass":"Unknown","score":0.0005545376655478607,"attachedInfoBytes":"sgJiCg\u002Forr7lpIfnq6\u002Fku6PnoIESB1Vua25vd24YyFogzVooATVlXhE6OgdhcnRpY2xlQOyx75b\u002Fy\u002Fe7A0gAUiQxMDBiZTU4Ny0xYmQ3LTRiZmQtOTM1MS03ODY0YzI3ZmY3ODTyAtQBCiQxMDBiZTU4Ny0xYmQ3LTRiZmQtOTM1MS03ODY0YzI3ZmY3ODQaB2FydGljbGUiCTIzODE5ODYwMjoP6K6+5aSH56uv5Luj56CBQOyx75b\u002Fy\u002Fe7A0gbUhJhaV9lbnRpdHlfcmVjYWxsZXJdZV4ROmJiCg\u002Forr7lpIfnq6\u002Fku6PnoIESB1Vua25vd24YyFogzVooATVlXhE6OgdhcnRpY2xlQOyx75b\u002Fy\u002Fe7A0gAUiQxMDBiZTU4Ny0xYmQ3LTRiZmQtOTM1MS03ODY0YzI3ZmY3ODQ=","isOnAB":false,"isNatural":1,"isDelete":false,"contentType":"","contentId":"","contentToken":""}],"id":675308830,"title":"cute 之 高效GEMM实现","type":"article","articleType":"normal","excerptTitle":"","url":"https:\u002F\u002Fzhuanlan.zhihu.com\u002Fp\u002F675308830","imageUrl":"https:\u002F\u002Fpica.zhimg.com\u002Fv2-145b8f31c7cf00c4608350d53b9646eb_720w.jpg?source=172ae18b","titleImage":"https:\u002F\u002Fpica.zhimg.com\u002Fv2-145b8f31c7cf00c4608350d53b9646eb_720w.jpg?source=172ae18b","excerpt":"\u003Cimg src=\"https:\u002F\u002Fpic4.zhimg.com\u002Fv2-d10f297a1220cca836229a7146daaf67_200x112.png\" data-caption=\"Figure 1. MMA能力层次和各层的主要功能\" data-size=\"normal\" data-rawwidth=\"1587\" data-rawheight=\"2114\" data-watermark=\"watermark\" data-original-src=\"v2-d10f297a1220cca836229a7146daaf67\" data-watermark-src=\"v2-0182682744b1a9f77a1adf63ae473873\" data-private-watermark-src=\"\" class=\"origin_image inline-img zh-lightbox-thumb\" data-original=\"https:\u002F\u002Fpic4.zhimg.com\u002Fv2-d10f297a1220cca836229a7146daaf67_r.png\"\u002F\u003E前面的文章我们介绍了cute中的 \u003Ca href=\"https:\u002F\u002Fzhuanlan.zhihu.com\u002Fp\u002F661182311\" class=\"internal\"\u003ELayout抽象\u003C\u002Fa\u003E、\u003Ca href=\"https:\u002F\u002Fzhuanlan.zhihu.com\u002Fp\u002F663093816\" class=\"internal\"\u003ETensor抽象\u003C\u002Fa\u003E、\u003Ca href=\"https:\u002F\u002Fzhuanlan.zhihu.com\u002Fp\u002F663092747\" class=\"internal\"\u003EMMA抽象\u003C\u002Fa\u003E、\u003Ca href=\"https:\u002F\u002Fzhuanlan.zhihu.com\u002Fp\u002F666232173\" class=\"internal\"\u003ECopy抽象\u003C\u002Fa\u003E、\u003Ca href=\"https:\u002F\u002Fzhuanlan.zhihu.com\u002Fp\u002F671419093\" class=\"internal\"\u003ESwizzle抽象\u003C\u002Fa\u003E和\u003Ca href=\"https:\u002F\u002Fzhuanlan.zhihu.com\u002Fp\u002F665082713\" class=\"internal\"\u003E流水线技术\u003C\u002Fa\u003E。本文将组合利用这些抽象和技术形成高效的矩阵乘法。为了更好地实现高效的矩阵乘法，本文从多个维度介绍了高效的实现方法。在文章结构上，本文首先介绍…","created":1703941979,"updated":1709720905,"author":{"isFollowed":false,"avatarUrlTemplate":"https:\u002F\u002Fpicx.zhimg.com\u002Fv2-e9c299bcbb6d098601ce529e9a358d82.jpg?source=172ae18b","uid":"1064511094718017536","userType":"people","isFollowing":true,"urlToken":"reed-84-49","id":"2600b0313c76a175aa9e09a235382b79","description":"https:\u002F\u002Freed-lau.github.io","name":"reed","isAdvertiser":false,"headline":"从科学计算到高性能计算系统","gender":1,"url":"\u002Fpeople\u002F2600b0313c76a175aa9e09a235382b79","avatarUrl":"https:\u002F\u002Fpicx.zhimg.com\u002Fv2-e9c299bcbb6d098601ce529e9a358d82_l.jpg?source=172ae18b","isOrg":false,"type":"people","badge":[{"type":"identity","topics":[],"description":"中国科学院大学 理学博士"}],"badgeV2":{"title":"中国科学院大学 理学博士","mergedBadges":[{"type":"identity","detailType":"identity","title":"认证","description":"中国科学院大学 理学博士","url":"https:\u002F\u002Fzhuanlan.zhihu.com\u002Fp\u002F96956163","sources":[],"icon":"","nightIcon":""}],"detailBadges":[{"type":"identity","detailType":"identity_people","title":"已认证的个人","description":"中国科学院大学 理学博士","url":"https:\u002F\u002Fzhuanlan.zhihu.com\u002Fp\u002F96956163","sources":[],"icon":"https:\u002F\u002Fpicx.zhimg.com\u002Fv2-2ddc5cc683982648f6f123616fb4ec09_l.png?source=32738c0c","nightIcon":"https:\u002F\u002Fpicx.zhimg.com\u002Fv2-2ddc5cc683982648f6f123616fb4ec09_l.png?source=32738c0c"}],"icon":"https:\u002F\u002Fpicx.zhimg.com\u002Fv2-2ddc5cc683982648f6f123616fb4ec09_l.png?source=32738c0c","nightIcon":"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-2ddc5cc683982648f6f123616fb4ec09_l.png?source=32738c0c"},"exposedMedal":{"medalId":"972477022068568064","medalName":"备受瞩目","avatarUrl":"https:\u002F\u002Fpicx.zhimg.com\u002Fv2-6da117205088242db9cd82e48b28640d_r.png?source=172ae18b","miniAvatarUrl":"https:\u002F\u002Fpicx.zhimg.com\u002Fv2-6da117205088242db9cd82e48b28640d_l.png?source=172ae18b","description":"被 1000 个人关注","medalAvatarFrame":""}},"commentPermission":"all","copyrightPermission":"need_review","state":"published","ipInfo":"IP 属地北京","imageWidth":2264,"imageHeight":1226,"content":"\u003Cp data-pid=\"u4_NTx4z\"\u003E前面的文章我们介绍了cute中的\u003Ca href=\"https:\u002F\u002Fzhuanlan.zhihu.com\u002Fp\u002F661182311\" class=\"internal\"\u003ELayout抽象\u003C\u002Fa\u003E、\u003Ca href=\"https:\u002F\u002Fzhuanlan.zhihu.com\u002Fp\u002F663093816\" class=\"internal\"\u003ETensor抽象\u003C\u002Fa\u003E、\u003Ca href=\"https:\u002F\u002Fzhuanlan.zhihu.com\u002Fp\u002F663092747\" class=\"internal\"\u003EMMA抽象\u003C\u002Fa\u003E、\u003Ca href=\"https:\u002F\u002Fzhuanlan.zhihu.com\u002Fp\u002F666232173\" class=\"internal\"\u003ECopy抽象\u003C\u002Fa\u003E、\u003Ca href=\"https:\u002F\u002Fzhuanlan.zhihu.com\u002Fp\u002F671419093\" class=\"internal\"\u003ESwizzle抽象\u003C\u002Fa\u003E和\u003Ca href=\"https:\u002F\u002Fzhuanlan.zhihu.com\u002Fp\u002F665082713\" class=\"internal\"\u003E流水线技术\u003C\u002Fa\u003E。本文将组合利用这些抽象和技术形成高效的矩阵乘法。为了更好地实现高效的矩阵乘法，本文从多个维度介绍了高效的实现方法。在文章结构上，本文首先介绍了计算高效，然后介绍了访存高效，再后介绍了算法高效，最后介绍了尾阶段高效。我们基于这些高效方案利用cute实现了高效的矩阵乘法，并和cuBLAS、cuBLASLt进行了性能对比，对比结果表明我们的实现达到了SOTA水平。文章最后讨论了搜索kernel的启发式算法和参数相容性问题并对文章进行了总结。\u003C\u002Fp\u003E\u003Ch2\u003E计算高效\u003C\u002Fh2\u003E\u003Cp data-pid=\"8DQMY6NZ\"\u003EGEMM中的核心计算部分是块状的矩阵乘法，针对输入为半精度类型（half precision），Accumulator为半精度类型的计算任务，Ampere架构提供了Tensor Core上的如下计算指令\u003C\u002Fp\u003E\u003Cul\u003E\u003Cli data-pid=\"f9dQruFm\"\u003E\u003Ccode\u003Emma.sync.aligned.m16n8k8.row.col.f16.f16.f16.f16\u003C\u002Fcode\u003E\u003C\u002Fli\u003E\u003Cli data-pid=\"QFgEOfBo\"\u003E\u003Ccode\u003Emma.sync.aligned.m16n8k16.row.col.f16.f16.f16.f16\u003C\u002Fcode\u003E， \u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cp data-pid=\"7q6EJ7FK\"\u003Ecute将这两条指令抽象为MMA_Operation：\u003C\u002Fp\u003E\u003Cul\u003E\u003Cli data-pid=\"gckBzpnJ\"\u003E\u003Ccode\u003ESM80_16x8x8_F16F16F16F16_TN\u003C\u002Fcode\u003E和\u003C\u002Fli\u003E\u003Cli data-pid=\"_eIldKVV\"\u003E\u003Ccode\u003ESM80_16x8x16_F16F16F16F16_TN\u003C\u002Fcode\u003E，\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cp data-pid=\"chT_8cf7\"\u003E当我们的问题规格较大时，我们尽可能选用计算量更大的指令，这样同一条指令产生的计算任务就更多，可以减少指令数目，提升调度效率。\u003C\u002Fp\u003E\u003Cp data-pid=\"FY9mczL8\"\u003E选定计算指令之后，我们便可以通过MMA_Traits，如图1，在MMA_Operation的基础上补充上后续计算所需要的其它信息，如矩阵计算的形状、该指令所需要的协作线程（此处为32线程）、A、B矩阵的寄存器Layout分布情况。有了MMA_Traits之后，我们便可以将其进一步封装为MMA_Atom，其利用Traits提供的信息，提供数据划分所需要的信息和Operation的执行功能。MMA_Atom描述了矩阵计算的原子能力（单条指令的计算能力，最小能力），我们通过增加更多的线程、每个线程做多次任务则可以将计算的规格增大，如此则有了TiledMMA，TiledMMA针对每一个线程则被分裂为ThrMMA，TiledMMA和ThrMMA利用MMA_Atom提供的信息，能够实现对矩阵块的划分。调用相应的cute::gemm函数即可以完成矩阵乘法计算。\u003C\u002Fp\u003E\u003Cfigure data-size=\"normal\"\u003E\u003Cnoscript\u003E\u003Cimg src=\"https:\u002F\u002Fpic4.zhimg.com\u002Fv2-0182682744b1a9f77a1adf63ae473873_b.jpg\" data-size=\"normal\" data-rawwidth=\"1587\" data-rawheight=\"2114\" class=\"origin_image zh-lightbox-thumb\" width=\"1587\" data-original=\"https:\u002F\u002Fpic4.zhimg.com\u002Fv2-0182682744b1a9f77a1adf63ae473873_r.jpg\"\u002F\u003E\u003C\u002Fnoscript\u003E\u003Cimg src=\"data:image\u002Fsvg+xml;utf8,&lt;svg xmlns=&#39;http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg&#39; width=&#39;1587&#39; height=&#39;2114&#39;&gt;&lt;\u002Fsvg&gt;\" data-size=\"normal\" data-rawwidth=\"1587\" data-rawheight=\"2114\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"1587\" data-original=\"https:\u002F\u002Fpic4.zhimg.com\u002Fv2-0182682744b1a9f77a1adf63ae473873_r.jpg\" data-actualsrc=\"https:\u002F\u002Fpic4.zhimg.com\u002Fv2-0182682744b1a9f77a1adf63ae473873_b.jpg\" data-original-token=\"v2-d10f297a1220cca836229a7146daaf67\"\u002F\u003E\u003Cfigcaption\u003EFigure 1. MMA能力层次和各层的主要功能\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Cp data-pid=\"e-E_6gqy\"\u003E此时，我们便可以得到如下主机端代码\u003C\u002Fp\u003E\u003Cdiv class=\"highlight\"\u003E\u003Cpre\u003E\u003Ccode class=\"language-cpp\"\u003E  \u003Cspan class=\"k\"\u003Eusing\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Emma_op\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003ESM80_16x8x16_F16F16F16F16_TN\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E;\u003C\u002Fspan\u003E\n  \u003Cspan class=\"k\"\u003Eusing\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Emma_traits\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EMMA_Traits\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Emma_op\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&gt;\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E;\u003C\u002Fspan\u003E\n  \u003Cspan class=\"k\"\u003Eusing\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Emma_atom\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EMMA_Atom\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Emma_traits\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&gt;\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E;\u003C\u002Fspan\u003E\n\n  \u003Cspan class=\"k\"\u003Estatic\u003C\u002Fspan\u003E \u003Cspan class=\"k\"\u003Econstexpr\u003C\u002Fspan\u003E \u003Cspan class=\"kt\"\u003Eint\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EkMmaEURepeatM\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"mi\"\u003E2\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E;\u003C\u002Fspan\u003E\n  \u003Cspan class=\"k\"\u003Estatic\u003C\u002Fspan\u003E \u003Cspan class=\"k\"\u003Econstexpr\u003C\u002Fspan\u003E \u003Cspan class=\"kt\"\u003Eint\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EkMmaEURepeatN\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"mi\"\u003E2\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E;\u003C\u002Fspan\u003E\n  \u003Cspan class=\"k\"\u003Estatic\u003C\u002Fspan\u003E \u003Cspan class=\"k\"\u003Econstexpr\u003C\u002Fspan\u003E \u003Cspan class=\"kt\"\u003Eint\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EkMmaEURepeatK\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"mi\"\u003E1\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E;\u003C\u002Fspan\u003E\n\n  \u003Cspan class=\"k\"\u003Estatic\u003C\u002Fspan\u003E \u003Cspan class=\"k\"\u003Econstexpr\u003C\u002Fspan\u003E \u003Cspan class=\"kt\"\u003Eint\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EkMmaVRepeatM\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"mi\"\u003E1\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E;\u003C\u002Fspan\u003E\n  \u003Cspan class=\"k\"\u003Estatic\u003C\u002Fspan\u003E \u003Cspan class=\"k\"\u003Econstexpr\u003C\u002Fspan\u003E \u003Cspan class=\"kt\"\u003Eint\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EkMmaVRepeatN\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"mi\"\u003E2\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E;\u003C\u002Fspan\u003E\n  \u003Cspan class=\"k\"\u003Estatic\u003C\u002Fspan\u003E \u003Cspan class=\"k\"\u003Econstexpr\u003C\u002Fspan\u003E \u003Cspan class=\"kt\"\u003Eint\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EkMmaVRepeatK\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"mi\"\u003E1\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E;\u003C\u002Fspan\u003E\n\n  \u003Cspan class=\"k\"\u003Eusing\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EMMA_EU_RepeatT\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"k\"\u003Edecltype\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Emake_layout\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Emake_shape\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\n      \u003Cspan class=\"n\"\u003EInt\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EkMmaEURepeatM\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&gt;\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E{},\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EInt\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EkMmaEURepeatN\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&gt;\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E{},\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EInt\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EkMmaEURepeatK\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&gt;\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E{})));\u003C\u002Fspan\u003E\n  \u003Cspan class=\"k\"\u003Eusing\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EMMA_V_RepeatT\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"k\"\u003Edecltype\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Emake_layout\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Emake_shape\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\n      \u003Cspan class=\"n\"\u003EInt\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EkMmaVRepeatM\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&gt;\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E{},\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EInt\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EkMmaVRepeatN\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&gt;\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E{},\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EInt\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EkMmaVRepeatK\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&gt;\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E{})));\u003C\u002Fspan\u003E\n\n  \u003Cspan class=\"k\"\u003Eusing\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EMMA\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E\n      \u003Cspan class=\"k\"\u003Edecltype\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Emake_tiled_mma\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Emma_atom\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E{},\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EMMA_EU_RepeatT\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E{},\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EMMA_V_RepeatT\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E{}));\u003C\u002Fspan\u003E\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Cp data-pid=\"DCqTznoF\"\u003E其中前三行选择了MMA指令形成了Atom能力，然后定义了对该Atom能力的重复方法（包括线程重复和寄存器重复），它们分别形成各自重复的Layout，然后利用\u003Ccode\u003Emake_tile_mma\u003C\u002Fcode\u003E接口形成更大块的矩阵乘法描述。设备端的代码如下：\u003C\u002Fp\u003E\u003Cdiv class=\"highlight\"\u003E\u003Cpre\u003E\u003Ccode class=\"language-cpp\"\u003E  \u003Cspan class=\"n\"\u003ETiledMMA\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Etiled_mma\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E;\u003C\u002Fspan\u003E\n  \u003Cspan class=\"k\"\u003Eauto\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Ethr_mma\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Etiled_mma\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Eget_slice\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Eidx\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E);\u003C\u002Fspan\u003E\n  \u003Cspan class=\"k\"\u003Eauto\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EtCrA\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Ethr_mma\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Epartition_fragment_A\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EgA\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003E_\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003E_\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"mi\"\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E));\u003C\u002Fspan\u003E  \u003Cspan class=\"c1\"\u003E\u002F\u002F (MMA, MMA_M, MMA_K)\n\u003C\u002Fspan\u003E\u003Cspan class=\"c1\"\u003E\u003C\u002Fspan\u003E  \u003Cspan class=\"k\"\u003Eauto\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EtCrB\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Ethr_mma\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Epartition_fragment_B\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EgB\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003E_\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003E_\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"mi\"\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E));\u003C\u002Fspan\u003E  \u003Cspan class=\"c1\"\u003E\u002F\u002F (MMA, MMA_N, MMA_K)\n\u003C\u002Fspan\u003E\u003Cspan class=\"c1\"\u003E\u003C\u002Fspan\u003E  \u003Cspan class=\"k\"\u003Eauto\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EtCrD\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Ethr_mma\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Epartition_fragment_C\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EgD\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E);\u003C\u002Fspan\u003E           \u003Cspan class=\"c1\"\u003E\u002F\u002F (MMA, MMA_M, MMA_N)\n\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Cp data-pid=\"KoqZSQXd\"\u003E将TileMMA提供线程号，则获得具体线程的数据划分能力，对给定的数据块进行划分，得到线程级的数据描述。\u003C\u002Fp\u003E\u003Cfigure data-size=\"normal\"\u003E\u003Cnoscript\u003E\u003Cimg src=\"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-fe899d28c68547b8175472b018113e04_b.jpg\" data-size=\"normal\" data-rawwidth=\"2235\" data-rawheight=\"1933\" class=\"origin_image zh-lightbox-thumb\" width=\"2235\" data-original=\"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-fe899d28c68547b8175472b018113e04_r.jpg\"\u002F\u003E\u003C\u002Fnoscript\u003E\u003Cimg src=\"data:image\u002Fsvg+xml;utf8,&lt;svg xmlns=&#39;http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg&#39; width=&#39;2235&#39; height=&#39;1933&#39;&gt;&lt;\u002Fsvg&gt;\" data-size=\"normal\" data-rawwidth=\"2235\" data-rawheight=\"1933\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"2235\" data-original=\"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-fe899d28c68547b8175472b018113e04_r.jpg\" data-actualsrc=\"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-fe899d28c68547b8175472b018113e04_b.jpg\" data-original-token=\"v2-ff7bf4c0a1d3e4119e4f77c2c4fd57a8\"\u002F\u003E\u003Cfigcaption\u003EFigure 2. partition_A\u002FB\u002FC逻辑示意图\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Cp data-pid=\"JFBnVqRT\"\u003E如图2所示，其展示了ThrMMA提供的partition_A\u002FB\u002FC和partition_fragment_A\u002FB\u002FC函数的计算逻辑，给定一个静态大小的Tensor TileB（被划分维度为Int&lt;&gt;编译时常量），则thr_mma可以对其进行划分，其中划分的逻辑为：以TileMMA中描述的矩阵大小对目标Tensor进行周期性平铺，对高亮的部分进行选取形成新的矩阵，其中第一个维度为TiledMMA中单个线程的数据描述，第二个维度和第三个维度为行方向和列方向需要重复的次数。如果TileB的维度比两维高，则高出的部分继承到N,K维度之后。类似地，A\u002FC的划分采用同样的逻辑。\u003C\u002Fp\u003E\u003Ch2\u003E访存高效\u003C\u002Fh2\u003E\u003Cp data-pid=\"CdIgkDWg\"\u003E整个GEMM计算体系中数据的在到达Tensor Core进行计算之前需要包含：全局内存到共享内存，共享内存到寄存器，在流水线章节我们介绍过全局内存到共享内存的异步拷贝方法，和共享内存到寄存器的ldmatrix指令。在cute中，针对全局内存到共享内存，我们和选择MMA能力类似，选择cute已经定义好的抽象能力即可，此处我们选择\u003Ccode\u003ESM80_CP_ASYNC_CACHEGLOBAL\u003C\u002Fcode\u003ECopy_Operation，该指令可以实现全局内存到共享内存到异步拷贝，同时CACHEGLOBAL指示了数据只在L2做Cache，对L1则做bypass。于是我们可以形成如下主机端代码： \u003C\u002Fp\u003E\u003Cdiv class=\"highlight\"\u003E\u003Cpre\u003E\u003Ccode class=\"language-cpp\"\u003E  \u003Cspan class=\"k\"\u003Eusing\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Eg2s_copy_op\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003ESM80_CP_ASYNC_CACHEGLOBAL\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Ecute\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E::\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Euint128_t\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&gt;\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E;\u003C\u002Fspan\u003E\n  \u003Cspan class=\"k\"\u003Eusing\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Eg2s_copy_traits\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003ECopy_Traits\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Eg2s_copy_op\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&gt;\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E;\u003C\u002Fspan\u003E\n  \u003Cspan class=\"k\"\u003Eusing\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Eg2s_copy_atom\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003ECopy_Atom\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Eg2s_copy_traits\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003ET\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&gt;\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E;\u003C\u002Fspan\u003E\n\n  \u003Cspan class=\"k\"\u003Eusing\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EG2SCopyA\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E\n      \u003Cspan class=\"k\"\u003Edecltype\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Emake_tiled_copy\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Eg2s_copy_atom\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E{},\u003C\u002Fspan\u003E\n                               \u003Cspan class=\"n\"\u003Emake_layout\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Emake_shape\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EInt\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\"mi\"\u003E32\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&gt;\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E{},\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EInt\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\"mi\"\u003E4\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&gt;\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E{}),\u003C\u002Fspan\u003E\n                                           \u003Cspan class=\"n\"\u003Emake_stride\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EInt\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\"mi\"\u003E4\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&gt;\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E{},\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EInt\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\"mi\"\u003E1\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&gt;\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E{})),\u003C\u002Fspan\u003E\n                               \u003Cspan class=\"n\"\u003Emake_layout\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Emake_shape\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EInt\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\"mi\"\u003E1\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&gt;\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E{},\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EInt\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\"mi\"\u003E8\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&gt;\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E{}))));\u003C\u002Fspan\u003E\n  \u003Cspan class=\"k\"\u003Eusing\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EG2SCopyB\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EG2SCopyA\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E;\u003C\u002Fspan\u003E\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Cp data-pid=\"FX2EHqZC\"\u003E和MMA时的make_tiled_mma类似，Copy抽象提供了make_tile_copy能力，其通过制定线程和数据的重复方法将Atom能力扩展到块状能力。数据拷贝时可以区分AB矩阵的不同拷贝方法，我们此处选用同样的Copy能力。设备端代码如下\u003C\u002Fp\u003E\u003Cdiv class=\"highlight\"\u003E\u003Cpre\u003E\u003Ccode class=\"language-cpp\"\u003E  \u003Cspan class=\"n\"\u003EG2SCopyA\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Eg2s_tiled_copy_a\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E;\u003C\u002Fspan\u003E\n  \u003Cspan class=\"k\"\u003Eauto\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Eg2s_thr_copy_a\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Eg2s_tiled_copy_a\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Eget_slice\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Eidx\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E);\u003C\u002Fspan\u003E\n  \u003Cspan class=\"k\"\u003Eauto\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EtAgA_copy\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Eg2s_thr_copy_a\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Epartition_S\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EgA\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E);\u003C\u002Fspan\u003E  \u003Cspan class=\"c1\"\u003E\u002F\u002F (CPY, CPY_M, CPY_K, k)\n\u003C\u002Fspan\u003E\u003Cspan class=\"c1\"\u003E\u003C\u002Fspan\u003E  \u003Cspan class=\"k\"\u003Eauto\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EtAsA_copy\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E\n      \u003Cspan class=\"n\"\u003Eg2s_thr_copy_a\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Epartition_D\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EsA\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E);\u003C\u002Fspan\u003E  \u003Cspan class=\"c1\"\u003E\u002F\u002F (CPY, CPY_M, CPY_K, kStage)\n\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Cp data-pid=\"7Jq9xRZq\"\u003E和图1中的MMA层级类似，Copy时先将TileCopy通过指定线程号得到线程级的Copy能力抽象ThrCopy。也和图2中的MMA划分类似，ThrCopy抽象提供了partiton_S\u002FD函数，其实现将大块的矩阵划分到线程维度上。经过partition_S\u002FD划分的数据维度为(E, M, K)，E表示该线程要做的数据大小（包含分布），M、K表示由于给定的被划分的块需要在纵轴和横轴上需要重复的次数。如果被划分的Tile的维度大于2，则多出的维度附加到（，M，K）维度之后。\u003C\u002Fp\u003E\u003Cp data-pid=\"LTjvlWJE\"\u003E对于共享内存到寄存器的拷贝，cute提供了对ldmatrix指令的封装，主机端代码和设备端代码分别如下：\u003C\u002Fp\u003E\u003Cdiv class=\"highlight\"\u003E\u003Cpre\u003E\u003Ccode class=\"language-cpp\"\u003E  \u003Cspan class=\"c1\"\u003E\u002F\u002F shared memory to register copy\n\u003C\u002Fspan\u003E\u003Cspan class=\"c1\"\u003E\u003C\u002Fspan\u003E  \u003Cspan class=\"k\"\u003Eusing\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Es2r_copy_op\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003ESM75_U32x4_LDSM_N\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E;\u003C\u002Fspan\u003E\n  \u003Cspan class=\"k\"\u003Eusing\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Es2r_copy_traits\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003ECopy_Traits\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Es2r_copy_op\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&gt;\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E;\u003C\u002Fspan\u003E\n  \u003Cspan class=\"k\"\u003Eusing\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Es2r_copy_atom\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003ECopy_Atom\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Es2r_copy_traits\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003ET\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&gt;\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E;\u003C\u002Fspan\u003E\n\n  \u003Cspan class=\"k\"\u003Eusing\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003ES2RCopyAtomA\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Es2r_copy_atom\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E;\u003C\u002Fspan\u003E\n  \u003Cspan class=\"k\"\u003Eusing\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003ES2RCopyAtomB\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Es2r_copy_atom\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E;\u003C\u002Fspan\u003E\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Cp data-pid=\"f4yQVr0w\"\u003E设备端代码：\u003C\u002Fp\u003E\u003Cdiv class=\"highlight\"\u003E\u003Cpre\u003E\u003Ccode class=\"language-cpp\"\u003E  \u003Cspan class=\"k\"\u003Eauto\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Es2r_tiled_copy_a\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Emake_tiled_copy_A\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003ES2RCopyAtomA\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E{},\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Etiled_mma\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E);\u003C\u002Fspan\u003E\n  \u003Cspan class=\"k\"\u003Eauto\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Es2r_thr_copy_a\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Es2r_tiled_copy_a\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Eget_slice\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Eidx\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E);\u003C\u002Fspan\u003E\n  \u003Cspan class=\"k\"\u003Eauto\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EtAsA\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Es2r_thr_copy_a\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Epartition_S\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EsA\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E);\u003C\u002Fspan\u003E  \u003Cspan class=\"c1\"\u003E\u002F\u002F (CPY, CPY_M, CPY_K, kStage)\n\u003C\u002Fspan\u003E\u003Cspan class=\"c1\"\u003E\u003C\u002Fspan\u003E  \u003Cspan class=\"k\"\u003Eauto\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EtCrA_view\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Es2r_thr_copy_a\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Eretile_D\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EtCrA\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E);\u003C\u002Fspan\u003E  \u003Cspan class=\"c1\"\u003E\u002F\u002F (CPY, CPY_M, CPY_K)\n\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Cp data-pid=\"uAEd_J-B\"\u003E其中主机端选择ldmatrix指令的x4模式，形成Atom抽象，设备端通过\u003Ccode\u003Emake_tiled_copy_A\u003C\u002Fcode\u003E函数借助tiled_mma抽象出共享内存到寄存的TileCopy。前面的全局内存到共享内存TileCopy不同的是，这里直接利用tiled_mma的信息形成块状拷贝，原因是TiledMMA包含了计算所需要的数据描述，所以对于以它作为目标的Copy而言，tiled_mma自然也是精准描述这部分数据的，所以就不需要用户额外制定Copy_Atom到TileCopy的信息，而是之间从MMA能力中获得，其一定程度上可以避免了独立设置的不一致性问题。由于MMA时已经声明了寄存器存储空间，此处直接对其进行线程级小块的retile即可，不再是大块到小块的partition。\u003C\u002Fp\u003E\u003Ch2\u003E算法高效\u003C\u002Fh2\u003E\u003Cp data-pid=\"QYV8QwAp\"\u003E前面两个章节介绍了计算的高效和访存的高效，如何将这两个步骤组合起来也是GEMM性能的关键要素，这部分我们成为算法的高效。其主要包含两个部分：1. 分块；2. 流水线。这两部分内容我们在简单GEMM实现和流水线中都有介绍，我们此处就不再赘述。对于分块部分，我们主机端和设备端的代码如下：\u003C\u002Fp\u003E\u003Cdiv class=\"highlight\"\u003E\u003Cpre\u003E\u003Ccode class=\"language-cpp\"\u003E  \u003Cspan class=\"k\"\u003Estatic\u003C\u002Fspan\u003E \u003Cspan class=\"k\"\u003Econstexpr\u003C\u002Fspan\u003E \u003Cspan class=\"kt\"\u003Eint\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EkTileM\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EkTileM_\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E;\u003C\u002Fspan\u003E\n  \u003Cspan class=\"k\"\u003Estatic\u003C\u002Fspan\u003E \u003Cspan class=\"k\"\u003Econstexpr\u003C\u002Fspan\u003E \u003Cspan class=\"kt\"\u003Eint\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EkTileN\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EkTileN_\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E;\u003C\u002Fspan\u003E\n  \u003Cspan class=\"k\"\u003Estatic\u003C\u002Fspan\u003E \u003Cspan class=\"k\"\u003Econstexpr\u003C\u002Fspan\u003E \u003Cspan class=\"kt\"\u003Eint\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EkTileK\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EkTileK_\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E;\u003C\u002Fspan\u003E\n  \u003Cspan class=\"k\"\u003Estatic\u003C\u002Fspan\u003E \u003Cspan class=\"k\"\u003Econstexpr\u003C\u002Fspan\u003E \u003Cspan class=\"kt\"\u003Eint\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EkStage\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EkStage_\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E;\u003C\u002Fspan\u003E\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Cp data-pid=\"NAAW7BWS\"\u003E设备端：\u003C\u002Fp\u003E\u003Cdiv class=\"highlight\"\u003E\u003Cpre\u003E\u003Ccode class=\"language-cpp\"\u003E  \u003Cspan class=\"c1\"\u003E\u002F\u002F slice the tensor to small one which is used for current thread block.\n\u003C\u002Fspan\u003E\u003Cspan class=\"c1\"\u003E\u003C\u002Fspan\u003E  \u003Cspan class=\"n\"\u003ETensor\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EgA\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Elocal_tile\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EA\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Emake_tile\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EInt\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EkTileM\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&gt;\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E{},\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EInt\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EkTileK\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&gt;\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E{}),\u003C\u002Fspan\u003E\n                         \u003Cspan class=\"n\"\u003Emake_coord\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Eiy\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003E_\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E));\u003C\u002Fspan\u003E  \u003Cspan class=\"c1\"\u003E\u002F\u002F (kTileM, kTileK, k)\n\u003C\u002Fspan\u003E\u003Cspan class=\"c1\"\u003E\u003C\u002Fspan\u003E  \u003Cspan class=\"n\"\u003ETensor\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EgB\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Elocal_tile\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EB\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Emake_tile\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EInt\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EkTileN\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&gt;\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E{},\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EInt\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EkTileK\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&gt;\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E{}),\u003C\u002Fspan\u003E\n                         \u003Cspan class=\"n\"\u003Emake_coord\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Eix\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003E_\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E));\u003C\u002Fspan\u003E  \u003Cspan class=\"c1\"\u003E\u002F\u002F (kTileN, kTileK, k)\n\u003C\u002Fspan\u003E\u003Cspan class=\"c1\"\u003E\u003C\u002Fspan\u003E  \u003Cspan class=\"n\"\u003ETensor\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EgD\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Elocal_tile\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003ED\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Emake_tile\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EInt\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EkTileM\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&gt;\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E{},\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EInt\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EkTileN\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&gt;\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E{}),\u003C\u002Fspan\u003E\n                         \u003Cspan class=\"n\"\u003Emake_coord\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Eiy\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Eix\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E));\u003C\u002Fspan\u003E  \u003Cspan class=\"c1\"\u003E\u002F\u002F (kTileM, kTileN)\n\u003C\u002Fspan\u003E\u003Cspan class=\"c1\"\u003E\u003C\u002Fspan\u003E\n  \u003Cspan class=\"c1\"\u003E\u002F\u002F shared memory\n\u003C\u002Fspan\u003E\u003Cspan class=\"c1\"\u003E\u003C\u002Fspan\u003E  \u003Cspan class=\"k\"\u003Eauto\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EsA\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Emake_tensor\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Emake_smem_ptr\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EAshm\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E),\u003C\u002Fspan\u003E\n                        \u003Cspan class=\"n\"\u003ESmemLayoutA\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E{});\u003C\u002Fspan\u003E  \u003Cspan class=\"c1\"\u003E\u002F\u002F (kTileM, kTileK, kStage)\n\u003C\u002Fspan\u003E\u003Cspan class=\"c1\"\u003E\u003C\u002Fspan\u003E  \u003Cspan class=\"k\"\u003Eauto\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EsB\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Emake_tensor\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Emake_smem_ptr\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EBshm\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E),\u003C\u002Fspan\u003E\n                        \u003Cspan class=\"n\"\u003ESmemLayoutB\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E{});\u003C\u002Fspan\u003E  \u003Cspan class=\"c1\"\u003E\u002F\u002F (kTileN, kTileK, kStage)\n\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Cp data-pid=\"AAyB64Ii\"\u003E分别定义了分块的大小和设备端如何通过Tensor抽象和local_tile将矩阵进行分块。\u003C\u002Fp\u003E\u003Cp data-pid=\"KE8_3OO0\"\u003E流水线方面，为了做multi stage流水线，需要在共享内存分配时指定流水线级数，同时设备端需要做必要的数据加载和计算重叠方案。主机端代码如下\u003C\u002Fp\u003E\u003Cdiv class=\"highlight\"\u003E\u003Cpre\u003E\u003Ccode class=\"language-cpp\"\u003E  \u003Cspan class=\"k\"\u003Estatic\u003C\u002Fspan\u003E \u003Cspan class=\"k\"\u003Econstexpr\u003C\u002Fspan\u003E \u003Cspan class=\"kt\"\u003Eint\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EkShmLoadSwizzleM\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"mi\"\u003E3\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E;\u003C\u002Fspan\u003E\n  \u003Cspan class=\"k\"\u003Estatic\u003C\u002Fspan\u003E \u003Cspan class=\"k\"\u003Econstexpr\u003C\u002Fspan\u003E \u003Cspan class=\"kt\"\u003Eint\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EkShmLoadSwizzleS\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"mi\"\u003E3\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E;\u003C\u002Fspan\u003E\n  \u003Cspan class=\"k\"\u003Estatic\u003C\u002Fspan\u003E \u003Cspan class=\"k\"\u003Econstexpr\u003C\u002Fspan\u003E \u003Cspan class=\"kt\"\u003Eint\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EkShmLoadSwizzleB\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"mi\"\u003E3\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E;\u003C\u002Fspan\u003E\n\n  \u003Cspan class=\"k\"\u003Eusing\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003ESmemLayoutAtom\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"k\"\u003Edecltype\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Ecomposition\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\n      \u003Cspan class=\"n\"\u003ESwizzle\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EkShmLoadSwizzleB\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EkShmLoadSwizzleM\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EkShmLoadSwizzleS\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&gt;\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E{},\u003C\u002Fspan\u003E\n      \u003Cspan class=\"n\"\u003Emake_layout\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Emake_shape\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EInt\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\"mi\"\u003E8\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&gt;\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E{},\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EInt\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EkTileK\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&gt;\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E{}),\u003C\u002Fspan\u003E\n                  \u003Cspan class=\"n\"\u003Emake_stride\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EInt\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EkTileK\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&gt;\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E{},\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EInt\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\"mi\"\u003E1\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&gt;\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E{}))));\u003C\u002Fspan\u003E\n  \u003Cspan class=\"k\"\u003Eusing\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003ESmemLayoutA\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"k\"\u003Edecltype\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\n      \u003Cspan class=\"n\"\u003Etile_to_shape\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003ESmemLayoutAtom\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E{},\u003C\u002Fspan\u003E\n                    \u003Cspan class=\"n\"\u003Emake_shape\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EInt\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EkTileM\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&gt;\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E{},\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EInt\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EkTileK\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&gt;\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E{},\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EInt\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EkStage\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&gt;\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E{})));\u003C\u002Fspan\u003E\n  \u003Cspan class=\"k\"\u003Eusing\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003ESmemLayoutB\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"k\"\u003Edecltype\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\n      \u003Cspan class=\"n\"\u003Etile_to_shape\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003ESmemLayoutAtom\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E{},\u003C\u002Fspan\u003E\n                    \u003Cspan class=\"n\"\u003Emake_shape\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EInt\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EkTileN\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&gt;\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E{},\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EInt\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EkTileK\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&gt;\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E{},\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EInt\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EkStage\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&gt;\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E{})));\u003C\u002Fspan\u003E\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Cp data-pid=\"OHH3jyAb\"\u003E其定义了共享内存的Layout，其中Swizzle用来避免bank conflict，其详细介绍可以参考前序文章cute之Siwzzle抽象，其中kStage表示流水线的级数。\u003C\u002Fp\u003E\u003Cp data-pid=\"Wm1RlqAK\"\u003E核心设备端代码由两个for循环组成，具体如下，\u003C\u002Fp\u003E\u003Cdiv class=\"highlight\"\u003E\u003Cpre\u003E\u003Ccode class=\"language-cpp\"\u003E  \u003Cspan class=\"c1\"\u003E\u002F\u002F loop over k: i. load tile, ii. mma\n\u003C\u002Fspan\u003E\u003Cspan class=\"c1\"\u003E\u003C\u002Fspan\u003E  \u003Cspan class=\"kt\"\u003Eint\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Entile\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Ek\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E\u002F\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EkTileK\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E;\u003C\u002Fspan\u003E\n\u003Cspan class=\"cp\"\u003E#pragma unroll 1\n\u003C\u002Fspan\u003E\u003Cspan class=\"cp\"\u003E\u003C\u002Fspan\u003E  \u003Cspan class=\"k\"\u003Efor\u003C\u002Fspan\u003E \u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"kt\"\u003Eint\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Eitile\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"mi\"\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E;\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Eitile\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E&lt;\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Entile\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E;\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E++\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Eitile\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"p\"\u003E{\u003C\u002Fspan\u003E\n    \u003Cspan class=\"kt\"\u003Eint\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Enk\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Esize\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\"mi\"\u003E2\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&gt;\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EtCrA\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E);\u003C\u002Fspan\u003E\n\n\u003Cspan class=\"cp\"\u003E#pragma unroll\n\u003C\u002Fspan\u003E\u003Cspan class=\"cp\"\u003E\u003C\u002Fspan\u003E    \u003Cspan class=\"k\"\u003Efor\u003C\u002Fspan\u003E \u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"kt\"\u003Eint\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Eik\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"mi\"\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E;\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Eik\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E&lt;\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Enk\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E;\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E++\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Eik\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"p\"\u003E{\u003C\u002Fspan\u003E\n      \u003Cspan class=\"kt\"\u003Eint\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Eik_next\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Eik\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E+\u003C\u002Fspan\u003E \u003Cspan class=\"mi\"\u003E1\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E%\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Enk\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E;\u003C\u002Fspan\u003E\n\n      \u003Cspan class=\"k\"\u003Eif\u003C\u002Fspan\u003E \u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Eik\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E==\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Enk\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E-\u003C\u002Fspan\u003E \u003Cspan class=\"mi\"\u003E1\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"p\"\u003E{\u003C\u002Fspan\u003E\n        \u003Cspan class=\"n\"\u003Ecp_async_wait\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EkStage\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E-\u003C\u002Fspan\u003E \u003Cspan class=\"mi\"\u003E2\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&gt;\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E();\u003C\u002Fspan\u003E\n        \u003Cspan class=\"n\"\u003E__syncthreads\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E();\u003C\u002Fspan\u003E\n\n        \u003Cspan class=\"n\"\u003Eismem_read\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Eismem_read\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E+\u003C\u002Fspan\u003E \u003Cspan class=\"mi\"\u003E1\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E%\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EkStage\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E;\u003C\u002Fspan\u003E\n      \u003Cspan class=\"p\"\u003E}\u003C\u002Fspan\u003E\n\n      \u003Cspan class=\"c1\"\u003E\u002F\u002F shm -&gt; reg s[itile][ik + 1] -&gt; r[ik + 1]\n\u003C\u002Fspan\u003E\u003Cspan class=\"c1\"\u003E\u003C\u002Fspan\u003E      \u003Cspan class=\"n\"\u003Ecute\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E::\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Ecopy\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Es2r_tiled_copy_a\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EtAsA\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003E_\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003E_\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Eik_next\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Eismem_read\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E),\u003C\u002Fspan\u003E\n                 \u003Cspan class=\"n\"\u003EtCrA_view\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003E_\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003E_\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Eik_next\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E));\u003C\u002Fspan\u003E\n      \u003Cspan class=\"n\"\u003Ecute\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E::\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Ecopy\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Es2r_tiled_copy_b\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EtBsB\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003E_\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003E_\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Eik_next\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Eismem_read\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E),\u003C\u002Fspan\u003E\n                 \u003Cspan class=\"n\"\u003EtCrB_view\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003E_\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003E_\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Eik_next\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E));\u003C\u002Fspan\u003E\n\n      \u003Cspan class=\"k\"\u003Eif\u003C\u002Fspan\u003E \u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Eik\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E==\u003C\u002Fspan\u003E \u003Cspan class=\"mi\"\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"p\"\u003E{\u003C\u002Fspan\u003E\n        \u003Cspan class=\"k\"\u003Eif\u003C\u002Fspan\u003E \u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Eitile_to_read\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E&lt;\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Entile\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"p\"\u003E{\u003C\u002Fspan\u003E\n          \u003Cspan class=\"n\"\u003Ecute\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E::\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Ecopy\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Eg2s_tiled_copy_a\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EtAgA_copy\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003E_\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003E_\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003E_\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Eitile_to_read\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E),\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EtAsA_copy\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003E_\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003E_\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003E_\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Eismem_write\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E));\u003C\u002Fspan\u003E\n          \u003Cspan class=\"n\"\u003Ecute\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E::\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Ecopy\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Eg2s_tiled_copy_b\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EtBgB_copy\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003E_\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003E_\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003E_\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Eitile_to_read\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E),\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EtBsB_copy\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003E_\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003E_\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003E_\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Eismem_write\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E));\u003C\u002Fspan\u003E\n\n          \u003Cspan class=\"o\"\u003E++\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Eitile_to_read\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E;\u003C\u002Fspan\u003E\n          \u003Cspan class=\"n\"\u003Eismem_write\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Eismem_write\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E+\u003C\u002Fspan\u003E \u003Cspan class=\"mi\"\u003E1\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E%\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EkStage\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E;\u003C\u002Fspan\u003E\n        \u003Cspan class=\"p\"\u003E}\u003C\u002Fspan\u003E\n\n        \u003Cspan class=\"n\"\u003Ecp_async_fence\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E();\u003C\u002Fspan\u003E\n      \u003Cspan class=\"p\"\u003E}\u003C\u002Fspan\u003E\n\n      \u003Cspan class=\"n\"\u003Ecute\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E::\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Egemm\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Etiled_mma\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EtCrD\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EtCrA\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003E_\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003E_\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Eik\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E),\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EtCrB\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003E_\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003E_\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Eik\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E),\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EtCrD\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E);\u003C\u002Fspan\u003E\n    \u003Cspan class=\"p\"\u003E}\u003C\u002Fspan\u003E  \u003Cspan class=\"c1\"\u003E\u002F\u002F for ik\n\u003C\u002Fspan\u003E\u003Cspan class=\"c1\"\u003E\u003C\u002Fspan\u003E  \u003Cspan class=\"p\"\u003E}\u003C\u002Fspan\u003E    \u003Cspan class=\"c1\"\u003E\u002F\u002F itile\n\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Cp data-pid=\"KVEc4AAu\"\u003E外层循环对Tile做循环，内层循环对Tile内做k循环，同时在ik == 0 和 ik == nk -1的时候发射了后kStage-1的Tile的全局内层到共享内存的数据加载和针对即将读取的共享内存的数据同步。\u003C\u002Fp\u003E\u003Ch2\u003E尾阶段高效（Epilogue）\u003C\u002Fh2\u003E\u003Cp data-pid=\"EYhvQAg-\"\u003E通过上面的计算、加载、算法，我们便可以得到矩阵乘之后的块状的数据，这些数据表示为线程内寄存器，由于数据存储，将这些数据存储出去并不平凡，如图3所示，如果将寄存器数据直接写出，则在全局地址空间中会产生内存地址的不连续，这将导致存储时需要更多的内存事务，并且不能使用向量化存储指令（STG.128）。\u003C\u002Fp\u003E\u003Cfigure data-size=\"normal\"\u003E\u003Cnoscript\u003E\u003Cimg src=\"https:\u002F\u002Fpic4.zhimg.com\u002Fv2-ddece7971d1161bbf7c7fa8022859993_b.jpg\" data-size=\"normal\" data-rawwidth=\"4333\" data-rawheight=\"1819\" class=\"origin_image zh-lightbox-thumb\" width=\"4333\" data-original=\"https:\u002F\u002Fpic4.zhimg.com\u002Fv2-ddece7971d1161bbf7c7fa8022859993_r.jpg\"\u002F\u003E\u003C\u002Fnoscript\u003E\u003Cimg src=\"data:image\u002Fsvg+xml;utf8,&lt;svg xmlns=&#39;http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg&#39; width=&#39;4333&#39; height=&#39;1819&#39;&gt;&lt;\u002Fsvg&gt;\" data-size=\"normal\" data-rawwidth=\"4333\" data-rawheight=\"1819\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"4333\" data-original=\"https:\u002F\u002Fpic4.zhimg.com\u002Fv2-ddece7971d1161bbf7c7fa8022859993_r.jpg\" data-actualsrc=\"https:\u002F\u002Fpic4.zhimg.com\u002Fv2-ddece7971d1161bbf7c7fa8022859993_b.jpg\" data-original-token=\"v2-fc06bf3c88dec25a069880ca4f7510ad\"\u002F\u003E\u003Cfigcaption\u003EFigure 3. 寄存器堆直接存储至全局内存引入的不连续\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Cp data-pid=\"piW0d2iQ\"\u003E针对这个问题，cute中（实质为cutlass中），专门提供了Epilogue来通过共享内存作为中间媒介。先将寄存器数据存储到共享内存，然后再从共享内存中以更连续、更高位宽的形式存储到全局内存中去。PACT&#39;20 Fireiron文章有对该问题的详细探讨，可以参考之。\u003C\u002Fp\u003E\u003Cfigure data-size=\"normal\"\u003E\u003Cnoscript\u003E\u003Cimg src=\"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-6fdb9b250a3c8a7cca64b251f83275c5_b.jpg\" data-size=\"normal\" data-rawwidth=\"2397\" data-rawheight=\"3030\" class=\"origin_image zh-lightbox-thumb\" width=\"2397\" data-original=\"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-6fdb9b250a3c8a7cca64b251f83275c5_r.jpg\"\u002F\u003E\u003C\u002Fnoscript\u003E\u003Cimg src=\"data:image\u002Fsvg+xml;utf8,&lt;svg xmlns=&#39;http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg&#39; width=&#39;2397&#39; height=&#39;3030&#39;&gt;&lt;\u002Fsvg&gt;\" data-size=\"normal\" data-rawwidth=\"2397\" data-rawheight=\"3030\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"2397\" data-original=\"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-6fdb9b250a3c8a7cca64b251f83275c5_r.jpg\" data-actualsrc=\"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-6fdb9b250a3c8a7cca64b251f83275c5_b.jpg\" data-original-token=\"v2-6afdc9ebda8a0f64c995531d42a44ef8\"\u002F\u003E\u003Cfigcaption\u003EFigure 4. Epilogue中Accumulator寄存器通过共享内存实现到全局内存的数据搬运\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Cp data-pid=\"n_aiQUnr\"\u003E本文通过共享内存实现高效的TileC的存储，具体代码可以参考github上的实现，整体过程如图4所示。\u003C\u002Fp\u003E\u003Ch2\u003E试验设置和结果\u003C\u002Fh2\u003E\u003Cp data-pid=\"veYG4-51\"\u003E根据上面介绍的优化方法，我们利用cute实现了高效的Multi-Stage GEMM，代码地址为\u003Ca href=\"https:\u002F\u002Flink.zhihu.com\u002F?target=https%3A\u002F\u002Fgithub.com\u002Freed-lau\u002Fcute-gemm\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"\u003E\u003Cspan class=\"invisible\"\u003Ehttps:\u002F\u002F\u003C\u002Fspan\u003E\u003Cspan class=\"visible\"\u003Egithub.com\u002Freed-lau\u002Fcut\u003C\u002Fspan\u003E\u003Cspan class=\"invisible\"\u003Ee-gemm\u003C\u002Fspan\u003E\u003Cspan class=\"ellipsis\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003E。我们针对具体业务中使用的问题规格进行了性能测试。具体地问题规格为：M=81920, N=256, K=256, 其中A矩阵为行优先，B矩阵为列优先，C矩阵为行优先，输入输出和计算数据类型均为half。测试环境方面，显卡为NVIDIA GeForce RTX 3090，操作系统为Ubuntu 20.04.6 LTS，NVidia驱动版本为535.113.01，NVCC编译器版本为V11.7.64。我们对比了cuBLAS和cuBLASLt的调优的kernel，其cuBLAS和cuBLASLt版本号为111001。我们使用cuBLASLt的启发式方法选择尽可能多的kernel进行对比。\u003C\u002Fp\u003E\u003Cp data-pid=\"yeqNaZoI\"\u003E使用Nsight Compute对kernel运行时间进行精准的测量，同时为了避免L2 Cache缓存数据对效率评估对影响，我们主动设置--cache-control=all选项来保证在进行kernel profiling的时候清空历史cache数据，通过设置--clock-control=base选项来锁定GPU运行的频率，避免动态调频对性能测量的影响。\u003C\u002Fp\u003E\u003Cp data-pid=\"kTPeaCk7\"\u003EcuBLASLt经过启发式算法选出5个kernel，针对上面提到的问题规格进行了11次试验， 我们统计了这11次的均值、方差和中位数，结果如下表格：\u003C\u002Fp\u003E\u003Ctable data-draft-node=\"block\" data-draft-type=\"table\" data-size=\"normal\" data-row-style=\"normal\"\u003E\u003Ctbody\u003E\u003Ctr\u003E\u003Cth\u003E所属库\u003C\u002Fth\u003E\u003Cth\u003Ekernel名称\u003C\u002Fth\u003E\u003Cth\u003E均值(us)\u003C\u002Fth\u003E\u003Cth\u003E方差(us)\u003C\u002Fth\u003E\u003Cth\u003E中位数(us)\u003C\u002Fth\u003E\u003C\u002Ftr\u003E\u003Ctr\u003E\u003Cth\u003Eour-impl\u003C\u002Fth\u003E\u003Ctd\u003Egemm_multi_stage\u003C\u002Ftd\u003E\u003Ctd\u003E130.1\u003C\u002Ftd\u003E\u003Ctd\u003E0.4\u003C\u002Ftd\u003E\u003Ctd\u003E130.1\u003C\u002Ftd\u003E\u003C\u002Ftr\u003E\u003Ctr\u003E\u003Cth\u003EcuBLAS\u003C\u002Fth\u003E\u003Ctd\u003Eampere_h1688gemm_128x128_ldg8_stages_32x1_tn\u003C\u002Ftd\u003E\u003Ctd\u003E153.4\u003C\u002Ftd\u003E\u003Ctd\u003E2\u003C\u002Ftd\u003E\u003Ctd\u003E154.1\u003C\u002Ftd\u003E\u003C\u002Ftr\u003E\u003Ctr\u003E\u003Cth\u003EcuBLASLt\u003C\u002Fth\u003E\u003Ctd\u003Eampere_h16816gemm_128x64_ldg8_tn\u003C\u002Ftd\u003E\u003Ctd\u003E154.0\u003C\u002Ftd\u003E\u003Ctd\u003E0.5\u003C\u002Ftd\u003E\u003Ctd\u003E154.1\u003C\u002Ftd\u003E\u003C\u002Ftr\u003E\u003Ctr\u003E\u003Cth\u003EcuBLASLt\u003C\u002Fth\u003E\u003Ctd\u003Eampere_h16816gemm_256x128_ldg8_stages_32x3_tn\u003C\u002Ftd\u003E\u003Ctd\u003E154.2\u003C\u002Ftd\u003E\u003Ctd\u003E0.6\u003C\u002Ftd\u003E\u003Ctd\u003E154.2\u003C\u002Ftd\u003E\u003C\u002Ftr\u003E\u003Ctr\u003E\u003Cth\u003EcuBLASLt\u003C\u002Fth\u003E\u003Ctd\u003Eampere_h1688gemm_128x128_ldg8_stages_32x1_tn\u003C\u002Ftd\u003E\u003Ctd\u003E153.4\u003C\u002Ftd\u003E\u003Ctd\u003E2\u003C\u002Ftd\u003E\u003Ctd\u003E154.1\u003C\u002Ftd\u003E\u003C\u002Ftr\u003E\u003Ctr\u003E\u003Cth\u003EcuBLASLt\u003C\u002Fth\u003E\u003Ctd\u003Eampere_h1688gemm_128x128_ldg8_tn\u003C\u002Ftd\u003E\u003Ctd\u003E136.5\u003C\u002Ftd\u003E\u003Ctd\u003E0.7\u003C\u002Ftd\u003E\u003Ctd\u003E136.5\u003C\u002Ftd\u003E\u003C\u002Ftr\u003E\u003Ctr\u003E\u003Cth\u003EcuBLASLt\u003C\u002Fth\u003E\u003Ctd\u003Ecutlass_80_tensorop_h16816gemm_128x256_32x3_tn_align2\u003C\u002Ftd\u003E\u003Ctd\u003E183.4\u003C\u002Ftd\u003E\u003Ctd\u003E0.7\u003C\u002Ftd\u003E\u003Ctd\u003E183.4\u003C\u002Ftd\u003E\u003C\u002Ftr\u003E\u003C\u002Ftbody\u003E\u003C\u002Ftable\u003E\u003Cp data-pid=\"6C9fIasy\"\u003E表格中的数据可以看出均值和中位数相当，所以测量结果相对稳定。我们看到我们的实现为130.1 us，cuBLAS和cuBLASLt的最好结果为136.5us。针对该问题规格，我们的实现达到了SOTA的结果。\u003C\u002Fp\u003E\u003Ch2\u003E总结和讨论\u003C\u002Fh2\u003E\u003Ch3\u003E启发式算法\u003C\u002Fh3\u003E\u003Cp data-pid=\"_z2ighLh\"\u003E回顾前文或者代码，我们不难发现代码中的很多参数是可以调整的，如矩阵分块的大小kTileM、kTileN、kTileK，流水线级数kStage等。针对不同的问题规格适当的调整这些参数能得到更好的效果。逻辑上，我们可以用理论计算来设计公式实现不同问题规模对这些参数的选择；我们也可以对不同的问题规格进行一些离线的穷举试验，分析这些参数维度空间中的分布数据，分析这些数据得到不同问题规格和这些优化参数的映射关系，归纳出特定的启发式算法，使得我们给定一个问题时能够选择出一个不错的kernel。本文只针对一个特定的case做优化，所以不涉及这部分内容，甚至可以直接参考cuBLAS选中的kernel对这些参数的设置情况。\u003C\u002Fp\u003E\u003Ch3\u003E参数相容性\u003C\u002Fh3\u003E\u003Cp data-pid=\"fVrBtGNr\"\u003E前面的代码介绍，我们发现无论是MMA还是Copy每一个操作都需要设置很多参数，这些参数有的是描述layout，有的是描述线程数，有的描述寄存器重复，有的是描述计算块的大小。这些参数并不是完全自由的，它们之间会存在某种约束，这种约束可以是共享内存大小、可以是寄存器多少、可以是线程块大小、可以是划分方法，这是我们调优时调整参数需要考虑的。\u003C\u002Fp\u003E\u003Ch3\u003E其它方面\u003C\u002Fh3\u003E\u003Cp data-pid=\"c7zXXJw7\"\u003ECUDA优化还有很多方面，如在流水线章节的最后部分我们介绍的提升L2命中率的Thread Block Swizzle方法，本文中的N维度不大，所以并没有使能；设置\u003Ccode\u003E__launch_bounds__\u003C\u002Fcode\u003E给编译器提供更多的优化提示本文也并未探究。本文的实现没有考虑数据地址非对齐和Tile非整除情形，这些在实际使用时都是有限制或者需要考虑的。同时cutlass的核心部分也已借助cute进行了collective和epilogue的抽象，我们也可以使用它来实现我们的矩阵计算，并且它们有更好的通用性。\u003C\u002Fp\u003E\u003Ch3\u003E总结\u003C\u002Fh3\u003E\u003Cp data-pid=\"EOngn4ID\"\u003E本文从计算高效、访存高效、算法高效、尾阶段高效这几个方面介绍了矩阵乘的高效实现方法。并且对核心代码进行了细致的解读。文章针对特定case将本文实现和cuBLAS、cuBLASLt进行了对比，实验结果表明，使用cute实现的GEMM方法可以达到SOTA的效果。\u003C\u002Fp\u003E\u003Cp data-pid=\"_YuHIA93\"\u003E掌握cute的Layout、Tensor、MMA、Copy抽象可以帮助我们快速的构建矩阵计算能力，我们可以借助这种能力更高效的解决其它更复杂的问题（如Flash Attention）。\u003C\u002Fp\u003E\u003Cp data-pid=\"64xoMav8\"\u003E这是该cute系列的最后一篇，希望该系列文章能够帮助大家快速掌握cute。后续我将再选个topic和大家共同探讨高性能计算、高性能系统，希望我们很快又能见面。\u003C\u002Fp\u003E\u003Ch2\u003E参考\u003C\u002Fh2\u003E\u003Cp data-pid=\"pFWUiTFv\"\u003E\u003Ca href=\"https:\u002F\u002Flink.zhihu.com\u002F?target=https%3A\u002F\u002Fdl.acm.org\u002Fdoi\u002F10.1145\u002F3410463.3414632\" class=\" wrap external\" target=\"_blank\" rel=\"nofollow noreferrer\"\u003EPACT&#39;20 Fireiron\u003C\u002Fa\u003E\u003C\u002Fp\u003E\u003Cp data-pid=\"6xqkQrf4\"\u003E\u003Ca href=\"https:\u002F\u002Flink.zhihu.com\u002F?target=https%3A\u002F\u002Fgithub.com\u002FNVIDIA\u002Fcutlass\u002Fblob\u002Fmain\u002Finclude\u002Fcutlass\u002Fepilogue\u002Fcollective\u002Fsm70_epilogue_vectorized.hpp\" class=\" wrap external\" target=\"_blank\" rel=\"nofollow noreferrer\"\u003ENVidia cutlass Epilogue\u003C\u002Fa\u003E\u003C\u002Fp\u003E","contentNeedTruncated":false,"adminClosedComment":false,"topics":[{"url":"https:\u002F\u002Fwww.zhihu.com\u002Fapi\u002Fv4\u002Ftopics\u002F19570902","type":"topic","id":"19570902","name":"GPU 通用计算"},{"url":"https:\u002F\u002Fwww.zhihu.com\u002Fapi\u002Fv4\u002Ftopics\u002F19551275","type":"topic","id":"19551275","name":"人工智能"},{"url":"https:\u002F\u002Fwww.zhihu.com\u002Fapi\u002Fv4\u002Ftopics\u002F19608622","type":"topic","id":"19608622","name":"高性能计算"}],"voteupCount":136,"voting":1,"heavyUpStatus":"allow_heavy_up","column":{"description":"","canManage":false,"intro":"高性能计算中CUDA软硬件体系","isFollowing":false,"urlToken":"c_1696937812497235968","id":"c_1696937812497235968","articlesCount":14,"acceptSubmission":false,"title":"CUDA高性能编程","url":"https:\u002F\u002Fzhuanlan.zhihu.com\u002Fc_1696937812497235968","commentPermission":"all","created":1697361502,"updated":1697361502,"imageUrl":"https:\u002F\u002Fpicx.zhimg.com\u002F4b70deef7_720w.jpg?source=172ae18b","author":{"isFollowed":false,"avatarUrlTemplate":"https:\u002F\u002Fpicx.zhimg.com\u002Fv2-e9c299bcbb6d098601ce529e9a358d82.jpg?source=172ae18b","uid":"1064511094718017536","userType":"people","isFollowing":false,"urlToken":"reed-84-49","id":"2600b0313c76a175aa9e09a235382b79","description":"https:\u002F\u002Freed-lau.github.io","name":"reed","isAdvertiser":false,"headline":"从科学计算到高性能计算系统","gender":1,"url":"\u002Fpeople\u002F2600b0313c76a175aa9e09a235382b79","avatarUrl":"https:\u002F\u002Fpicx.zhimg.com\u002Fv2-e9c299bcbb6d098601ce529e9a358d82_l.jpg?source=172ae18b","isOrg":false,"type":"people","badgeV2":{"title":"","mergedBadges":[],"detailBadges":[],"icon":"","nightIcon":""}},"followers":1,"type":"column"},"commentCount":36,"contributions":[{"id":47504914,"state":"accepted","type":"first_publish","column":{"description":"","canManage":false,"intro":"高性能计算中CUDA软硬件体系","isFollowing":false,"urlToken":"c_1696937812497235968","id":"c_1696937812497235968","articlesCount":14,"acceptSubmission":false,"title":"CUDA高性能编程","url":"https:\u002F\u002Fzhuanlan.zhihu.com\u002Fc_1696937812497235968","commentPermission":"all","created":1697361502,"updated":1697361502,"imageUrl":"https:\u002F\u002Fpicx.zhimg.com\u002F4b70deef7_720w.jpg?source=172ae18b","author":{"isFollowed":false,"avatarUrlTemplate":"https:\u002F\u002Fpicx.zhimg.com\u002Fv2-e9c299bcbb6d098601ce529e9a358d82.jpg?source=172ae18b","uid":"1064511094718017536","userType":"people","isFollowing":false,"urlToken":"reed-84-49","id":"2600b0313c76a175aa9e09a235382b79","description":"https:\u002F\u002Freed-lau.github.io","name":"reed","isAdvertiser":false,"headline":"从科学计算到高性能计算系统","gender":1,"url":"\u002Fpeople\u002F2600b0313c76a175aa9e09a235382b79","avatarUrl":"https:\u002F\u002Fpicx.zhimg.com\u002Fv2-e9c299bcbb6d098601ce529e9a358d82_l.jpg?source=172ae18b","isOrg":false,"type":"people","badgeV2":{"title":"","mergedBadges":[],"detailBadges":[],"icon":"","nightIcon":""}},"followers":1,"type":"column"}}],"isTitleImageFullScreen":false,"upvotedFollowees":[],"commercialInfo":{"isCommercial":false,"plugin":{}},"suggestEdit":{"status":false,"reason":"","tip":"","url":"","title":""},"reason":"","annotationAction":[],"canTip":true,"tipjarorsCount":0,"isLabeled":true,"hasPublishingDraft":false,"isFavorited":true,"favlistsCount":246,"isNormal":true,"status":0,"activityToppingInfo":{"state":"untopped"},"shareText":"cute 之 高效GEMM实现 - 来自知乎专栏「CUDA高性能编程」，作者: reed https:\u002F\u002Fzhuanlan.zhihu.com\u002Fp\u002F675308830 （想看更多？下载 @知乎 App：http:\u002F\u002Fweibo.com\u002Fp\u002F100404711598 ）","canComment":{"status":true,"reason":""},"mcnFpShow":-1,"isVisible":true,"isLiked":true,"likedCount":26,"hasColumn":true,"republishers":[],"isNewLinkCard":true,"emojiReaction":{"likeCount":26,"likeHasSet":true},"abParam":{"pnNbtoolbar":"0","qaFotoolbar":"1","qaHiddenVoteup":"1","qaNewdownvote":"1","rsInterest1":"","zpZhiStyle":""},"attachedInfo":"kgIkCgkyMzgxOTg2MDISCTY3NTMwODgzMBgHIgpJTUFHRV9URVhU","shareGuide":{"hasPositiveBubble":false,"hasTimeBubble":false,"hitShareGuideCluster":false},"settings":{"tableOfContents":{"enabled":true}},"canReference":false,"reactionInstruction":{},"reaction":{"statistics":{"upVoteCount":136,"downVoteCount":0,"likeCount":26,"commentCount":36,"shareCount":0,"playCount":0,"interestPlayCount":0,"favorites":246,"pvCount":0,"bulletCount":0,"applaudCount":0,"questionFollowerCount":0,"questionAnswerCount":0,"plaincontentVoteUpCount":0,"plaincontentLikeCount":0,"imgLikeCount":{"v2145b8f31c7cf00c4608350d53b9646eb":0,"v26afdc9ebda8a0f64c995531d42a44ef8":0,"v2D10f297a1220cca836229a7146daaf67":0,"v2Fc06bf3c88dec25a069880ca4f7510ad":0,"v2Ff7bf4c0a1d3e4119e4f77c2c4fd57a8":1}},"relation":{"isAuthor":false,"vote":"UP","liked":true,"imgLiked":{"v2145b8f31c7cf00c4608350d53b9646eb":false,"v26afdc9ebda8a0f64c995531d42a44ef8":false,"v2D10f297a1220cca836229a7146daaf67":false,"v2Fc06bf3c88dec25a069880ca4f7510ad":false,"v2Ff7bf4c0a1d3e4119e4f77c2c4fd57a8":false},"faved":true},"imageReactions":{"v2145b8f31c7cf00c4608350d53b9646eb":{"likeCount":0,"isLiked":false},"v26afdc9ebda8a0f64c995531d42a44ef8":{"likeCount":0,"isLiked":false},"v2D10f297a1220cca836229a7146daaf67":{"likeCount":0,"isLiked":false},"v2Fc06bf3c88dec25a069880ca4f7510ad":{"likeCount":0,"isLiked":false},"v2Ff7bf4c0a1d3e4119e4f77c2c4fd57a8":{"likeCount":1,"isLiked":false}}},"interactionBarPlugins":[{"type":"comment","comment":{"enable":true,"placeholder":"发条带图评论"}}],"barPluginsFlipTime":3000,"trackUrl":["https:\u002F\u002Fsugar.zhihu.com\u002Fplutus_adreaper\u002Fcontent_monitor_log?si=__SESSIONID__&ti=__ATOKEN__&at=view&pf=__OS__&ed=BiBUKF0xBSkqGGRVA2F6CF5wRvRrVR3EE00=&idfa=__IDFA__&imei=__IMEI__&androidid=__ANDROIDID__&oaid=__OAID__&ci=__CREATIVEID__&zid=__ZONEID__"]}},"columns":{"c_1696937812497235968":{"description":"","canManage":false,"intro":"高性能计算中CUDA软硬件体系","isFollowing":false,"urlToken":"c_1696937812497235968","id":"c_1696937812497235968","articlesCount":14,"acceptSubmission":false,"title":"CUDA高性能编程","url":"https:\u002F\u002Fzhuanlan.zhihu.com\u002Fc_1696937812497235968","commentPermission":"all","created":1697361502,"updated":1697361502,"imageUrl":"https:\u002F\u002Fpicx.zhimg.com\u002F4b70deef7_720w.jpg?source=172ae18b","author":{"isFollowed":false,"avatarUrlTemplate":"https:\u002F\u002Fpicx.zhimg.com\u002Fv2-e9c299bcbb6d098601ce529e9a358d82.jpg?source=172ae18b","uid":"1064511094718017536","userType":"people","isFollowing":false,"urlToken":"reed-84-49","id":"2600b0313c76a175aa9e09a235382b79","description":"https:\u002F\u002Freed-lau.github.io","name":"reed","isAdvertiser":false,"headline":"从科学计算到高性能计算系统","gender":1,"url":"\u002Fpeople\u002F2600b0313c76a175aa9e09a235382b79","avatarUrl":"https:\u002F\u002Fpicx.zhimg.com\u002Fv2-e9c299bcbb6d098601ce529e9a358d82_l.jpg?source=172ae18b","isOrg":false,"type":"people","badgeV2":{"title":"","mergedBadges":[],"detailBadges":[],"icon":"","nightIcon":""}},"followers":1,"type":"column"}},"topics":{},"roundtables":{},"favlists":{},"comments":{},"notifications":{},"ebooks":{},"activities":{},"feeds":{},"pins":{},"promotions":{},"drafts":{},"chats":{},"posts":{},"zvideos":{},"zvideoContributions":{},"eduCourses":{}},"currentUser":"d4901200cbf4b641d3bc073c37356443","account":{"unlockTicketStatus":false,"unlockTicket":null,"challenge":[],"errorStatus":false,"message":"","isFetching":false,"accountInfo":{},"urlToken":{"loading":false},"cardUserInfo":{"vipInfo":{}},"handleWidget":{},"widgetList":[],"userWidgetId":""},"settings":{"socialBind":null,"inboxMsg":null,"notification":{},"email":{},"privacyFlag":null,"blockedUsers":{"isFetching":false,"paging":{"pageNo":1,"pageSize":6},"data":[]},"blockedFollowees":{"isFetching":false,"paging":{"pageNo":1,"pageSize":6},"data":[]},"ignoredTopics":{"isFetching":false,"paging":{"pageNo":1,"pageSize":6},"data":[]},"restrictedTopics":null,"laboratory":{}},"notification":{},"people":{"profileStatus":{},"activitiesByUser":{},"answersByUser":{},"answersSortByVotesByUser":{},"answersIncludedByUser":{},"votedAnswersByUser":{},"thankedAnswersByUser":{},"voteAnswersByUser":{},"thankAnswersByUser":{},"topicAnswersByUser":{},"zvideosByUser":{},"articlesByUser":{},"articlesSortByVotesByUser":{},"articlesIncludedByUser":{},"pinsByUser":{},"questionsByUser":{},"commercialQuestionsByUser":{},"favlistsByUser":{},"followingByUser":{},"followersByUser":{},"mutualsByUser":{},"followingColumnsByUser":{},"followingQuestionsByUser":{},"followingFavlistsByUser":{},"followingTopicsByUser":{},"publicationsByUser":{},"columnsByUser":{},"allFavlistsByUser":{},"brands":null,"creationsByUser":{},"creationsSortByVotesByUser":{},"creationsFeed":{},"infinity":{},"batchUsers":{},"profileInfinity":null},"env":{"abV2":{"config":{"paramMap":{"ws_must_login":{"value":"0","abId":"must_login-0"},"ws_group":{"value":"0"},"ws_publish_answer":{"value":"1","abId":"rl-pc_pub_answer_2-1"},"ws_publish_post":{"value":"1","abId":"rl-publish_article-1"},"ws_is_show":{"value":"0"},"pc_mou_cre_remove":{"value":"1","abId":"rl-mou_create_remove-1"},"ws_qiangzhisafe":{"value":"1","abId":"rl-qiangzhisafe_copy-1"},"ws_publish_ask":{"value":"1","abId":"rl-pc_publish_ask-1"},"ws_video_publish":{"value":"1","abId":"rl-video_contentpub-1"},"ws_platform_new":{"value":"1","abId":"author_platform-1"}},"abMap":{"must_login-0":{"abId":"must_login-0","layerId":"web_standard_domain_layer2"},"rl-pc_pub_answer_2-1":{"abId":"rl-pc_pub_answer_2-1","layerId":"rl-pc_pub_answer_2","diversionType":2},"rl-publish_article-1":{"abId":"rl-publish_article-1","layerId":"rl-publish_article","diversionType":2},"rl-mou_create_remove-1":{"abId":"rl-mou_create_remove-1","layerId":"rl-mou_create_remove","diversionType":2},"rl-qiangzhisafe_copy-1":{"abId":"rl-qiangzhisafe_copy-1","layerId":"rl-qiangzhisafe_copy"},"rl-pc_publish_ask-1":{"abId":"rl-pc_publish_ask-1","layerId":"rl-pc_publish_ask","diversionType":2},"rl-video_contentpub-1":{"abId":"rl-video_contentpub-1","layerId":"rl-video_contentpub","diversionType":2},"author_platform-1":{"abId":"author_platform-1","layerId":"author_platform_layer","diversionType":2}}},"triggers":{}},"userAgent":{"Edge":false,"IE":false,"Wechat":false,"Weibo":false,"QQ":false,"MQQBrowser":false,"Qzone":false,"Mobile":false,"Android":false,"HarmonyOS":false,"iOS":false,"isAppleDevice":true,"Zhihu":false,"ZhihuHybrid":false,"isBot":false,"Tablet":false,"UC":false,"Quark":false,"Sogou":false,"Qihoo":false,"Baidu":false,"BaiduApp":false,"Safari":false,"GoogleBot":false,"AndroidDaily":false,"iOSDaily":false,"WxMiniProgram":false,"BaiduMiniProgram":false,"QQMiniProgram":false,"JDMiniProgram":false,"isWebView":false,"isMiniProgram":false,"origin":"Mozilla\u002F5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit\u002F537.36 (KHTML, like Gecko) Chrome\u002F126.0.0.0 Safari\u002F537.36"},"appViewConfig":{},"ctx":{"path":"\u002Fp\u002F675308830","query":{},"href":"http:\u002F\u002Fzhuanlan.zhihu.com\u002Fp\u002F675308830","host":"zhuanlan.zhihu.com"},"trafficSource":"production","edition":{"beijing":false,"baidu":false,"sogou":false,"baiduBeijing":false,"sogouBeijing":false,"sogouInput":false,"oppoSearch":false,"baiduSearch":false,"googleSearch":false,"shenma":false,"miniProgram":false,"xiaomi":false,"huaweiSearch":false},"theme":"light","appHeaderTheme":{"current":"normal","disable":true,"normal":{"bgColor":"GBK99A"},"custom":{"bgColor":"GBK99A"}},"enableShortcut":true,"referer":"","xUDId":"AGAQrYF5yRiPTg-1l2ERiyXvjJVrbIJnf3U=","mode":"ssr","conf":{},"xTrafficFreeOrigin":"","ipInfo":{"cityName":"广州","countryName":"中国","regionName":"广东","countryCode":"CN"},"logged":true,"vars":{"passThroughHeaders":{}}},"me":{"columnContributions":[]},"label":{},"ecommerce":{},"comments":{"pagination":{},"collapsed":{},"reverse":{},"reviewing":{},"conversation":{},"parent":{}},"commentsV2":{"stickers":[],"commentWithPicPermission":{},"notificationsComments":{},"pagination":{},"collapsed":{},"reverse":{},"reviewing":{},"conversation":{},"conversationMore":{},"parent":{}},"pushNotifications":{"default":{"isFetching":false,"isDrained":false,"ids":[]},"follow":{"isFetching":false,"isDrained":false,"ids":[]},"vote_thank":{"isFetching":false,"isDrained":false,"ids":[]},"currentTab":"default","notificationsCount":{"default":0,"follow":0,"vote_thank":0}},"messages":{"data":{},"currentTab":"common","messageCount":0},"register":{"registerValidateSucceeded":null,"registerValidateErrors":{},"registerConfirmError":null,"sendDigitsError":null,"registerConfirmSucceeded":null},"login":{"loginUnregisteredError":false,"loginBindWechatError":false,"loginConfirmError":null,"sendDigitsError":null,"needSMSIdentify":false,"validateDigitsError":false,"loginConfirmSucceeded":null,"qrcodeLoginToken":"","qrcodeLoginScanStatus":0,"qrcodeLoginError":null,"qrcodeLoginReturnNewToken":false},"switches":{},"captcha":{"captchaNeeded":false,"captchaValidated":false},"sms":{"supportedCountries":[]},"chat":{"chats":{},"inbox":{"recents":{"isFetching":false,"isDrained":false,"isPrevDrained":false,"result":[],"next":null,"key":null},"strangers":{"isFetching":false,"isDrained":false,"isPrevDrained":false,"result":[],"next":null,"key":null},"friends":{"isFetching":false,"isDrained":false,"isPrevDrained":false,"result":[],"next":null,"key":null},"search":{"isFetching":false,"isDrained":false,"isPrevDrained":false,"result":[],"next":null,"key":null},"config":{"newCount":0,"strangerMessageSwitch":false,"strangerMessageUnread":false,"friendCount":0}},"global":{"isChatMqttExisted":false}},"emoticons":{"emoticonGroupList":[],"emoticonGroupDetail":{}},"creator":{"tools":{"question":{"invitationCount":{"questionFolloweeCount":0,"questionTotalCount":0}},"recommend":{"recommendTimes":{}}},"explore":{},"levelUpperLimit":10,"mcn":{},"mcnManage":{},"tasks":{},"announcement":{},"creatorsRecommendInfo":{}},"creators":{"common":{"applyStatus":{},"rightsStatus":{}},"bayesDomains":{"status":{},"options":{"topDomains":null,"allDomains":null,"editable":0},"contents":null},"school":{"tabs":[],"contents":[],"banner":null,"entities":{}},"faq":{"tabs":[],"article":{}},"knowledgeIncome":{},"safeguardRights":{},"analytics":{"all":{},"answer":{},"zvideo":{},"article":{},"pin":{},"singleContent":{}},"account":{"growthLevel":{}},"KMResource":{},"training":{},"ToolsQuestion":{"goodatTopics":[]},"ToolsHotspot":{"domains":[]},"ToolsRecommend":{},"ToolsCustomPromotion":{"itemLists":{},"baseInfo":{}},"ToolsSearchQuestion":{},"editorSetting":{},"MCNManage":{},"knowledgeTasks":{},"incomeAnalysis":{"income":{"aggregation":{}}},"creationManage":{"editModal":{"status":false}},"activity":{},"announcement":{},"home":{"currentCreatorUrlToken":null,"rights":[],"newRights":[],"scoreInfo":{},"menusShowControlByServer":{"bVipRecomend":false,"creationRelationship":false},"newTasks":{"creatorTask":{"tasks":[],"des":[]}},"bannerList":[],"recentlyCreated":[],"homecard":{},"homeData":{}},"videoSupport":{"textBenefit":{}},"videoDistribution":{},"profilePoster":{"creatorPosterConfig":{},"creatorPosterData":{}}},"answers":{"voters":{},"upvoters":{},"copyrightApplicants":{},"favlists":{},"newAnswer":{},"entityWords":{},"paidContent":{},"settings":{},"relationEndorsement":{},"interests":{}},"recommendation":{"homeRecommendations":[]},"shareTexts":{},"articles":{"voters":{},"upvoters":{},"relationEndorsement":{}},"previewPost":{},"favlists":{"relations":{}},"columns":{"voters":{}},"reward":{"answer":{},"article":{},"question":{}},"video":{"data":{},"shareVideoDetail":{},"last":{}},"topstory":{"recommend":{"isFetching":false,"isDrained":false,"afterId":0,"items":[],"next":null},"follow":{"isFetching":false,"isDrained":false,"afterId":0,"items":[],"next":null},"followWonderful":{"isFetching":false,"isDrained":false,"afterId":0,"items":[],"next":null},"sidebar":null,"announcement":{},"hotList":[],"hotListHeadZone":[],"guestFeeds":{"isFetching":false,"isDrained":false,"afterId":0,"items":[],"next":null},"followExtra":{"isNewUser":null,"isFetched":false,"followCount":0,"followers":[]},"hotDaily":{"data":[],"paging":{}},"hotHighlight":{"isFetching":false,"isDrained":false,"data":[],"paging":{}},"banner":{},"commercialBanner":{"show":false,"banner":{},"trackData":{}},"video":{"items":[],"next":null,"isLoading":false,"isDrained":false}},"readStatus":{},"column":{},"requestColumn":{"categories":[],"error":null},"articleContribution":{"contributeRequests":[],"deleteContributeIdList":[],"handledContributeIdList":[],"recommendedColumns":[],"pinnedColumns":[],"sentContributeRequestsIdList":[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"c_1696937812497235968",null]},"columnContribution":{"contributeRequests":[],"autoInviteEnabled":false,"recommendedContributors":[]},"draftHistory":{"history":{},"drafts":{}},"upload":{},"articleDraft":{"titleImage":"","titleImageSize":{},"isTitleImageFullScreen":false,"canTitleImageFullScreen":false,"title":"","titleImageUploading":false,"error":"","content":"","draftLoading":false,"updating":false,"globalLoading":false,"pendingVideo":{"resource":null,"error":null},"deleteFail":{"fail":false},"recommendTopics":[],"selectedColumn":0,"articleDisclaimers":[]},"articleDrafts":{"isDrained":false,"isLoading":false,"items":[]},"columnAutocomplete":{"users":[],"friends":[]},"columnCollection":{},"userProfit":{"permission":{"permissionStatus":{"zhiZixuan":0,"recommend":-1,"task":0,"plugin":0,"infinity":0},"visible":false},"linkCardLimit":0},"mcn":{"bindInfo":{},"memberCategoryList":[],"producerList":[],"categoryList":[],"lists":{},"banners":{},"protocolStatus":{"isAgreedNew":true,"isAgreedOld":true},"probationCountdownDays":0},"zvideos":{"campaignVideoList":{},"campaigns":{},"tagoreCategory":[],"recommendations":{},"insertable":{},"recruit":{"form":{"platform":"","nickname":"","followerCount":"","domain":"","contact":""},"submited":false,"ranking":[]},"qyActivityData":{},"talkActivityData":{},"party2022ActivityData":{},"batchVideos":{},"contribution":{"selectedContribution":null,"campaign":null,"configs":{},"contributionLists":{},"recommendQuestions":{"isLoading":true,"paging":{"isEnd":false,"isStart":true,"totals":0},"data":[]},"questionSearchResults":{"isLoading":true,"paging":{"isEnd":false,"isStart":true,"totals":0},"data":[]}},"creationReferences":{},"zvideoCollection":{},"zvideoGrant":{},"collectData":{"isFetching":false,"list":[]},"videoSource":{"isLoaded":false}},"republish":{},"commentPermission":{},"creatorRightStatus":{"list":[]},"adPromotion":{"answer":{},"article":{}}},"fetchHost":"www.zhihu.com","subAppName":"column","spanName":"Post","canaryConfig":{"test_canary":"0","use_new_player":"0","player_vendor":"0","use_hevc":"1","upload_use_signature":"1","use_backdrop_blur":"1","article_title_imagex":"1","play_station":"1","use_cached_supported_countries":"1"}}</script><script crossorigin="" src="./cute 之 高效GEMM实现 - 知乎_files/vendor.b2043823c211547b094b.js"></script><script crossorigin="" src="./cute 之 高效GEMM实现 - 知乎_files/react.production.min.js"></script><script crossorigin="" src="./cute 之 高效GEMM实现 - 知乎_files/react-dom.production.min.js"></script><script crossorigin="" src="./cute 之 高效GEMM实现 - 知乎_files/react-dom-server.browser.production.min.js"></script><script crossorigin="" src="./cute 之 高效GEMM实现 - 知乎_files/runtime.app.5bd37fc1293b7bf52664.js"></script><script crossorigin="" src="./cute 之 高效GEMM实现 - 知乎_files/lib-75fc9c18.app.3db651c252e14ef6658e.js"></script><script crossorigin="" src="./cute 之 高效GEMM实现 - 知乎_files/lib-29107295.app.42d07f814b7b05187671.js"></script><script crossorigin="" src="./cute 之 高效GEMM实现 - 知乎_files/lib-79b5cf47.app.8b6b6bf4b6d894db9b07.js"></script><script crossorigin="" src="./cute 之 高效GEMM实现 - 知乎_files/lib-330004dc.app.7437cf54ac28fca0e302.js"></script><script crossorigin="" src="./cute 之 高效GEMM实现 - 知乎_files/lib-f3572862.app.d7ec7e2db90ddb91c8f1.js"></script><script crossorigin="" src="./cute 之 高效GEMM实现 - 知乎_files/lib-0e5ce61e.app.b22b78c2be57c983262f.js"></script><script crossorigin="" src="./cute 之 高效GEMM实现 - 知乎_files/lib-83b0f42f.app.e34e650850a4762e3d73.js"></script><script crossorigin="" src="./cute 之 高效GEMM实现 - 知乎_files/lib-38cf5c11.app.0ef475c02226ac0ff291.js"></script><script crossorigin="" src="./cute 之 高效GEMM实现 - 知乎_files/lib-2ec050f6.app.3130baf54e01ef0a8956.js"></script><script crossorigin="" src="./cute 之 高效GEMM实现 - 知乎_files/lib-9b20c40c.app.e400308f4969b7849daf.js"></script><script crossorigin="" src="./cute 之 高效GEMM实现 - 知乎_files/1907.app.d9386c63ba90d5e0d998.js"></script><script crossorigin="" src="./cute 之 高效GEMM实现 - 知乎_files/column.app.b14fe13639a65f8c96c4.js"></script><script defer="" src="./cute 之 高效GEMM实现 - 知乎_files/aria.js" id="ariascripts" wapforceoldfixed="false" loaddata="false"></script><script src="./cute 之 高效GEMM实现 - 知乎_files/hm.js" async=""></script><script crossorigin="" src="./cute 之 高效GEMM实现 - 知乎_files/zap.js"></script><div><div style="display: none;"><i>想来知乎工作？请发送邮件到 jobs@zhihu.com</i></div></div><script src="./cute 之 高效GEMM实现 - 知乎_files/push.js"></script><div><div><div class="css-8pdeid"></div></div></div><script crossorigin="" src="./cute 之 高效GEMM实现 - 知乎_files/js"></script><script crossorigin="" src="./cute 之 高效GEMM实现 - 知乎_files/emoticon.js"></script><div><div><div class="Editable-languageSuggestions" style="left: -1179px; top: -999px;"><div><div class="Popover"><label class="Editable-languageSuggestionsInput Input-wrapper"><input autocomplete="off" role="combobox" aria-expanded="false" aria-autocomplete="list" aria-activedescendant="AutoComplete7-0" id="Popover6-toggle" aria-haspopup="true" class="Input" placeholder="选择语言" value=""><svg width="24" height="24" viewBox="0 0 24 24" fill="#afbdcf" class="Zi Zi--Select" data-darkreader-inline-fill="" style="--darkreader-inline-fill: #a7baca;"><path fill-rule="evenodd" d="M12.53 3.47a.75.75 0 0 0-1.06 0l-5 5a.75.75 0 0 0 1.06 1.06L12 5.06l4.47 4.47a.75.75 0 1 0 1.06-1.06l-5-5Zm-5 11a.75.75 0 0 0-1.06 1.06l5 5a.75.75 0 0 0 1.06 0l5-5a.75.75 0 1 0-1.06-1.06L12 18.94l-4.47-4.47Z" clip-rule="evenodd"></path></svg></label></div></div></div></div></div><div><div><div class="Editable-languageSuggestions" style="left: -1179px; top: -999px;"><div><div class="Popover"><label class="Editable-languageSuggestionsInput Input-wrapper"><input autocomplete="off" role="combobox" aria-expanded="false" aria-autocomplete="list" aria-activedescendant="AutoComplete9-0" id="Popover8-toggle" aria-haspopup="true" class="Input" placeholder="选择语言" value=""><svg width="24" height="24" viewBox="0 0 24 24" fill="#afbdcf" class="Zi Zi--Select" data-darkreader-inline-fill="" style="--darkreader-inline-fill: #a7baca;"><path fill-rule="evenodd" d="M12.53 3.47a.75.75 0 0 0-1.06 0l-5 5a.75.75 0 0 0 1.06 1.06L12 5.06l4.47 4.47a.75.75 0 1 0 1.06-1.06l-5-5Zm-5 11a.75.75 0 0 0-1.06 1.06l5 5a.75.75 0 0 0 1.06 0l5-5a.75.75 0 1 0-1.06-1.06L12 18.94l-4.47-4.47Z" clip-rule="evenodd"></path></svg></label></div></div></div></div></div></body></html>