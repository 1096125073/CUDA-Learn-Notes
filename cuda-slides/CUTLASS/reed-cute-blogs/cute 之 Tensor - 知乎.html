<!DOCTYPE html>
<!-- saved from url=(0038)https://zhuanlan.zhihu.com/p/663093816 -->
<html lang="zh" data-hairline="true" class="itcauecng" data-theme="light" data-darkreader-mode="dynamic" data-darkreader-scheme="dark" data-darkreader-proxy-injected="true" data-rh="data-theme"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><style class="darkreader darkreader--fallback" media="screen"></style><style class="darkreader darkreader--text" media="screen"></style><style class="darkreader darkreader--invert" media="screen">.jfk-bubble.gtx-bubble, .captcheck_answer_label > input + img, span#closed_text > img[src^="https://www.gstatic.com/images/branding/googlelogo"], span[data-href^="https://www.hcaptcha.com/"] > #icon, ::-webkit-calendar-picker-indicator, img.Wirisformula {
    filter: invert(100%) hue-rotate(180deg) contrast(90%) !important;
}</style><style class="darkreader darkreader--inline" media="screen">[data-darkreader-inline-bgcolor] {
  background-color: var(--darkreader-inline-bgcolor) !important;
}
[data-darkreader-inline-bgimage] {
  background-image: var(--darkreader-inline-bgimage) !important;
}
[data-darkreader-inline-border] {
  border-color: var(--darkreader-inline-border) !important;
}
[data-darkreader-inline-border-bottom] {
  border-bottom-color: var(--darkreader-inline-border-bottom) !important;
}
[data-darkreader-inline-border-left] {
  border-left-color: var(--darkreader-inline-border-left) !important;
}
[data-darkreader-inline-border-right] {
  border-right-color: var(--darkreader-inline-border-right) !important;
}
[data-darkreader-inline-border-top] {
  border-top-color: var(--darkreader-inline-border-top) !important;
}
[data-darkreader-inline-boxshadow] {
  box-shadow: var(--darkreader-inline-boxshadow) !important;
}
[data-darkreader-inline-color] {
  color: var(--darkreader-inline-color) !important;
}
[data-darkreader-inline-fill] {
  fill: var(--darkreader-inline-fill) !important;
}
[data-darkreader-inline-stroke] {
  stroke: var(--darkreader-inline-stroke) !important;
}
[data-darkreader-inline-outline] {
  outline-color: var(--darkreader-inline-outline) !important;
}
[data-darkreader-inline-stopcolor] {
  stop-color: var(--darkreader-inline-stopcolor) !important;
}
[data-darkreader-inline-bg] {
  background: var(--darkreader-inline-bg) !important;
}
[data-darkreader-inline-invert] {
    filter: invert(100%) hue-rotate(180deg);
}</style><style class="darkreader darkreader--variables" media="screen">:root {
   --darkreader-neutral-background: #131516;
   --darkreader-neutral-text: #d8d4cf;
   --darkreader-selection-background: #004daa;
   --darkreader-selection-text: #e8e6e3;
}</style><style class="darkreader darkreader--root-vars" media="screen"></style><style class="darkreader darkreader--user-agent" media="screen">@layer {
html {
    background-color: #181a1b !important;
}
html {
    color-scheme: dark !important;
}
iframe {
    color-scheme: initial;
}
html, body {
    background-color: #181a1b;
}
html, body {
    border-color: #736b5e;
    color: #e8e6e3;
}
a {
    color: #3391ff;
}
table {
    border-color: #545b5e;
}
mark {
    color: #e8e6e3;
}
::placeholder {
    color: #b2aba1;
}
input:-webkit-autofill,
textarea:-webkit-autofill,
select:-webkit-autofill {
    background-color: #404400 !important;
    color: #e8e6e3 !important;
}
::selection {
    background-color: #004daa !important;
    color: #e8e6e3 !important;
}
::-moz-selection {
    background-color: #004daa !important;
    color: #e8e6e3 !important;
}
}</style><title>cute 之 Tensor - 知乎</title><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="renderer" content="webkit"><meta name="force-rendering" content="webkit"><meta http-equiv="X-UA-Compatible" content="IE=10,chrome=1"><meta name="google-site-verification" content="FTeR0c8arOPKh8c5DYh_9uu98_zJbaWw53J-Sch9MTg"><meta data-rh="true" name="keywords" content="CUDA,GPU 通用计算,图形处理器（GPU）"><meta data-rh="true" name="description" content="前面的章节介绍了 cute Layout以及Layout的代数和几何解释，Layout描述了数据的排列和底层存储位置关系，但Layout并没有指定存储。Tensor就是在Layout的基础上包含了存储，即Tensor = Layout + storage，数据存储…"><meta data-rh="true" property="og:title" content="cute 之 Tensor"><meta data-rh="true" property="og:url" content="https://zhuanlan.zhihu.com/p/663093816"><meta data-rh="true" property="og:description" content="前面的章节介绍了 cute Layout以及Layout的代数和几何解释，Layout描述了数据的排列和底层存储位置关系，但Layout并没有指定存储。Tensor就是在Layout的基础上包含了存储，即Tensor = Layout + storage，数据存储…"><meta data-rh="true" property="og:image" content="https://picx.zhimg.com/v2-8db31200d4ae0956591ceb309d19962a_720w.jpg?source=172ae18b"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="og:site_name" content="知乎专栏"><link data-rh="true" rel="apple-touch-icon" href="https://static.zhihu.com/heifetz/assets/apple-touch-icon-152.81060cab.png"><link data-rh="true" rel="apple-touch-icon" href="https://static.zhihu.com/heifetz/assets/apple-touch-icon-152.81060cab.png" sizes="152x152"><link data-rh="true" rel="apple-touch-icon" href="https://static.zhihu.com/heifetz/assets/apple-touch-icon-120.d5793cac.png" sizes="120x120"><link data-rh="true" rel="apple-touch-icon" href="https://static.zhihu.com/heifetz/assets/apple-touch-icon-76.7abf3393.png" sizes="76x76"><link data-rh="true" rel="apple-touch-icon" href="https://static.zhihu.com/heifetz/assets/apple-touch-icon-60.362a8eac.png" sizes="60x60"><link crossorigin="" rel="shortcut icon" type="image/x-icon" href="https://static.zhihu.com/heifetz/favicon.ico"><link crossorigin="" rel="search" type="application/opensearchdescription+xml" href="https://static.zhihu.com/heifetz/search.xml" title="知乎"><link rel="dns-prefetch" href="https://static.zhimg.com/"><link rel="dns-prefetch" href="https://pica.zhimg.com/"><link rel="dns-prefetch" href="https://picx.zhimg.com/"><link rel="dns-prefetch" href="https://pic1.zhimg.com/"><link rel="dns-prefetch" href="https://pic2.zhimg.com/"><link rel="dns-prefetch" href="https://pic3.zhimg.com/"><link rel="dns-prefetch" href="https://pic4.zhimg.com/"><link rel="dns-prefetch" href="https://static.zhihu.com/"><style data-emotion-css="9mvwt1">:root{--zhc-padding-horizontal:20px;--zhc-padding-vertical:16px;--zhc-notification-top:75px;--app-padding:16px;--app-header-height:52px;--app-max-width:640px;--app-width:1000px;--app-font-size:15px;}</style><style class="darkreader darkreader--sync" media="screen"></style><script nonce="" data-web-reporter-config="{&quot;platform&quot;:&quot;web&quot;,&quot;project&quot;:&quot;heifetz&quot;}">!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e=e||self).webReporter={})}(this,function(e){"use strict";var t={},n=!1,o=function(){var e,o,r,a,i;return n||(e=document.querySelector("script[data-web-reporter-config]"),o=e&&e.dataset.webReporterConfig||"{}",r=JSON.parse(o),a=r.platform,i=r.project,t={platform:a,project:i},n=!0),t};function r(e){return a(function(){return localStorage.getItem(e)})()}function a(e){return function(){try{return e.apply(void 0,arguments)}catch(e){}}}var i=a(function(e,t){var n={platform:"web",project:o().project,clientTimestamp:+new Date};!function(e,t,n){"1"===r("weber:logenabled")&&console.log("[web-reporter]%o",{type:e,base:t,data:n})}(e,n,t),function(e,t){var n=btoa(JSON.stringify(t));if("undefined"!=typeof Blob&&window.navigator&&window.navigator.sendBeacon){var o=new Blob([n],{type:"text/plain"});navigator.sendBeacon(e,o)}else{var r=new XMLHttpRequest;r.open("POST",e),r.withCredentials=!1,r.setRequestHeader("Content-Type","text/plain;charset=UTF-8"),r.send(n)}}(r("weber:api")||"https://apm.zhihu.com/collector/web_json",{type:e,base:n,data:t})});e.report=i,Object.defineProperty(e,"__esModule",{value:!0})});
</script><link href="./cute 之 Tensor - 知乎_files/1907.216a26f4.3a30d0c778e087df9648.css" crossorigin="" rel="stylesheet"><style class="darkreader darkreader--sync" media="screen"></style><link href="./cute 之 Tensor - 知乎_files/column.216a26f4.c878ff8b92c3fa3efa99.css" crossorigin="" rel="stylesheet"><style class="darkreader darkreader--sync" media="screen"></style><link rel="stylesheet" type="text/css" href="./cute 之 Tensor - 知乎_files/user-hover-card.216a26f4.0e3930e2ffc649f7ed8b.css" crossorigin="anonymous"><style class="darkreader darkreader--sync" media="screen"></style><link rel="stylesheet" type="text/css" href="./cute 之 Tensor - 知乎_files/GoodsRecommendGoodsCardList.216a26f4.d95ce79191cdf8d7ac28.css" crossorigin="anonymous"><style class="darkreader darkreader--sync" media="screen"></style><link rel="stylesheet" type="text/css" href="./cute 之 Tensor - 知乎_files/report_modals.216a26f4.370935343bb8c3bca346.css" crossorigin="anonymous"><style class="darkreader darkreader--sync" media="screen"></style><link rel="stylesheet" type="text/css" href="./cute 之 Tensor - 知乎_files/632.216a26f4.b3e609d82ae4a031d7a1.css" crossorigin="anonymous"><style class="darkreader darkreader--sync" media="screen"></style><link rel="stylesheet" type="text/css" href="./cute 之 Tensor - 知乎_files/ECommerceAd.216a26f4.c90979d08ed65b86fc8f.css" crossorigin="anonymous"><style class="darkreader darkreader--sync" media="screen"></style><link rel="stylesheet" type="text/css" href="./cute 之 Tensor - 知乎_files/1468.216a26f4.101bb14a2c1d8d20b744.css" crossorigin="anonymous"><style class="darkreader darkreader--sync" media="screen"></style><link rel="stylesheet" type="text/css" href="./cute 之 Tensor - 知乎_files/EditableV2.216a26f4.6c9301eaad8df7e50cb2.css" crossorigin="anonymous"><style class="darkreader darkreader--sync" media="screen"></style><script nonce="">!function(){"use strict";!function(e,n){var r=[];function t(e){return function(){r.push([e,arguments])}}n.Raven={captureException:t("captureException"),captureMessage:t("captureMessage"),captureBreadcrumb:t("captureBreadcrumb")};var a,o,c,i,s,u="undefined"!=typeof DOMError;function d(e){var n=e instanceof Error||e instanceof ErrorEvent||u&&e instanceof DOMError||e instanceof DOMException;Raven.captureException(n?e:new Error(e.message||e.reason))}n.addEventListener("unhandledrejection",d),n.addEventListener("error",d,!0),a=e.src,o=e,c=function(){r.forEach(function(e){var n;(n=Raven)[e[0]].apply(n,e[1])}),n.removeEventListener("unhandledrejection",d),n.removeEventListener("error",d,!0)},i=document.head||document.getElementsByTagName("head")[0],(s=document.createElement("script")).crossOrigin=o.crossOrigin,s.dataset.sentryConfig=o["data-sentry-config"],s.onload=c,s.src=a,i.appendChild(s)}({"defer":true,"crossOrigin":"anonymous","src":"https://unpkg.zhimg.com/@cfe/sentry-script@1.3.1/dist/init.js","data-sentry-config":"{\"dsn\":\"https://2d8d764432cc4f6fb3bc78ab9528299d@crash2.zhihu.com/1224\",\"sampleRate\":0.1,\"release\":\"1460-273bc90e\",\"ignoreErrorNames\":[\"NetworkError\",\"SecurityError\"],\"ignoreErrorsPreset\":\"ReactApp\",\"tags\":{\"app_name\":\"heifetz\"}}"},window)}();
</script><script crossorigin="anonymous" data-sentry-config="{&quot;dsn&quot;:&quot;https://2d8d764432cc4f6fb3bc78ab9528299d@crash2.zhihu.com/1224&quot;,&quot;sampleRate&quot;:0.1,&quot;release&quot;:&quot;1460-273bc90e&quot;,&quot;ignoreErrorNames&quot;:[&quot;NetworkError&quot;,&quot;SecurityError&quot;],&quot;ignoreErrorsPreset&quot;:&quot;ReactApp&quot;,&quot;tags&quot;:{&quot;app_name&quot;:&quot;heifetz&quot;}}" src="./cute 之 Tensor - 知乎_files/init.js"></script><meta name="darkreader" content="598106feb978497ca63b2402b3155d2e"><style class="darkreader darkreader--override" media="screen">.vimvixen-hint {
    background-color: #7b5300 !important;
    border-color: #d8b013 !important;
    color: #f3e8c8 !important;
}
#vimvixen-console-frame {
    color-scheme: light !important;
}
::placeholder {
    opacity: 0.5 !important;
}
#edge-translate-panel-body,
.MuiTypography-body1,
.nfe-quote-text {
    color: var(--darkreader-neutral-text) !important;
}
gr-main-header {
    background-color: #0f3a48 !important;
}
.tou-z65h9k,
.tou-mignzq,
.tou-1b6i2ox,
.tou-lnqlqk {
    background-color: var(--darkreader-neutral-background) !important;
}
.tou-75mvi {
    background-color: #032029 !important;
}
.tou-ta9e87,
.tou-1w3fhi0,
.tou-1b8t2us,
.tou-py7lfi,
.tou-1lpmd9d,
.tou-1frrtv8,
.tou-17ezmgn {
    background-color: #0a0a0a !important;
}
.tou-uknfeu {
    background-color: #231603 !important;
}
.tou-6i3zyv {
    background-color: #19576c !important;
}
div.mermaid-viewer-control-panel .btn {
    background-color: var(--darkreader-neutral-background);
    fill: var(--darkreader-neutral-text);
}
svg g rect.er {
    fill: var(--darkreader-neutral-background) !important;
}
svg g rect.er.entityBox {
    fill: var(--darkreader-neutral-background) !important;
}
svg g rect.er.attributeBoxOdd {
    fill: var(--darkreader-neutral-background) !important;
}
svg g rect.er.attributeBoxEven {
    fill: var(--darkreader-selection-background);
    fill-opacity: 0.8 !important;
}
svg rect.er.relationshipLabelBox {
    fill: var(--darkreader-neutral-background) !important;
}
svg g g.nodes rect,
svg g g.nodes polygon {
    fill: var(--darkreader-neutral-background) !important;
}
svg g rect.task {
    fill: var(--darkreader-selection-background) !important;
}
svg line.messageLine0,
svg line.messageLine1 {
    stroke: var(--darkreader-neutral-text) !important;
}
div.mermaid .actor {
    fill: var(--darkreader-neutral-background) !important;
}
mitid-authenticators-code-app > .code-app-container {
    background-color: white !important;
    padding-top: 1rem;
}
iframe#unpaywall[src$="unpaywall.html"] {
    color-scheme: light !important;
}
embed[type="application/pdf"][src="about:blank"] { filter: invert(100%) contrast(90%); }</style><style data-emotion-css="55n9hh">.css-55n9hh{position:fixed;top:0;right:0;left:0;z-index:101;display:none;height:2px;pointer-events:none;background:#1772F6;-webkit-transform:translateX(-100%);-ms-transform:translateX(-100%);transform:translateX(-100%);}</style><style class="darkreader darkreader--sync" media="screen"></style><style data-emotion-css="1l12z7y">.css-1l12z7y{box-shadow:0px 16px 32px rgba(0,0,0,0.04);}</style><style class="darkreader darkreader--sync" media="screen"></style><style data-emotion-css="1hlrcxk">.css-1hlrcxk{-webkit-transition-property:fill;transition-property:fill;-webkit-transition-duration:0.25s;transition-duration:0.25s;-webkit-transition-timing-function:ease-in;transition-timing-function:ease-in;}</style><style class="darkreader darkreader--sync" media="screen"></style><style data-emotion-css="icip60">.css-icip60{border-radius:2px;}</style><style class="darkreader darkreader--sync" media="screen"></style><style data-emotion-css="fnnb9l">.css-fnnb9l{box-sizing:border-box;margin:0;min-width:0;max-width:100%;height:auto;background-color:#ffffff;width:30px;height:30px;border-radius:2px;}</style><style class="darkreader darkreader--sync" media="screen"></style><style data-emotion-css="78p1r9">.css-78p1r9{box-sizing:border-box;margin:0;min-width:0;margin-left:auto;margin-right:auto;max-width:690px;margin-top:0;}@media screen and (min-width:40em){.css-78p1r9{margin-top:1em;}}</style><style class="darkreader darkreader--sync" media="screen"></style><style data-emotion-css="1binura">.css-1binura{position:relative;padding-bottom:104.5%;height:0;border-radius:inherit;}</style><style class="darkreader darkreader--sync" media="screen"></style><style data-emotion-css="grd3se">.css-grd3se{box-sizing:border-box;margin:0;min-width:0;position:relative;padding-bottom:104.5%;height:0;border-radius:inherit;}</style><style class="darkreader darkreader--sync" media="screen"></style><style data-emotion-css="1ld0bim">.css-1ld0bim{position:absolute;top:0;left:0;width:100%;height:100%;border-radius:inherit;}</style><style class="darkreader darkreader--sync" media="screen"></style><style data-emotion-css="uodor8">.css-uodor8{border-radius:50%;}</style><style class="darkreader darkreader--sync" media="screen"></style><style data-emotion-css="1syywx2">.css-1syywx2{box-sizing:border-box;margin:0;min-width:0;max-width:100%;height:auto;background-color:#ffffff;width:38px;height:38px;border-radius:50%;}</style><style class="darkreader darkreader--sync" media="screen"></style><style data-emotion-css="1cd9gw4">.css-1cd9gw4{margin-left:.3em;}</style><style class="darkreader darkreader--sync" media="screen"></style><style data-emotion-css="4gq0sj">.css-4gq0sj{box-sizing:border-box;margin:0;min-width:0;color:#09408e;display:inline-block;margin-left:.3em;}</style><style class="darkreader darkreader--sync" media="screen"></style><style data-emotion-css="1ldqog6">.css-1ldqog6{-webkit-transform:scale(1.1);-ms-transform:scale(1.1);transform:scale(1.1);}</style><style class="darkreader darkreader--sync" media="screen"></style><style data-emotion-css="z4ujak">.css-z4ujak{color:#8491a5;}</style><style class="darkreader darkreader--sync" media="screen"></style><style data-emotion-css="1od93p9">.css-1od93p9{margin-top:16px;position:relative;}</style><style class="darkreader darkreader--sync" media="screen"></style><style data-emotion-css="376mun">.css-376mun{position:relative;display:inline;}</style><style class="darkreader darkreader--sync" media="screen"></style><style data-emotion-css="1dlndns">.css-1dlndns{position:absolute;left:NaNpx;top:0;}</style><style class="darkreader darkreader--sync" media="screen"></style><style data-emotion-css="ldd79s">.css-ldd79s{box-sizing:border-box;margin:0;min-width:0;position:absolute;left:NaNpx;top:0;}</style><style class="darkreader darkreader--sync" media="screen"></style><style data-emotion-css="dg64xe">.css-dg64xe .FileLinkCard{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;background-color:rgba(248,248,250,0.88);border-radius:12px;box-sizing:border-box;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;margin:1em auto;max-width:100%;overflow:hidden;padding:12px;position:relative;width:390px;}.css-dg64xe .FileLinkCard-icon{-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;height:30px;width:30px;}.css-dg64xe .FileLinkCard-info{margin-left:12px;}.css-dg64xe .FileLinkCard-name{color:#191B1F;font-size:15px;font-weight:500;line-height:21px;display:-webkit-box;text-overflow:ellipsis;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:2;}.css-dg64xe .FileLinkCard-meta{color:#9196a1;font-size:12px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;line-height:14px;margin-top:5px;}.css-dg64xe .FileLinkCard-source{white-space:pre;}.css-dg64xe img[data-uncomfortable]{content:url(data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%20344.88888888888886%20194%22%3E%3CforeignObject%20width%3D%22344.88888888888886%22%20height%3D%22194%22%3E%0A%20%20%20%20%20%20%3Cdiv%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxhtml%22%20style%3D%22font-size%3A%2013px%3B%20font-family%3A%20-apple-system%2C%20BlinkMacSystemFont%2C%20Microsoft%20YaHei%2C%20sans-serif%3B%20color%3A%20%23fff%3B%20width%3A100%25%3B%20height%3A194px%3B%22%3E%0A%20%20%20%20%20%20%20%20%3Cdiv%20style%3D%22display%3A%20flex%3B%20flex-direction%3A%20column%3B%20align-items%3A%20center%3B%20justify-content%3A%20center%3B%20height%3A%20100%25%3B%22%3E%0A%20%20%20%20%20%20%20%20%20%20%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%2218%22%20height%3D%2218%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22currentColor%22%3E%3Cpath%20d%3D%22M8%203.65a7%207%200%2000-1.353.128.65.65%200%2011-.25-1.275A8.3%208.3%200%20018%202.35c2.387%200%204.172.954%205.357%202.125C14.511%205.615%2015.15%207.022%2015.15%208c0%20.621-.257%201.391-.699%202.134a7.076%207.076%200%2001-1.403%201.68l.495.46a.65.65%200%2011-.886.951l-.998-.929a.645.645%200%2001-.104-.097L9.73%2010.501a.647.647%200%2001-.29.301%203.15%203.15%200%2001-4.313-4.094.647.647%200%2001.234-.275L3.908%205.08a5.774%205.774%200%2000-1.283%201.522C2.282%207.198%202.15%207.707%202.15%208c0%20.522.41%201.616%201.407%202.6.965.954%202.43%201.75%204.443%201.75.468%200%20.905-.043%201.311-.12a.65.65%200%2001.243%201.277A8.322%208.322%200%20018%2013.65c-2.387%200-4.172-.954-5.357-2.125C1.49%2010.385.85%208.978.85%208c0-.598.238-1.333.648-2.046A7.054%207.054%200%20012.95%204.188l-.547-.509a.65.65%200%2011.886-.951l8.8%208.194a5.793%205.793%200%20001.244-1.453c.372-.624.516-1.163.516-1.469%200-.522-.41-1.616-1.407-2.6-.965-.954-2.43-1.75-4.443-1.75zM6.29%207.296a1.85%201.85%200%20002.534%202.36l-2.535-2.36zM8%204.85a.65.65%200%20100%201.3%201.85%201.85%200%20011.843%201.694.65.65%200%20101.296-.11A3.15%203.15%200%20008%204.85z%22%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%3E%3C%2Fpath%3E%3C%2Fsvg%3E%0A%20%20%20%20%20%20%20%20%20%20%3Cdiv%20style%3D%22margin%3A%20.6em%200%201.2em%22%3E%E8%AF%A5%E5%9B%BE%E7%89%87%E6%9C%89%E5%8F%AF%E8%83%BD%E4%BC%9A%E5%BC%95%E8%B5%B7%E4%B8%8D%E9%80%82%3C%2Fdiv%3E%0A%20%20%20%20%20%20%20%20%20%20%3Cbutton%20style%3D%22padding%3A%204px%201em%3B%20font-size%3A%201.1em%3B%20color%3A%20inherit%3B%20background%3A%20none%3B%20border%3A%201px%20solid%20rgba%28255%2C255%2C255%2C.5%29%3B%20border-radius%3A%209999px%3B%22%3E%E7%BB%A7%E7%BB%AD%E6%9F%A5%E7%9C%8B%3C%2Fbutton%3E%0A%20%20%20%20%20%20%20%20%3C%2Fdiv%3E%0A%20%20%20%20%20%20%3C%2Fdiv%3E%0A%20%20%20%20%3C%2FforeignObject%3E%3C%2Fsvg%3E);width:100%;height:194px;background:url(https://pic1.zhimg.com/v2-cf70d0759d787c70091857151c1cad4a.jpeg) no-repeat rgba(191,191,191,0.7);background-size:cover;cursor:pointer!important;}.css-dg64xe img.content_image[data-size="normal"],.css-dg64xe img.origin_image[data-size="normal"]{width:100%;max-width:100%;}.css-dg64xe img.content_image[data-size="small"],.css-dg64xe img.origin_image[data-size="small"]{width:320px;max-width:100%;}</style><style class="darkreader darkreader--sync" media="screen"></style><style data-emotion-css="1vqsdx1">.css-1vqsdx1 .LinkCard.new{position:relative;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;box-sizing:border-box;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;width:390px;min-height:84px;border-radius:8px;max-width:100%;overflow:hidden;margin:16px auto;padding:12px 12px 9px 12px;background-color:#f8f8fa;}.css-1vqsdx1 .LinkCard.new,.css-1vqsdx1 .LinkCard.new:hover{-webkit-text-decoration:none;text-decoration:none;border:none !important;color:inherit !important;}.css-1vqsdx1 .LinkCard.new .LinkCard-contents{display:block;-webkit-flex:1 1 auto;-ms-flex:1 1 auto;flex:1 1 auto;position:relative;}.css-1vqsdx1 .LinkCard.new .LinkCard-contents .loading{height:14px;background:#ebeced;border-radius:7px;}.css-1vqsdx1 .LinkCard.new .LinkCard-contents.withTitle{margin-bottom:3px;}.css-1vqsdx1 .LinkCard.new .LinkCard-title{display:-webkit-box;font-size:15px;font-weight:500;line-height:1.4;margin-bottom:2px;color:#191B1F;text-overflow:ellipsis;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:1;}.css-1vqsdx1 .LinkCard.new .LinkCard-title.two-line{line-height:20px;display:-webkit-box;text-overflow:ellipsis;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:2;}.css-1vqsdx1 .LinkCard.new .LinkCard-title.loading{margin-bottom:8px;width:80%;}.css-1vqsdx1 .LinkCard.new .LinkCard-title.loading.withTitle{margin-bottom:6px;}.css-1vqsdx1 .LinkCard.new .LinkCard-title.loadingTitle{margin-bottom:5px;}.css-1vqsdx1 .LinkCard.new .LinkCard-excerpt{display:-webkit-box;text-overflow:ellipsis;font-size:13px;line-height:18px;color:#9196a1;margin-bottom:4px;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:1;}.css-1vqsdx1 .LinkCard.new .LinkCard-excerpt .LinkCard-author{color:#373a40;}.css-1vqsdx1 .LinkCard.new .LinkCard-desc{display:-webkit-box;font-size:13px;height:18px;line-height:18px;color:#9196a1;word-break:break-all;text-overflow:ellipsis;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:1;}.css-1vqsdx1 .LinkCard.new .LinkCard-desc .LinkCard-tag,.css-1vqsdx1 .LinkCard.new .LinkCard-desc .tag{display:inline-block;font-size:11px;margin-left:8px;padding:0 4px;border-radius:3px;background:rgba(196,199,206,0.3);}.css-1vqsdx1 .LinkCard.new .LinkCard-desc.loading{width:40%;}.css-1vqsdx1 .LinkCard.new .LinkCard-desc svg{margin-right:2px;}.css-1vqsdx1 .LinkCard.new .LinkCard-image{-webkit-flex:0 0 auto;-ms-flex:0 0 auto;flex:0 0 auto;background-color:#ebeced;background-size:cover;background-position:center;position:relative;display:block;width:60px;height:60px;margin-left:20px;object-fit:cover;border-radius:inherit;overflow:hidden;}.css-1vqsdx1 .LinkCard.new .LinkCard-image.LinkCard-image--default{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;background-color:#ebeced;color:#c4c7ce;}.css-1vqsdx1 .LinkCard.new .LinkCard-image.LinkCard-image--default svg{color:#9196a1;}.css-1vqsdx1 .LinkCard.new .LinkCard-image img{width:100%;height:100%;object-fit:cover;}.css-1vqsdx1 .LinkCard.new .LinkCard-image .LinkCard-image--video{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;position:absolute;top:50%;left:50%;-webkit-transform:translateX(-50%) translateY(-50%);-ms-transform:translateX(-50%) translateY(-50%);transform:translateX(-50%) translateY(-50%);width:24px;height:24px;border-radius:12px;background:rgba(255,255,255,0.9);pointer-events:none;}.css-1vqsdx1 .LinkCard.new .LinkCard-image .LinkCard-image--video svg{color:#373a40;}.css-1vqsdx1 .LinkCard.new .LinkCard-richText .text{color:#373a40;}.css-1vqsdx1 .LinkCard.new .LinkCard-richText .bold{font-weight:600;}.css-1vqsdx1 .LinkCard.new .LinkCard-richText .tag{margin-left:4px;}.css-1vqsdx1 .LinkCard.old{position:relative;display:block;margin:1em auto;width:390px;box-sizing:border-box;border-radius:12px;max-width:100%;overflow:hidden;}.css-1vqsdx1 .LinkCard.old,.css-1vqsdx1 .LinkCard.old:hover{-webkit-text-decoration:none;text-decoration:none;border:none !important;color:inherit !important;}.css-1vqsdx1 .LinkCard-ecommerceLoadingCard{position:relative;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;padding:12px;border-radius:inherit;height:80px;box-sizing:border-box;background:rgba(248,248,250,0.88);color:#c4c7ce;}.css-1vqsdx1 .LinkCard-ecommerceLoadingCardAvatarWrapper{width:60px;height:60px;background:#ebeced;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;border-radius:6px;margin-right:10px;}.css-1vqsdx1 .LinkCard-ecommerceLoadingCardNetwork{width:20px;height:20px;}.css-1vqsdx1 .LinkCard-ecommerceLoadingCardLoadingbar{height:60px;-webkit-flex:1;-ms-flex:1;flex:1;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}.css-1vqsdx1 .LinkCard-ecommerceLoadingCardLoadingbar span{height:16px;display:inline-block;background:#ebeced;}.css-1vqsdx1 .LinkCard-ecommerceLoadingCardLoadingbar span:nth-of-type(1){width:60px;margin-bottom:4px;}.css-1vqsdx1 .LinkCard-ecommerceLoadingCardLoadingbar span:nth-of-type(2){width:127px;}</style><style class="darkreader darkreader--sync" media="screen"></style><style data-emotion-css="yxro2d">.css-yxro2d .LinkCard.old{position:relative;display:block;margin:1em auto;width:390px;box-sizing:border-box;border-radius:12px;max-width:100%;overflow:hidden;}.css-yxro2d .LinkCard.old,.css-yxro2d .LinkCard.old:hover{-webkit-text-decoration:none;text-decoration:none;border:none !important;color:inherit !important;}.css-yxro2d .LinkCard-ecommerceLoadingCard{position:relative;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;padding:12px;border-radius:inherit;height:80px;box-sizing:border-box;background:rgba(248,248,250,0.88);color:#c4c7ce;}.css-yxro2d .LinkCard-ecommerceLoadingCardAvatarWrapper{width:60px;height:60px;background:#ebeced;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;border-radius:6px;margin-right:10px;}.css-yxro2d .LinkCard-ecommerceLoadingCardNetwork{width:20px;height:20px;}.css-yxro2d .LinkCard-ecommerceLoadingCardLoadingbar{height:60px;-webkit-flex:1;-ms-flex:1;flex:1;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}.css-yxro2d .LinkCard-ecommerceLoadingCardLoadingbar span{height:16px;display:inline-block;background:#ebeced;}.css-yxro2d .LinkCard-ecommerceLoadingCardLoadingbar span:nth-of-type(1){width:60px;margin-bottom:4px;}.css-yxro2d .LinkCard-ecommerceLoadingCardLoadingbar span:nth-of-type(2){width:127px;}.css-yxro2d .LinkCard.new{position:relative;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;box-sizing:border-box;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;width:390px;min-height:84px;border-radius:8px;max-width:100%;overflow:hidden;margin:16px auto;padding:12px 12px 9px 12px;background-color:#f8f8fa;}.css-yxro2d .LinkCard.new,.css-yxro2d .LinkCard.new:hover{-webkit-text-decoration:none;text-decoration:none;border:none !important;color:inherit !important;}.css-yxro2d .LinkCard.new .LinkCard-contents{display:block;-webkit-flex:1 1 auto;-ms-flex:1 1 auto;flex:1 1 auto;position:relative;}.css-yxro2d .LinkCard.new .LinkCard-contents .loading{height:14px;background:#ebeced;border-radius:7px;}.css-yxro2d .LinkCard.new .LinkCard-contents.withTitle{margin-bottom:3px;}.css-yxro2d .LinkCard.new .LinkCard-title{display:-webkit-box;font-size:15px;font-weight:500;line-height:1.4;margin-bottom:2px;color:#191B1F;text-overflow:ellipsis;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:1;}.css-yxro2d .LinkCard.new .LinkCard-title.two-line{line-height:20px;display:-webkit-box;text-overflow:ellipsis;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:2;}.css-yxro2d .LinkCard.new .LinkCard-title.loading{margin-bottom:8px;width:80%;}.css-yxro2d .LinkCard.new .LinkCard-title.loading.withTitle{margin-bottom:6px;}.css-yxro2d .LinkCard.new .LinkCard-title.loadingTitle{margin-bottom:5px;}.css-yxro2d .LinkCard.new .LinkCard-excerpt{display:-webkit-box;text-overflow:ellipsis;font-size:13px;line-height:18px;color:#9196a1;margin-bottom:4px;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:1;}.css-yxro2d .LinkCard.new .LinkCard-excerpt .LinkCard-author{color:#373a40;}.css-yxro2d .LinkCard.new .LinkCard-desc{display:-webkit-box;font-size:13px;height:18px;line-height:18px;color:#9196a1;word-break:break-all;text-overflow:ellipsis;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:1;}.css-yxro2d .LinkCard.new .LinkCard-desc .LinkCard-tag,.css-yxro2d .LinkCard.new .LinkCard-desc .tag{display:inline-block;font-size:11px;margin-left:8px;padding:0 4px;border-radius:3px;background:rgba(196,199,206,0.3);}.css-yxro2d .LinkCard.new .LinkCard-desc.loading{width:40%;}.css-yxro2d .LinkCard.new .LinkCard-desc svg{margin-right:2px;}.css-yxro2d .LinkCard.new .LinkCard-image{-webkit-flex:0 0 auto;-ms-flex:0 0 auto;flex:0 0 auto;background-color:#ebeced;background-size:cover;background-position:center;position:relative;display:block;width:60px;height:60px;margin-left:20px;object-fit:cover;border-radius:inherit;overflow:hidden;}.css-yxro2d .LinkCard.new .LinkCard-image.LinkCard-image--default{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;background-color:#ebeced;color:#c4c7ce;}.css-yxro2d .LinkCard.new .LinkCard-image.LinkCard-image--default svg{color:#9196a1;}.css-yxro2d .LinkCard.new .LinkCard-image img{width:100%;height:100%;object-fit:cover;}.css-yxro2d .LinkCard.new .LinkCard-image .LinkCard-image--video{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;position:absolute;top:50%;left:50%;-webkit-transform:translateX(-50%) translateY(-50%);-ms-transform:translateX(-50%) translateY(-50%);transform:translateX(-50%) translateY(-50%);width:24px;height:24px;border-radius:12px;background:rgba(255,255,255,0.9);pointer-events:none;}.css-yxro2d .LinkCard.new .LinkCard-image .LinkCard-image--video svg{color:#373a40;}.css-yxro2d .LinkCard.new .LinkCard-richText .text{color:#373a40;}.css-yxro2d .LinkCard.new .LinkCard-richText .bold{font-weight:600;}.css-yxro2d .LinkCard.new .LinkCard-richText .tag{margin-left:4px;}.css-yxro2d .FileLinkCard{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;background-color:rgba(248,248,250,0.88);border-radius:12px;box-sizing:border-box;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;margin:1em auto;max-width:100%;overflow:hidden;padding:12px;position:relative;width:390px;}.css-yxro2d .FileLinkCard-icon{-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;height:30px;width:30px;}.css-yxro2d .FileLinkCard-info{margin-left:12px;}.css-yxro2d .FileLinkCard-name{color:#191B1F;font-size:15px;font-weight:500;line-height:21px;display:-webkit-box;text-overflow:ellipsis;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:2;}.css-yxro2d .FileLinkCard-meta{color:#9196a1;font-size:12px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;line-height:14px;margin-top:5px;}.css-yxro2d .FileLinkCard-source{white-space:pre;}.css-yxro2d img[data-uncomfortable]{content:url(data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%20344.88888888888886%20194%22%3E%3CforeignObject%20width%3D%22344.88888888888886%22%20height%3D%22194%22%3E%0A%20%20%20%20%20%20%3Cdiv%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxhtml%22%20style%3D%22font-size%3A%2013px%3B%20font-family%3A%20-apple-system%2C%20BlinkMacSystemFont%2C%20Microsoft%20YaHei%2C%20sans-serif%3B%20color%3A%20%23fff%3B%20width%3A100%25%3B%20height%3A194px%3B%22%3E%0A%20%20%20%20%20%20%20%20%3Cdiv%20style%3D%22display%3A%20flex%3B%20flex-direction%3A%20column%3B%20align-items%3A%20center%3B%20justify-content%3A%20center%3B%20height%3A%20100%25%3B%22%3E%0A%20%20%20%20%20%20%20%20%20%20%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%2218%22%20height%3D%2218%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22currentColor%22%3E%3Cpath%20d%3D%22M8%203.65a7%207%200%2000-1.353.128.65.65%200%2011-.25-1.275A8.3%208.3%200%20018%202.35c2.387%200%204.172.954%205.357%202.125C14.511%205.615%2015.15%207.022%2015.15%208c0%20.621-.257%201.391-.699%202.134a7.076%207.076%200%2001-1.403%201.68l.495.46a.65.65%200%2011-.886.951l-.998-.929a.645.645%200%2001-.104-.097L9.73%2010.501a.647.647%200%2001-.29.301%203.15%203.15%200%2001-4.313-4.094.647.647%200%2001.234-.275L3.908%205.08a5.774%205.774%200%2000-1.283%201.522C2.282%207.198%202.15%207.707%202.15%208c0%20.522.41%201.616%201.407%202.6.965.954%202.43%201.75%204.443%201.75.468%200%20.905-.043%201.311-.12a.65.65%200%2001.243%201.277A8.322%208.322%200%20018%2013.65c-2.387%200-4.172-.954-5.357-2.125C1.49%2010.385.85%208.978.85%208c0-.598.238-1.333.648-2.046A7.054%207.054%200%20012.95%204.188l-.547-.509a.65.65%200%2011.886-.951l8.8%208.194a5.793%205.793%200%20001.244-1.453c.372-.624.516-1.163.516-1.469%200-.522-.41-1.616-1.407-2.6-.965-.954-2.43-1.75-4.443-1.75zM6.29%207.296a1.85%201.85%200%20002.534%202.36l-2.535-2.36zM8%204.85a.65.65%200%20100%201.3%201.85%201.85%200%20011.843%201.694.65.65%200%20101.296-.11A3.15%203.15%200%20008%204.85z%22%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%3E%3C%2Fpath%3E%3C%2Fsvg%3E%0A%20%20%20%20%20%20%20%20%20%20%3Cdiv%20style%3D%22margin%3A%20.6em%200%201.2em%22%3E%E8%AF%A5%E5%9B%BE%E7%89%87%E6%9C%89%E5%8F%AF%E8%83%BD%E4%BC%9A%E5%BC%95%E8%B5%B7%E4%B8%8D%E9%80%82%3C%2Fdiv%3E%0A%20%20%20%20%20%20%20%20%20%20%3Cbutton%20style%3D%22padding%3A%204px%201em%3B%20font-size%3A%201.1em%3B%20color%3A%20inherit%3B%20background%3A%20none%3B%20border%3A%201px%20solid%20rgba%28255%2C255%2C255%2C.5%29%3B%20border-radius%3A%209999px%3B%22%3E%E7%BB%A7%E7%BB%AD%E6%9F%A5%E7%9C%8B%3C%2Fbutton%3E%0A%20%20%20%20%20%20%20%20%3C%2Fdiv%3E%0A%20%20%20%20%20%20%3C%2Fdiv%3E%0A%20%20%20%20%3C%2FforeignObject%3E%3C%2Fsvg%3E);width:100%;height:194px;background:url(https://pic1.zhimg.com/v2-cf70d0759d787c70091857151c1cad4a.jpeg) no-repeat rgba(191,191,191,0.7);background-size:cover;cursor:pointer!important;}.css-yxro2d img.content_image[data-size="normal"],.css-yxro2d img.origin_image[data-size="normal"]{width:100%;max-width:100%;}.css-yxro2d img.content_image[data-size="small"],.css-yxro2d img.origin_image[data-size="small"]{width:320px;max-width:100%;}</style><style class="darkreader darkreader--sync" media="screen"></style><style data-emotion-css="1ygg4xu animation-1yvu044">.css-1ygg4xu{word-break:break-word;line-height:1.6;}.css-1ygg4xu > [data-first-child]{margin-top:0;}.css-1ygg4xu > :last-child{margin-bottom:0;}.css-1ygg4xu h1,.css-1ygg4xu h2{clear:left;margin-top:calc((1.4em * 2) / 1.2);margin-bottom:calc(1.4em / 1.2);font-size:1.2em;line-height:1.5;font-weight:600;}.css-1ygg4xu h3,.css-1ygg4xu h4,.css-1ygg4xu h5,.css-1ygg4xu h6{clear:left;margin-top:calc((1.4em * 1.5) / 1.1);margin-bottom:calc(1.4em / 1.1);font-size:1.1em;line-height:1.5;font-weight:600;}.css-1ygg4xu u{-webkit-text-decoration:none;text-decoration:none;border-bottom:1px solid #373a40;}.css-1ygg4xu b{font-weight:600;}.css-1ygg4xu sup{font-size:0.8em;}.css-1ygg4xu sup[data-draft-type='reference']{color:#09408e;}.css-1ygg4xu a:focus{outline:none;-webkit-transition:box-shadow 0.3s;transition:box-shadow 0.3s;}html[data-focus-visible] .css-1ygg4xu a:focus{box-shadow:0 0 0 2px #ffffff,0 0 0 4px rgba(23,114,246,0.3);}.css-1ygg4xu a.ztext-link,.css-1ygg4xu a.internal,.css-1ygg4xu a.external{-webkit-text-decoration:none;text-decoration:none;cursor:pointer;border-bottom:1px solid #81858f;}.css-1ygg4xu a.ztext-link:hover,.css-1ygg4xu a.internal:hover,.css-1ygg4xu a.external:hover{color:#09408e;border-bottom:1px solid #09408e;}.css-1ygg4xu a.ztext-link > .ellipsis::after,.css-1ygg4xu a.internal > .ellipsis::after,.css-1ygg4xu a.external > .ellipsis::after{content:'...';}.css-1ygg4xu a.ztext-link > .invisible,.css-1ygg4xu a.internal > .invisible,.css-1ygg4xu a.external > .invisible{font:0/0 a;color:transparent;text-shadow:none;background-color:transparent;}.css-1ygg4xu a.ztext-link u,.css-1ygg4xu a.internal u,.css-1ygg4xu a.external u{border:none;}.css-1ygg4xu a.member_mention{color:#09408e;}.css-1ygg4xu a.member_mention:hover{border-bottom:1px solid #09408e;}.css-1ygg4xu a.UserLink-link{color:#09408e;}.css-1ygg4xu a.UserLink-link:hover{border-bottom:1px solid #09408e;}.css-1ygg4xu p{margin:1.4em 0;}.css-1ygg4xu p.ztext-empty-paragraph{margin:calc((2.8em- (1.4em * 2 + 1.6em)) / 2) 0;}.css-1ygg4xu p.ztext-empty-paragraph + .ztext-empty-paragraph{margin:1.4em 0;}.css-1ygg4xu hr{margin:4em auto;width:240px;max-width:100%;border:none;border-top:1px solid #c4c7ce;}.css-1ygg4xu img[eeimg]{max-width:100%;vertical-align:middle;}.css-1ygg4xu img[eeimg="1"]{margin:0 3px;max-width:calc(100% - 6px);display:inline-block;}.css-1ygg4xu img[eeimg="2"]{margin:1.4em auto;display:block;}.css-1ygg4xu blockquote{margin:1.4em 0;padding-left:1em;color:#535861;border-left:3px solid #c4c7ce;}.css-1ygg4xu ol,.css-1ygg4xu ul{margin:1.4em 0;padding:0;width:100%;}.css-1ygg4xu ol ol,.css-1ygg4xu ul ol,.css-1ygg4xu ol ul,.css-1ygg4xu ul ul{margin:0;}.css-1ygg4xu ol li::before,.css-1ygg4xu ul li::before{width:1em;}.css-1ygg4xu ol > ol,.css-1ygg4xu ul > ol,.css-1ygg4xu ol > ul,.css-1ygg4xu ul > ul{padding-left:1em;box-sizing:border-box;}.css-1ygg4xu ul>li{display:table;width:100%;list-style:none;}.css-1ygg4xu ul>li::before{display:table-cell;content:'•  ';white-space:pre;}.css-1ygg4xu ol{counter-reset:ol;}.css-1ygg4xu ol > li{display:table;width:100%;list-style:none;}.css-1ygg4xu ol > li::before{display:table-cell;text-align:right;counter-increment:ol;content:counter(ol) '. ';white-space:pre;}.css-1ygg4xu ol ol{counter-reset:ol2;}.css-1ygg4xu ol ol li::before{counter-increment:ol2;content:counter(ol2) '. ';}.css-1ygg4xu ol ol ol{counter-reset:ol3;}.css-1ygg4xu ol ol ol li::before{counter-increment:ol3;content:counter(ol3) '. ';}.css-1ygg4xu ol ol ol ol{counter-reset:ol4;}.css-1ygg4xu ol ol ol ol li::before{counter-increment:ol4;content:counter(ol4) '. ';}.css-1ygg4xu figure{margin:1.4em 0;}.css-1ygg4xu figure .content_image,.css-1ygg4xu figure .origin_image{margin:0 auto;}.css-1ygg4xu figure figcaption{margin-top:calc(0.6em / 0.9);padding:0 1em;font-size:0.9em;line-height:1.5;text-align:center;color:#9196a1;}.css-1ygg4xu figure + figure{margin-top:calc(1.4em * 1.6);}.css-1ygg4xu figure[data-size='small'],.css-1ygg4xu figure:not([data-size]) > [data-size='small']{clear:both;}.css-1ygg4xu figure[data-size='left'],.css-1ygg4xu figure:not([data-size]) > [data-size='left']{float:left;margin:0 20px 20px 0;max-width:33%;}.css-1ygg4xu figure[data-size='right'],.css-1ygg4xu figure:not([data-size]) > [data-size='right']{float:right;margin:0 0 20px 20px;max-width:33%;}.css-1ygg4xu figure[data-size='collapse']{margin-bottom:0;}.css-1ygg4xu figure[data-size='collapse'] + figure{margin-top:0;}.css-1ygg4xu .content_image,.css-1ygg4xu .origin_image{display:block;max-width:100%;height:auto;margin:1.4em auto;}.css-1ygg4xu .content_image[data-size='small'],.css-1ygg4xu .origin_image[data-size='small']{max-width:40%;}.css-1ygg4xu .content_image.zh-lightbox-thumb,.css-1ygg4xu .origin_image.zh-lightbox-thumb{cursor:-webkit-zoom-in;cursor:-moz-zoom-in;cursor:zoom-in;}.css-1ygg4xu code{margin:0 2px;padding:3px 4px;border-radius:3px;font-family:Menlo,Monaco,Consolas,'Andale Mono','lucida console','Courier New',monospace;font-size:0.9em;background-color:#f8f8fa;}.css-1ygg4xu pre{margin:1.4em 0;padding:calc(0.8em / 0.9);font-size:0.9em;word-break:initial;word-wrap:initial;white-space:pre;overflow:auto;-webkit-overflow-scrolling:touch;background:#f8f8fa;border-radius:4px;}.css-1ygg4xu pre code{margin:0;padding:0;font-size:inherit;border-radius:0;background-color:inherit;}.css-1ygg4xu li pre{white-space:pre-wrap;}.css-1ygg4xu table[data-draft-type='table']{border-collapse:collapse;font-size:15px;margin:1.4em auto;max-width:100%;table-layout:fixed;text-align:left;width:100%;}.css-1ygg4xu table[data-draft-type='table'][data-size='small']{min-width:260px;width:40%;}.css-1ygg4xu table[data-draft-type='table'][data-row-style='striped'] tr:nth-of-type(2n + 1){background:#f8f8fa;}.css-1ygg4xu table[data-draft-type='table'] td,.css-1ygg4xu table[data-draft-type='table'] th{border:1px solid #c4c7ce;line-height:24px;height:24px;padding:3px 12px;}.css-1ygg4xu table[data-draft-type='table'] th{background:#ebeced;color:#191B1F;font-weight:500;}.css-1ygg4xu .video-box,.css-1ygg4xu .link-box{position:relative;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;margin:1.4em 0;overflow:auto;white-space:normal;cursor:pointer;border:solid 1px #ebeced;border-radius:4px;}.css-1ygg4xu .lazy[data-lazy-status]{background-color:#f8f8fa;}.css-1ygg4xu .lazy[data-lazy-status="ok"]{background-color:transparent;-webkit-animation:animation-1yvu044 0.5s ease-in;animation:animation-1yvu044 0.5s ease-in;}.css-1ygg4xu .highlight{margin:1em 0;}.css-1ygg4xu .highlight pre{margin:0;}.css-1ygg4xu .highlight .hll{background-color:#f8f8fa;}.css-1ygg4xu .highlight .c{font-style:italic;color:#9196a1;}.css-1ygg4xu .highlight .err{color:#D95350;}.css-1ygg4xu .highlight .k{font-weight:600;}.css-1ygg4xu .highlight .o{font-weight:600;}.css-1ygg4xu .highlight .cm{font-style:italic;color:#9196a1;}.css-1ygg4xu .highlight .cp{font-weight:600;color:#9196a1;}.css-1ygg4xu .highlight .c1{font-style:italic;color:#9196a1;}.css-1ygg4xu .highlight .cs{font-style:italic;font-weight:600;color:#9196a1;}.css-1ygg4xu .highlight .gd{color:#F05159;}.css-1ygg4xu .highlight .ge{font-style:italic;}.css-1ygg4xu .highlight .gr{color:#D95350;}.css-1ygg4xu .highlight .gh{color:#9196a1;}.css-1ygg4xu .highlight .gi{color:#12b370;}.css-1ygg4xu .highlight .go{color:#81858f;}.css-1ygg4xu .highlight .gp{color:#535861;}.css-1ygg4xu .highlight .gs{font-weight:600;}.css-1ygg4xu .highlight .gu{color:#9196a1;}.css-1ygg4xu .highlight .gt{color:#D95350;}.css-1ygg4xu .highlight .kc{font-weight:600;}.css-1ygg4xu .highlight .kd{font-weight:600;}.css-1ygg4xu .highlight .kn{font-weight:600;}.css-1ygg4xu .highlight .kp{font-weight:600;}.css-1ygg4xu .highlight .kr{font-weight:600;}.css-1ygg4xu .highlight .kt{font-weight:600;color:#09408e;}.css-1ygg4xu .highlight .m{color:#1772F6;}.css-1ygg4xu .highlight .s{color:#D95350;}.css-1ygg4xu .highlight .na{color:#1772F6;}.css-1ygg4xu .highlight .nb{color:#1772F6;}.css-1ygg4xu .highlight .nc{font-weight:600;color:#09408e;}.css-1ygg4xu .highlight .no{color:#1772F6;}.css-1ygg4xu .highlight .ni{color:#6A5FF3;}.css-1ygg4xu .highlight .ne{font-weight:600;color:#D95350;}.css-1ygg4xu .highlight .nf{font-weight:600;color:#D95350;}.css-1ygg4xu .highlight .nn{color:#535861;}.css-1ygg4xu .highlight .nt{color:#09408e;}.css-1ygg4xu .highlight .nv{color:#1772F6;}.css-1ygg4xu .highlight .ow{font-weight:600;}.css-1ygg4xu .highlight .w{color:#adb0b7;}.css-1ygg4xu .highlight .mf{color:#1772F6;}.css-1ygg4xu .highlight .mh{color:#1772F6;}.css-1ygg4xu .highlight .mi{color:#1772F6;}.css-1ygg4xu .highlight .mo{color:#1772F6;}.css-1ygg4xu .highlight .sb{color:#D95350;}.css-1ygg4xu .highlight .sc{color:#D95350;}.css-1ygg4xu .highlight .sd{color:#D95350;}.css-1ygg4xu .highlight .s2{color:#D95350;}.css-1ygg4xu .highlight .se{color:#D95350;}.css-1ygg4xu .highlight .sh{color:#D95350;}.css-1ygg4xu .highlight .si{color:#D95350;}.css-1ygg4xu .highlight .sx{color:#D95350;}.css-1ygg4xu .highlight .sr{color:#A5542F;}.css-1ygg4xu .highlight .s1{color:#D95350;}.css-1ygg4xu .highlight .ss{color:#D95350;}.css-1ygg4xu .highlight .bp{color:#9196a1;}.css-1ygg4xu .highlight .vc{color:#1772F6;}.css-1ygg4xu .highlight .vg{color:#1772F6;}.css-1ygg4xu .highlight .vi{color:#1772F6;}.css-1ygg4xu .highlight .il{color:#1772F6;}.css-1ygg4xu .highlight::-webkit-scrollbar{width:6px;height:6px;}.css-1ygg4xu .highlight::-webkit-scrollbar-thumb:horizontal{background-color:rgba(25,27,31,0.5);border-radius:6px;}.css-1ygg4xu .highlight::-webkit-scrollbar-thumb:horizontal:hover{background-color:rgba(25,27,31,0.6);}.css-1ygg4xu .LinkCard.old{position:relative;display:block;margin:1em auto;width:390px;box-sizing:border-box;border-radius:12px;max-width:100%;overflow:hidden;}.css-1ygg4xu .LinkCard.old,.css-1ygg4xu .LinkCard.old:hover{-webkit-text-decoration:none;text-decoration:none;border:none !important;color:inherit !important;}.css-1ygg4xu .LinkCard-ecommerceLoadingCard{position:relative;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;padding:12px;border-radius:inherit;height:80px;box-sizing:border-box;background:rgba(248,248,250,0.88);color:#c4c7ce;}.css-1ygg4xu .LinkCard-ecommerceLoadingCardAvatarWrapper{width:60px;height:60px;background:#ebeced;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;border-radius:6px;margin-right:10px;}.css-1ygg4xu .LinkCard-ecommerceLoadingCardNetwork{width:20px;height:20px;}.css-1ygg4xu .LinkCard-ecommerceLoadingCardLoadingbar{height:60px;-webkit-flex:1;-ms-flex:1;flex:1;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}.css-1ygg4xu .LinkCard-ecommerceLoadingCardLoadingbar span{height:16px;display:inline-block;background:#ebeced;}.css-1ygg4xu .LinkCard-ecommerceLoadingCardLoadingbar span:nth-of-type(1){width:60px;margin-bottom:4px;}.css-1ygg4xu .LinkCard-ecommerceLoadingCardLoadingbar span:nth-of-type(2){width:127px;}.css-1ygg4xu .LinkCard.new{position:relative;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;box-sizing:border-box;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;width:390px;min-height:84px;border-radius:8px;max-width:100%;overflow:hidden;margin:16px auto;padding:12px 12px 9px 12px;background-color:#f8f8fa;}.css-1ygg4xu .LinkCard.new,.css-1ygg4xu .LinkCard.new:hover{-webkit-text-decoration:none;text-decoration:none;border:none !important;color:inherit !important;}.css-1ygg4xu .LinkCard.new .LinkCard-contents{display:block;-webkit-flex:1 1 auto;-ms-flex:1 1 auto;flex:1 1 auto;position:relative;}.css-1ygg4xu .LinkCard.new .LinkCard-contents .loading{height:14px;background:#ebeced;border-radius:7px;}.css-1ygg4xu .LinkCard.new .LinkCard-contents.withTitle{margin-bottom:3px;}.css-1ygg4xu .LinkCard.new .LinkCard-title{display:-webkit-box;font-size:15px;font-weight:500;line-height:1.4;margin-bottom:2px;color:#191B1F;text-overflow:ellipsis;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:1;}.css-1ygg4xu .LinkCard.new .LinkCard-title.two-line{line-height:20px;display:-webkit-box;text-overflow:ellipsis;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:2;}.css-1ygg4xu .LinkCard.new .LinkCard-title.loading{margin-bottom:8px;width:80%;}.css-1ygg4xu .LinkCard.new .LinkCard-title.loading.withTitle{margin-bottom:6px;}.css-1ygg4xu .LinkCard.new .LinkCard-title.loadingTitle{margin-bottom:5px;}.css-1ygg4xu .LinkCard.new .LinkCard-excerpt{display:-webkit-box;text-overflow:ellipsis;font-size:13px;line-height:18px;color:#9196a1;margin-bottom:4px;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:1;}.css-1ygg4xu .LinkCard.new .LinkCard-excerpt .LinkCard-author{color:#373a40;}.css-1ygg4xu .LinkCard.new .LinkCard-desc{display:-webkit-box;font-size:13px;height:18px;line-height:18px;color:#9196a1;word-break:break-all;text-overflow:ellipsis;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:1;}.css-1ygg4xu .LinkCard.new .LinkCard-desc .LinkCard-tag,.css-1ygg4xu .LinkCard.new .LinkCard-desc .tag{display:inline-block;font-size:11px;margin-left:8px;padding:0 4px;border-radius:3px;background:rgba(196,199,206,0.3);}.css-1ygg4xu .LinkCard.new .LinkCard-desc.loading{width:40%;}.css-1ygg4xu .LinkCard.new .LinkCard-desc svg{margin-right:2px;}.css-1ygg4xu .LinkCard.new .LinkCard-image{-webkit-flex:0 0 auto;-ms-flex:0 0 auto;flex:0 0 auto;background-color:#ebeced;background-size:cover;background-position:center;position:relative;display:block;width:60px;height:60px;margin-left:20px;object-fit:cover;border-radius:inherit;overflow:hidden;}.css-1ygg4xu .LinkCard.new .LinkCard-image.LinkCard-image--default{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;background-color:#ebeced;color:#c4c7ce;}.css-1ygg4xu .LinkCard.new .LinkCard-image.LinkCard-image--default svg{color:#9196a1;}.css-1ygg4xu .LinkCard.new .LinkCard-image img{width:100%;height:100%;object-fit:cover;}.css-1ygg4xu .LinkCard.new .LinkCard-image .LinkCard-image--video{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;position:absolute;top:50%;left:50%;-webkit-transform:translateX(-50%) translateY(-50%);-ms-transform:translateX(-50%) translateY(-50%);transform:translateX(-50%) translateY(-50%);width:24px;height:24px;border-radius:12px;background:rgba(255,255,255,0.9);pointer-events:none;}.css-1ygg4xu .LinkCard.new .LinkCard-image .LinkCard-image--video svg{color:#373a40;}.css-1ygg4xu .LinkCard.new .LinkCard-richText .text{color:#373a40;}.css-1ygg4xu .LinkCard.new .LinkCard-richText .bold{font-weight:600;}.css-1ygg4xu .LinkCard.new .LinkCard-richText .tag{margin-left:4px;}.css-1ygg4xu .FileLinkCard{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;background-color:rgba(248,248,250,0.88);border-radius:12px;box-sizing:border-box;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;margin:1em auto;max-width:100%;overflow:hidden;padding:12px;position:relative;width:390px;}.css-1ygg4xu .FileLinkCard-icon{-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;height:30px;width:30px;}.css-1ygg4xu .FileLinkCard-info{margin-left:12px;}.css-1ygg4xu .FileLinkCard-name{color:#191B1F;font-size:15px;font-weight:500;line-height:21px;display:-webkit-box;text-overflow:ellipsis;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:2;}.css-1ygg4xu .FileLinkCard-meta{color:#9196a1;font-size:12px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;line-height:14px;margin-top:5px;}.css-1ygg4xu .FileLinkCard-source{white-space:pre;}.css-1ygg4xu img[data-uncomfortable]{content:url(data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%20344.88888888888886%20194%22%3E%3CforeignObject%20width%3D%22344.88888888888886%22%20height%3D%22194%22%3E%0A%20%20%20%20%20%20%3Cdiv%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxhtml%22%20style%3D%22font-size%3A%2013px%3B%20font-family%3A%20-apple-system%2C%20BlinkMacSystemFont%2C%20Microsoft%20YaHei%2C%20sans-serif%3B%20color%3A%20%23fff%3B%20width%3A100%25%3B%20height%3A194px%3B%22%3E%0A%20%20%20%20%20%20%20%20%3Cdiv%20style%3D%22display%3A%20flex%3B%20flex-direction%3A%20column%3B%20align-items%3A%20center%3B%20justify-content%3A%20center%3B%20height%3A%20100%25%3B%22%3E%0A%20%20%20%20%20%20%20%20%20%20%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%2218%22%20height%3D%2218%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22currentColor%22%3E%3Cpath%20d%3D%22M8%203.65a7%207%200%2000-1.353.128.65.65%200%2011-.25-1.275A8.3%208.3%200%20018%202.35c2.387%200%204.172.954%205.357%202.125C14.511%205.615%2015.15%207.022%2015.15%208c0%20.621-.257%201.391-.699%202.134a7.076%207.076%200%2001-1.403%201.68l.495.46a.65.65%200%2011-.886.951l-.998-.929a.645.645%200%2001-.104-.097L9.73%2010.501a.647.647%200%2001-.29.301%203.15%203.15%200%2001-4.313-4.094.647.647%200%2001.234-.275L3.908%205.08a5.774%205.774%200%2000-1.283%201.522C2.282%207.198%202.15%207.707%202.15%208c0%20.522.41%201.616%201.407%202.6.965.954%202.43%201.75%204.443%201.75.468%200%20.905-.043%201.311-.12a.65.65%200%2001.243%201.277A8.322%208.322%200%20018%2013.65c-2.387%200-4.172-.954-5.357-2.125C1.49%2010.385.85%208.978.85%208c0-.598.238-1.333.648-2.046A7.054%207.054%200%20012.95%204.188l-.547-.509a.65.65%200%2011.886-.951l8.8%208.194a5.793%205.793%200%20001.244-1.453c.372-.624.516-1.163.516-1.469%200-.522-.41-1.616-1.407-2.6-.965-.954-2.43-1.75-4.443-1.75zM6.29%207.296a1.85%201.85%200%20002.534%202.36l-2.535-2.36zM8%204.85a.65.65%200%20100%201.3%201.85%201.85%200%20011.843%201.694.65.65%200%20101.296-.11A3.15%203.15%200%20008%204.85z%22%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%3E%3C%2Fpath%3E%3C%2Fsvg%3E%0A%20%20%20%20%20%20%20%20%20%20%3Cdiv%20style%3D%22margin%3A%20.6em%200%201.2em%22%3E%E8%AF%A5%E5%9B%BE%E7%89%87%E6%9C%89%E5%8F%AF%E8%83%BD%E4%BC%9A%E5%BC%95%E8%B5%B7%E4%B8%8D%E9%80%82%3C%2Fdiv%3E%0A%20%20%20%20%20%20%20%20%20%20%3Cbutton%20style%3D%22padding%3A%204px%201em%3B%20font-size%3A%201.1em%3B%20color%3A%20inherit%3B%20background%3A%20none%3B%20border%3A%201px%20solid%20rgba%28255%2C255%2C255%2C.5%29%3B%20border-radius%3A%209999px%3B%22%3E%E7%BB%A7%E7%BB%AD%E6%9F%A5%E7%9C%8B%3C%2Fbutton%3E%0A%20%20%20%20%20%20%20%20%3C%2Fdiv%3E%0A%20%20%20%20%20%20%3C%2Fdiv%3E%0A%20%20%20%20%3C%2FforeignObject%3E%3C%2Fsvg%3E);width:100%;height:194px;background:url(https://pic1.zhimg.com/v2-cf70d0759d787c70091857151c1cad4a.jpeg) no-repeat rgba(191,191,191,0.7);background-size:cover;cursor:pointer!important;}.css-1ygg4xu img.content_image[data-size="normal"],.css-1ygg4xu img.origin_image[data-size="normal"]{width:100%;max-width:100%;}.css-1ygg4xu img.content_image[data-size="small"],.css-1ygg4xu img.origin_image[data-size="small"]{width:320px;max-width:100%;}@-webkit-keyframes animation-1yvu044{from{opacity:0;}to{opacity:1;}}@keyframes animation-1yvu044{from{opacity:0;}to{opacity:1;}}</style><style class="darkreader darkreader--sync" media="screen"></style><style data-emotion-css="ch8ocw">.css-ch8ocw{position:relative;display:inline-block;height:30px;padding:0 12px;font-size:14px;line-height:30px;color:#1772F6;vertical-align:top;border-radius:100px;background:rgba(23,114,246,0.1);}.css-ch8ocw:hover{background-color:rgba(23,114,246,0.15);}</style><style class="darkreader darkreader--sync" media="screen"></style><style data-emotion-css="1xlfegr">.css-1xlfegr{background:transparent;box-shadow:none;}</style><style class="darkreader darkreader--sync" media="screen"></style><style data-emotion-css="1gomreu">.css-1gomreu{position:relative;display:inline-block;}</style><style class="darkreader darkreader--sync" media="screen"></style><style data-emotion-css="1u7r5c9">.css-1u7r5c9{box-sizing:border-box;margin:0;min-width:0;max-width:100%;height:auto;background-color:#ffffff;width:40px;height:40px;border-radius:50%;}</style><style class="darkreader darkreader--sync" media="screen"></style><style type="text/css">.Marquee_module_marquee__218919a6 {
  overflow: hidden;
}

.Marquee_module_marqueeText__218919a6 {
  position: relative;
  transition: all 0.5s ease-in-out;
}
.Marquee_module_noAnimation__218919a6 {
  transition: none;
}

.Marquee_module_marqueeItem__218919a6 {
  display: flex;
  align-items: center;
  flex-wrap: nowrap;
  overflow: hidden;
  flex: 1;
}
</style><style class="darkreader darkreader--sync" media="screen"></style><style data-emotion="css"></style><style class="darkreader darkreader--sync" media="screen"></style></head><body class="WhiteBg-body PostIndex-body Body--isAppleDevice" aria-basefontsize="16" data-rh="class"><a id="ariaTipText" role="pagedescription" aria-label="欢迎进入 cute 之 Tensor - 知乎,盲人用户使用操作智能引导，请按快捷键Ctrl+Alt+R；阅读详细操作说明请按快捷键Ctrl+Alt+问号键。" aria-atomic="true" href="javascript:void(0)" class="skipAutoFix" style="width: 1px; height: 1px;"><img src="https://zhuanlan.zhihu.com/p/663093816" style="width:1px !important;height:1px !important;position:absolute;top:0;"></a><div id="root"><div class="App"><div class="LoadingBar  css-55n9hh"></div><div><span style="position:absolute;top:-10000px;left:-10000px" role="log" aria-live="assertive"></span></div><main role="main" class="App-main"><div class="Post-content" data-zop-usertoken="{&quot;userToken&quot;:&quot;qyjdef&quot;}" data-zop="{&quot;authorName&quot;:&quot;reed&quot;,&quot;itemId&quot;:663093816,&quot;title&quot;:&quot;cute 之 Tensor&quot;,&quot;type&quot;:&quot;article&quot;}" data-za-detail-view-path-module="PostItem" data-za-extra-module="{&quot;card&quot;:{&quot;content&quot;:{&quot;type&quot;:&quot;Post&quot;,&quot;token&quot;:&quot;663093816&quot;}}}"><div class="ColumnPageHeader-Wrapper"><div><div class="Sticky ColumnPageHeader is-fixed css-1l12z7y" style="width: 1718.86px; top: 0px; left: 0px;"><div class="ColumnPageHeader-content"><a href="https://www.zhihu.com/" aria-label="知乎"><svg viewBox="0 0 64 30" fill="#1772F6" width="64" height="30" class="css-1hlrcxk" data-darkreader-inline-fill="" style="--darkreader-inline-fill: #0751bc;"><path d="M29.05 4.582H16.733V25.94h3.018l.403 2.572 4.081-2.572h4.815V4.582zm-5.207 18.69l-2.396 1.509-.235-1.508h-1.724V7.233h6.78v16.04h-2.425zM14.46 14.191H9.982c0-.471.033-.954.039-1.458v-5.5h5.106V5.935a1.352 1.352 0 0 0-.404-.957 1.378 1.378 0 0 0-.968-.396H5.783c.028-.088.056-.177.084-.255.274-.82 1.153-3.326 1.153-3.326a4.262 4.262 0 0 0-2.413.698c-.57.4-.912.682-1.371 1.946-.532 1.453-.997 2.856-1.31 3.693C1.444 8.674.28 11.025.28 11.025a5.85 5.85 0 0 0 2.52-.61c1.119-.593 1.679-1.502 2.054-2.883l.09-.3h2.334v5.5c0 .5-.045.982-.073 1.46h-4.12c-.71 0-1.39.278-1.893.775a2.638 2.638 0 0 0-.783 1.874h6.527a17.717 17.717 0 0 1-.778 3.649 16.796 16.796 0 0 1-3.012 5.273A33.104 33.104 0 0 1 0 28.74s3.13 1.175 5.425-.954c1.388-1.292 2.631-3.814 3.23-5.727a28.09 28.09 0 0 0 1.12-5.229h5.967v-1.37a1.254 1.254 0 0 0-.373-.899 1.279 1.279 0 0 0-.909-.37z"></path><path d="M11.27 19.675l-2.312 1.491 5.038 7.458a6.905 6.905 0 0 0 .672-2.218 3.15 3.15 0 0 0-.28-2.168l-3.118-4.563zM51.449 15.195V5.842c4.181-.205 7.988-.405 9.438-.483l.851-.05c.387-.399.885-2.395.689-3.021-.073-.25-.213-.666-.638-.555a33.279 33.279 0 0 1-4.277.727c-2.766.321-3.97.404-7.804.682-6.718.487-12.709.72-12.709.72a2.518 2.518 0 0 0 .788 1.834 2.567 2.567 0 0 0 1.883.706c2.278-.095 5.598-.25 8.996-.41v9.203h-12.78c0 .703.281 1.377.783 1.874a2.69 2.69 0 0 0 1.892.777h10.105v7.075c0 .887-.464 1.192-1.231 1.214h-3.92a4.15 4.15 0 0 0 .837 1.544 4.2 4.2 0 0 0 1.403 1.067 6.215 6.215 0 0 0 2.71.277c1.36-.066 2.967-.826 2.967-3.57v-7.607h11.28c.342 0 .67-.135.91-.374.242-.239.378-.563.378-.902v-1.375H51.449z"></path><path d="M42.614 8.873a2.304 2.304 0 0 0-1.508-.926 2.334 2.334 0 0 0-1.727.405l-.376.272 4.255 5.85 2.24-1.62-2.884-3.98zM57.35 8.68l-3.125 4.097 2.24 1.663 4.517-5.927-.375-.277a2.32 2.32 0 0 0-1.722-.452 2.327 2.327 0 0 0-1.536.896z"></path></svg></a><i class="ColumnPageHeader-Line"></i><div class="ColumnPageHeader-Title"><div class="ColumnPageHeader-TitleName"><span class="ColumnPageHeader-TitleMeta">首发于</span><a class="ColumnLink ColumnPageHeader-TitleColumn" href="https://www.zhihu.com/column/c_1696937812497235968">CUDA高性能编程</a></div></div><div class="ColumnPageHeader-Button"><div class="Popover"><button title="更多" id="Popover1-toggle" aria-haspopup="true" aria-expanded="false" type="button" class="Button ColumnPageHeader-MenuToggler FEfUrdfMIKpQDJDqkjte Button--plain fEPKGkUK5jyc4fUuT0QP"><svg width="24" height="24" viewBox="0 0 24 24" class="Zi Zi--Dots" fill="currentColor" data-darkreader-inline-fill="" style="--darkreader-inline-fill: currentColor;"><path d="M6 10.5a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3ZM10.5 12a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0ZM16.5 12a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0Z"></path></svg></button></div><button type="button" class="Button ColumnPageHeader-WriteButton FEfUrdfMIKpQDJDqkjte Button--blue JmYzaky7MEPMFcJDLNMG"><svg width="24" height="24" viewBox="0 0 24 24" class="Zi Zi--EditSurround" fill="currentColor" data-darkreader-inline-fill="" style="--darkreader-inline-fill: currentColor;"><path d="M4.352 6.804A2.554 2.554 0 0 1 6.905 4.25h6.072a.875.875 0 0 0 0-1.75H6.905a4.304 4.304 0 0 0-4.303 4.304v10.142a4.304 4.304 0 0 0 4.303 4.304h10.143a4.304 4.304 0 0 0 4.304-4.304v-6.071a.875.875 0 0 0-1.75 0v6.071a2.554 2.554 0 0 1-2.554 2.554H6.905a2.554 2.554 0 0 1-2.553-2.554V6.804Z"></path><path d="M20.595 4.731a.875.875 0 1 0-1.237-1.237l-7.763 7.762a.875.875 0 1 0 1.238 1.238l7.762-7.763Z"></path></svg>写文章</button></div></div><div class="ColumnPageHeader-profile"><div class="Popover AppHeader-menu"><button id="Popover4-toggle" aria-haspopup="true" aria-expanded="false" type="button" class="Button AppHeader-profileEntry FEfUrdfMIKpQDJDqkjte Button--plain fEPKGkUK5jyc4fUuT0QP"><img class="Avatar AppHeader-profileAvatar css-fnnb9l" src="./cute 之 Tensor - 知乎_files/v2-c58ab06f0991ecef82f9d358f471cfd3_l.jpg" srcset="https://pica.zhimg.com/v2-c58ab06f0991ecef82f9d358f471cfd3_l.jpg?source=32738c0c 2x" alt="点击打开DefTruth的主页"></button></div><div class="Popover ddLajxN_Q0AuobBZjX9m AppHeaderProfileMenu-creatorHintPopover"><div class="AppHeaderProfileMenu-creatorHintToggler" id="Popover5-toggle" aria-haspopup="true" aria-expanded="false"></div></div></div></div><div class="Sticky--holder" style="position: relative; inset: 0px; display: block; float: none; margin: 0px; height: 52px;"></div></div></div><div class="css-78p1r9"><div class="css-grd3se"><div class="css-1ld0bim"><span style="box-sizing: border-box; display: block; overflow: hidden; width: initial; height: initial; background: none; opacity: 1; border: 0px; margin: 0px; padding: 0px; --darkreader-inline-bgimage: none; --darkreader-inline-bgcolor: initial; --darkreader-inline-border-top: 0px; --darkreader-inline-border-right: 0px; --darkreader-inline-border-bottom: 0px; --darkreader-inline-border-left: 0px;" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left=""><picture><source type="image/avif" srcset="https://picx.zhimg.com/70/v2-8db31200d4ae0956591ceb309d19962a_1440w.avis?source=172ae18b&amp;biz_tag=Post 1x, https://picx.zhimg.com/70/v2-8db31200d4ae0956591ceb309d19962a_1440w.avis?source=172ae18b&amp;biz_tag=Post 2x" src="https://picx.zhimg.com/70/v2-8db31200d4ae0956591ceb309d19962a_1440w.avis?source=172ae18b&amp;biz_tag=Post"><source type="image/webp" srcset="https://picx.zhimg.com/70/v2-8db31200d4ae0956591ceb309d19962a_1440w.awebp?source=172ae18b&amp;biz_tag=Post 1x, https://picx.zhimg.com/70/v2-8db31200d4ae0956591ceb309d19962a_1440w.awebp?source=172ae18b&amp;biz_tag=Post 2x" src="https://picx.zhimg.com/70/v2-8db31200d4ae0956591ceb309d19962a_1440w.awebp?source=172ae18b&amp;biz_tag=Post"><img alt="cute 之 Tensor" decoding="async" style="position: absolute; inset: 0px; box-sizing: border-box; padding: 0px; border: none; margin: auto; display: block; width: 0px; height: 0px; min-width: 100%; max-width: 100%; min-height: 100%; max-height: 100%; --darkreader-inline-border-top: none; --darkreader-inline-border-right: none; --darkreader-inline-border-bottom: none; --darkreader-inline-border-left: none;" width="100%" src="./cute 之 Tensor - 知乎_files/v2-8db31200d4ae0956591ceb309d19962a_1440w.image" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="" srcset="https://picx.zhimg.com/70/v2-8db31200d4ae0956591ceb309d19962a_1440w.image?source=172ae18b&amp;biz_tag=Post 1x, https://picx.zhimg.com/70/v2-8db31200d4ae0956591ceb309d19962a_1440w.image?source=172ae18b&amp;biz_tag=Post 2x"></picture></span></div></div></div><article class="Post-Main Post-NormalMain" tabindex="-1"><header class="Post-Header"><h1 class="Post-Title">cute 之 Tensor</h1><div class="Post-Author"><div class="AuthorInfo" itemprop="author" itemscope="" itemtype="http://schema.org/Person"><div class="AuthorInfo"><meta itemprop="name" content="reed"><meta itemprop="image" content="https://picx.zhimg.com/v2-e9c299bcbb6d098601ce529e9a358d82_l.jpg?source=172ae18b"><meta itemprop="url" content="https://www.zhihu.com/people/reed-84-49"><meta itemprop="zhihu:followerCount"><span class="UserLink AuthorInfo-avatarWrapper"><div class="css-1gomreu"><a href="https://www.zhihu.com/people/reed-84-49" target="_blank" class="UserLink-link" data-za-detail-view-element_name="User"><img class="Avatar AuthorInfo-avatar css-1syywx2" src="./cute 之 Tensor - 知乎_files/v2-e9c299bcbb6d098601ce529e9a358d82_l.jpg" srcset="https://picx.zhimg.com/v2-e9c299bcbb6d098601ce529e9a358d82_l.jpg?source=172ae18b 2x" alt="reed"></a></div></span><div class="AuthorInfo-content"><div class="AuthorInfo-head"><span class="UserLink AuthorInfo-name"><div class="css-1gomreu"><a href="https://www.zhihu.com/people/reed-84-49" target="_blank" class="UserLink-link" data-za-detail-view-element_name="User">reed</a></div><a href="https://www.zhihu.com/question/48510028" target="_blank" class="css-4gq0sj" aria-label="中国科学院大学 理学博士" data-tooltip="中国科学院大学 理学博士"><span style="display:inline-flex;align-items:center">​<svg width="18" height="18" fill="none" viewBox="0 0 24 24" class="ZDI ZDI--BadgeCertNewStrokeLightFill24 css-1ldqog6"><path fill="#fff" d="M12 2c-2.02.05-1.86 1.2-3.38 1.83-1.48.61-2.33-.26-3.69 1.1-1.39 1.47-.46 2.17-1.1 3.69C3.2 10.14 2.05 9.98 2 12c.05 2.02 1.2 1.86 1.83 3.38.63 1.52-.3 2.22 1.1 3.69 1.36 1.35 2.21.49 3.69 1.1 1.52.63 1.36 1.78 3.38 1.83 2.02-.05 1.86-1.2 3.38-1.83 1.48-.61 2.33.26 3.69-1.1 1.39-1.47.46-2.16 1.1-3.69.63-1.52 1.78-1.36 1.83-3.38-.05-2.02-1.2-1.86-1.83-3.38-.63-1.52.3-2.22-1.1-3.69-1.36-1.35-2.21-.49-3.69-1.1C13.86 3.2 14.02 2.05 12 2Z" style="fill: rgb(255, 255, 255); fill-opacity: 1; --darkreader-inline-fill: #e8e6e3;" data-darkreader-inline-fill=""></path><path fill="url(#id-106203557-a)" fill-rule="evenodd" d="M3 12c0 1.449 1.035 1.251 1.755 2.997s-.144 2.34.882 3.366c1.026 1.026 1.62.153 3.366.882C10.749 19.965 10.551 21 12 21c1.449 0 1.251-1.035 2.997-1.755s2.34.144 3.366-.882c1.026-1.026.153-1.62.882-3.366C19.965 13.251 21 13.44 21 12c0-1.449-1.035-1.251-1.755-2.997s.144-2.34-.882-3.366c-1.026-1.026-1.62-.153-3.366-.882C13.251 4.035 13.449 3 12 3c-1.449 0-1.251 1.035-2.997 1.755s-2.34-.144-3.366.882c-1.026 1.026-.153 1.62-.882 3.366C4.035 10.749 3 10.551 3 12Z" clip-rule="evenodd"></path><path fill="#fff" fill-rule="evenodd" d="m10.003 15.355-2.37-2.699s-.413-.634.217-1.226c.63-.591 1.195-.197 1.195-.197l1.758 1.92 4.226-4.439s.597-.313 1.17.178c.572.49.243 1.244.243 1.244s-3.12 3.472-4.839 5.204c-.881.837-1.6.015-1.6.015Z" clip-rule="evenodd" style="fill: rgb(255, 255, 255); fill-opacity: 1; --darkreader-inline-fill: #e8e6e3;" data-darkreader-inline-fill=""></path><defs><lineargradient id="id-106203557-a" x1="5.7" x2="15.6" y1="5.7" y2="19.2" gradientUnits="userSpaceOnUse"><stop stop-color="#47D3FF" style="stop-color: rgb(71, 211, 255); stop-opacity: 1; --darkreader-inline-stopcolor: #4bd4ff;" data-darkreader-inline-stopcolor=""></stop><stop offset="1" stop-color="#4A7DFF" style="--darkreader-inline-stopcolor: #002da0;" data-darkreader-inline-stopcolor=""></stop></lineargradient></defs></svg></span></a></span></div><div class="AuthorInfo-detail"><div class="AuthorInfo-badge"><div class="ztext AuthorInfo-badgeText css-0">中国科学院大学 理学博士</div></div></div></div></div></div><button type="button" class="Button FollowButton FEfUrdfMIKpQDJDqkjte Button--primary Button--grey epMJl0lFQuYbC7jrwr_o ZdfrHW7Ef5ZjwFiiBJuS">已关注</button></div><div class="LabelContainer-wrapper"><div class="LabelContainer css-36m2wi"><div><div class="css-vphnkw" style="cursor: pointer;"><div class="css-4rl99m"><div class="css-140fcia">创作声明: 内容包含剧透</div></div><svg width="26" height="26" viewBox="0 0 24 24" fill="#09408e" class="Zi Zi--ArrowDown css-ouwgqw" data-darkreader-inline-fill="" style="--darkreader-inline-fill: #7abbf7;"><path fill-rule="evenodd" d="M17.776 10.517a.875.875 0 0 1-.248 1.212l-5.05 3.335a.875.875 0 0 1-.964 0L6.47 11.73a.875.875 0 1 1 .965-1.46l4.56 3.015 4.568-3.016a.875.875 0 0 1 1.212.248Z" clip-rule="evenodd"></path></svg></div></div></div></div><div><div class="css-dvccr2"><div class="css-1lr85n">zzk again、我自己 等 86 人赞同了该文章</div></div></div><span class="css-z4ujak"></span></header><div class="Post-RichTextContainer"><div class="css-1od93p9"><div class="css-376mun"><div class="css-l44lgl"><div class="css-g7war6"><div class="css-s1xz2x"><div><div class="Catalog isCatalogV2 css-17v5fjs" data-za-detail-view-name="正文"><div class="css-8kjoqe"><div class="css-1e6hvbc"><div class="css-zkfaav"><span style="display: inline-flex; align-items: center;">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="ZDI ZDI--Catalog24" fill="currentColor" data-darkreader-inline-fill="" style="--darkreader-inline-fill: currentColor;"><path d="M10 5a1 1 0 011-1h10a1 1 0 110 2H11a1 1 0 01-1-1zm4 6a1 1 0 100 2h7a1 1 0 100-2h-7zm0 7a1 1 0 100 2h7a1 1 0 100-2h-7zm-8.335.25a.915.915 0 01-.915-.915V12.75H10a.75.75 0 000-1.5H4.75V6.665c0-.505.41-.915.915-.915H7a.75.75 0 000-1.5H5.665A2.415 2.415 0 003.25 6.665v10.67a2.415 2.415 0 002.415 2.415H10a.75.75 0 000-1.5H5.665z"></path></svg></span><div class="css-5287jj">目录</div></div><div class="css-1ifd8ga">收起</div></div></div><div class="css-vm33ny"><div class="Catalog-content css-a3sv8e"><div class="Catalog-FirstLevelTitle Catalog-Title css-lvmdsl"><div data-catalog-target-id="h_663093816_0" data-za-detail-view-id="9745" data-za-detail-view-action="Click" data-za-detail-view-name="正文" class="css-byi3it"><div class="css-nj7ofv">Tensor的生成</div></div></div><div class="Catalog-FirstLevelTitle Catalog-Title css-lvmdsl"><div data-catalog-target-id="h_663093816_1" data-za-detail-view-id="9745" data-za-detail-view-action="Click" data-za-detail-view-name="正文" class="css-byi3it"><div class="css-nj7ofv">Tensor维度信息查询</div></div></div><div class="Catalog-FirstLevelTitle Catalog-Title css-lvmdsl"><div data-catalog-target-id="h_663093816_2" data-za-detail-view-id="9745" data-za-detail-view-action="Click" data-za-detail-view-name="正文" class="css-byi3it"><div class="css-nj7ofv">Tensor的访问operator()/operator[]</div></div></div><div class="Catalog-FirstLevelTitle Catalog-Title css-lvmdsl"><div data-catalog-target-id="h_663093816_3" data-za-detail-view-id="9745" data-za-detail-view-action="Click" data-za-detail-view-name="正文" class="css-byi3it"><div class="css-nj7ofv">Tensor的Slice</div></div></div><div class="Catalog-FirstLevelTitle Catalog-Title css-lvmdsl"><div data-catalog-target-id="h_663093816_4" data-za-detail-view-id="9745" data-za-detail-view-action="Click" data-za-detail-view-name="正文" class="css-byi3it"><div class="css-nj7ofv">Tensor的Take</div></div></div><div class="Catalog-FirstLevelTitle Catalog-Title css-lvmdsl"><div data-catalog-target-id="h_663093816_5" data-za-detail-view-id="9745" data-za-detail-view-action="Click" data-za-detail-view-name="正文" class="css-byi3it"><div class="css-nj7ofv">Tensor的flatten</div></div></div><div class="Catalog-FirstLevelTitle Catalog-Title css-lvmdsl"><div data-catalog-target-id="h_663093816_6" data-za-detail-view-id="9745" data-za-detail-view-action="Click" data-za-detail-view-name="正文" class="css-byi3it"><div class="css-nj7ofv">Tensor的层级合并coalesce</div></div></div><div class="Catalog-FirstLevelTitle Catalog-Title css-lvmdsl"><div data-catalog-target-id="h_663093816_7" data-za-detail-view-id="9745" data-za-detail-view-action="Click" data-za-detail-view-name="正文" class="css-byi3it"><div class="css-nj7ofv">Tensor的主轴层级化group_modes</div></div></div><div class="Catalog-FirstLevelTitle Catalog-Title css-lvmdsl"><div data-catalog-target-id="h_663093816_8" data-za-detail-view-id="9745" data-za-detail-view-action="Click" data-za-detail-view-name="正文" class="css-byi3it"><div class="css-nj7ofv">Tensor的划分logical_divide/tiled_divide/zipped_divide</div></div></div><div class="Catalog-FirstLevelTitle Catalog-Title css-lvmdsl"><div data-catalog-target-id="h_663093816_9" data-za-detail-view-id="9745" data-za-detail-view-action="Click" data-za-detail-view-name="正文" class="css-byi3it"><div class="css-nj7ofv">Layout的乘积logical/zipped/tiled/blocked/raked</div></div></div><div class="Catalog-FirstLevelTitle Catalog-Title css-lvmdsl"><div data-catalog-target-id="h_663093816_10" data-za-detail-view-id="9745" data-za-detail-view-action="Click" data-za-detail-view-name="正文" class="css-byi3it"><div class="css-nj7ofv">Tensor的局部化切块local_tile</div></div></div><div class="Catalog-FirstLevelTitle Catalog-Title css-lvmdsl"><div data-catalog-target-id="h_663093816_11" data-za-detail-view-id="9745" data-za-detail-view-action="Click" data-za-detail-view-name="正文" class="css-byi3it"><div class="css-nj7ofv">Tensor的局部数据提取local_partition</div></div></div><div class="Catalog-FirstLevelTitle Catalog-Title css-lvmdsl"><div data-catalog-target-id="h_663093816_12" data-za-detail-view-id="9745" data-za-detail-view-action="Click" data-za-detail-view-name="正文" class="css-byi3it"><div class="css-nj7ofv">Tensor数据类型转换recast</div></div></div><div class="Catalog-FirstLevelTitle Catalog-Title css-lvmdsl"><div data-catalog-target-id="h_663093816_13" data-za-detail-view-id="9745" data-za-detail-view-action="Click" data-za-detail-view-name="正文" class="css-byi3it"><div class="css-nj7ofv">Tensor内容的填充fill和清除clear</div></div></div><div class="Catalog-FirstLevelTitle Catalog-Title css-lvmdsl"><div data-catalog-target-id="h_663093816_14" data-za-detail-view-id="9745" data-za-detail-view-action="Click" data-za-detail-view-name="正文" class="css-byi3it"><div class="css-nj7ofv">Tensor的线性组合axpby</div></div></div><div class="Catalog-FirstLevelTitle Catalog-Title css-lvmdsl"><div data-catalog-target-id="h_663093816_15" data-za-detail-view-id="9745" data-za-detail-view-action="Click" data-za-detail-view-name="正文" class="css-byi3it"><div class="css-nj7ofv">Tensor的打印print</div></div></div><div class="Catalog-FirstLevelTitle Catalog-Title css-lvmdsl"><div data-catalog-target-id="h_663093816_16" data-za-detail-view-id="9745" data-za-detail-view-action="Click" data-za-detail-view-name="正文" class="css-byi3it"><div class="css-nj7ofv">特殊矩阵</div></div></div><div class="Catalog-FirstLevelTitle Catalog-Title css-lvmdsl"><div data-catalog-target-id="h_663093816_17" data-za-detail-view-id="9745" data-za-detail-view-action="Click" data-za-detail-view-name="正文" class="css-byi3it"><div class="css-nj7ofv">使用Tensor实现Vector Add示例：</div></div></div><div class="Catalog-FirstLevelTitle Catalog-Title css-lvmdsl"><div data-catalog-target-id="h_663093816_18" data-za-detail-view-id="9745" data-za-detail-view-action="Click" data-za-detail-view-name="正文" class="css-byi3it"><div class="css-nj7ofv">总结与讨论</div></div></div></div></div></div></div></div></div></div><div class="RichText ztext Post-RichText css-1ygg4xu" options="[object Object]"><p data-first-child="" data-pid="O2cYeFBa">前面的章节介绍了<a href="https://zhuanlan.zhihu.com/p/661182311" class="internal" data-za-detail-view-id="1043">cute Layout</a>以及<a href="https://zhuanlan.zhihu.com/p/662089556" class="internal" data-za-detail-view-id="1043">Layout的代数和几何解释</a>，Layout描述了数据的排列和底层存储位置关系，但Layout并没有指定存储。Tensor就是在Layout的基础上包含了存储，即Tensor = Layout + storage，数据存储的具体表现上可以是指针表达的数据或则是栈上数据（GPU上表现为寄存器）。cute中的Tensor并不同于深度学习框架中的Tensor（如Pytorch、Tensorflow），深度学习框架中的Tensor更强调数据的表达实体，通过Tensor实体与实体之间的计算产生新的Tensor实体，即多份数据实体，cute中的Tensor更多的是对Tensor进行分解和组合等操作，而这些操作多是对Layout的变换（只是逻辑层面的数据组织形式），底层的数据实体一般不变更。也就是说深度学习框架中的Tensor是通过Tensor产生新Tensor，cute中是对数据表达形式的变换，底层数据一般不变更，指变更表达的形式，这个表达形式的变更是通过之前文章介绍的Layout上的运算实现的。之所以有这些差别是因为深度学习框架中的Tensor是用来表达数据实体，cute中的Tensor是偏向描述的实体。</p><p data-pid="VXxICH8F">本文介绍了cute中Tensor的相关操作，通过阅读本文，开发者可以了解cute中Tensor的常用方法，熟悉Tensor方法的语义，为后续通过Tensor进行操作和变换提供基础知识。在文章结构方面，本文首先介绍cute中Tensor的常用函数，然后以一个向量求和的例子展示如何使用cute Tensor工具，最后文章对Tensor的特性和使用进行了总结。</p><h2 id="h_663093816_0" data-into-catalog-status="">Tensor的生成</h2><div class="highlight"><pre><code class="language-cpp"><span class="c1">// 栈上对象：需同时指定类型和Layout，layout必须是静态shape
</span><span class="c1"></span><span class="n">Tensor</span> <span class="n">make_tensor</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="p">(</span><span class="n">Layout</span> <span class="n">layout</span><span class="p">);</span>

<span class="c1">// 堆上对象：需指定pointer和Layout，layout可动可静
</span><span class="c1"></span><span class="n">Tensor</span> <span class="nf">make_tensor</span><span class="p">(</span><span class="n">Pointer</span> <span class="n">pointer</span><span class="p">,</span> <span class="n">Layout</span> <span class="n">layout</span><span class="p">);</span>
 
<span class="c1">// 栈上对象，tensor的layout必须是静态的
</span><span class="c1"></span><span class="n">Tensor</span> <span class="nf">make_tensor_like</span><span class="p">(</span><span class="n">Tensor</span> <span class="n">tensor</span><span class="p">);</span> 

<span class="c1">// 栈上对象，tensor的layout必须是静态的
</span><span class="c1"></span><span class="n">Tensor</span> <span class="nf">make_fragment_like</span><span class="p">(</span><span class="n">Tensor</span> <span class="n">tensor</span><span class="p">);</span>
</code></pre></div><p data-pid="UQOWqIrY">通过make_tensor可以方便的生成Tensor，常用的Tensor构造方式有两种，一种是栈上对象，如上形式1；第二种是堆上对象，通过指定pointer来实现；线性地址指针pointer，layout描述pointer指向的数据的layout，其可以是多hierarchy的。其中pointer可以通过<code>make_gmem_ptr, make_smem_ptr</code>来生成。其中栈上的对象必须是静态的，堆上对象可以是动态也可以是静态，不存在动态的栈上结构，整体如下表格：</p><table data-draft-node="block" data-draft-type="table" data-size="normal" data-row-style="normal"><tbody><tr><td></td><td>Static</td><td>Dynamic</td></tr><tr><td>Heap<br>non-owning</td><td>make_tensor(ptr, make_shape(Int&lt;M&gt;{}, Int&lt;N&gt;{}));<br>make_tensor_like(tensor);make_fragment_like(tensor);</td><td>make_tensor(ptr, make_shape(M, N));</td></tr><tr><td>Stack<br>owning</td><td>make_tensor(make_shape(Int&lt;M&gt;, Int&lt;N&gt;{}));<br>make_tensor_like(tensor);<br>make_fragment_like(tensor);</td><td>NA</td></tr></tbody></table><h2 id="h_663093816_1" data-into-catalog-status="">Tensor维度信息查询</h2><p data-pid="IKc7OLgq">全局<code>size</code>函数可以获取tensor的元素的个数。其重载了比较运算，可以直接和整数类型进行比较。同时Tensor也提供了面向对象的方式来获取各个属性信息，其成员函数和全局函数如下：</p><div class="highlight"><pre><code class="language-cpp"><span class="c1">// 成员函数
</span><span class="c1"></span><span class="n">Tensor</span><span class="o">::</span><span class="n">layout</span><span class="p">();</span>
<span class="n">Tensor</span><span class="o">::</span><span class="n">shape</span><span class="p">();</span>
<span class="n">Tensor</span><span class="o">::</span><span class="n">stride</span><span class="p">();</span>
<span class="n">Tensor</span><span class="o">::</span><span class="n">size</span><span class="p">();</span>

<span class="c1">// 全局函数, 可以获取完整信息，或者通过&lt;&gt;获取某一个维度
</span><span class="c1"></span><span class="k">auto</span> <span class="n">cute</span><span class="o">::</span><span class="n">layout</span><span class="o">&lt;&gt;</span><span class="p">(</span><span class="n">Tensor</span> <span class="n">tensor</span><span class="p">);</span>
<span class="k">auto</span> <span class="n">cute</span><span class="o">::</span><span class="n">shape</span><span class="o">&lt;&gt;</span><span class="p">(</span><span class="n">Tensor</span> <span class="n">tensor</span><span class="p">);</span>
<span class="k">auto</span> <span class="n">cute</span><span class="o">::</span><span class="n">stride</span><span class="o">&lt;&gt;</span><span class="p">(</span><span class="n">Tensor</span> <span class="n">tensor</span><span class="p">);</span>
<span class="k">auto</span> <span class="n">cute</span><span class="o">::</span><span class="n">size</span><span class="o">&lt;&gt;</span><span class="p">(</span><span class="n">Tensor</span> <span class="n">tensor</span><span class="p">);</span>
<span class="k">auto</span> <span class="n">cute</span><span class="o">::</span><span class="n">rank</span><span class="o">&lt;&gt;</span><span class="p">(</span><span class="n">Tensor</span> <span class="n">tensor</span><span class="p">);</span> <span class="c1">// (1, (2, 3)) =&gt; rank 2 
</span><span class="c1"></span><span class="k">auto</span> <span class="n">cute</span><span class="o">::</span><span class="n">depth</span><span class="o">&lt;&gt;</span><span class="p">(</span><span class="n">Tensor</span> <span class="n">tensor</span><span class="p">);</span>
</code></pre></div><h2 id="h_663093816_2" data-into-catalog-status="">Tensor的访问operator()/operator[]</h2><p data-pid="4RtdxW8T">Tensor可以通过<b>括号运算符</b>来实现对数据的访问（可读+可写）, 坐标可以使用一维的，也可以使用有层次的表示形式，具体的如下：</p><div class="highlight"><pre><code class="language-cpp"><span class="n">Tensor</span> <span class="n">tensor</span> <span class="o">=</span> <span class="n">make_tensor</span><span class="p">(</span><span class="n">ptr</span><span class="p">,</span> <span class="n">layout</span><span class="p">);</span>
<span class="k">auto</span> <span class="n">coord</span> <span class="o">=</span> <span class="n">make_coord</span><span class="p">(</span><span class="n">irow</span><span class="p">,</span> <span class="n">icol</span><span class="p">);</span>

<span class="n">tensor</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="n">tensor</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="mi">100</span><span class="p">;</span>
<span class="n">tensor</span><span class="p">(</span><span class="n">coord</span><span class="p">)</span> <span class="o">=</span> <span class="mi">200</span><span class="p">;</span>
</code></pre></div><p data-pid="Zd-1jxaA">也可以通过<code>data</code>函数直接获取数据存储空间的地址</p><div class="highlight"><pre><code class="language-text">Tensor::data();</code></pre></div><h2 id="h_663093816_3" data-into-catalog-status="">Tensor的Slice</h2><p data-pid="XpGjz__v">可以通过<code>_</code>来筛选（slice）特定轴，和Layout的表达形式一致，具体的代码如下：</p><div class="highlight"><pre><code class="language-cpp"><span class="n">Tensor</span> <span class="n">tensor</span> <span class="o">=</span> <span class="n">make_tensor</span><span class="p">(</span><span class="n">ptr</span><span class="p">,</span> <span class="n">make_shape</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">N</span><span class="err">，</span> <span class="n">K</span><span class="p">));</span> <span class="c1">// MxNxK
</span><span class="c1"></span><span class="n">Tensor</span> <span class="n">tensor1</span> <span class="o">=</span> <span class="n">tensor</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span> <span class="c1">// MxN,k =3
</span></code></pre></div><h2 id="h_663093816_4" data-into-catalog-status="">Tensor的Take</h2><p data-pid="cLw_HiCs">通过take函数提取take出[B, E)的轴上的数据</p><div class="highlight"><pre><code class="language-cpp"><span class="n">Tensor</span> <span class="n">tensor</span> <span class="o">=</span> <span class="n">make_tensor</span><span class="p">(</span><span class="n">ptr</span><span class="p">,</span> <span class="n">make_shape</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">K</span><span class="p">));</span>
<span class="n">Tensor</span> <span class="n">tensor1</span> <span class="o">=</span> <span class="n">take</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="o">&gt;</span><span class="p">(</span><span class="n">tensor</span><span class="p">);</span>
</code></pre></div><h2 id="h_663093816_5" data-into-catalog-status="">Tensor的flatten</h2><p data-pid="vKyrp9Sq">将层次的layout展开为一层（不是将M，N，K 展开为 MNK）</p><div class="highlight"><pre><code class="language-cpp"><span class="n">Tensor</span> <span class="n">tensor</span> <span class="o">=</span> <span class="p">...;</span>  <span class="c1">// M，N，K
</span><span class="c1"></span><span class="n">Tensor</span> <span class="n">tensor1</span> <span class="o">=</span> <span class="n">flatten</span><span class="p">(</span><span class="n">tensor</span><span class="p">);</span>  <span class="c1">// M，N，K
</span></code></pre></div><h2 id="h_663093816_6" data-into-catalog-status="">Tensor的层级合并coalesce</h2><p data-pid="DDUG-NnM">层级中如果存在空间可连续的坐标，即stride意义下不存在空隙，则进行合并</p><div class="highlight"><pre><code class="language-cpp"><span class="n">Tensor</span> <span class="n">tensor</span> <span class="o">=</span> <span class="n">make_tensor</span><span class="p">(</span><span class="n">ptr</span><span class="p">,</span> <span class="n">make_shape</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">N</span><span class="p">));</span>
<span class="n">Tensor</span> <span class="n">tensor1</span> <span class="o">=</span> <span class="n">coalesce</span><span class="p">(</span><span class="n">tensor</span><span class="p">);</span>
</code></pre></div><h2 id="h_663093816_7" data-into-catalog-status="">Tensor的主轴层级化group_modes</h2><p data-pid="-Jg_nVaF">将[B,E)的主轴层级化为一个新的层级</p><div class="highlight"><pre><code class="language-cpp"><span class="n">Tensor</span> <span class="n">tensor</span> <span class="o">=</span> <span class="p">...;</span> <span class="c1">// 1, 2, 3, 4
</span><span class="c1"></span><span class="n">Tensor</span> <span class="n">tensor1</span> <span class="o">=</span> <span class="n">group_modes</span><span class="o">&lt;</span><span class="n">B</span><span class="p">,</span> <span class="n">E</span><span class="o">&gt;</span><span class="p">(</span><span class="n">tensor</span><span class="p">);</span> <span class="c1">// B=1,E=3 =&gt; 1, &lt;2, 3&gt;, 4
</span></code></pre></div><h2 id="h_663093816_8" data-into-catalog-status="">Tensor的划分logical_divide/tiled_divide/zipped_divide</h2><p data-pid="xd-piE3p">divide是将tensor进行按照tile参数的大小进行划分，具体的可以参考前序文章“cute Layout代数和几何解释”中的除法的解释：</p><div class="highlight"><pre><code class="language-cpp"><span class="n">Tensor</span> <span class="n">tensor</span> <span class="o">=</span> <span class="p">...;</span>
<span class="n">Tensor</span> <span class="n">tensor1</span> <span class="o">=</span> <span class="n">logical_divide</span><span class="p">(</span><span class="n">tensor</span><span class="p">,</span> <span class="n">tile</span><span class="p">);</span>
<span class="n">Tensor</span> <span class="n">tensor2</span> <span class="o">=</span> <span class="n">zipped_divide</span><span class="p">(</span><span class="n">tensor</span><span class="p">,</span> <span class="n">tile</span><span class="p">);</span>
<span class="n">Tensor</span> <span class="n">tensor3</span> <span class="o">=</span> <span class="n">tiled_divide</span><span class="p">(</span><span class="n">tensor</span><span class="p">,</span> <span class="n">tile</span><span class="p">);</span>
</code></pre></div><h2 id="h_663093816_9" data-into-catalog-status="">Layout的乘积logical/zipped/tiled/blocked/raked</h2><p data-pid="fG8M4BWW">Tensor上没有定义乘法，只有Layout上有乘法，其表达了<b>重复</b>的语义：</p><div class="highlight"><pre><code class="language-cpp"><span class="n">Layout</span>  <span class="o">=</span> <span class="p">..;</span>
<span class="n">Tile</span> <span class="n">tile</span> <span class="o">=</span> <span class="p">...;</span>
<span class="n">Layout</span> <span class="n">tensor1</span> <span class="o">=</span> <span class="n">logical_product</span><span class="p">(</span><span class="n">layout</span><span class="p">,</span> <span class="n">tile</span><span class="p">);</span>
<span class="n">Layout</span> <span class="n">tensor2</span> <span class="o">=</span> <span class="n">zipped_product</span><span class="p">(</span><span class="n">layout</span><span class="p">,</span> <span class="n">tile</span><span class="p">);</span>
<span class="n">Layout</span> <span class="n">tensor3</span> <span class="o">=</span> <span class="n">tiled_product</span><span class="p">(</span><span class="n">layout</span><span class="p">,</span> <span class="n">tile</span><span class="p">);</span>
<span class="n">Layout</span> <span class="n">tensor4</span> <span class="o">=</span> <span class="n">blocked_product</span><span class="p">(</span><span class="n">layout</span><span class="p">,</span> <span class="n">tile</span><span class="p">);</span>
<span class="n">Layout</span> <span class="n">tensor5</span> <span class="o">=</span> <span class="n">raked_product</span><span class="p">(</span><span class="n">layout</span><span class="p">,</span> <span class="n">tile</span><span class="p">);</span>
</code></pre></div><h2 id="h_663093816_10" data-into-catalog-status="">Tensor的局部化切块local_tile</h2><p data-pid="XHQNX6cz">该函数是Tensor中用户可以使用到的重要的函数，可以通过tile方法对tensor进行分块，通过local_tile可以实现从大的tensor中切取tile块，并且通过coord进行块的选取，以下代码展示了将维度为MNK的张量按照<code>2x3x4</code>的小块进行划分，取出其中的第<code>(1, 2, 3)</code>块。</p><div class="highlight"><pre><code class="language-cpp"><span class="n">Tensor</span> <span class="n">tensor</span> <span class="o">=</span> <span class="n">make_tensor</span><span class="p">(</span><span class="n">ptr</span><span class="p">,</span> <span class="n">make_shape</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">K</span><span class="p">));</span>
<span class="n">Tensor</span> <span class="n">tensor1</span> <span class="o">=</span> <span class="n">local_tile</span><span class="p">(</span><span class="n">tensor</span><span class="p">,</span> <span class="n">make_shape</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="err">，</span><span class="mi">4</span><span class="p">),</span> <span class="n">make_coord</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="err">，</span><span class="mi">3</span><span class="p">));</span>
</code></pre></div><figure data-size="normal"><noscript><img src="https://pic1.zhimg.com/v2-97d7483ee5a4ca0d5fb5657d0754c194_b.jpg" data-size="normal" data-rawwidth="1687" data-rawheight="882" class="origin_image zh-lightbox-thumb" width="1687" data-original="https://pic1.zhimg.com/v2-97d7483ee5a4ca0d5fb5657d0754c194_r.jpg"/></noscript><div><img src="data:image/svg+xml;utf8,&lt;svg xmlns=&#39;http://www.w3.org/2000/svg&#39; width=&#39;1687&#39; height=&#39;882&#39;&gt;&lt;/svg&gt;" data-size="normal" data-rawwidth="1687" data-rawheight="882" class="origin_image zh-lightbox-thumb lazy" width="1687" data-original="https://pic1.zhimg.com/v2-97d7483ee5a4ca0d5fb5657d0754c194_r.jpg" data-actualsrc="https://pic1.zhimg.com/v2-97d7483ee5a4ca0d5fb5657d0754c194_b.jpg" data-original-token="v2-7fc05e3a5603c600955729c5e2e4134c"></div><figcaption>Figure 1. local tile的几何解释</figcaption></figure><p data-pid="dUupOyRC">如上图1所示，A Tensor表达了4行6列的行优先的数据，分块的tile大小为2x2, local_tile会将A矩阵按照tile的单位进行分块，然后根据坐标选取出(1, 1)位置的分块，如图则取出了（1，1）位置的tensor得到右下角的结果。</p><h2 id="h_663093816_11" data-into-catalog-status="">Tensor的局部数据提取local_partition</h2><p data-pid="AVCKBFCX">local  partition和local tile类似，现将大的Tensor按照tile大小进行分块，分块后每一块取出coordinate指定的元素形成新的块，代码形式和具体实例参考图2:</p><div class="highlight"><pre><code class="language-cpp"><span class="n">Tensor</span> <span class="n">tensor</span> <span class="o">=</span> <span class="n">make_tensor</span><span class="p">(</span><span class="n">ptr</span><span class="p">,</span> <span class="p">...);</span>
<span class="n">Tensor</span> <span class="n">tensor1</span> <span class="o">=</span> <span class="n">local_partition</span><span class="p">(</span><span class="n">tensor</span><span class="p">,</span> <span class="n">tile</span><span class="p">);</span>
</code></pre></div><figure data-size="normal"><noscript><img src="https://pic3.zhimg.com/v2-940f54c0095cfc2860f772d985cbb726_b.jpg" data-size="normal" data-rawwidth="1687" data-rawheight="888" class="origin_image zh-lightbox-thumb" width="1687" data-original="https://pic3.zhimg.com/v2-940f54c0095cfc2860f772d985cbb726_r.jpg"/></noscript><div><img src="data:image/svg+xml;utf8,&lt;svg xmlns=&#39;http://www.w3.org/2000/svg&#39; width=&#39;1687&#39; height=&#39;888&#39;&gt;&lt;/svg&gt;" data-size="normal" data-rawwidth="1687" data-rawheight="888" class="origin_image zh-lightbox-thumb lazy" width="1687" data-original="https://pic3.zhimg.com/v2-940f54c0095cfc2860f772d985cbb726_r.jpg" data-actualsrc="https://pic3.zhimg.com/v2-940f54c0095cfc2860f772d985cbb726_b.jpg" data-original-token="v2-f04a8382e2589cae2d56bcecfc049a6e"></div><figcaption>Figure 2. local partition的几何解释</figcaption></figure><h2 id="h_663093816_12" data-into-catalog-status="">Tensor数据类型转换recast</h2><p data-pid="PEcJ-q0_">Tensor表达了特定的数据类型的数据，可以对其进行数据类型的重新解释，然后形成新的tensor，类似于C++中的reinterpret_cast语义，代码形式如下：</p><div class="highlight"><pre><code class="language-cpp"><span class="n">Tensor</span> <span class="n">tensor</span> <span class="o">=</span> <span class="n">make_tensor</span><span class="o">&lt;</span><span class="kt">float</span><span class="o">&gt;</span><span class="p">(</span><span class="n">make_shape</span><span class="p">(...));</span>
<span class="n">Tensor</span> <span class="n">tensor1</span> <span class="o">=</span> <span class="n">recast</span><span class="o">&lt;</span><span class="n">NewType</span><span class="o">&gt;</span><span class="p">(</span><span class="n">tensor</span><span class="p">);</span>
</code></pre></div><h2 id="h_663093816_13" data-into-catalog-status="">Tensor内容的填充fill和清除clear</h2><p data-pid="RMZrGJ3J"><code>clear()</code>, <code>fill()</code> 可以对tensor进行元素级别的清除和填充操作</p><div class="highlight"><pre><code class="language-cpp"><span class="n">Tensor</span> <span class="n">tensor</span> <span class="o">=</span> <span class="n">make_tensor</span><span class="p">(...);</span>

<span class="n">clear</span><span class="p">(</span><span class="n">Tensor</span><span class="p">);</span>  <span class="c1">// 使用T{}类型的默认构造函数对tensor进行赋值
</span><span class="c1"></span><span class="n">fill</span><span class="p">(</span><span class="n">Tensor</span> <span class="n">tensor</span><span class="p">,</span> <span class="n">T</span> <span class="n">value</span><span class="p">);</span>  <span class="c1">// 将Tensor中的值填充为value值。
</span></code></pre></div><h2 id="h_663093816_14" data-into-catalog-status="">Tensor的线性组合axpby</h2><p data-pid="UZyeu9JS">对两个tensor进行线性组合运算<code>y = a*x + b*y</code>：</p><div class="highlight"><pre><code class="language-cpp"><span class="n">Tensor</span> <span class="n">x</span> <span class="o">=</span> <span class="n">make_tensor</span><span class="p">(...);</span>
<span class="n">Tensor</span> <span class="n">y</span> <span class="o">=</span> <span class="n">make_tensor_like</span><span class="p">(</span><span class="n">x</span><span class="p">);</span>

<span class="n">axpby</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">y</span><span class="p">);</span>
</code></pre></div><h2 id="h_663093816_15" data-into-catalog-status="">Tensor的打印print</h2><p data-pid="Ikp-bmeq">可以通过全局print方法来完成对tensor的打印来debug和展示Tensor的信息，print会打印tensor存储空间所在的位置和shape、stride信息，而print_tensor除了以上信息还会打印Tensor中具体的每一个数值：</p><div class="highlight"><pre><code class="language-cpp"><span class="n">Tensor</span> <span class="n">tensor</span> <span class="o">=</span> <span class="n">make_tensor</span><span class="p">(...);</span>
<span class="n">print</span><span class="p">(</span><span class="n">tensor</span><span class="p">);</span>
<span class="n">print_tensor</span><span class="p">(</span><span class="n">tensor</span><span class="p">);</span>
</code></pre></div><h2 id="h_663093816_16" data-into-catalog-status="">特殊矩阵</h2><p data-pid="gC2x_5mK">构造只有形状没有类型的tensor，用于一些特定变换：</p><div class="highlight"><pre><code class="language-cpp"><span class="n">Tensor</span> <span class="n">tensor</span> <span class="o">=</span> <span class="n">make_identity_tensor</span><span class="p">(</span><span class="n">shape</span><span class="p">);</span>
</code></pre></div><h2 id="h_663093816_17" data-into-catalog-status="">使用Tensor实现Vector Add示例：</h2><p data-pid="NZEMwcYS">以上回顾了Tensor的常用操作和方法，下面我们通过具体的实例展示如何使用Tensor工具实现CUDA kernel来完成针对half类型数据的向量化的z = ax + by + c的计算。</p><p data-pid="RW_1hQVc">对于该向量类问题，如果有丰富的CUDA 开发的经验，我们可以通过如下优化手段提供高效的实现：</p><ul><li data-pid="pNxwPy7U">单个线程处理多个数据，通过数据预取和指令并行，提升数据读取销量、提升执行单元的流水线效率；</li><li data-pid="p9g1-Ciw">对global内存进行大字长读写，减少数据IO所需要的指令数目，减少调度开销，提升程序运行效率；</li><li data-pid="rE9nqHMh">使用Half2类型，减少half类型引入的PRMT指令的转换和开销；</li><li data-pid="ALt-uO8x">使用FMA（fused multiply accumulate）指令完成计算，减少FMUL、FADD指令数，提升计算精度；</li></ul><p data-pid="cJr1s-iZ">具体地，我们实现了如下函数，</p><div class="highlight"><pre><code class="language-cpp"><span class="c1">// z = ax + by + c
</span><span class="c1"></span><span class="k">template</span> <span class="o">&lt;</span><span class="kt">int</span> <span class="n">kNumElemPerThread</span> <span class="o">=</span> <span class="mi">8</span><span class="o">&gt;</span>
<span class="n">__global__</span> <span class="kt">void</span> <span class="n">vector_add_local_tile_multi_elem_per_thread_half</span><span class="p">(</span>
    <span class="n">half</span> <span class="o">*</span><span class="n">z</span><span class="p">,</span> <span class="kt">int</span> <span class="n">num</span><span class="p">,</span> <span class="k">const</span> <span class="n">half</span> <span class="o">*</span><span class="n">x</span><span class="p">,</span> <span class="k">const</span> <span class="n">half</span> <span class="o">*</span><span class="n">y</span><span class="p">,</span> <span class="k">const</span> <span class="n">half</span> <span class="n">a</span><span class="p">,</span> <span class="k">const</span> <span class="n">half</span> <span class="n">b</span><span class="p">,</span> <span class="k">const</span> <span class="n">half</span> <span class="n">c</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">using</span> <span class="k">namespace</span> <span class="n">cute</span><span class="p">;</span>

  <span class="kt">int</span> <span class="n">idx</span> <span class="o">=</span> <span class="n">threadIdx</span><span class="p">.</span><span class="n">x</span> <span class="o">+</span> <span class="n">blockIdx</span><span class="p">.</span><span class="n">x</span> <span class="o">*</span> <span class="n">blockDim</span><span class="p">.</span><span class="n">x</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">idx</span> <span class="o">&gt;=</span> <span class="n">num</span> <span class="o">/</span> <span class="n">kNumElemPerThread</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// 未处理非对齐问题
</span><span class="c1"></span>    <span class="k">return</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="n">Tensor</span> <span class="n">tz</span> <span class="o">=</span> <span class="n">make_tensor</span><span class="p">(</span><span class="n">make_gmem_ptr</span><span class="p">(</span><span class="n">z</span><span class="p">),</span> <span class="n">make_shape</span><span class="p">(</span><span class="n">num</span><span class="p">));</span>
  <span class="n">Tensor</span> <span class="n">tx</span> <span class="o">=</span> <span class="n">make_tensor</span><span class="p">(</span><span class="n">make_gmem_ptr</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">make_shape</span><span class="p">(</span><span class="n">num</span><span class="p">));</span>
  <span class="n">Tensor</span> <span class="n">ty</span> <span class="o">=</span> <span class="n">make_tensor</span><span class="p">(</span><span class="n">make_gmem_ptr</span><span class="p">(</span><span class="n">y</span><span class="p">),</span> <span class="n">make_shape</span><span class="p">(</span><span class="n">num</span><span class="p">));</span>

  <span class="n">Tensor</span> <span class="n">tzr</span> <span class="o">=</span> <span class="n">local_tile</span><span class="p">(</span><span class="n">tz</span><span class="p">,</span> <span class="n">make_shape</span><span class="p">(</span><span class="n">Int</span><span class="o">&lt;</span><span class="n">kNumElemPerThread</span><span class="o">&gt;</span><span class="p">{}),</span> <span class="n">make_coord</span><span class="p">(</span><span class="n">idx</span><span class="p">));</span>
  <span class="n">Tensor</span> <span class="n">txr</span> <span class="o">=</span> <span class="n">local_tile</span><span class="p">(</span><span class="n">tx</span><span class="p">,</span> <span class="n">make_shape</span><span class="p">(</span><span class="n">Int</span><span class="o">&lt;</span><span class="n">kNumElemPerThread</span><span class="o">&gt;</span><span class="p">{}),</span> <span class="n">make_coord</span><span class="p">(</span><span class="n">idx</span><span class="p">));</span>
  <span class="n">Tensor</span> <span class="n">tyr</span> <span class="o">=</span> <span class="n">local_tile</span><span class="p">(</span><span class="n">ty</span><span class="p">,</span> <span class="n">make_shape</span><span class="p">(</span><span class="n">Int</span><span class="o">&lt;</span><span class="n">kNumElemPerThread</span><span class="o">&gt;</span><span class="p">{}),</span> <span class="n">make_coord</span><span class="p">(</span><span class="n">idx</span><span class="p">));</span>

  <span class="n">Tensor</span> <span class="n">txR</span> <span class="o">=</span> <span class="n">make_tensor_like</span><span class="p">(</span><span class="n">txr</span><span class="p">);</span>
  <span class="n">Tensor</span> <span class="n">tyR</span> <span class="o">=</span> <span class="n">make_tensor_like</span><span class="p">(</span><span class="n">tyr</span><span class="p">);</span>
  <span class="n">Tensor</span> <span class="n">tzR</span> <span class="o">=</span> <span class="n">make_tensor_like</span><span class="p">(</span><span class="n">tzr</span><span class="p">);</span>

  <span class="c1">// LDG.128
</span><span class="c1"></span>  <span class="n">copy</span><span class="p">(</span><span class="n">txr</span><span class="p">,</span> <span class="n">txR</span><span class="p">);</span>
  <span class="n">copy</span><span class="p">(</span><span class="n">tyr</span><span class="p">,</span> <span class="n">tyR</span><span class="p">);</span>

  <span class="n">half2</span> <span class="n">a2</span> <span class="o">=</span> <span class="p">{</span><span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="p">};</span>
  <span class="n">half2</span> <span class="n">b2</span> <span class="o">=</span> <span class="p">{</span><span class="n">b</span><span class="p">,</span> <span class="n">b</span><span class="p">};</span>
  <span class="n">half2</span> <span class="n">c2</span> <span class="o">=</span> <span class="p">{</span><span class="n">c</span><span class="p">,</span> <span class="n">c</span><span class="p">};</span>

  <span class="k">auto</span> <span class="n">tzR2</span> <span class="o">=</span> <span class="n">recast</span><span class="o">&lt;</span><span class="n">half2</span><span class="o">&gt;</span><span class="p">(</span><span class="n">tzR</span><span class="p">);</span>
  <span class="k">auto</span> <span class="n">txR2</span> <span class="o">=</span> <span class="n">recast</span><span class="o">&lt;</span><span class="n">half2</span><span class="o">&gt;</span><span class="p">(</span><span class="n">txR</span><span class="p">);</span>
  <span class="k">auto</span> <span class="n">tyR2</span> <span class="o">=</span> <span class="n">recast</span><span class="o">&lt;</span><span class="n">half2</span><span class="o">&gt;</span><span class="p">(</span><span class="n">tyR</span><span class="p">);</span>

<span class="cp">#pragma unroll
</span><span class="cp"></span>  <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">size</span><span class="p">(</span><span class="n">tzR2</span><span class="p">);</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// two hfma2 instruction
</span><span class="c1"></span>    <span class="n">tzR2</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">txR2</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">*</span> <span class="n">a2</span> <span class="o">+</span> <span class="p">(</span><span class="n">tyR2</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">*</span> <span class="n">b2</span> <span class="o">+</span> <span class="n">c2</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="k">auto</span> <span class="n">tzRx</span> <span class="o">=</span> <span class="n">recast</span><span class="o">&lt;</span><span class="n">half</span><span class="o">&gt;</span><span class="p">(</span><span class="n">tzR2</span><span class="p">);</span>

  <span class="c1">// STG.128
</span><span class="c1"></span>  <span class="n">copy</span><span class="p">(</span><span class="n">tzRx</span><span class="p">,</span> <span class="n">tzr</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div><p data-pid="jtm9kkm-">其中template行通过编译时常量指定每个线程处理8个数据，避免运行时常量不能利用寄存器（寄存器不可以寻址）所带来的Local Memory问题。由于一个线程处理8个元素，并且单个数据的大小为sizeof(half) = 2, 这样一个线程所需要的数据量为8 x 2 = 16byte，该大小的数据可以通过LDG.128指令实现一条指令完成对数据从全局内存到寄存器到加载；</p><p data-pid="g9YpTrMf">其中函数声明行通过 __global__ 关键字指明该函数为cuda kernel函数，且通过const等信息提示了输入输出数据；</p><p data-pid="2rJkx4Zv">using行引入cute的名字空间，以便使用cute名字空间中的Tensor工具和其他函数；</p><p data-pid="olQkHvzQ">idx和if判断行，通过使用cuda提供的内建threadIdx、blockIdx、blockDim变量来定位线程在网格中的位置；</p><p data-pid="LHG5hwym">Tensor tz、tx、ty行，通过利用make_tensor 接口将kernel参数中的裸指针和维度信息包装成tensor表达；</p><p data-pid="Ul9aRNbc">Tensor tzr、txr、tyr行，通过local_tile方法实现对tz/tx/ty Tensor的分块和选择（利用idx），在这之后我们只需要关注我们需要处理的局部的tensor即可，无需关注大的全局的tensor。同时在进行局部切块的时候，我们使用Int&lt;&gt;{}形式实现形状的编译常量表示，避免了运行时的量及其会引入的local memory；</p><p data-pid="MrZMpBcw">Tensor txR、tyR、tzR行通过make_tensor_like接口实现栈上tensor的定义（GPU表现为寄存器空间）；</p><p data-pid="pA7GtlyJ">copy行通过调用cute提供的copy函数实现全局内存数据读入到寄存器空间，此处会生成LDG.128指令；</p><p data-pid="uInSdXBC">half2 a2、b2、c2行，重复系数a、b、c构造half2类型的系数，以利用的HFMA2的指令完成后续计算；</p><p data-pid="H7azI1Wt">auto tzR2等行通过recast指令实现连续的half类型到half2类型的转换，以便能利用更高效的HFMA2指令；</p><p data-pid="HzAxWDD8">pragma 及后续for行实现了多个元素的z = ax + by + c的计算，并且通过括号将该计算通过两个HFMA2指令实现，如果没有括号，则其会生成 HMUL2 + HMUL2 + HADD2 + HADD2指令（由于乘法不满足结合律，且IEEE规定了浮点数计算的顺序需按照代码书写顺序）；</p><p data-pid="slR9KzAl">最后我们将结果cast回来并通过copy接口将计算结果存储到全局内存；</p><p data-pid="djvB6IeT">值得注意的是，Tensor tz; Tensor tzr; 行看似是生成Tensor但实际其并没有涉及到全局内存到读写（并没有Tensor被拷贝），只是利用Layout进行tensor的表达和变换数，数据实体没有移动，只有在copy的时候才有实际的数据读写。这也回应了文章开头的对cute中Tensor和深度学习框架中的Tensor不一样，大部分时间，我们在cute中使用Tensor只是使用Tensor的逻辑语义和变换，并没有实质的触发Tensor的搬运。同时我们也看到我们使用Tensor语义和工具能够更形象化的表达我们的逻辑，方便我们的思考，而CUDA的优化思路和技巧并不会因为Tensor的引入而变简单或困难。Tensor只是工具，可以方便我们的表达，至于深层次的优化思路那还是对经验的挑战。</p><h2 id="h_663093816_18" data-into-catalog-status="">总结与讨论</h2><p data-pid="el4OM3_m">本文介绍cute中Tensor常用的方法，并通过该Tensor工具完成了向量乘加法运算。Tensor是对数据表达的一种很好的抽象，我们可以利用这些抽象简化我们的思考模型（使我们的思考可以更抽象），降低编程困难，cute中提供的Tensor更多的是对Tensor的表达和变换，由Tensor生成Tensor只是Layout表达的变换并不产生数据实体的搬运（如local_tile）。Tensor表达虽然提供了很多方便，但也只限于表达的高效和便捷，如何对程序进行优化，Tensor表达的引入并没有提供额外帮助，它仍然需要我们从别的途径来获得。</p><p data-pid="AJ4z8RJ5">即便如此，“表达和抽象”依然无比重要，那正如：伽罗瓦如果没有群这一表达工具，就难以解决多项式根的问题；杨振宁没有群这一工具就难以构思举世的杨-米尔斯理论。</p><p data-pid="s8XNPfmV">抽象和工具让我们可以在更高的维度上思考。在后续文章中我们将基于Tensor（Layout）这种抽象进行MMA（matrix multiply accumulate）和COPY的介绍。</p></div></div></div></div><div role="button" tabindex="0" class="ContentItem-time">编辑于 2023-10-28 21:43<!-- -->・IP 属地北京</div><div class="Post-topicsAndReviewer"><div class="TopicList Post-Topics"><div class="Tag Topic css-ch8ocw" data-za-detail-view-path-module="TopicItem" data-za-extra-module="{&quot;card&quot;:{&quot;content&quot;:{&quot;type&quot;:&quot;Topic&quot;,&quot;token&quot;:&quot;19597236&quot;}}}"><span class="Tag-content"><a class="TopicLink" href="https://www.zhihu.com/topic/19597236" target="_blank"><div class="css-1gomreu">CUDA</div></a></span></div><div class="Tag Topic css-ch8ocw" data-za-detail-view-path-module="TopicItem" data-za-extra-module="{&quot;card&quot;:{&quot;content&quot;:{&quot;type&quot;:&quot;Topic&quot;,&quot;token&quot;:&quot;19570902&quot;}}}"><span class="Tag-content"><a class="TopicLink" href="https://www.zhihu.com/topic/19570902" target="_blank"><div class="css-1gomreu">GPU 通用计算</div></a></span></div><div class="Tag Topic css-ch8ocw" data-za-detail-view-path-module="TopicItem" data-za-extra-module="{&quot;card&quot;:{&quot;content&quot;:{&quot;type&quot;:&quot;Topic&quot;,&quot;token&quot;:&quot;19570894&quot;}}}"><span class="Tag-content"><a class="TopicLink" href="https://www.zhihu.com/topic/19570894" target="_blank"><div class="css-1gomreu">图形处理器（GPU）</div></a></span></div></div></div><div><div class="Sticky RichContent-actions is-fixed is-bottom" style="width: 690px; bottom: 0px; left: 514.429px;"><div class="ContentItem-actions" data-za-detail-view-path-module="BottomBar" data-za-extra-module="{&quot;card&quot;:{&quot;content&quot;:{&quot;type&quot;:&quot;Post&quot;,&quot;id&quot;:&quot;663093816&quot;,&quot;token&quot;:&quot;663093816&quot;}}}"><span><button aria-label="已赞同 86 " aria-live="polite" type="button" class="Button VoteButton VoteButton--up is-active FEfUrdfMIKpQDJDqkjte"><span style="display:inline-flex;align-items:center">​<svg width="10" height="10" viewBox="0 0 24 24" class="Zi Zi--TriangleUp VoteButton-TriangleUp" fill="currentColor" data-darkreader-inline-fill="" style="--darkreader-inline-fill: currentColor;"><path fill-rule="evenodd" d="M13.792 3.681c-.781-1.406-2.803-1.406-3.584 0l-7.79 14.023c-.76 1.367.228 3.046 1.791 3.046h15.582c1.563 0 2.55-1.68 1.791-3.046l-7.79-14.023Z" clip-rule="evenodd"></path></svg></span>已赞同 86</button><button aria-label="反对" aria-live="polite" type="button" class="Button VoteButton VoteButton--down FEfUrdfMIKpQDJDqkjte"><span style="display:inline-flex;align-items:center">​<svg width="10" height="10" viewBox="0 0 24 24" class="Zi Zi--TriangleDown" fill="currentColor" data-darkreader-inline-fill="" style="--darkreader-inline-fill: currentColor;"><path fill-rule="evenodd" d="M13.792 20.319c-.781 1.406-2.803 1.406-3.584 0L2.418 6.296c-.76-1.367.228-3.046 1.791-3.046h15.582c1.563 0 2.55 1.68 1.791 3.046l-7.79 14.023Z" clip-rule="evenodd"></path></svg></span></button></span><button type="button" class="Button BottomActions-CommentBtn FEfUrdfMIKpQDJDqkjte Button--plain Button--withIcon Button--withLabel fEPKGkUK5jyc4fUuT0QP B46v1Ak6Gj5sL2JTS4PY RuuQ6TOh2cRzJr6WlyQp"><span style="display:inline-flex;align-items:center">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="Zi Zi--Comment Button-zi t2ntD6J1DemdOdvh5FB4" fill="currentColor" data-darkreader-inline-fill="" style="--darkreader-inline-fill: currentColor;"><path fill-rule="evenodd" d="M12 2.75a9.25 9.25 0 1 0 4.737 17.197l2.643.817a1 1 0 0 0 1.25-1.25l-.8-2.588A9.25 9.25 0 0 0 12 2.75Z" clip-rule="evenodd"></path></svg></span>17 条评论</button><div class="Popover ShareMenu"><div class="ShareMenu-toggler" id="Popover2-toggle" aria-haspopup="true" aria-expanded="false"><button type="button" class="Button FEfUrdfMIKpQDJDqkjte Button--plain Button--withIcon Button--withLabel fEPKGkUK5jyc4fUuT0QP B46v1Ak6Gj5sL2JTS4PY RuuQ6TOh2cRzJr6WlyQp"><span style="display:inline-flex;align-items:center">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="Zi Zi--Share Button-zi t2ntD6J1DemdOdvh5FB4" fill="currentColor" data-darkreader-inline-fill="" style="--darkreader-inline-fill: currentColor;"><path d="M19.47 1.914a.8.8 0 0 1 1.204.778l-1.872 16.386a.9.9 0 0 1-1.204.743l-4.615-1.692a.7.7 0 0 0-.831.28l-1.927 3.02c-.43.674-1.474.369-1.474-.43v-3.865a.8.8 0 0 1 .179-.504l5.808-7.148a.595.595 0 0 0-.897-.781l-5.93 6.354a1.1 1.1 0 0 1-1.258.252L2.57 13.46a.8.8 0 0 1-.08-1.415l16.98-10.13Z"></path></svg></span>分享</button></div></div><button aria-live="polite" type="button" class="Button ContentItem-action FEfUrdfMIKpQDJDqkjte Button--plain Button--withIcon Button--withLabel fEPKGkUK5jyc4fUuT0QP B46v1Ak6Gj5sL2JTS4PY RuuQ6TOh2cRzJr6WlyQp"><span style="display:inline-flex;align-items:center">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="Zi Zi--Heart Button-zi t2ntD6J1DemdOdvh5FB4" fill="currentColor" data-darkreader-inline-fill="" style="--darkreader-inline-fill: currentColor;"><path fill-rule="evenodd" d="M12.004 4.934c1.015-.944 2.484-1.618 3.98-1.618 3.48 0 6.53 3.265 6.15 7.614-.11 1.254-.686 2.55-1.458 3.753-.778 1.215-1.79 2.392-2.845 3.419-1.054 1.028-2.168 1.923-3.161 2.566a9.96 9.96 0 0 1-1.41.777c-.418.182-.862.32-1.268.32s-.848-.137-1.267-.317a9.918 9.918 0 0 1-1.407-.771c-.992-.64-2.103-1.53-3.156-2.555-1.052-1.024-2.062-2.2-2.84-3.417-.77-1.208-1.346-2.51-1.456-3.775-.38-4.349 2.67-7.614 6.15-7.614 1.484 0 2.983.673 3.988 1.618Z" clip-rule="evenodd"></path></svg></span>取消喜欢</button><button type="button" class="Button FEfUrdfMIKpQDJDqkjte Button--plain Button--withIcon Button--withLabel fEPKGkUK5jyc4fUuT0QP B46v1Ak6Gj5sL2JTS4PY RuuQ6TOh2cRzJr6WlyQp"><span style="display:inline-flex;align-items:center">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="Zi Zi--Star Button-zi t2ntD6J1DemdOdvh5FB4" fill="currentColor" data-darkreader-inline-fill="" style="--darkreader-inline-fill: currentColor;"><path d="M10.484 3.307c.673-1.168 2.358-1.168 3.032 0l2.377 4.122a.25.25 0 0 0 .165.12l4.655.987c1.319.28 1.84 1.882.937 2.884l-3.186 3.535a.25.25 0 0 0-.063.193l.5 4.733c.142 1.34-1.222 2.33-2.453 1.782l-4.346-1.938a.25.25 0 0 0-.204 0l-4.346 1.938c-1.231.549-2.595-.442-2.453-1.782l.5-4.733a.25.25 0 0 0-.064-.193L2.35 11.42c-.903-1.002-.382-2.604.937-2.884l4.655-.987a.25.25 0 0 0 .164-.12l2.378-4.122Z"></path></svg></span>收藏</button><button type="button" class="Button ContentItem-action FEfUrdfMIKpQDJDqkjte Button--plain Button--withIcon Button--withLabel fEPKGkUK5jyc4fUuT0QP B46v1Ak6Gj5sL2JTS4PY RuuQ6TOh2cRzJr6WlyQp"><span style="display:inline-flex;align-items:center">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="Zi Zi--Deliver Button-zi t2ntD6J1DemdOdvh5FB4" fill="currentColor" data-darkreader-inline-fill="" style="--darkreader-inline-fill: currentColor;"><g fill-rule="evenodd" clip-rule="evenodd"><path d="M7.821 12a.75.75 0 0 1 .75-.75h6.857a.75.75 0 0 1 0 1.5H8.571a.75.75 0 0 1-.75-.75ZM8.965 8a.75.75 0 0 1 .75-.75h4.571a.75.75 0 0 1 0 1.5H9.715a.75.75 0 0 1-.75-.75Z"></path><path d="M7.527 3.15a2.35 2.35 0 0 0-2.309 1.91L3.165 15.84a.85.85 0 0 0-.015.16v2.5a2.35 2.35 0 0 0 2.35 2.35h13a2.35 2.35 0 0 0 2.35-2.35V16a.848.848 0 0 0-.015-.16L18.78 5.06a2.35 2.35 0 0 0-2.308-1.91H7.527Zm0 1.7a.65.65 0 0 0-.639.528l-1.88 9.872h13.984l-1.88-9.872a.65.65 0 0 0-.64-.528H7.528Z"></path></g></svg></span>申请转载</button><div class="Post-ActionMenuButton"><div class="Popover"><div id="Popover3-toggle" aria-haspopup="true" aria-expanded="false"><button type="button" class="Button FEfUrdfMIKpQDJDqkjte Button--plain Button--withIcon Button--iconOnly fEPKGkUK5jyc4fUuT0QP B46v1Ak6Gj5sL2JTS4PY hIwDV_tcL6XN1HprrnAq"><span style="display:inline-flex;align-items:center">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="Zi Zi--Dots Button-zi t2ntD6J1DemdOdvh5FB4" fill="currentColor" data-darkreader-inline-fill="" style="--darkreader-inline-fill: currentColor;"><path d="M6 10.5a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3ZM10.5 12a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0ZM16.5 12a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0Z"></path></svg></span></button></div></div></div></div><div class="Post-SideActions" style="opacity: 1;" data-za-detail-view-path-module="LeftTabBar" data-za-extra-module="{&quot;card&quot;:{&quot;content&quot;:{&quot;type&quot;:&quot;Post&quot;,&quot;id&quot;:&quot;663093816&quot;,&quot;token&quot;:&quot;663093816&quot;}}}"><button class="like active"><div class="Post-SideActions-icon"><svg width="16" height="16" viewBox="0 0 24 24" class="Zi Zi--TriangleUp Post-SideActions-upIcon" fill="currentColor" data-darkreader-inline-fill="" style="--darkreader-inline-fill: currentColor;"><path fill-rule="evenodd" d="M13.792 3.681c-.781-1.406-2.803-1.406-3.584 0l-7.79 14.023c-.76 1.367.228 3.046 1.791 3.046h15.582c1.563 0 2.55-1.68 1.791-3.046l-7.79-14.023Z" clip-rule="evenodd"></path></svg></div><div class="likeCount"><div class="likeCount-inner" data-previous="赞同 85">已赞同 86</div></div></button><div class="Popover ShareMenu"><div class="ShareMenu-toggler" id="Popover6-toggle" aria-haspopup="true" aria-expanded="false"><button><div class="Post-SideActions-icon"><span style="display: inline-flex; align-items: center;">​<svg width="20" height="20" viewBox="0 0 24 24" class="Zi Zi--Share" fill="currentColor" data-darkreader-inline-fill="" style="--darkreader-inline-fill: currentColor;"><path d="M19.47 1.914a.8.8 0 0 1 1.204.778l-1.872 16.386a.9.9 0 0 1-1.204.743l-4.615-1.692a.7.7 0 0 0-.831.28l-1.927 3.02c-.43.674-1.474.369-1.474-.43v-3.865a.8.8 0 0 1 .179-.504l5.808-7.148a.595.595 0 0 0-.897-.781l-5.93 6.354a1.1 1.1 0 0 1-1.258.252L2.57 13.46a.8.8 0 0 1-.08-1.415l16.98-10.13Z"></path></svg></span></div>分享</button></div></div></div></div><div class="Sticky--holder" style="position: static; inset: auto auto 0px 0px; display: block; float: none; margin: 0px 0px 10px; height: 53.7143px;"></div></div></article><div class="Post-Sub Post-NormalSub"><div style="overflow: unset;" data-za-detail-view-path-module="CommentList" data-za-extra-module="{}"><div class="Comments-container css-plbgu"><div class="css-79elbk"><div><div class="css-1fo89v5"><img class="Avatar css-m4psdq" src="./cute 之 Tensor - 知乎_files/v2-c58ab06f0991ecef82f9d358f471cfd3_l.jpg" srcset="https://pica.zhimg.com/v2-c58ab06f0991ecef82f9d358f471cfd3_l.jpg?source=32738c0c 2x"><div class="css-14zbeoe"><div class="css-i6bazn"><div class="css-0"><div class="InputLike css-1rl4wxv Editable"><div class="Dropzone Editable-content RichText RichText--editable RichText--clearBoth ztext" style="min-height: 38px;"><div class="DraftEditor-root"><div class="public-DraftEditorPlaceholder-root"><div class="public-DraftEditorPlaceholder-inner" id="placeholder-80tfm" style="white-space: pre-wrap;">理性发言，友善互动</div></div><div class="DraftEditor-editorContainer"><div aria-describedby="placeholder-80tfm" class="notranslate public-DraftEditor-content" contenteditable="true" spellcheck="true" tabindex="0" style="outline: none; user-select: text; white-space: pre-wrap; overflow-wrap: break-word; --darkreader-inline-outline: initial;" data-darkreader-inline-outline="" role="textbox"><div data-contents="true"><div class="Editable-unstyled" data-block="true" data-editor="80tfm" data-offset-key="6ak91-0-0"><div data-offset-key="6ak91-0-0" class="public-DraftStyleDefault-block public-DraftStyleDefault-ltr"><span data-offset-key="6ak91-0-0"><br data-text="true"></span></div></div></div></div></div></div></div><div></div><input multiple="" type="file" accept="image/webp,image/jpg,image/jpeg,image/png,image/gif" style="display: none;"></div></div></div></div></div></div><div class="css-u76jt1"><div class="css-1onritu"><div class="css-r4op92"><div class="css-1k10w8f">17 条评论</div></div><div class="css-59erns"></div><div class="css-97fdvh"><div class="css-m0zh86">默认</div><div class="css-1fjr6cy">最新</div></div></div><div class="css-840pn3"><div class="css-18ld3w0"><div data-id="10759803151"><div class="css-jp43l4"><div class="css-1jll2aj"><div class="css-1gomreu"><a href="https://www.zhihu.com/people/d0a6dd74ac061b17930c6b4f237ae154" target="_blank" class="css-1dxejhk"><img class="Avatar css-1ljippv" src="./cute 之 Tensor - 知乎_files/v2-abed1a8c04700ba7d72b45195223e0ff_l.jpg" srcset="https://picx.zhimg.com/v2-abed1a8c04700ba7d72b45195223e0ff_l.jpg?source=06d4cd63 2x" alt="rot.cx" loading="lazy"></a></div></div><div class="css-14nvvry"><div class="css-z0cc58"><div class="css-swj9d4"><div class="css-1tww9qq"><div class="css-1gomreu"><a href="https://www.zhihu.com/people/d0a6dd74ac061b17930c6b4f237ae154" target="_blank" class="css-10u695f">rot.cx</a></div><div class="css-1qe0v6x"><div class="css-1ssbn0c"></div><span class="css-8v0dsd" href="">关注我的人</span></div></div></div><svg width="16" height="16" viewBox="0 0 24 24" class="ZDI ZDI--Dots24 css-zgte1c" fill="currentColor" data-darkreader-inline-fill="" style="--darkreader-inline-fill: currentColor;"><path d="M6 10.5a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3ZM10.5 12a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0ZM16.5 12a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0Z"></path></svg></div><div class="CommentContent css-1jpzztt">template &lt;int kNumElemPerThread = 8&gt;：模板参数kNumElemPerThread表示每个线程处理的数据数量，这里默认为8。<br><br>__global__ void vector_add_local_tile_multi_elem_per_thread_half(half *z, int num, const half *x, const half *y, const half a, const half b, const half c)：这是一个全局函数，用于在GPU上执行。输入参数包括三个half类型的指针x, y, z，用于存储数据，以及三个half类型的变量a, b, c，用于计算。num是数据的数量。<br><br>int idx = threadIdx.x + blockIdx.x * blockDim.x;：计算当前线程的全局索引。<br><br>if (idx &gt;= num / kNumElemPerThread) { return; }：如果当前线程的索引超过了数据的数量，那么就直接返回。这是为了处理数据量不是线程数的倍数的情况。<br><br>Tensor tz = make_tensor(make_gmem_ptr(z), make_shape(num));：创建一个表示全局内存中数据z的张量。<br><br>Tensor tzr = local_tile(tz, make_shape(Int&lt;kNumElemPerThread&gt;{}), make_coord(idx));：创建一个表示当前线程需要处理的数据的张量。<br><br>Tensor txR = make_tensor_like(txr);：创建一个与txr形状相同的张量，用于存储中间结果。<br><br>copy(txr, txR);：将全局内存中的数据复制到寄存器中。<br><br>half2 a2 = {a, a};：创建一个half2类型的变量，用于存储系数a。<br><br>auto tzR2 = recast&lt;half2&gt;(tzR);：将tzR转换为half2类型，以便使用HFMA2指令。<br><br>for (int i = 0; i &lt; size(tzR2); ++i) { tzR2(i) = txR2(i) * a2 + (tyR2(i) * b2 + c2); }：进行计算，使用了FMA（fused multiply-add）操作，可以提高计算精度并减少指令数。<br><br>copy(tzRx, tzr);：将计算结果从寄存器复制到全局内存。<p></p></div><div class="css-140jo2"><div class="css-1a5a57m"><div class="css-x1xlu5"><span class="css-12cl38p">2023-12-25</span><span> · </span><span class="css-ntkn7q" href="">IP 属地北京</span></div></div><div class="css-18opwoy"><button type="button" class="Button Button--plain Button--withIcon Button--withLabel css-1ij6qqc"><span style="display: inline-flex; align-items: center;">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="ZDI ZDI--ChatBubbleFill24 css-15ro776" fill="currentColor" data-darkreader-inline-fill="" style="--darkreader-inline-fill: currentColor;"><path fill-rule="evenodd" d="M12 2.75a9.25 9.25 0 1 0 4.737 17.197l2.643.817a1 1 0 0 0 1.25-1.25l-.8-2.588A9.25 9.25 0 0 0 12 2.75Z" clip-rule="evenodd"></path></svg></span>回复</button><button type="button" class="Button Button--plain Button--red Button--withIcon Button--withLabel css-1staphk" style="transform: none;"><span style="display: inline-flex; align-items: center;">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="ZDI ZDI--HeartFill24 css-15ro776" fill="currentColor" data-darkreader-inline-fill="" style="--darkreader-inline-fill: currentColor;"><path fill-rule="evenodd" d="M12.004 4.934c1.015-.944 2.484-1.618 3.98-1.618 3.48 0 6.53 3.265 6.15 7.614-.11 1.254-.686 2.55-1.458 3.753-.778 1.215-1.79 2.392-2.845 3.419-1.054 1.028-2.168 1.923-3.161 2.566a9.96 9.96 0 0 1-1.41.777c-.418.182-.862.32-1.268.32s-.848-.137-1.267-.317a9.918 9.918 0 0 1-1.407-.771c-.992-.64-2.103-1.53-3.156-2.555-1.052-1.024-2.062-2.2-2.84-3.417-.77-1.208-1.346-2.51-1.456-3.775-.38-4.349 2.67-7.614 6.15-7.614 1.484 0 2.983.673 3.988 1.618Z" clip-rule="evenodd"></path></svg></span>2</button></div></div></div></div></div><div data-id="10806916855"><div class="css-jp43l4"><div class="css-1jll2aj"><div class="css-1gomreu"><a href="https://www.zhihu.com/people/408747d708b12db2781d33148d425545" target="_blank" class="css-1dxejhk"><img class="Avatar css-1ljippv" src="./cute 之 Tensor - 知乎_files/11ff1c248d5dd6aeb5cc32c2f6f32e48_l.jpg" srcset="https://picx.zhimg.com/11ff1c248d5dd6aeb5cc32c2f6f32e48_l.jpg?source=06d4cd63 2x" alt="陈小草" loading="lazy"></a></div></div><div class="css-14nvvry"><div class="css-z0cc58"><div class="css-swj9d4"><div class="css-1tww9qq"><div class="css-1gomreu"><a href="https://www.zhihu.com/people/408747d708b12db2781d33148d425545" target="_blank" class="css-10u695f">陈小草</a></div><div class="css-1qe0v6x"><div class="css-1ssbn0c"></div></div></div></div><svg width="16" height="16" viewBox="0 0 24 24" class="ZDI ZDI--Dots24 css-zgte1c" fill="currentColor" data-darkreader-inline-fill="" style="--darkreader-inline-fill: currentColor;"><path d="M6 10.5a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3ZM10.5 12a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0ZM16.5 12a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0Z"></path></svg></div><div class="CommentContent css-1jpzztt"><p>写得真好，最后的例子看懂这个cute的用处了</p></div><div class="css-140jo2"><div class="css-1a5a57m"><div class="css-x1xlu5"><span class="css-12cl38p">02-20</span><span> · </span><span class="css-ntkn7q" href="">IP 属地广东</span></div></div><div class="css-18opwoy"><button type="button" class="Button Button--plain Button--withIcon Button--withLabel css-1ij6qqc"><span style="display: inline-flex; align-items: center;">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="ZDI ZDI--ChatBubbleFill24 css-15ro776" fill="currentColor" data-darkreader-inline-fill="" style="--darkreader-inline-fill: currentColor;"><path fill-rule="evenodd" d="M12 2.75a9.25 9.25 0 1 0 4.737 17.197l2.643.817a1 1 0 0 0 1.25-1.25l-.8-2.588A9.25 9.25 0 0 0 12 2.75Z" clip-rule="evenodd"></path></svg></span>回复</button><button type="button" class="Button Button--plain Button--grey Button--withIcon Button--withLabel css-1vd72tl" style="transform: none;"><span style="display: inline-flex; align-items: center;">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="ZDI ZDI--HeartFill24 css-15ro776" fill="currentColor" data-darkreader-inline-fill="" style="--darkreader-inline-fill: currentColor;"><path fill-rule="evenodd" d="M12.004 4.934c1.015-.944 2.484-1.618 3.98-1.618 3.48 0 6.53 3.265 6.15 7.614-.11 1.254-.686 2.55-1.458 3.753-.778 1.215-1.79 2.392-2.845 3.419-1.054 1.028-2.168 1.923-3.161 2.566a9.96 9.96 0 0 1-1.41.777c-.418.182-.862.32-1.268.32s-.848-.137-1.267-.317a9.918 9.918 0 0 1-1.407-.771c-.992-.64-2.103-1.53-3.156-2.555-1.052-1.024-2.062-2.2-2.84-3.417-.77-1.208-1.346-2.51-1.456-3.775-.38-4.349 2.67-7.614 6.15-7.614 1.484 0 2.983.673 3.988 1.618Z" clip-rule="evenodd"></path></svg></span>1</button></div></div></div></div></div><div data-id="10742155431"><div class="css-jp43l4"><div class="css-1jll2aj"><div class="css-1gomreu"><a href="https://www.zhihu.com/people/e2a454f2ee65517b226819ec7ca455ed" target="_blank" class="css-1dxejhk"><img class="Avatar css-1ljippv" src="./cute 之 Tensor - 知乎_files/v2-abed1a8c04700ba7d72b45195223e0ff_l(1).jpg" srcset="https://pic1.zhimg.com/v2-abed1a8c04700ba7d72b45195223e0ff_l.jpg?source=06d4cd63 2x" alt="春日的阳光" loading="lazy"></a></div></div><div class="css-14nvvry"><div class="css-z0cc58"><div class="css-swj9d4"><div class="css-1tww9qq"><div class="css-1gomreu"><a href="https://www.zhihu.com/people/e2a454f2ee65517b226819ec7ca455ed" target="_blank" class="css-10u695f">春日的阳光</a></div><div class="css-1qe0v6x"><div class="css-1ssbn0c"></div><span class="css-8v0dsd" href="">关注我的人</span></div></div></div><svg width="16" height="16" viewBox="0 0 24 24" class="ZDI ZDI--Dots24 css-zgte1c" fill="currentColor" data-darkreader-inline-fill="" style="--darkreader-inline-fill: currentColor;"><path d="M6 10.5a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3ZM10.5 12a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0ZM16.5 12a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0Z"></path></svg></div><div class="CommentContent css-1jpzztt"><p>这个z = ax + by + c，可以开源下代码么？</p></div><div class="css-140jo2"><div class="css-1a5a57m"><div class="css-x1xlu5"><span class="css-12cl38p">2023-12-01</span><span> · </span><span class="css-ntkn7q" href="">IP 属地北京</span></div></div><div class="css-18opwoy"><button type="button" class="Button Button--plain Button--withIcon Button--withLabel css-1ij6qqc"><span style="display: inline-flex; align-items: center;">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="ZDI ZDI--ChatBubbleFill24 css-15ro776" fill="currentColor" data-darkreader-inline-fill="" style="--darkreader-inline-fill: currentColor;"><path fill-rule="evenodd" d="M12 2.75a9.25 9.25 0 1 0 4.737 17.197l2.643.817a1 1 0 0 0 1.25-1.25l-.8-2.588A9.25 9.25 0 0 0 12 2.75Z" clip-rule="evenodd"></path></svg></span>回复</button><button type="button" class="Button Button--plain Button--grey Button--withIcon Button--withLabel css-1vd72tl" style="transform: none;"><span style="display: inline-flex; align-items: center;">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="ZDI ZDI--HeartFill24 css-15ro776" fill="currentColor" data-darkreader-inline-fill="" style="--darkreader-inline-fill: currentColor;"><path fill-rule="evenodd" d="M12.004 4.934c1.015-.944 2.484-1.618 3.98-1.618 3.48 0 6.53 3.265 6.15 7.614-.11 1.254-.686 2.55-1.458 3.753-.778 1.215-1.79 2.392-2.845 3.419-1.054 1.028-2.168 1.923-3.161 2.566a9.96 9.96 0 0 1-1.41.777c-.418.182-.862.32-1.268.32s-.848-.137-1.267-.317a9.918 9.918 0 0 1-1.407-.771c-.992-.64-2.103-1.53-3.156-2.555-1.052-1.024-2.062-2.2-2.84-3.417-.77-1.208-1.346-2.51-1.456-3.775-.38-4.349 2.67-7.614 6.15-7.614 1.484 0 2.983.673 3.988 1.618Z" clip-rule="evenodd"></path></svg></span>1</button></div></div></div></div></div><div data-id="10922383129"><div class="css-jp43l4"><div class="css-1jll2aj"><div class="css-1gomreu"><a href="https://www.zhihu.com/people/c8ca0b228fdfcd92189f4cbc1767209d" target="_blank" class="css-1dxejhk"><img class="Avatar css-1ljippv" src="./cute 之 Tensor - 知乎_files/v2-abed1a8c04700ba7d72b45195223e0ff_l(1).jpg" srcset="https://pic1.zhimg.com/v2-abed1a8c04700ba7d72b45195223e0ff_l.jpg?source=06d4cd63 2x" alt="恒少" loading="lazy"></a></div></div><div class="css-14nvvry"><div class="css-z0cc58"><div class="css-swj9d4"><div class="css-1tww9qq"><div class="css-1gomreu"><a href="https://www.zhihu.com/people/c8ca0b228fdfcd92189f4cbc1767209d" target="_blank" class="css-10u695f">恒少</a></div><div class="css-1qe0v6x"><div class="css-1ssbn0c"></div><span class="css-8v0dsd" href="">关注我的人</span></div></div></div><svg width="16" height="16" viewBox="0 0 24 24" class="ZDI ZDI--Dots24 css-zgte1c" fill="currentColor" data-darkreader-inline-fill="" style="--darkreader-inline-fill: currentColor;"><path d="M6 10.5a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3ZM10.5 12a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0ZM16.5 12a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0Z"></path></svg></div><div class="CommentContent css-1jpzztt"><p>”我们使用Int&lt;&gt;{}形式实现形状的编译常量表示，避免了运行时的量及其会引入的local memory“<br>请教一下，这里是避免的是一个int（4 Bytes）的local memory引入？<br>那直接写8应该也可以吧，只是没跟kernel的template联动起来</p></div><div class="css-140jo2"><div class="css-1a5a57m"><div class="css-x1xlu5"><span class="css-12cl38p">07-03</span><span> · </span><span class="css-ntkn7q" href="">IP 属地上海</span></div></div><div class="css-18opwoy"><button type="button" class="Button Button--plain Button--withIcon Button--withLabel css-1ij6qqc"><span style="display: inline-flex; align-items: center;">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="ZDI ZDI--ChatBubbleFill24 css-15ro776" fill="currentColor" data-darkreader-inline-fill="" style="--darkreader-inline-fill: currentColor;"><path fill-rule="evenodd" d="M12 2.75a9.25 9.25 0 1 0 4.737 17.197l2.643.817a1 1 0 0 0 1.25-1.25l-.8-2.588A9.25 9.25 0 0 0 12 2.75Z" clip-rule="evenodd"></path></svg></span>回复</button><button type="button" class="Button Button--plain Button--grey Button--withIcon Button--withLabel css-1vd72tl" style="transform: none;"><span style="display: inline-flex; align-items: center;">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="ZDI ZDI--HeartFill24 css-15ro776" fill="currentColor" data-darkreader-inline-fill="" style="--darkreader-inline-fill: currentColor;"><path fill-rule="evenodd" d="M12.004 4.934c1.015-.944 2.484-1.618 3.98-1.618 3.48 0 6.53 3.265 6.15 7.614-.11 1.254-.686 2.55-1.458 3.753-.778 1.215-1.79 2.392-2.845 3.419-1.054 1.028-2.168 1.923-3.161 2.566a9.96 9.96 0 0 1-1.41.777c-.418.182-.862.32-1.268.32s-.848-.137-1.267-.317a9.918 9.918 0 0 1-1.407-.771c-.992-.64-2.103-1.53-3.156-2.555-1.052-1.024-2.062-2.2-2.84-3.417-.77-1.208-1.346-2.51-1.456-3.775-.38-4.349 2.67-7.614 6.15-7.614 1.484 0 2.983.673 3.988 1.618Z" clip-rule="evenodd"></path></svg></span>喜欢</button></div></div></div></div></div><div data-id="10887985071"><div class="css-jp43l4"><div class="css-1jll2aj"><div class="css-1gomreu"><a href="https://www.zhihu.com/people/5bb90e3a934d518bda92215688009dc0" target="_blank" class="css-1dxejhk"><img class="Avatar css-1ljippv" src="./cute 之 Tensor - 知乎_files/v2-abed1a8c04700ba7d72b45195223e0ff_l(1).jpg" srcset="https://pic1.zhimg.com/v2-abed1a8c04700ba7d72b45195223e0ff_l.jpg?source=06d4cd63 2x" alt="Archer" loading="lazy"></a></div></div><div class="css-14nvvry"><div class="css-z0cc58"><div class="css-swj9d4"><div class="css-1tww9qq"><div class="css-1gomreu"><a href="https://www.zhihu.com/people/5bb90e3a934d518bda92215688009dc0" target="_blank" class="css-10u695f">Archer</a></div><div class="css-1qe0v6x"><div class="css-1ssbn0c"></div></div></div></div><svg width="16" height="16" viewBox="0 0 24 24" class="ZDI ZDI--Dots24 css-zgte1c" fill="currentColor" data-darkreader-inline-fill="" style="--darkreader-inline-fill: currentColor;"><path d="M6 10.5a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3ZM10.5 12a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0ZM16.5 12a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0Z"></path></svg></div><div class="CommentContent css-1jpzztt"><p>"tzR2(i) = txR2(i) * a2 + (tyR2(i) * b2 + c2);" 这一行最终被映射成FMA指令，是因为tensor本身实现了一些编译技术的IR转换吗？也就是Tensor本身不仅承担layout这种地址映射函数和数据表达，也承担了一部分IR的使命？</p></div><div class="css-140jo2"><div class="css-1a5a57m"><div class="css-x1xlu5"><span class="css-12cl38p">05-25</span><span> · </span><span class="css-ntkn7q" href="">IP 属地北京</span></div></div><div class="css-18opwoy"><button type="button" class="Button Button--plain Button--withIcon Button--withLabel css-1ij6qqc"><span style="display: inline-flex; align-items: center;">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="ZDI ZDI--ChatBubbleFill24 css-15ro776" fill="currentColor" data-darkreader-inline-fill="" style="--darkreader-inline-fill: currentColor;"><path fill-rule="evenodd" d="M12 2.75a9.25 9.25 0 1 0 4.737 17.197l2.643.817a1 1 0 0 0 1.25-1.25l-.8-2.588A9.25 9.25 0 0 0 12 2.75Z" clip-rule="evenodd"></path></svg></span>回复</button><button type="button" class="Button Button--plain Button--grey Button--withIcon Button--withLabel css-1vd72tl" style="transform: none;"><span style="display: inline-flex; align-items: center;">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="ZDI ZDI--HeartFill24 css-15ro776" fill="currentColor" data-darkreader-inline-fill="" style="--darkreader-inline-fill: currentColor;"><path fill-rule="evenodd" d="M12.004 4.934c1.015-.944 2.484-1.618 3.98-1.618 3.48 0 6.53 3.265 6.15 7.614-.11 1.254-.686 2.55-1.458 3.753-.778 1.215-1.79 2.392-2.845 3.419-1.054 1.028-2.168 1.923-3.161 2.566a9.96 9.96 0 0 1-1.41.777c-.418.182-.862.32-1.268.32s-.848-.137-1.267-.317a9.918 9.918 0 0 1-1.407-.771c-.992-.64-2.103-1.53-3.156-2.555-1.052-1.024-2.062-2.2-2.84-3.417-.77-1.208-1.346-2.51-1.456-3.775-.38-4.349 2.67-7.614 6.15-7.614 1.484 0 2.983.673 3.988 1.618Z" clip-rule="evenodd"></path></svg></span>喜欢</button></div></div></div></div><div data-id="10888325134"><div class="css-1kwt8l8"><div class="css-1jll2aj"><div class="css-1gomreu"><a href="https://www.zhihu.com/people/2600b0313c76a175aa9e09a235382b79" target="_blank" class="css-1dxejhk"><img class="Avatar css-1ljippv" src="./cute 之 Tensor - 知乎_files/v2-e9c299bcbb6d098601ce529e9a358d82_l(1).jpg" srcset="https://picx.zhimg.com/v2-e9c299bcbb6d098601ce529e9a358d82_l.jpg?source=06d4cd63 2x" alt="reed" loading="lazy"></a></div></div><div class="css-14nvvry"><div class="css-z0cc58"><div class="css-swj9d4"><div class="css-1tww9qq"><div class="css-1gomreu"><a href="https://www.zhihu.com/people/2600b0313c76a175aa9e09a235382b79" target="_blank" class="css-10u695f">reed</a></div><div class="css-1qe0v6x"><div class="css-1ssbn0c"></div><span class="css-8v0dsd" href="">作者</span><span class="css-18biwo">​<svg viewBox="0 0 24 24" class="css-paut93" width="18" height="18"><defs><lineargradient id="biz-badges-blue" x1="0" y1="0" x2="100%" y2="73.32%"><stop offset="15%" stop-color="#47D3FF" data-darkreader-inline-stopcolor="" style="--darkreader-inline-stopcolor: #007ba1;"></stop><stop offset="81.54%" stop-color="#4A7DFF" data-darkreader-inline-stopcolor="" style="--darkreader-inline-stopcolor: #002da0;"></stop></lineargradient></defs><svg viewBox="0 0 24 24" x="-3" y="-3" fill="#ffffff" width="30" height="30" data-darkreader-inline-fill="" style="--darkreader-inline-fill: #e8e6e3;"><path d="M3.56231227,13.8535307 C2.40051305,12.768677 2.41398885,11.0669203 3.59484487,9.99979213 L3.59222085,9.99654885 C4.26730143,9.45036719 4.79446755,8.21005186 4.7184197,7.34453784 L4.72305873,7.34412719 C4.66942824,5.75539997 5.8824188,4.56066914 7.47188965,4.64242381 L7.47229112,4.6386236 C8.33515314,4.72977993 9.58467253,4.22534048 10.1426329,3.55925173 L10.1462611,3.56228565 C11.2316055,2.40008701 12.9353108,2.41394456 14.0015072,3.59634088 L14.0047263,3.59374004 C14.5498229,4.26841874 15.7896857,4.79521622 16.6545744,4.71844347 L16.6549836,4.72304294 C18.245027,4.66894057 19.4396947,5.88213996 19.3575031,7.47241135 L19.3623099,7.47292747 C19.2704388,8.3358681 19.7742711,9.58421483 20.4407199,10.1424506 L20.437686,10.1460789 C21.5997217,11.2312209 21.5860695,12.9345218 20.4042441,14.0007396 L20.4072865,14.0045125 C19.7325967,14.5495925 19.2055209,15.7896954 19.2815865,16.6561959 L19.2770449,16.6565978 C19.3315454,18.2453037 18.1173775,19.4393568 16.5274188,19.3571512 L16.5269029,19.3619539 C15.6647098,19.270083 14.415408,19.7741709 13.8573671,20.4403558 L13.8537409,20.4373235 C12.76842,21.5995708 11.0650432,21.5864553 9.99899434,20.4039226 L9.99527367,20.406923 C9.45025436,19.7323399 8.21017638,19.2051872 7.34461983,19.2812352 L7.344304,19.2776405 C5.75448683,19.3312904 4.55977145,18.1170085 4.64254978,16.527117 L4.63769921,16.5265942 C4.72957031,15.6644394 4.22547659,14.4151814 3.55928015,13.8571569 L3.56231227,13.8535307 Z"></path></svg><path d="M2.63951518,13.3895441 C3.70763333,14.2842292 4.44777637,16.1226061 4.30075305,17.5023312 L4.32211542,17.3063047 C4.17509209,18.6910561 5.17786655,19.7063729 6.5613937,19.5844846 L6.364106,19.6008202 C7.75140298,19.4789319 9.57474349,20.2554985 10.4468305,21.3349009 L10.3224262,21.1803415 C11.1982831,22.2647703 12.6257916,22.2723098 13.5167278,21.2079863 L13.3898102,21.3600325 C14.2845162,20.2919393 16.1229361,19.5518136 17.5026934,19.6988334 L17.3054057,19.6774716 C18.6914461,19.8244915 19.7067866,18.8217404 19.5836389,17.4395022 L19.6012314,17.6367853 C19.4793403,16.2482641 20.255925,14.4249662 21.3353526,13.5528995 L21.1807897,13.677301 C22.2639871,12.8014646 22.2727834,11.3739894 21.2084351,10.483074 L21.3604848,10.6099886 C20.2923667,9.71530351 19.5522236,7.87818322 19.6992469,6.49720154 L19.6778846,6.69448464 C19.8249079,5.30847665 18.8221335,4.2944164 17.4386063,4.41630468 L17.635894,4.39871256 C16.248597,4.52185742 14.4252565,3.74529084 13.5531695,2.66588842 L13.6775738,2.81919121 C12.8017169,1.73601905 11.3742084,1.72722299 10.4832722,2.79154644 L10.6101898,2.63950024 C9.71548377,3.70759343 7.87706394,4.44771919 6.49730661,4.30195588 L6.69459432,4.32206116 C5.30855394,4.17504128 4.29447,5.17904888 4.41636114,6.56128713 L4.3987686,6.36400404 C4.52065973,7.75126861 3.74407501,9.57456653 2.66464737,10.4478898 L2.81921035,10.3222318 C1.73601288,11.1993248 1.72721662,12.6255433 2.79156494,13.5164587 L2.63951518,13.3895441 Z" fill="url(#biz-badges-blue)"></path><svg width="12" height="12" viewBox="0 0 24 24" fill="#fff" x="6" y="6" class="Zi Zi--Check" data-darkreader-inline-fill="" style="--darkreader-inline-fill: #e8e6e3;"><path fill-rule="evenodd" d="M21.864 5.347a1.25 1.25 0 0 1 .04 1.767L10.976 18.537a1.35 1.35 0 0 1-1.965-.014L2.584 11.6a1.25 1.25 0 0 1 1.832-1.702l5.598 6.029L20.096 5.386a1.25 1.25 0 0 1 1.767-.04Z" clip-rule="evenodd"></path></svg></svg></span></div></div><svg width="12" height="12" viewBox="0 0 16 16" class="ZDI ZDI--ArrowRightAlt16 css-gx7lzm" fill="currentColor" data-darkreader-inline-fill="" style="--darkreader-inline-fill: currentColor;"><path d="M10.727 7.48a.63.63 0 0 1 0 1.039l-4.299 2.88c-.399.268-.926-.028-.926-.519V5.12c0-.491.527-.787.926-.52l4.299 2.881Z"></path></svg><div class="css-1tww9qq"><div class="css-1gomreu"><a href="https://www.zhihu.com/people/5bb90e3a934d518bda92215688009dc0" target="_blank" class="css-10u695f">Archer</a></div></div></div><svg width="16" height="16" viewBox="0 0 24 24" class="ZDI ZDI--Dots24 css-zgte1c" fill="currentColor" data-darkreader-inline-fill="" style="--darkreader-inline-fill: currentColor;"><path d="M6 10.5a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3ZM10.5 12a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0ZM16.5 12a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0Z"></path></svg></div><div class="CommentContent css-1jpzztt">这是编译器中的优化pass做的，fma可以单指令实现乘法和加法 吞吐更高</div><div class="css-140jo2"><div class="css-1a5a57m"><div class="css-x1xlu5"><span class="css-12cl38p">05-26</span><span> · </span><span class="css-ntkn7q" href="">IP 属地北京</span></div></div><div class="css-18opwoy"><button type="button" class="Button Button--plain Button--withIcon Button--withLabel css-1ij6qqc"><span style="display: inline-flex; align-items: center;">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="ZDI ZDI--ChatBubbleFill24 css-15ro776" fill="currentColor" data-darkreader-inline-fill="" style="--darkreader-inline-fill: currentColor;"><path fill-rule="evenodd" d="M12 2.75a9.25 9.25 0 1 0 4.737 17.197l2.643.817a1 1 0 0 0 1.25-1.25l-.8-2.588A9.25 9.25 0 0 0 12 2.75Z" clip-rule="evenodd"></path></svg></span>回复</button><button type="button" class="Button Button--plain Button--grey Button--withIcon Button--withLabel css-1vd72tl" style="transform: none;"><span style="display: inline-flex; align-items: center;">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="ZDI ZDI--HeartFill24 css-15ro776" fill="currentColor" data-darkreader-inline-fill="" style="--darkreader-inline-fill: currentColor;"><path fill-rule="evenodd" d="M12.004 4.934c1.015-.944 2.484-1.618 3.98-1.618 3.48 0 6.53 3.265 6.15 7.614-.11 1.254-.686 2.55-1.458 3.753-.778 1.215-1.79 2.392-2.845 3.419-1.054 1.028-2.168 1.923-3.161 2.566a9.96 9.96 0 0 1-1.41.777c-.418.182-.862.32-1.268.32s-.848-.137-1.267-.317a9.918 9.918 0 0 1-1.407-.771c-.992-.64-2.103-1.53-3.156-2.555-1.052-1.024-2.062-2.2-2.84-3.417-.77-1.208-1.346-2.51-1.456-3.775-.38-4.349 2.67-7.614 6.15-7.614 1.484 0 2.983.673 3.988 1.618Z" clip-rule="evenodd"></path></svg></span>喜欢</button></div></div></div></div></div><div data-id="10887993933"><div class="css-1kwt8l8"><div class="css-1jll2aj"><div class="css-1gomreu"><a href="https://www.zhihu.com/people/5bb90e3a934d518bda92215688009dc0" target="_blank" class="css-1dxejhk"><img class="Avatar css-1ljippv" src="./cute 之 Tensor - 知乎_files/v2-abed1a8c04700ba7d72b45195223e0ff_l.jpg" srcset="https://picx.zhimg.com/v2-abed1a8c04700ba7d72b45195223e0ff_l.jpg?source=06d4cd63 2x" alt="Archer" loading="lazy"></a></div></div><div class="css-14nvvry"><div class="css-z0cc58"><div class="css-swj9d4"><div class="css-1tww9qq"><div class="css-1gomreu"><a href="https://www.zhihu.com/people/5bb90e3a934d518bda92215688009dc0" target="_blank" class="css-10u695f">Archer</a></div><div class="css-1qe0v6x"><div class="css-1ssbn0c"></div></div></div><svg width="12" height="12" viewBox="0 0 16 16" class="ZDI ZDI--ArrowRightAlt16 css-gx7lzm" fill="currentColor" data-darkreader-inline-fill="" style="--darkreader-inline-fill: currentColor;"><path d="M10.727 7.48a.63.63 0 0 1 0 1.039l-4.299 2.88c-.399.268-.926-.028-.926-.519V5.12c0-.491.527-.787.926-.52l4.299 2.881Z"></path></svg><div class="css-1tww9qq"><div class="css-1gomreu"><a href="https://www.zhihu.com/people/2600b0313c76a175aa9e09a235382b79" target="_blank" class="css-10u695f">reed</a></div></div></div><svg width="16" height="16" viewBox="0 0 24 24" class="ZDI ZDI--Dots24 css-zgte1c" fill="currentColor" data-darkreader-inline-fill="" style="--darkreader-inline-fill: currentColor;"><path d="M6 10.5a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3ZM10.5 12a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0ZM16.5 12a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0Z"></path></svg></div><div class="CommentContent css-1jpzztt"><p>嗯。。。转换为寄存器行为的这个过程是不是也是对+和*的操作做了语法分析然后变成FMA，因为“标准操作变为特定硬件的特定指令”这个过程，并且和上下文有关，应该也得是通过一些编译的rule，不然确实想不通怎么变过去的，比如为啥不转移成ADD和MUL，而是变成了FMA</p></div><div class="css-140jo2"><div class="css-1a5a57m"><div class="css-x1xlu5"><span class="css-12cl38p">05-26</span><span> · </span><span class="css-ntkn7q" href="">IP 属地北京</span></div></div><div class="css-18opwoy"><button type="button" class="Button Button--plain Button--withIcon Button--withLabel css-1ij6qqc"><span style="display: inline-flex; align-items: center;">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="ZDI ZDI--ChatBubbleFill24 css-15ro776" fill="currentColor" data-darkreader-inline-fill="" style="--darkreader-inline-fill: currentColor;"><path fill-rule="evenodd" d="M12 2.75a9.25 9.25 0 1 0 4.737 17.197l2.643.817a1 1 0 0 0 1.25-1.25l-.8-2.588A9.25 9.25 0 0 0 12 2.75Z" clip-rule="evenodd"></path></svg></span>回复</button><button type="button" class="Button Button--plain Button--grey Button--withIcon Button--withLabel css-1vd72tl" style="transform: none;"><span style="display: inline-flex; align-items: center;">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="ZDI ZDI--HeartFill24 css-15ro776" fill="currentColor" data-darkreader-inline-fill="" style="--darkreader-inline-fill: currentColor;"><path fill-rule="evenodd" d="M12.004 4.934c1.015-.944 2.484-1.618 3.98-1.618 3.48 0 6.53 3.265 6.15 7.614-.11 1.254-.686 2.55-1.458 3.753-.778 1.215-1.79 2.392-2.845 3.419-1.054 1.028-2.168 1.923-3.161 2.566a9.96 9.96 0 0 1-1.41.777c-.418.182-.862.32-1.268.32s-.848-.137-1.267-.317a9.918 9.918 0 0 1-1.407-.771c-.992-.64-2.103-1.53-3.156-2.555-1.052-1.024-2.062-2.2-2.84-3.417-.77-1.208-1.346-2.51-1.456-3.775-.38-4.349 2.67-7.614 6.15-7.614 1.484 0 2.983.673 3.988 1.618Z" clip-rule="evenodd"></path></svg></span>喜欢</button></div></div></div></div></div><button type="button" class="Button Button--secondary Button--grey css-7dh30y">展开其他 1 条回复<span style="display: inline-flex; align-items: center;">​<svg width="24" height="24" viewBox="0 0 24 24" class="ZDI ZDI--ArrowRightSmall24" fill="currentColor" data-darkreader-inline-fill="" style="--darkreader-inline-fill: currentColor;"><path fill-rule="evenodd" d="M10.518 6.224a.875.875 0 0 1 1.212.248l3.335 5.05a.875.875 0 0 1 0 .964l-3.334 5.043a.875.875 0 0 1-1.46-.965l3.015-4.56-3.016-4.568a.875.875 0 0 1 .248-1.212Z" clip-rule="evenodd"></path></svg></span></button></div><div data-id="10774095234"><div class="css-jp43l4"><div class="css-1jll2aj"><div class="css-1gomreu"><a href="https://www.zhihu.com/people/09dd7fbe97e62aeef892e9694c5c852f" target="_blank" class="css-1dxejhk"><img class="Avatar css-1ljippv" src="./cute 之 Tensor - 知乎_files/v2-a3e11ce92bf69bf958a38514e2002e7e_l.jpg" srcset="https://picx.zhimg.com/v2-a3e11ce92bf69bf958a38514e2002e7e_l.jpg?source=06d4cd63 2x" alt="张凯歌" loading="lazy"></a></div></div><div class="css-14nvvry"><div class="css-z0cc58"><div class="css-swj9d4"><div class="css-1tww9qq"><div class="css-1gomreu"><a href="https://www.zhihu.com/people/09dd7fbe97e62aeef892e9694c5c852f" target="_blank" class="css-10u695f">张凯歌</a></div><div class="css-1qe0v6x"><div class="css-1ssbn0c"></div><span class="css-8v0dsd" href="">关注我的人</span></div></div></div><svg width="16" height="16" viewBox="0 0 24 24" class="ZDI ZDI--Dots24 css-zgte1c" fill="currentColor" data-darkreader-inline-fill="" style="--darkreader-inline-fill: currentColor;"><path d="M6 10.5a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3ZM10.5 12a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0ZM16.5 12a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0Z"></path></svg></div><div class="CommentContent css-1jpzztt"><p>local_tile对于tensor具有多层次shape的时候应该怎么写呢<img src="./cute 之 Tensor - 知乎_files/v2-aa15ce4a2bfe1ca54c8bb6cc3ea6627b.png" class="sticker" alt="[可怜]"></p></div><div class="css-140jo2"><div class="css-1a5a57m"><div class="css-x1xlu5"><span class="css-12cl38p">01-12</span><span> · </span><span class="css-ntkn7q" href="">IP 属地北京</span></div></div><div class="css-18opwoy"><button type="button" class="Button Button--plain Button--withIcon Button--withLabel css-1ij6qqc"><span style="display: inline-flex; align-items: center;">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="ZDI ZDI--ChatBubbleFill24 css-15ro776" fill="currentColor" data-darkreader-inline-fill="" style="--darkreader-inline-fill: currentColor;"><path fill-rule="evenodd" d="M12 2.75a9.25 9.25 0 1 0 4.737 17.197l2.643.817a1 1 0 0 0 1.25-1.25l-.8-2.588A9.25 9.25 0 0 0 12 2.75Z" clip-rule="evenodd"></path></svg></span>回复</button><button type="button" class="Button Button--plain Button--grey Button--withIcon Button--withLabel css-1vd72tl" style="transform: none;"><span style="display: inline-flex; align-items: center;">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="ZDI ZDI--HeartFill24 css-15ro776" fill="currentColor" data-darkreader-inline-fill="" style="--darkreader-inline-fill: currentColor;"><path fill-rule="evenodd" d="M12.004 4.934c1.015-.944 2.484-1.618 3.98-1.618 3.48 0 6.53 3.265 6.15 7.614-.11 1.254-.686 2.55-1.458 3.753-.778 1.215-1.79 2.392-2.845 3.419-1.054 1.028-2.168 1.923-3.161 2.566a9.96 9.96 0 0 1-1.41.777c-.418.182-.862.32-1.268.32s-.848-.137-1.267-.317a9.918 9.918 0 0 1-1.407-.771c-.992-.64-2.103-1.53-3.156-2.555-1.052-1.024-2.062-2.2-2.84-3.417-.77-1.208-1.346-2.51-1.456-3.775-.38-4.349 2.67-7.614 6.15-7.614 1.484 0 2.983.673 3.988 1.618Z" clip-rule="evenodd"></path></svg></span>喜欢</button></div></div></div></div></div><div data-id="10766553453"><div class="css-jp43l4"><div class="css-1jll2aj"><div class="css-1gomreu"><a href="https://www.zhihu.com/people/c751a0fa58a074fc0fddb9329d3d3141" target="_blank" class="css-1dxejhk"><img class="Avatar css-1ljippv" src="./cute 之 Tensor - 知乎_files/v2-4806447ffad7c76e9f785b994e8a2151_l.jpg" srcset="https://picx.zhimg.com/v2-4806447ffad7c76e9f785b994e8a2151_l.jpg?source=06d4cd63 2x" alt="Micro" loading="lazy"></a></div></div><div class="css-14nvvry"><div class="css-z0cc58"><div class="css-swj9d4"><div class="css-1tww9qq"><div class="css-1gomreu"><a href="https://www.zhihu.com/people/c751a0fa58a074fc0fddb9329d3d3141" target="_blank" class="css-10u695f">Micro</a></div><div class="css-1qe0v6x"><div class="css-1ssbn0c"></div><span class="css-8v0dsd" href="">我关注的人</span></div></div></div><svg width="16" height="16" viewBox="0 0 24 24" class="ZDI ZDI--Dots24 css-zgte1c" fill="currentColor" data-darkreader-inline-fill="" style="--darkreader-inline-fill: currentColor;"><path d="M6 10.5a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3ZM10.5 12a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0ZM16.5 12a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0Z"></path></svg></div><div class="CommentContent css-1jpzztt">太牛了太牛了</div><div class="css-140jo2"><div class="css-1a5a57m"><div class="css-x1xlu5"><span class="css-12cl38p">01-02</span><span> · </span><span class="css-ntkn7q" href="">IP 属地北京</span></div></div><div class="css-18opwoy"><button type="button" class="Button Button--plain Button--withIcon Button--withLabel css-1ij6qqc"><span style="display: inline-flex; align-items: center;">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="ZDI ZDI--ChatBubbleFill24 css-15ro776" fill="currentColor" data-darkreader-inline-fill="" style="--darkreader-inline-fill: currentColor;"><path fill-rule="evenodd" d="M12 2.75a9.25 9.25 0 1 0 4.737 17.197l2.643.817a1 1 0 0 0 1.25-1.25l-.8-2.588A9.25 9.25 0 0 0 12 2.75Z" clip-rule="evenodd"></path></svg></span>回复</button><button type="button" class="Button Button--plain Button--grey Button--withIcon Button--withLabel css-1vd72tl" style="transform: none;"><span style="display: inline-flex; align-items: center;">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="ZDI ZDI--HeartFill24 css-15ro776" fill="currentColor" data-darkreader-inline-fill="" style="--darkreader-inline-fill: currentColor;"><path fill-rule="evenodd" d="M12.004 4.934c1.015-.944 2.484-1.618 3.98-1.618 3.48 0 6.53 3.265 6.15 7.614-.11 1.254-.686 2.55-1.458 3.753-.778 1.215-1.79 2.392-2.845 3.419-1.054 1.028-2.168 1.923-3.161 2.566a9.96 9.96 0 0 1-1.41.777c-.418.182-.862.32-1.268.32s-.848-.137-1.267-.317a9.918 9.918 0 0 1-1.407-.771c-.992-.64-2.103-1.53-3.156-2.555-1.052-1.024-2.062-2.2-2.84-3.417-.77-1.208-1.346-2.51-1.456-3.775-.38-4.349 2.67-7.614 6.15-7.614 1.484 0 2.983.673 3.988 1.618Z" clip-rule="evenodd"></path></svg></span>喜欢</button></div></div></div></div></div><div data-id="10756407775"><div class="css-jp43l4"><div class="css-1jll2aj"><div class="css-1gomreu"><a href="https://www.zhihu.com/people/ee01edaad387c6a681e11628f680bb60" target="_blank" class="css-1dxejhk"><img class="Avatar css-1ljippv" src="./cute 之 Tensor - 知乎_files/v2-84fca1bb5c9f9c9b716a7aef1a4acc90_l.jpg" srcset="https://picx.zhimg.com/v2-84fca1bb5c9f9c9b716a7aef1a4acc90_l.jpg?source=06d4cd63 2x" alt="哦哦啊" loading="lazy"></a></div></div><div class="css-14nvvry"><div class="css-z0cc58"><div class="css-swj9d4"><div class="css-1tww9qq"><div class="css-1gomreu"><a href="https://www.zhihu.com/people/ee01edaad387c6a681e11628f680bb60" target="_blank" class="css-10u695f">哦哦啊</a></div><div class="css-1qe0v6x"><div class="css-1ssbn0c"></div></div></div></div><svg width="16" height="16" viewBox="0 0 24 24" class="ZDI ZDI--Dots24 css-zgte1c" fill="currentColor" data-darkreader-inline-fill="" style="--darkreader-inline-fill: currentColor;"><path d="M6 10.5a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3ZM10.5 12a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0ZM16.5 12a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0Z"></path></svg></div><div class="CommentContent css-1jpzztt"><p>gpu上也有栈和堆的概念吗</p></div><div class="css-140jo2"><div class="css-1a5a57m"><div class="css-x1xlu5"><span class="css-12cl38p">2023-12-20</span><span> · </span><span class="css-ntkn7q" href="">IP 属地北京</span></div></div><div class="css-18opwoy"><button type="button" class="Button Button--plain Button--withIcon Button--withLabel css-1ij6qqc"><span style="display: inline-flex; align-items: center;">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="ZDI ZDI--ChatBubbleFill24 css-15ro776" fill="currentColor" data-darkreader-inline-fill="" style="--darkreader-inline-fill: currentColor;"><path fill-rule="evenodd" d="M12 2.75a9.25 9.25 0 1 0 4.737 17.197l2.643.817a1 1 0 0 0 1.25-1.25l-.8-2.588A9.25 9.25 0 0 0 12 2.75Z" clip-rule="evenodd"></path></svg></span>回复</button><button type="button" class="Button Button--plain Button--grey Button--withIcon Button--withLabel css-1vd72tl" style="transform: none;"><span style="display: inline-flex; align-items: center;">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="ZDI ZDI--HeartFill24 css-15ro776" fill="currentColor" data-darkreader-inline-fill="" style="--darkreader-inline-fill: currentColor;"><path fill-rule="evenodd" d="M12.004 4.934c1.015-.944 2.484-1.618 3.98-1.618 3.48 0 6.53 3.265 6.15 7.614-.11 1.254-.686 2.55-1.458 3.753-.778 1.215-1.79 2.392-2.845 3.419-1.054 1.028-2.168 1.923-3.161 2.566a9.96 9.96 0 0 1-1.41.777c-.418.182-.862.32-1.268.32s-.848-.137-1.267-.317a9.918 9.918 0 0 1-1.407-.771c-.992-.64-2.103-1.53-3.156-2.555-1.052-1.024-2.062-2.2-2.84-3.417-.77-1.208-1.346-2.51-1.456-3.775-.38-4.349 2.67-7.614 6.15-7.614 1.484 0 2.983.673 3.988 1.618Z" clip-rule="evenodd"></path></svg></span>喜欢</button></div></div></div></div></div><div data-id="10742423027"><div class="css-jp43l4"><div class="css-1jll2aj"><div class="css-1gomreu"><a href="https://www.zhihu.com/people/319207f87f154964fafae2135d60b420" target="_blank" class="css-1dxejhk"><img class="Avatar css-1ljippv" src="./cute 之 Tensor - 知乎_files/v2-e5aeb4872c80f1b3edccc46617dfe3de_l.jpg" srcset="https://picx.zhimg.com/v2-e5aeb4872c80f1b3edccc46617dfe3de_l.jpg?source=06d4cd63 2x" alt="Ohge" loading="lazy"></a></div></div><div class="css-14nvvry"><div class="css-z0cc58"><div class="css-swj9d4"><div class="css-1tww9qq"><div class="css-1gomreu"><a href="https://www.zhihu.com/people/319207f87f154964fafae2135d60b420" target="_blank" class="css-10u695f">Ohge</a></div><div class="css-1qe0v6x"><div class="css-1ssbn0c"></div></div></div></div><svg width="16" height="16" viewBox="0 0 24 24" class="ZDI ZDI--Dots24 css-zgte1c" fill="currentColor" data-darkreader-inline-fill="" style="--darkreader-inline-fill: currentColor;"><path d="M6 10.5a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3ZM10.5 12a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0ZM16.5 12a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0Z"></path></svg></div><div class="CommentContent css-1jpzztt"><p>请问最后的代码有没有可以运行的完整的代码？包括main函数那种？多谢~</p></div><div class="css-140jo2"><div class="css-1a5a57m"><div class="css-x1xlu5"><span class="css-12cl38p">2023-12-02</span><span> · </span><span class="css-ntkn7q" href="">IP 属地上海</span></div></div><div class="css-18opwoy"><button type="button" class="Button Button--plain Button--withIcon Button--withLabel css-1ij6qqc"><span style="display: inline-flex; align-items: center;">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="ZDI ZDI--ChatBubbleFill24 css-15ro776" fill="currentColor" data-darkreader-inline-fill="" style="--darkreader-inline-fill: currentColor;"><path fill-rule="evenodd" d="M12 2.75a9.25 9.25 0 1 0 4.737 17.197l2.643.817a1 1 0 0 0 1.25-1.25l-.8-2.588A9.25 9.25 0 0 0 12 2.75Z" clip-rule="evenodd"></path></svg></span>回复</button><button type="button" class="Button Button--plain Button--grey Button--withIcon Button--withLabel css-1vd72tl" style="transform: none;"><span style="display: inline-flex; align-items: center;">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="ZDI ZDI--HeartFill24 css-15ro776" fill="currentColor" data-darkreader-inline-fill="" style="--darkreader-inline-fill: currentColor;"><path fill-rule="evenodd" d="M12.004 4.934c1.015-.944 2.484-1.618 3.98-1.618 3.48 0 6.53 3.265 6.15 7.614-.11 1.254-.686 2.55-1.458 3.753-.778 1.215-1.79 2.392-2.845 3.419-1.054 1.028-2.168 1.923-3.161 2.566a9.96 9.96 0 0 1-1.41.777c-.418.182-.862.32-1.268.32s-.848-.137-1.267-.317a9.918 9.918 0 0 1-1.407-.771c-.992-.64-2.103-1.53-3.156-2.555-1.052-1.024-2.062-2.2-2.84-3.417-.77-1.208-1.346-2.51-1.456-3.775-.38-4.349 2.67-7.614 6.15-7.614 1.484 0 2.983.673 3.988 1.618Z" clip-rule="evenodd"></path></svg></span>喜欢</button></div></div></div></div><div data-id="10741786455"><div class="css-1kwt8l8"><div class="css-1jll2aj"><div class="css-1gomreu"><a href="https://www.zhihu.com/people/319207f87f154964fafae2135d60b420" target="_blank" class="css-1dxejhk"><img class="Avatar css-1ljippv" src="./cute 之 Tensor - 知乎_files/v2-e5aeb4872c80f1b3edccc46617dfe3de_l(1).jpg" srcset="https://pica.zhimg.com/v2-e5aeb4872c80f1b3edccc46617dfe3de_l.jpg?source=06d4cd63 2x" alt="Ohge" loading="lazy"></a></div></div><div class="css-14nvvry"><div class="css-z0cc58"><div class="css-swj9d4"><div class="css-1tww9qq"><div class="css-1gomreu"><a href="https://www.zhihu.com/people/319207f87f154964fafae2135d60b420" target="_blank" class="css-10u695f">Ohge</a></div><div class="css-1qe0v6x"><div class="css-1ssbn0c"></div></div></div></div><svg width="16" height="16" viewBox="0 0 24 24" class="ZDI ZDI--Dots24 css-zgte1c" fill="currentColor" data-darkreader-inline-fill="" style="--darkreader-inline-fill: currentColor;"><path d="M6 10.5a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3ZM10.5 12a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0ZM16.5 12a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0Z"></path></svg></div><div class="CommentContent css-1jpzztt"><p>我自己拟了一个，但是出现了报错：<a href="http://link.zhihu.com/?target=https%3A//github.com/ziyuhuang123/delete.git" class=" external css-2ietpx" target="_blank" rel="nofollow noreferrer"><span class="invisible">https://</span><span class="visible">github.com/ziyuhuang123</span><span class="invisible">/delete.git</span><span class="ellipsis"></span></a><br>~/temp_can$ ./delete <br>Mismatch at 0: 2052 != 2051<img src="./cute 之 Tensor - 知乎_files/v2-7f09d05d34f03eab99e820014c393070.png" class="sticker" alt="[发呆]"></p></div><div class="css-140jo2"><div class="css-1a5a57m"><div class="css-x1xlu5"><span class="css-12cl38p">2023-12-02</span><span> · </span><span class="css-ntkn7q" href="">IP 属地上海</span></div></div><div class="css-18opwoy"><button type="button" class="Button Button--plain Button--withIcon Button--withLabel css-1ij6qqc"><span style="display: inline-flex; align-items: center;">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="ZDI ZDI--ChatBubbleFill24 css-15ro776" fill="currentColor" data-darkreader-inline-fill="" style="--darkreader-inline-fill: currentColor;"><path fill-rule="evenodd" d="M12 2.75a9.25 9.25 0 1 0 4.737 17.197l2.643.817a1 1 0 0 0 1.25-1.25l-.8-2.588A9.25 9.25 0 0 0 12 2.75Z" clip-rule="evenodd"></path></svg></span>回复</button><button type="button" class="Button Button--plain Button--grey Button--withIcon Button--withLabel css-1vd72tl" style="transform: none;"><span style="display: inline-flex; align-items: center;">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="ZDI ZDI--HeartFill24 css-15ro776" fill="currentColor" data-darkreader-inline-fill="" style="--darkreader-inline-fill: currentColor;"><path fill-rule="evenodd" d="M12.004 4.934c1.015-.944 2.484-1.618 3.98-1.618 3.48 0 6.53 3.265 6.15 7.614-.11 1.254-.686 2.55-1.458 3.753-.778 1.215-1.79 2.392-2.845 3.419-1.054 1.028-2.168 1.923-3.161 2.566a9.96 9.96 0 0 1-1.41.777c-.418.182-.862.32-1.268.32s-.848-.137-1.267-.317a9.918 9.918 0 0 1-1.407-.771c-.992-.64-2.103-1.53-3.156-2.555-1.052-1.024-2.062-2.2-2.84-3.417-.77-1.208-1.346-2.51-1.456-3.775-.38-4.349 2.67-7.614 6.15-7.614 1.484 0 2.983.673 3.988 1.618Z" clip-rule="evenodd"></path></svg></span>喜欢</button></div></div></div></div></div></div><div data-id="10742388439"><div class="css-jp43l4"><div class="css-1jll2aj"><div class="css-1gomreu"><a href="https://www.zhihu.com/people/319207f87f154964fafae2135d60b420" target="_blank" class="css-1dxejhk"><img class="Avatar css-1ljippv" src="./cute 之 Tensor - 知乎_files/v2-e5aeb4872c80f1b3edccc46617dfe3de_l.jpg" srcset="https://picx.zhimg.com/v2-e5aeb4872c80f1b3edccc46617dfe3de_l.jpg?source=06d4cd63 2x" alt="Ohge" loading="lazy"></a></div></div><div class="css-14nvvry"><div class="css-z0cc58"><div class="css-swj9d4"><div class="css-1tww9qq"><div class="css-1gomreu"><a href="https://www.zhihu.com/people/319207f87f154964fafae2135d60b420" target="_blank" class="css-10u695f">Ohge</a></div><div class="css-1qe0v6x"><div class="css-1ssbn0c"></div></div></div></div><svg width="16" height="16" viewBox="0 0 24 24" class="ZDI ZDI--Dots24 css-zgte1c" fill="currentColor" data-darkreader-inline-fill="" style="--darkreader-inline-fill: currentColor;"><path d="M6 10.5a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3ZM10.5 12a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0ZM16.5 12a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0Z"></path></svg></div><div class="CommentContent css-1jpzztt"><p>大佬 请问这里为什么是Tensor tensor1 = local_tile(tensor, make_shape(2, 3，4), make_coord(1, 2，3));   2 3 4呢？对应其中的图，尤其是4这个维度，我不明白啊，4不能表达出里面是2*2的特性，应该起码也写成2,2吧？</p></div><div class="css-140jo2"><div class="css-1a5a57m"><div class="css-x1xlu5"><span class="css-12cl38p">2023-12-01</span><span> · </span><span class="css-ntkn7q" href="">IP 属地上海</span></div></div><div class="css-18opwoy"><button type="button" class="Button Button--plain Button--withIcon Button--withLabel css-1ij6qqc"><span style="display: inline-flex; align-items: center;">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="ZDI ZDI--ChatBubbleFill24 css-15ro776" fill="currentColor" data-darkreader-inline-fill="" style="--darkreader-inline-fill: currentColor;"><path fill-rule="evenodd" d="M12 2.75a9.25 9.25 0 1 0 4.737 17.197l2.643.817a1 1 0 0 0 1.25-1.25l-.8-2.588A9.25 9.25 0 0 0 12 2.75Z" clip-rule="evenodd"></path></svg></span>回复</button><button type="button" class="Button Button--plain Button--grey Button--withIcon Button--withLabel css-1vd72tl" style="transform: none;"><span style="display: inline-flex; align-items: center;">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="ZDI ZDI--HeartFill24 css-15ro776" fill="currentColor" data-darkreader-inline-fill="" style="--darkreader-inline-fill: currentColor;"><path fill-rule="evenodd" d="M12.004 4.934c1.015-.944 2.484-1.618 3.98-1.618 3.48 0 6.53 3.265 6.15 7.614-.11 1.254-.686 2.55-1.458 3.753-.778 1.215-1.79 2.392-2.845 3.419-1.054 1.028-2.168 1.923-3.161 2.566a9.96 9.96 0 0 1-1.41.777c-.418.182-.862.32-1.268.32s-.848-.137-1.267-.317a9.918 9.918 0 0 1-1.407-.771c-.992-.64-2.103-1.53-3.156-2.555-1.052-1.024-2.062-2.2-2.84-3.417-.77-1.208-1.346-2.51-1.456-3.775-.38-4.349 2.67-7.614 6.15-7.614 1.484 0 2.983.673 3.988 1.618Z" clip-rule="evenodd"></path></svg></span>喜欢</button></div></div></div></div><div data-id="10742245483"><div class="css-1kwt8l8"><div class="css-1jll2aj"><div class="css-1gomreu"><a href="https://www.zhihu.com/people/2600b0313c76a175aa9e09a235382b79" target="_blank" class="css-1dxejhk"><img class="Avatar css-1ljippv" src="./cute 之 Tensor - 知乎_files/v2-e9c299bcbb6d098601ce529e9a358d82_l(2).jpg" srcset="https://pic1.zhimg.com/v2-e9c299bcbb6d098601ce529e9a358d82_l.jpg?source=06d4cd63 2x" alt="reed" loading="lazy"></a></div></div><div class="css-14nvvry"><div class="css-z0cc58"><div class="css-swj9d4"><div class="css-1tww9qq"><div class="css-1gomreu"><a href="https://www.zhihu.com/people/2600b0313c76a175aa9e09a235382b79" target="_blank" class="css-10u695f">reed</a></div><div class="css-1qe0v6x"><div class="css-1ssbn0c"></div><span class="css-8v0dsd" href="">作者</span><span class="css-18biwo">​<svg viewBox="0 0 24 24" class="css-paut93" width="18" height="18"><defs><lineargradient id="biz-badges-blue" x1="0" y1="0" x2="100%" y2="73.32%"><stop offset="15%" stop-color="#47D3FF" data-darkreader-inline-stopcolor="" style="--darkreader-inline-stopcolor: #007ba1;"></stop><stop offset="81.54%" stop-color="#4A7DFF" data-darkreader-inline-stopcolor="" style="--darkreader-inline-stopcolor: #002da0;"></stop></lineargradient></defs><svg viewBox="0 0 24 24" x="-3" y="-3" fill="#ffffff" width="30" height="30" data-darkreader-inline-fill="" style="--darkreader-inline-fill: #e8e6e3;"><path d="M3.56231227,13.8535307 C2.40051305,12.768677 2.41398885,11.0669203 3.59484487,9.99979213 L3.59222085,9.99654885 C4.26730143,9.45036719 4.79446755,8.21005186 4.7184197,7.34453784 L4.72305873,7.34412719 C4.66942824,5.75539997 5.8824188,4.56066914 7.47188965,4.64242381 L7.47229112,4.6386236 C8.33515314,4.72977993 9.58467253,4.22534048 10.1426329,3.55925173 L10.1462611,3.56228565 C11.2316055,2.40008701 12.9353108,2.41394456 14.0015072,3.59634088 L14.0047263,3.59374004 C14.5498229,4.26841874 15.7896857,4.79521622 16.6545744,4.71844347 L16.6549836,4.72304294 C18.245027,4.66894057 19.4396947,5.88213996 19.3575031,7.47241135 L19.3623099,7.47292747 C19.2704388,8.3358681 19.7742711,9.58421483 20.4407199,10.1424506 L20.437686,10.1460789 C21.5997217,11.2312209 21.5860695,12.9345218 20.4042441,14.0007396 L20.4072865,14.0045125 C19.7325967,14.5495925 19.2055209,15.7896954 19.2815865,16.6561959 L19.2770449,16.6565978 C19.3315454,18.2453037 18.1173775,19.4393568 16.5274188,19.3571512 L16.5269029,19.3619539 C15.6647098,19.270083 14.415408,19.7741709 13.8573671,20.4403558 L13.8537409,20.4373235 C12.76842,21.5995708 11.0650432,21.5864553 9.99899434,20.4039226 L9.99527367,20.406923 C9.45025436,19.7323399 8.21017638,19.2051872 7.34461983,19.2812352 L7.344304,19.2776405 C5.75448683,19.3312904 4.55977145,18.1170085 4.64254978,16.527117 L4.63769921,16.5265942 C4.72957031,15.6644394 4.22547659,14.4151814 3.55928015,13.8571569 L3.56231227,13.8535307 Z"></path></svg><path d="M2.63951518,13.3895441 C3.70763333,14.2842292 4.44777637,16.1226061 4.30075305,17.5023312 L4.32211542,17.3063047 C4.17509209,18.6910561 5.17786655,19.7063729 6.5613937,19.5844846 L6.364106,19.6008202 C7.75140298,19.4789319 9.57474349,20.2554985 10.4468305,21.3349009 L10.3224262,21.1803415 C11.1982831,22.2647703 12.6257916,22.2723098 13.5167278,21.2079863 L13.3898102,21.3600325 C14.2845162,20.2919393 16.1229361,19.5518136 17.5026934,19.6988334 L17.3054057,19.6774716 C18.6914461,19.8244915 19.7067866,18.8217404 19.5836389,17.4395022 L19.6012314,17.6367853 C19.4793403,16.2482641 20.255925,14.4249662 21.3353526,13.5528995 L21.1807897,13.677301 C22.2639871,12.8014646 22.2727834,11.3739894 21.2084351,10.483074 L21.3604848,10.6099886 C20.2923667,9.71530351 19.5522236,7.87818322 19.6992469,6.49720154 L19.6778846,6.69448464 C19.8249079,5.30847665 18.8221335,4.2944164 17.4386063,4.41630468 L17.635894,4.39871256 C16.248597,4.52185742 14.4252565,3.74529084 13.5531695,2.66588842 L13.6775738,2.81919121 C12.8017169,1.73601905 11.3742084,1.72722299 10.4832722,2.79154644 L10.6101898,2.63950024 C9.71548377,3.70759343 7.87706394,4.44771919 6.49730661,4.30195588 L6.69459432,4.32206116 C5.30855394,4.17504128 4.29447,5.17904888 4.41636114,6.56128713 L4.3987686,6.36400404 C4.52065973,7.75126861 3.74407501,9.57456653 2.66464737,10.4478898 L2.81921035,10.3222318 C1.73601288,11.1993248 1.72721662,12.6255433 2.79156494,13.5164587 L2.63951518,13.3895441 Z" fill="url(#biz-badges-blue)"></path><svg width="12" height="12" viewBox="0 0 24 24" fill="#fff" x="6" y="6" class="Zi Zi--Check" data-darkreader-inline-fill="" style="--darkreader-inline-fill: #e8e6e3;"><path fill-rule="evenodd" d="M21.864 5.347a1.25 1.25 0 0 1 .04 1.767L10.976 18.537a1.35 1.35 0 0 1-1.965-.014L2.584 11.6a1.25 1.25 0 0 1 1.832-1.702l5.598 6.029L20.096 5.386a1.25 1.25 0 0 1 1.767-.04Z" clip-rule="evenodd"></path></svg></svg></span></div></div></div><svg width="16" height="16" viewBox="0 0 24 24" class="ZDI ZDI--Dots24 css-zgte1c" fill="currentColor" data-darkreader-inline-fill="" style="--darkreader-inline-fill: currentColor;"><path d="M6 10.5a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3ZM10.5 12a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0ZM16.5 12a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0Z"></path></svg></div><div class="CommentContent css-1jpzztt">代码示意了使用的方法 和图没有对应关系</div><div class="css-140jo2"><div class="css-1a5a57m"><div class="css-x1xlu5"><span class="css-12cl38p">2023-12-01</span><span> · </span><span class="css-ntkn7q" href="">IP 属地北京</span></div></div><div class="css-18opwoy"><button type="button" class="Button Button--plain Button--withIcon Button--withLabel css-1ij6qqc"><span style="display: inline-flex; align-items: center;">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="ZDI ZDI--ChatBubbleFill24 css-15ro776" fill="currentColor" data-darkreader-inline-fill="" style="--darkreader-inline-fill: currentColor;"><path fill-rule="evenodd" d="M12 2.75a9.25 9.25 0 1 0 4.737 17.197l2.643.817a1 1 0 0 0 1.25-1.25l-.8-2.588A9.25 9.25 0 0 0 12 2.75Z" clip-rule="evenodd"></path></svg></span>回复</button><button type="button" class="Button Button--plain Button--grey Button--withIcon Button--withLabel css-1vd72tl" style="transform: none;"><span style="display: inline-flex; align-items: center;">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="ZDI ZDI--HeartFill24 css-15ro776" fill="currentColor" data-darkreader-inline-fill="" style="--darkreader-inline-fill: currentColor;"><path fill-rule="evenodd" d="M12.004 4.934c1.015-.944 2.484-1.618 3.98-1.618 3.48 0 6.53 3.265 6.15 7.614-.11 1.254-.686 2.55-1.458 3.753-.778 1.215-1.79 2.392-2.845 3.419-1.054 1.028-2.168 1.923-3.161 2.566a9.96 9.96 0 0 1-1.41.777c-.418.182-.862.32-1.268.32s-.848-.137-1.267-.317a9.918 9.918 0 0 1-1.407-.771c-.992-.64-2.103-1.53-3.156-2.555-1.052-1.024-2.062-2.2-2.84-3.417-.77-1.208-1.346-2.51-1.456-3.775-.38-4.349 2.67-7.614 6.15-7.614 1.484 0 2.983.673 3.988 1.618Z" clip-rule="evenodd"></path></svg></span>1</button></div></div></div></div></div></div><div></div></div></div><div class="css-wu78cf"><div class="css-vurnku">点击查看全部评论</div><svg width="24" height="24" viewBox="0 0 24 24" class="ZDI ZDI--ArrowRightSmall24" fill="currentColor" data-darkreader-inline-fill="" style="--darkreader-inline-fill: currentColor;"><path fill-rule="evenodd" d="M10.518 6.224a.875.875 0 0 1 1.212.248l3.335 5.05a.875.875 0 0 1 0 .964l-3.334 5.043a.875.875 0 0 1-1.46-.965l3.015-4.56-3.016-4.568a.875.875 0 0 1 .248-1.212Z" clip-rule="evenodd"></path></svg></div></div><div class="css-l8iyjs"></div><div class="css-kt4t4n" style="position: relative; box-shadow: 0px 0px;" data-darkreader-inline-boxshadow=""><div><div class="css-59erns"><img class="Avatar css-m4psdq" src="./cute 之 Tensor - 知乎_files/v2-c58ab06f0991ecef82f9d358f471cfd3_l.jpg" srcset="https://pica.zhimg.com/v2-c58ab06f0991ecef82f9d358f471cfd3_l.jpg?source=32738c0c 2x"><div class="css-14zbeoe"><div class="css-i6bazn"><div class="css-1ryozpy"><div class="InputLike css-1rl4wxv Editable"><div class="Dropzone Editable-content RichText RichText--editable RichText--clearBoth ztext" style="min-height: 38px;"><div class="DraftEditor-root"><div class="public-DraftEditorPlaceholder-root"><div class="public-DraftEditorPlaceholder-inner" id="placeholder-7o98k" style="white-space: pre-wrap;">理性发言，友善互动</div></div><div class="DraftEditor-editorContainer"><div aria-describedby="placeholder-7o98k" class="notranslate public-DraftEditor-content" contenteditable="true" role="textbox" spellcheck="true" tabindex="0" style="outline: none; user-select: text; white-space: pre-wrap; overflow-wrap: break-word; --darkreader-inline-outline: initial;" data-darkreader-inline-outline=""><div data-contents="true"><div class="Editable-unstyled" data-block="true" data-editor="7o98k" data-offset-key="c8ut7-0-0"><div data-offset-key="c8ut7-0-0" class="public-DraftStyleDefault-block public-DraftStyleDefault-ltr"><span data-offset-key="c8ut7-0-0"><br data-text="true"></span></div></div></div></div></div></div></div><div></div><input multiple="" type="file" accept="image/webp,image/jpg,image/jpeg,image/png,image/gif" style="display: none;"></div></div></div></div></div></div></div><div></div></div></div></div><div class="PostIndex-Contributions" data-za-detail-view-path-module="ColumnList" data-za-detail-view-path-module_name="文章被以下专栏收录" data-za-extra-module="{}"><h3 class="BlockTitle">文章被以下专栏收录</h3><ul><div class="ContentItem Column-ColumnItem"><div class="ContentItem-main"><div class="ContentItem-image"><a class="ColumnLink" href="https://www.zhihu.com/column/c_1696937812497235968"><div class="css-1gomreu"><img class="Avatar css-1u7r5c9" src="./cute 之 Tensor - 知乎_files/4b70deef7_l.jpg" srcset="https://pic1.zhimg.com/4b70deef7_l.jpg?source=172ae18b 2x" alt="CUDA高性能编程"></div></a></div><div class="ContentItem-head"><h2 class="ContentItem-title"><span><a class="ColumnLink ColumnItem-Title" href="https://www.zhihu.com/column/c_1696937812497235968"><div class="css-1gomreu">CUDA高性能编程</div></a></span></h2><div class="ContentItem-meta">高性能计算中CUDA软硬件体系</div></div></div></div></ul></div><div role="complementary" aria-label="推荐阅读" class="Recommendations-Main" style="width: 1719px;"><h3 class="BlockTitle Recommendations-BlockTitle">推荐阅读</h3><ul class="Recommendations-List"><button class="PagingButton PagingButton-Previous" disabled="" data-za-detail-view-path-module="Unknown" data-za-detail-view-path-module_name="推荐阅读" data-za-extra-module="{}"><svg width="40" height="40" viewBox="0 0 24 24" fill="#d3d3d3" class="Zi Zi--ArrowLeft" data-darkreader-inline-fill="" style="--darkreader-inline-fill: #313537;"><path fill-rule="evenodd" d="M14.609 6.322c.349.335.36.889.026 1.237l-4.253 4.438 4.254 4.444a.875.875 0 1 1-1.264 1.21l-4.834-5.05a.875.875 0 0 1 0-1.21l4.834-5.043a.875.875 0 0 1 1.237-.026Z" clip-rule="evenodd"></path></svg></button><a href="https://zhuanlan.zhihu.com/p/538329106" class="PostItem"><div><img src="./cute 之 Tensor - 知乎_files/v2-e7a0016dd09e04c9aff40f9856224802_250x0.jpg" srcset="https://picx.zhimg.com/v2-e7a0016dd09e04c9aff40f9856224802_qhd.jpg?source=172ae18b 2x" class="PostItem-TitleImage" alt="CVPR 2022 CLIP还能做分割任务？哥廷根大学提出了一个使用文本和图像prompt，能同时作三个分割任务的模型《CLIPSeg》，榨干CLIP的能力！"><h1 class="PostItem-Title">CVPR 2022 CLIP还能做分割任务？哥廷根大学提出了一个使用文本和图像prompt，能同时作三个分割任务的模型《CLIPSeg》，榨干CLIP的能力！</h1><div class="PostItem-Footer"><span>我爱计算机...</span><span class="PostItem-FooterTitle">发表于我爱计算机...</span></div></div></a><a href="https://zhuanlan.zhihu.com/p/687529756" class="PostItem"><div><h1 class="PostItem-Title">CMU 15-445 Bustub 2023-Fall Project 4 MVCC 思路分享</h1><p class="PostItem-Summary">这是全新的MVCC Lab, 核心在于读操作是无锁的。 Motivation是「我们为什么需要读最新的数据？只要读的数据是一致的就可以了。」比如OLAP的时候，我们在23点开始分析购物网站的流水，只要账…</p><div class="PostItem-Footer"><span>crash Fire</span><span class="PostItem-FooterTitle"></span></div></div></a><a href="https://zhuanlan.zhihu.com/p/673208290" class="PostItem"><div><img src="./cute 之 Tensor - 知乎_files/v2-7b1873c3f162ca7df1a84fb264376eb0_250x0.jpg" srcset="https://pica.zhimg.com/v2-7b1873c3f162ca7df1a84fb264376eb0_qhd.jpg?source=172ae18b 2x" class="PostItem-TitleImage" alt="UE5 新功能 MLDeformer 原理流程解析"><h1 class="PostItem-Title">UE5 新功能 MLDeformer 原理流程解析</h1><div class="PostItem-Footer"><span>鱼露</span><span class="PostItem-FooterTitle"></span></div></div></a><a href="https://zhuanlan.zhihu.com/p/346850896" class="PostItem"><div><h1 class="PostItem-Title">Floating Gate VS Charge Trap</h1><p class="PostItem-Summary">FG flash的浮栅极材料是导体。任何两个彼此绝缘且相隔很近的导体间都构成一个电容器。因此，任何两个存储单元的浮栅极就构成一个电容器，一个浮栅极里面电荷的变化，都会引起别的存储单元浮…</p><div class="PostItem-Footer"><span>半导体搬运工</span><span class="PostItem-FooterTitle"></span></div></div></a><button class="PagingButton PagingButton-Next" data-za-detail-view-path-module="Unknown" data-za-detail-view-path-module_name="推荐阅读" data-za-extra-module="{}"><svg width="40" height="40" viewBox="0 0 24 24" fill="#d3d3d3" class="Zi Zi--ArrowRight" data-darkreader-inline-fill="" style="--darkreader-inline-fill: #313537;"><path fill-rule="evenodd" d="M10.518 6.224a.875.875 0 0 1 1.212.248l3.335 5.05a.875.875 0 0 1 0 .964l-3.334 5.043a.875.875 0 0 1-1.46-.965l3.015-4.56-3.016-4.568a.875.875 0 0 1 .248-1.212Z" clip-rule="evenodd"></path></svg></button></ul></div></div></div></main><div role="complementary"><div class="CornerButtons"><div class="CornerAnimayedFlex CornerAnimayedFlex--hidden"><button data-tooltip="回到顶部" data-tooltip-position="left" data-tooltip-will-hide-on-click="true" aria-label="回到顶部" type="button" class="Button CornerButton Button--plain css-4lspwd"><svg width="24" height="24" viewBox="0 0 24 24" aria-hidden="true" class="Zi Zi--BackToTop" fill="currentColor" data-darkreader-inline-fill="" style="--darkreader-inline-fill: currentColor;"><path fill-rule="evenodd" d="M13.204 3.107a1.75 1.75 0 0 0-2.408 0L3.806 9.73c-1.148 1.088-.378 3.02 1.204 3.02h2.24V20c0 .966.784 1.75 1.75 1.75h6A1.75 1.75 0 0 0 16.75 20v-7.25h2.24c1.582 0 2.353-1.932 1.204-3.02l-6.99-6.623Z" clip-rule="evenodd"></path></svg></button></div></div></div></div></div><script id="js-clientConfig" type="text/json">{"fetchRoot":{"www":"https:\u002F\u002Fwww.zhihu.com","api":"https:\u002F\u002Fapi.zhihu.com","lens":"https:\u002F\u002Flens.zhihu.com","zhida":"https:\u002F\u002Fzhida.zhihu.com","zhuanlan":"https:\u002F\u002Fzhuanlan.zhihu.com\u002Fapi\u002F","walletpay":"https:\u002F\u002Fwalletpay.zhihu.com","captcha":"https:\u002F\u002Fcaptcha.zhihu.com","vzuu":"https:\u002F\u002Fv.vzuu.com","openapi":"https:\u002F\u002Fopenapi.zhihu.com","svip":"https:\u002F\u002Fsvip.zhihu.com"},"host":"zhihu.com","protocol":"https:","wwwHost":"www.zhihu.com","videoHost":"video.zhihu.com","zhuanlanHost":"zhuanlan.zhihu.com","allowSignUp":true,"refreshValidityPeriod":"30","release":"1460-273bc90e","currentEntry":"column","isMobileEntry":false,"apollo":{"env":"prod","globalSilence":"","ncgModeSign":"3f8e56febda4fb3bbea72e379d76de1e","topstory_rec_adp":"1","topstory_hot_adp":"1","editor_adapt_native":"0","editor_auto_rotate":"0","enable_request_filter":"1","content_publish_pin":"0","content_publish_answer":"1","content_publish_question":"1","content_publish_article":"1","content_publish_zvideo":"1","balanceModalSign":"ChYHAcB5ihJECkAFnhDAYmdhsTWVJoNc","reportBackendPublishError":"1","dynamic_font_schema":"1","enable_vzuu_login":"on","test_canary":"member|0-100,1-0","use_new_player":"member|0-100,1-0","player_vendor":"member|0-100,1-0,2-0","use_hevc":"member|0-0,1-100","upload_use_signature":"member|0-0,1-100","use_backdrop_blur":"member|0-0,1-100","article_title_imagex":"member|0-0,1-100","play_station":"member|0-0,1-100","use_cached_supported_countries":"device|1-100,0-0","contentItem_cover_imagex":"member|0-0,1-100","use_qrcode_login_v2":"device|1-100,0-0"}}</script><script id="js-initialData" type="text/json">{"initialState":{"common":{"ask":{},"cities":{"cityData":[]}},"loading":{"global":{"count":0},"local":{"env\u002FgetIpinfo\u002F":false,"article\u002Fget\u002F":false,"brand\u002FgetUrl\u002F":false,"article\u002FloadPostSearchEntity\u002F":false}},"entities":{"users":{"d4901200cbf4b641d3bc073c37356443":{"uid":783097360782868500,"userType":"people","id":"d4901200cbf4b641d3bc073c37356443"},"reed-84-49":{"isFollowed":false,"avatarUrlTemplate":"https:\u002F\u002Fpicx.zhimg.com\u002Fv2-e9c299bcbb6d098601ce529e9a358d82.jpg?source=172ae18b","uid":"1064511094718017536","userType":"people","isFollowing":true,"urlToken":"reed-84-49","id":"2600b0313c76a175aa9e09a235382b79","description":"https:\u002F\u002Freed-lau.github.io","name":"reed","isAdvertiser":false,"headline":"从科学计算到高性能计算系统","gender":1,"url":"\u002Fpeople\u002F2600b0313c76a175aa9e09a235382b79","avatarUrl":"https:\u002F\u002Fpicx.zhimg.com\u002Fv2-e9c299bcbb6d098601ce529e9a358d82_l.jpg?source=172ae18b","isOrg":false,"type":"people","badge":[{"type":"identity","topics":[],"description":"中国科学院大学 理学博士"}],"badgeV2":{"title":"中国科学院大学 理学博士","mergedBadges":[{"type":"identity","detailType":"identity","title":"认证","description":"中国科学院大学 理学博士","url":"https:\u002F\u002Fzhuanlan.zhihu.com\u002Fp\u002F96956163","sources":[],"icon":"","nightIcon":""}],"detailBadges":[{"type":"identity","detailType":"identity_people","title":"已认证的个人","description":"中国科学院大学 理学博士","url":"https:\u002F\u002Fzhuanlan.zhihu.com\u002Fp\u002F96956163","sources":[],"icon":"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-2ddc5cc683982648f6f123616fb4ec09_l.png?source=32738c0c","nightIcon":"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-2ddc5cc683982648f6f123616fb4ec09_l.png?source=32738c0c"}],"icon":"https:\u002F\u002Fpicx.zhimg.com\u002Fv2-2ddc5cc683982648f6f123616fb4ec09_l.png?source=32738c0c","nightIcon":"https:\u002F\u002Fpicx.zhimg.com\u002Fv2-2ddc5cc683982648f6f123616fb4ec09_l.png?source=32738c0c"},"exposedMedal":{"medalId":"972477022068568064","medalName":"备受瞩目","avatarUrl":"https:\u002F\u002Fpicx.zhimg.com\u002Fv2-6da117205088242db9cd82e48b28640d_r.png?source=172ae18b","miniAvatarUrl":"https:\u002F\u002Fpicx.zhimg.com\u002Fv2-6da117205088242db9cd82e48b28640d_l.png?source=172ae18b","description":"被 1000 个人关注","medalAvatarFrame":""}}},"questions":{},"answers":{},"articles":{"663093816":{"trackUrl":["https:\u002F\u002Fsugar.zhihu.com\u002Fplutus_adreaper\u002Fcontent_monitor_log?si=__SESSIONID__&ti=__ATOKEN__&at=view&pf=__OS__&ed=BiBUKF0xBSkqGGRVA2F6CF5wRvRrVR3EE00=&idfa=__IDFA__&imei=__IMEI__&androidid=__ANDROIDID__&oaid=__OAID__&ci=__CREATIVEID__&zid=__ZONEID__"],"entityWords":[{"name":"张量","mention":"张量","matchorder":1,"begin":13570,"end":13572,"entityid":-1067519905688665200,"isBookMark":false,"link":{"linkType":0,"linkUrl":"","docType":"","topicToken":""},"entityClass":"Physics","score":0.0008001892173951919,"attachedInfoBytes":"sgJaCgblvKDph48SB1BoeXNpY3MYgmoghGooATXKw1E6OgdhcnRpY2xlQO6Gk\u002FbTidqX8QFIAFIkYjliOTJjYWQtZDg2Yi00YmVhLTgyZTEtMDhlODVkNTVmYjM28gLEAQokYjliOTJjYWQtZDg2Yi00YmVhLTgyZTEtMDhlODVkNTVmYjM2GgdhcnRpY2xlIgkyMzU0ODMwNzE6BuW8oOmHj0DuhpP204nal\u002FEBSABSEmFpX2VudGl0eV9yZWNhbGxlcl3Kw1E6YloKBuW8oOmHjxIHUGh5c2ljcxiCaiCEaigBNcrDUTo6B2FydGljbGVA7oaT9tOJ2pfxAUgAUiRiOWI5MmNhZC1kODZiLTRiZWEtODJlMS0wOGU4NWQ1NWZiMzY=","isOnAB":false,"isNatural":1,"isDelete":false,"contentType":"","contentId":"","contentToken":""},{"name":"局部化切块","mention":"局部化切块","matchorder":1,"begin":13415,"end":13420,"entityid":2648309280126846500,"isBookMark":false,"link":{"linkType":0,"linkUrl":"","docType":"","topicToken":""},"entityClass":"Math","score":0.0006636791638432518,"attachedInfoBytes":"sgJfCg\u002FlsYDpg6jljJbliIflnZcSBE1hdGgY52gg7GgoATXB+i06OgdhcnRpY2xlQLuN08qk6KvgJEgAUiRiOWI5MmNhZC1kODZiLTRiZWEtODJlMS0wOGU4NWQ1NWZiMzbyAtEBCiRiOWI5MmNhZC1kODZiLTRiZWEtODJlMS0wOGU4NWQ1NWZiMzYaB2FydGljbGUiCTIzNTQ4MzA3MToP5bGA6YOo5YyW5YiH5Z2XQLuN08qk6KvgJEgBUhJhaV9lbnRpdHlfcmVjYWxsZXJdwfotOmJfCg\u002FlsYDpg6jljJbliIflnZcSBE1hdGgY52gg7GgoATXB+i06OgdhcnRpY2xlQLuN08qk6KvgJEgAUiRiOWI5MmNhZC1kODZiLTRiZWEtODJlMS0wOGU4NWQ1NWZiMzY=","isOnAB":false,"isNatural":1,"isDelete":false,"contentType":"","contentId":"","contentToken":""},{"name":"浮点数","mention":"浮点数","matchorder":1,"begin":30451,"end":30454,"entityid":3005512809600111000,"isBookMark":false,"link":{"linkType":0,"linkUrl":"","docType":"","topicToken":""},"entityClass":"Unknown","score":0.0006350561631933635,"attachedInfoBytes":"sgJeCgnmta7ngrnmlbASB1Vua25vd24Y8+0BIPbtASgBNeZ5Jjo6B2FydGljbGVAqqXnwJ+\u002F7topSABSJGI5YjkyY2FkLWQ4NmItNGJlYS04MmUxLTA4ZTg1ZDU1ZmIzNvICzwEKJGI5YjkyY2FkLWQ4NmItNGJlYS04MmUxLTA4ZTg1ZDU1ZmIzNhoHYXJ0aWNsZSIJMjM1NDgzMDcxOgnmta7ngrnmlbBAqqXnwJ+\u002F7topSAJSF2JhaWR1LWJhaWtlLWl0ZW0tcmVjYWxsXeZ5JjpiXgoJ5rWu54K55pWwEgdVbmtub3duGPPtASD27QEoATXmeSY6OgdhcnRpY2xlQKql58Cfv+7aKUgAUiRiOWI5MmNhZC1kODZiLTRiZWEtODJlMS0wOGU4NWQ1NWZiMzY=","isOnAB":false,"isNatural":1,"isDelete":false,"contentType":"","contentId":"","contentToken":""},{"name":"栈上数据","mention":"栈上数据","matchorder":1,"begin":313,"end":317,"entityid":4951335962363198000,"isBookMark":false,"link":{"linkType":0,"linkUrl":"","docType":"","topicToken":""},"entityClass":"Computer","score":0.0005680597742745985,"attachedInfoBytes":"sgJgCgzmoIjkuIrmlbDmja4SCENvbXB1dGVyGLkCIL0CKAE12ekUOjoHYXJ0aWNsZUDR+ZmCsbqr20RIAFIkYjliOTJjYWQtZDg2Yi00YmVhLTgyZTEtMDhlODVkNTVmYjM28gLPAQokYjliOTJjYWQtZDg2Yi00YmVhLTgyZTEtMDhlODVkNTVmYjM2GgdhcnRpY2xlIgkyMzU0ODMwNzE6DOagiOS4iuaVsOaNrkDR+ZmCsbqr20RIA1ISYWlfZW50aXR5X3JlY2FsbGVyXdnpFDpiYAoM5qCI5LiK5pWw5o2uEghDb21wdXRlchi5AiC9AigBNdnpFDo6B2FydGljbGVA0fmZgrG6q9tESABSJGI5YjkyY2FkLWQ4NmItNGJlYS04MmUxLTA4ZTg1ZDU1ZmIzNg==","isOnAB":false,"isNatural":1,"isDelete":false,"contentType":"","contentId":"","contentToken":""},{"name":"特殊矩阵","mention":"特殊矩阵","matchorder":1,"begin":19375,"end":19379,"entityid":1223010386172212700,"isBookMark":false,"link":{"linkType":0,"linkUrl":"","docType":"","topicToken":""},"entityClass":"Unknown","score":0.0008482611653162775,"attachedInfoBytes":"sgJhCgznibnmrornn6npmLUSB1Vua25vd24Yr5cBILOXASgBNdhdXjo6B2FydGljbGVAgOyhw\u002FauwPwQSABSJGI5YjkyY2FkLWQ4NmItNGJlYS04MmUxLTA4ZTg1ZDU1ZmIzNvIC1QEKJGI5YjkyY2FkLWQ4NmItNGJlYS04MmUxLTA4ZTg1ZDU1ZmIzNhoHYXJ0aWNsZSIJMjM1NDgzMDcxOgznibnmrornn6npmLVAgOyhw\u002FauwPwQSARSF2JhaWR1LWJhaWtlLWl0ZW0tcmVjYWxsXdhdXjpiYQoM54m55q6K55+p6Zi1EgdVbmtub3duGK+XASCzlwEoATXYXV46OgdhcnRpY2xlQIDsocP2rsD8EEgAUiRiOWI5MmNhZC1kODZiLTRiZWEtODJlMS0wOGU4NWQ1NWZiMzY=","isOnAB":false,"isNatural":1,"isDelete":false,"contentType":"","contentId":"","contentToken":""},{"name":"operator","mention":"operator","matchorder":2,"begin":5394,"end":5402,"entityid":-4271030336535136000,"isBookMark":false,"link":{"linkType":0,"linkUrl":"","docType":"","topicToken":""},"entityClass":"Math","score":0.000578362037973866,"attachedInfoBytes":"sgJZCghvcGVyYXRvchIETWF0aBiSKiCaKigCNTidFzo6B2FydGljbGVApPCf75qRkN3EAUgAUiRiOWI5MmNhZC1kODZiLTRiZWEtODJlMS0wOGU4NWQ1NWZiMzbyAsUBCiRiOWI5MmNhZC1kODZiLTRiZWEtODJlMS0wOGU4NWQ1NWZiMzYaB2FydGljbGUiCTIzNTQ4MzA3MToIb3BlcmF0b3JApPCf75qRkN3EAUgFUhJhaV9lbnRpdHlfcmVjYWxsZXJdOJ0XOmJZCghvcGVyYXRvchIETWF0aBiSKiCaKigCNTidFzo6B2FydGljbGVApPCf75qRkN3EAUgAUiRiOWI5MmNhZC1kODZiLTRiZWEtODJlMS0wOGU4NWQ1NWZiMzY=","isOnAB":false,"isNatural":1,"isDelete":false,"contentType":"","contentId":"","contentToken":""},{"name":"tensor1 = tensor","mention":"tensor1 = tensor","matchorder":1,"begin":2383,"end":2399,"entityid":2462515160359122400,"isBookMark":false,"link":{"linkType":0,"linkUrl":"","docType":"","topicToken":""},"entityClass":"Math","score":0.001780003098176497,"attachedInfoBytes":"sgJgChB0ZW5zb3IxID0gdGVuc29yEgRNYXRoGM8SIN8SKAE1\u002Fk7pOjoHYXJ0aWNsZUC57eDZ3I+nliJIAFIkYjliOTJjYWQtZDg2Yi00YmVhLTgyZTEtMDhlODVkNTVmYjM28gLTAQokYjliOTJjYWQtZDg2Yi00YmVhLTgyZTEtMDhlODVkNTVmYjM2GgdhcnRpY2xlIgkyMzU0ODMwNzE6EHRlbnNvcjEgPSB0ZW5zb3JAue3g2dyPp5YiSAdSEmFpX2VudGl0eV9yZWNhbGxlcl3+Tuk6YmAKEHRlbnNvcjEgPSB0ZW5zb3ISBE1hdGgYzxIg3xIoATX+Tuk6OgdhcnRpY2xlQLnt4Nncj6eWIkgAUiRiOWI5MmNhZC1kODZiLTRiZWEtODJlMS0wOGU4NWQ1NWZiMzY=","isOnAB":false,"isNatural":1,"isDelete":false,"contentType":"","contentId":"","contentToken":""},{"name":"reinterpret_cast","mention":"reinterpret_cast","matchorder":1,"begin":16529,"end":16545,"entityid":3320692714547195000,"isBookMark":false,"link":{"linkType":0,"linkUrl":"","docType":"","topicToken":""},"entityClass":"OtherTerm","score":0.0015010104115374123,"attachedInfoBytes":"sgJnChByZWludGVycHJldF9jYXN0EglPdGhlclRlcm0YkYEBIKGBASgBNY29xDo6B2FydGljbGVAs9fA1uGN3oouSABSJGI5YjkyY2FkLWQ4NmItNGJlYS04MmUxLTA4ZTg1ZDU1ZmIzNvIC2gEKJGI5YjkyY2FkLWQ4NmItNGJlYS04MmUxLTA4ZTg1ZDU1ZmIzNhoHYXJ0aWNsZSIJMjM1NDgzMDcxOhByZWludGVycHJldF9jYXN0QLPXwNbhjd6KLkgIUhJhaV9lbnRpdHlfcmVjYWxsZXJdjb3EOmJnChByZWludGVycHJldF9jYXN0EglPdGhlclRlcm0YkYEBIKGBASgBNY29xDo6B2FydGljbGVAs9fA1uGN3oouSABSJGI5YjkyY2FkLWQ4NmItNGJlYS04MmUxLTA4ZTg1ZDU1ZmIzNg==","isOnAB":false,"isNatural":1,"isDelete":false,"contentType":"","contentId":"","contentToken":""},{"name":"成员函数","mention":"成员函数","matchorder":1,"begin":3146,"end":3150,"entityid":2767673746727516700,"isBookMark":false,"link":{"linkType":0,"linkUrl":"","docType":"","topicToken":""},"entityClass":"Math","score":0.000734328835243013,"attachedInfoBytes":"sgJcCgzmiJDlkZjlh73mlbASBE1hdGgYyhggzhgoATX5f0A6OgdhcnRpY2xlQOzy+P69k7C0JkgAUiRiOWI5MmNhZC1kODZiLTRiZWEtODJlMS0wOGU4NWQ1NWZiMzbyAssBCiRiOWI5MmNhZC1kODZiLTRiZWEtODJlMS0wOGU4NWQ1NWZiMzYaB2FydGljbGUiCTIzNTQ4MzA3MToM5oiQ5ZGY5Ye95pWwQOzy+P69k7C0JkgJUhJhaV9lbnRpdHlfcmVjYWxsZXJd+X9AOmJcCgzmiJDlkZjlh73mlbASBE1hdGgYyhggzhgoATX5f0A6OgdhcnRpY2xlQOzy+P69k7C0JkgAUiRiOWI5MmNhZC1kODZiLTRiZWEtODJlMS0wOGU4NWQ1NWZiMzY=","isOnAB":false,"isNatural":1,"isDelete":false,"contentType":"","contentId":"","contentToken":""},{"name":"data函数","mention":"data函数","matchorder":1,"begin":2222,"end":2228,"entityid":-6946275531739401000,"isBookMark":false,"link":{"linkType":0,"linkUrl":"","docType":"","topicToken":""},"entityClass":"OtherTerm","score":0.0006218112789518615,"attachedInfoBytes":"sgJgCgpkYXRh5Ye95pWwEglPdGhlclRlcm0YrhEgtBEoATUMASM6OgdhcnRpY2xlQPflvZXP5vfMnwFIAFIkYjliOTJjYWQtZDg2Yi00YmVhLTgyZTEtMDhlODVkNTVmYjM28gLOAQokYjliOTJjYWQtZDg2Yi00YmVhLTgyZTEtMDhlODVkNTVmYjM2GgdhcnRpY2xlIgkyMzU0ODMwNzE6CmRhdGHlh73mlbBA9+W9lc\u002Fm98yfAUgKUhJhaV9lbnRpdHlfcmVjYWxsZXJdDAEjOmJgCgpkYXRh5Ye95pWwEglPdGhlclRlcm0YrhEgtBEoATUMASM6OgdhcnRpY2xlQPflvZXP5vfMnwFIAFIkYjliOTJjYWQtZDg2Yi00YmVhLTgyZTEtMDhlODVkNTVmYjM2","isOnAB":false,"isNatural":1,"isDelete":false,"contentType":"","contentId":"","contentToken":""},{"name":"线性地址指针","mention":"线性地址指针","matchorder":1,"begin":2295,"end":2301,"entityid":1169219976843799800,"isBookMark":false,"link":{"linkType":0,"linkUrl":"","docType":"","topicToken":""},"entityClass":"Math","score":0.0005693922839773435,"attachedInfoBytes":"sgJiChLnur\u002FmgKflnLDlnYDmjIfpkogSBE1hdGgY9xEg\u002FREoATVFQxU6OgdhcnRpY2xlQLjZwsD86\u002FmcEEgAUiRiOWI5MmNhZC1kODZiLTRiZWEtODJlMS0wOGU4NWQ1NWZiMzbyAtcBCiRiOWI5MmNhZC1kODZiLTRiZWEtODJlMS0wOGU4NWQ1NWZiMzYaB2FydGljbGUiCTIzNTQ4MzA3MToS57q\u002F5oCn5Zyw5Z2A5oyH6ZKIQLjZwsD86\u002FmcEEgLUhJhaV9lbnRpdHlfcmVjYWxsZXJdRUMVOmJiChLnur\u002FmgKflnLDlnYDmjIfpkogSBE1hdGgY9xEg\u002FREoATVFQxU6OgdhcnRpY2xlQLjZwsD86\u002FmcEEgAUiRiOWI5MmNhZC1kODZiLTRiZWEtODJlMS0wOGU4NWQ1NWZiMzY=","isOnAB":false,"isNatural":1,"isDelete":false,"contentType":"","contentId":"","contentToken":""},{"name":"杨-米尔斯理论","mention":"杨-米尔斯理论","matchorder":1,"begin":31315,"end":31322,"entityid":3092584630071582000,"isBookMark":false,"link":{"linkType":0,"linkUrl":"","docType":"","topicToken":""},"entityClass":"Unknown","score":0.0035388098686618408,"attachedInfoBytes":"sgJoChPmnagt57Gz5bCU5pav55CG6K66EgdVbmtub3duGNP0ASDa9AEoATVh62c7OgdhcnRpY2xlQI+6\u002F8nfqsT1KkgAUiRiOWI5MmNhZC1kODZiLTRiZWEtODJlMS0wOGU4NWQ1NWZiMzbyAuMBCiRiOWI5MmNhZC1kODZiLTRiZWEtODJlMS0wOGU4NWQ1NWZiMzYaB2FydGljbGUiCTIzNTQ4MzA3MToT5p2oLeexs+WwlOaWr+eQhuiuukCPuv\u002FJ36rE9SpIDFIXYmFpZHUtYmFpa2UtaXRlbS1yZWNhbGxdYetnO2JoChPmnagt57Gz5bCU5pav55CG6K66EgdVbmtub3duGNP0ASDa9AEoATVh62c7OgdhcnRpY2xlQI+6\u002F8nfqsT1KkgAUiRiOWI5MmNhZC1kODZiLTRiZWEtODJlMS0wOGU4NWQ1NWZiMzY=","isOnAB":false,"isNatural":1,"isDelete":false,"contentType":"","contentId":"","contentToken":""},{"name":"make_smem_ptr","mention":"make_smem_ptr","matchorder":1,"begin":2387,"end":2400,"entityid":-7700937659838758000,"isBookMark":false,"link":{"linkType":0,"linkUrl":"","docType":"","topicToken":""},"entityClass":"Math","score":0.0019182234577670987,"attachedInfoBytes":"sgJeCg1tYWtlX3NtZW1fcHRyEgRNYXRoGNMSIOASKAE15mz7OjoHYXJ0aWNsZUDbi4jf\u002Fr+xkJUBSABSJGI5YjkyY2FkLWQ4NmItNGJlYS04MmUxLTA4ZTg1ZDU1ZmIzNvICzwEKJGI5YjkyY2FkLWQ4NmItNGJlYS04MmUxLTA4ZTg1ZDU1ZmIzNhoHYXJ0aWNsZSIJMjM1NDgzMDcxOg1tYWtlX3NtZW1fcHRyQNuLiN\u002F+v7GQlQFIDVISYWlfZW50aXR5X3JlY2FsbGVyXeZs+zpiXgoNbWFrZV9zbWVtX3B0chIETWF0aBjTEiDgEigBNeZs+zo6B2FydGljbGVA24uI3\u002F6\u002FsZCVAUgAUiRiOWI5MmNhZC1kODZiLTRiZWEtODJlMS0wOGU4NWQ1NWZiMzY=","isOnAB":false,"isNatural":1,"isDelete":false,"contentType":"","contentId":"","contentToken":""},{"name":"auto cute","mention":"auto cute","matchorder":6,"begin":1953,"end":1962,"entityid":5661848930147092000,"isBookMark":false,"link":{"linkType":0,"linkUrl":"","docType":"","topicToken":""},"entityClass":"Math","score":0.00064260625164686,"attachedInfoBytes":"sgJZCglhdXRvIGN1dGUSBE1hdGgYoQ8gqg8oBjWTdCg6OgdhcnRpY2xlQOWM3+qqs7vJTkgAUiRiOWI5MmNhZC1kODZiLTRiZWEtODJlMS0wOGU4NWQ1NWZiMzbyAsUBCiRiOWI5MmNhZC1kODZiLTRiZWEtODJlMS0wOGU4NWQ1NWZiMzYaB2FydGljbGUiCTIzNTQ4MzA3MToJYXV0byBjdXRlQOWM3+qqs7vJTkgOUhJhaV9lbnRpdHlfcmVjYWxsZXJdk3QoOmJZCglhdXRvIGN1dGUSBE1hdGgYoQ8gqg8oBjWTdCg6OgdhcnRpY2xlQOWM3+qqs7vJTkgAUiRiOWI5MmNhZC1kODZiLTRiZWEtODJlMS0wOGU4NWQ1NWZiMzY=","isOnAB":false,"isNatural":1,"isDelete":false,"contentType":"","contentId":"","contentToken":""},{"name":"全局size函数","mention":"全局size函数","matchorder":1,"begin":1554,"end":1562,"entityid":-8106196356595022000,"isBookMark":false,"link":{"linkType":0,"linkUrl":"","docType":"","topicToken":""},"entityClass":"Computer","score":0.0006250026405579603,"attachedInfoBytes":"sgJlChDlhajlsYBzaXpl5Ye95pWwEghDb21wdXRlchiSDCCaDCgBNTjXIzo6B2FydGljbGVAtY7arMurwMCPAUgAUiRiOWI5MmNhZC1kODZiLTRiZWEtODJlMS0wOGU4NWQ1NWZiMzbyAtkBCiRiOWI5MmNhZC1kODZiLTRiZWEtODJlMS0wOGU4NWQ1NWZiMzYaB2FydGljbGUiCTIzNTQ4MzA3MToQ5YWo5bGAc2l6ZeWHveaVsEC1jtqsy6vAwI8BSA9SEmFpX2VudGl0eV9yZWNhbGxlcl041yM6YmUKEOWFqOWxgHNpemXlh73mlbASCENvbXB1dGVyGJIMIJoMKAE1ONcjOjoHYXJ0aWNsZUC1jtqsy6vAwI8BSABSJGI5YjkyY2FkLWQ4NmItNGJlYS04MmUxLTA4ZTg1ZDU1ZmIzNg==","isOnAB":false,"isNatural":1,"isDelete":false,"contentType":"","contentId":"","contentToken":""}],"id":663093816,"title":"cute 之 Tensor","type":"article","articleType":"normal","excerptTitle":"","url":"https:\u002F\u002Fzhuanlan.zhihu.com\u002Fp\u002F663093816","imageUrl":"https:\u002F\u002Fpicx.zhimg.com\u002Fv2-8db31200d4ae0956591ceb309d19962a_720w.jpg?source=172ae18b","titleImage":"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-8db31200d4ae0956591ceb309d19962a_720w.jpg?source=172ae18b","excerpt":"\u003Cimg src=\"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-7fc05e3a5603c600955729c5e2e4134c_200x112.png\" data-caption=\"Figure 1. local tile的几何解释\" data-size=\"normal\" data-rawwidth=\"1687\" data-rawheight=\"882\" data-watermark=\"watermark\" data-original-src=\"v2-7fc05e3a5603c600955729c5e2e4134c\" data-watermark-src=\"v2-97d7483ee5a4ca0d5fb5657d0754c194\" data-private-watermark-src=\"\" class=\"origin_image inline-img zh-lightbox-thumb\" data-original=\"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-7fc05e3a5603c600955729c5e2e4134c_r.png\"\u002F\u003E前面的章节介绍了 \u003Ca href=\"https:\u002F\u002Fzhuanlan.zhihu.com\u002Fp\u002F661182311\" class=\"internal\"\u003Ecute Layout\u003C\u002Fa\u003E以及\u003Ca href=\"https:\u002F\u002Fzhuanlan.zhihu.com\u002Fp\u002F662089556\" class=\"internal\"\u003ELayout的代数和几何解释\u003C\u002Fa\u003E，Layout描述了数据的排列和底层存储位置关系，但Layout并没有指定存储。Tensor就是在Layout的基础上包含了存储，即Tensor = Layout + storage，数据存储的具体表现上可以是指针表达的数据或则是栈…","created":1698403401,"updated":1698500631,"author":{"isFollowed":false,"avatarUrlTemplate":"https:\u002F\u002Fpicx.zhimg.com\u002Fv2-e9c299bcbb6d098601ce529e9a358d82.jpg?source=172ae18b","uid":"1064511094718017536","userType":"people","isFollowing":true,"urlToken":"reed-84-49","id":"2600b0313c76a175aa9e09a235382b79","description":"https:\u002F\u002Freed-lau.github.io","name":"reed","isAdvertiser":false,"headline":"从科学计算到高性能计算系统","gender":1,"url":"\u002Fpeople\u002F2600b0313c76a175aa9e09a235382b79","avatarUrl":"https:\u002F\u002Fpicx.zhimg.com\u002Fv2-e9c299bcbb6d098601ce529e9a358d82_l.jpg?source=172ae18b","isOrg":false,"type":"people","badge":[{"type":"identity","topics":[],"description":"中国科学院大学 理学博士"}],"badgeV2":{"title":"中国科学院大学 理学博士","mergedBadges":[{"type":"identity","detailType":"identity","title":"认证","description":"中国科学院大学 理学博士","url":"https:\u002F\u002Fzhuanlan.zhihu.com\u002Fp\u002F96956163","sources":[],"icon":"","nightIcon":""}],"detailBadges":[{"type":"identity","detailType":"identity_people","title":"已认证的个人","description":"中国科学院大学 理学博士","url":"https:\u002F\u002Fzhuanlan.zhihu.com\u002Fp\u002F96956163","sources":[],"icon":"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-2ddc5cc683982648f6f123616fb4ec09_l.png?source=32738c0c","nightIcon":"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-2ddc5cc683982648f6f123616fb4ec09_l.png?source=32738c0c"}],"icon":"https:\u002F\u002Fpicx.zhimg.com\u002Fv2-2ddc5cc683982648f6f123616fb4ec09_l.png?source=32738c0c","nightIcon":"https:\u002F\u002Fpicx.zhimg.com\u002Fv2-2ddc5cc683982648f6f123616fb4ec09_l.png?source=32738c0c"},"exposedMedal":{"medalId":"972477022068568064","medalName":"备受瞩目","avatarUrl":"https:\u002F\u002Fpicx.zhimg.com\u002Fv2-6da117205088242db9cd82e48b28640d_r.png?source=172ae18b","miniAvatarUrl":"https:\u002F\u002Fpicx.zhimg.com\u002Fv2-6da117205088242db9cd82e48b28640d_l.png?source=172ae18b","description":"被 1000 个人关注","medalAvatarFrame":""}},"commentPermission":"all","copyrightPermission":"need_review","state":"published","ipInfo":"IP 属地北京","imageWidth":1344,"imageHeight":1410,"content":"\u003Cp data-pid=\"O2cYeFBa\"\u003E前面的章节介绍了\u003Ca href=\"https:\u002F\u002Fzhuanlan.zhihu.com\u002Fp\u002F661182311\" class=\"internal\"\u003Ecute Layout\u003C\u002Fa\u003E以及\u003Ca href=\"https:\u002F\u002Fzhuanlan.zhihu.com\u002Fp\u002F662089556\" class=\"internal\"\u003ELayout的代数和几何解释\u003C\u002Fa\u003E，Layout描述了数据的排列和底层存储位置关系，但Layout并没有指定存储。Tensor就是在Layout的基础上包含了存储，即Tensor = Layout + storage，数据存储的具体表现上可以是指针表达的数据或则是栈上数据（GPU上表现为寄存器）。cute中的Tensor并不同于深度学习框架中的Tensor（如Pytorch、Tensorflow），深度学习框架中的Tensor更强调数据的表达实体，通过Tensor实体与实体之间的计算产生新的Tensor实体，即多份数据实体，cute中的Tensor更多的是对Tensor进行分解和组合等操作，而这些操作多是对Layout的变换（只是逻辑层面的数据组织形式），底层的数据实体一般不变更。也就是说深度学习框架中的Tensor是通过Tensor产生新Tensor，cute中是对数据表达形式的变换，底层数据一般不变更，指变更表达的形式，这个表达形式的变更是通过之前文章介绍的Layout上的运算实现的。之所以有这些差别是因为深度学习框架中的Tensor是用来表达数据实体，cute中的Tensor是偏向描述的实体。\u003C\u002Fp\u003E\u003Cp data-pid=\"VXxICH8F\"\u003E本文介绍了cute中Tensor的相关操作，通过阅读本文，开发者可以了解cute中Tensor的常用方法，熟悉Tensor方法的语义，为后续通过Tensor进行操作和变换提供基础知识。在文章结构方面，本文首先介绍cute中Tensor的常用函数，然后以一个向量求和的例子展示如何使用cute Tensor工具，最后文章对Tensor的特性和使用进行了总结。\u003C\u002Fp\u003E\u003Ch2\u003ETensor的生成\u003C\u002Fh2\u003E\u003Cdiv class=\"highlight\"\u003E\u003Cpre\u003E\u003Ccode class=\"language-cpp\"\u003E\u003Cspan class=\"c1\"\u003E\u002F\u002F 栈上对象：需同时指定类型和Layout，layout必须是静态shape\n\u003C\u002Fspan\u003E\u003Cspan class=\"c1\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003ETensor\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Emake_tensor\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003ET\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&gt;\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003ELayout\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Elayout\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E);\u003C\u002Fspan\u003E\n\n\u003Cspan class=\"c1\"\u003E\u002F\u002F 堆上对象：需指定pointer和Layout，layout可动可静\n\u003C\u002Fspan\u003E\u003Cspan class=\"c1\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003ETensor\u003C\u002Fspan\u003E \u003Cspan class=\"nf\"\u003Emake_tensor\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EPointer\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Epointer\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003ELayout\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Elayout\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E);\u003C\u002Fspan\u003E\n \n\u003Cspan class=\"c1\"\u003E\u002F\u002F 栈上对象，tensor的layout必须是静态的\n\u003C\u002Fspan\u003E\u003Cspan class=\"c1\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003ETensor\u003C\u002Fspan\u003E \u003Cspan class=\"nf\"\u003Emake_tensor_like\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003ETensor\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Etensor\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E);\u003C\u002Fspan\u003E \n\n\u003Cspan class=\"c1\"\u003E\u002F\u002F 栈上对象，tensor的layout必须是静态的\n\u003C\u002Fspan\u003E\u003Cspan class=\"c1\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003ETensor\u003C\u002Fspan\u003E \u003Cspan class=\"nf\"\u003Emake_fragment_like\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003ETensor\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Etensor\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E);\u003C\u002Fspan\u003E\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Cp data-pid=\"UQOWqIrY\"\u003E通过make_tensor可以方便的生成Tensor，常用的Tensor构造方式有两种，一种是栈上对象，如上形式1；第二种是堆上对象，通过指定pointer来实现；线性地址指针pointer，layout描述pointer指向的数据的layout，其可以是多hierarchy的。其中pointer可以通过\u003Ccode\u003Emake_gmem_ptr, make_smem_ptr\u003C\u002Fcode\u003E来生成。其中栈上的对象必须是静态的，堆上对象可以是动态也可以是静态，不存在动态的栈上结构，整体如下表格：\u003C\u002Fp\u003E\u003Ctable data-draft-node=\"block\" data-draft-type=\"table\" data-size=\"normal\" data-row-style=\"normal\"\u003E\u003Ctbody\u003E\u003Ctr\u003E\u003Ctd\u003E\u003C\u002Ftd\u003E\u003Ctd\u003EStatic\u003C\u002Ftd\u003E\u003Ctd\u003EDynamic\u003C\u002Ftd\u003E\u003C\u002Ftr\u003E\u003Ctr\u003E\u003Ctd\u003EHeap\u003Cbr\u002F\u003Enon-owning\u003C\u002Ftd\u003E\u003Ctd\u003Emake_tensor(ptr, make_shape(Int&lt;M&gt;{}, Int&lt;N&gt;{}));\u003Cbr\u002F\u003Emake_tensor_like(tensor);make_fragment_like(tensor);\u003C\u002Ftd\u003E\u003Ctd\u003Emake_tensor(ptr, make_shape(M, N));\u003C\u002Ftd\u003E\u003C\u002Ftr\u003E\u003Ctr\u003E\u003Ctd\u003EStack\u003Cbr\u002F\u003Eowning\u003C\u002Ftd\u003E\u003Ctd\u003Emake_tensor(make_shape(Int&lt;M&gt;, Int&lt;N&gt;{}));\u003Cbr\u002F\u003Emake_tensor_like(tensor);\u003Cbr\u002F\u003Emake_fragment_like(tensor);\u003C\u002Ftd\u003E\u003Ctd\u003ENA\u003C\u002Ftd\u003E\u003C\u002Ftr\u003E\u003C\u002Ftbody\u003E\u003C\u002Ftable\u003E\u003Ch2\u003ETensor维度信息查询\u003C\u002Fh2\u003E\u003Cp data-pid=\"IKc7OLgq\"\u003E全局\u003Ccode\u003Esize\u003C\u002Fcode\u003E函数可以获取tensor的元素的个数。其重载了比较运算，可以直接和整数类型进行比较。同时Tensor也提供了面向对象的方式来获取各个属性信息，其成员函数和全局函数如下：\u003C\u002Fp\u003E\u003Cdiv class=\"highlight\"\u003E\u003Cpre\u003E\u003Ccode class=\"language-cpp\"\u003E\u003Cspan class=\"c1\"\u003E\u002F\u002F 成员函数\n\u003C\u002Fspan\u003E\u003Cspan class=\"c1\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003ETensor\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E::\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Elayout\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E();\u003C\u002Fspan\u003E\n\u003Cspan class=\"n\"\u003ETensor\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E::\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Eshape\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E();\u003C\u002Fspan\u003E\n\u003Cspan class=\"n\"\u003ETensor\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E::\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Estride\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E();\u003C\u002Fspan\u003E\n\u003Cspan class=\"n\"\u003ETensor\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E::\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Esize\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E();\u003C\u002Fspan\u003E\n\n\u003Cspan class=\"c1\"\u003E\u002F\u002F 全局函数, 可以获取完整信息，或者通过&lt;&gt;获取某一个维度\n\u003C\u002Fspan\u003E\u003Cspan class=\"c1\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\"k\"\u003Eauto\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Ecute\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E::\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Elayout\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&lt;&gt;\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003ETensor\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Etensor\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E);\u003C\u002Fspan\u003E\n\u003Cspan class=\"k\"\u003Eauto\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Ecute\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E::\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Eshape\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&lt;&gt;\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003ETensor\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Etensor\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E);\u003C\u002Fspan\u003E\n\u003Cspan class=\"k\"\u003Eauto\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Ecute\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E::\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Estride\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&lt;&gt;\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003ETensor\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Etensor\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E);\u003C\u002Fspan\u003E\n\u003Cspan class=\"k\"\u003Eauto\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Ecute\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E::\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Esize\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&lt;&gt;\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003ETensor\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Etensor\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E);\u003C\u002Fspan\u003E\n\u003Cspan class=\"k\"\u003Eauto\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Ecute\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E::\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Erank\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&lt;&gt;\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003ETensor\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Etensor\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E);\u003C\u002Fspan\u003E \u003Cspan class=\"c1\"\u003E\u002F\u002F (1, (2, 3)) =&gt; rank 2 \n\u003C\u002Fspan\u003E\u003Cspan class=\"c1\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\"k\"\u003Eauto\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Ecute\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E::\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Edepth\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&lt;&gt;\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003ETensor\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Etensor\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E);\u003C\u002Fspan\u003E\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Ch2\u003ETensor的访问operator()\u002Foperator[]\u003C\u002Fh2\u003E\u003Cp data-pid=\"4RtdxW8T\"\u003ETensor可以通过\u003Cb\u003E括号运算符\u003C\u002Fb\u003E来实现对数据的访问（可读+可写）, 坐标可以使用一维的，也可以使用有层次的表示形式，具体的如下：\u003C\u002Fp\u003E\u003Cdiv class=\"highlight\"\u003E\u003Cpre\u003E\u003Ccode class=\"language-cpp\"\u003E\u003Cspan class=\"n\"\u003ETensor\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Etensor\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Emake_tensor\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Eptr\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Elayout\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E);\u003C\u002Fspan\u003E\n\u003Cspan class=\"k\"\u003Eauto\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Ecoord\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Emake_coord\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Eirow\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Eicol\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E);\u003C\u002Fspan\u003E\n\n\u003Cspan class=\"n\"\u003Etensor\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"mi\"\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"mi\"\u003E1\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E;\u003C\u002Fspan\u003E\n\u003Cspan class=\"n\"\u003Etensor\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"mi\"\u003E1\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"mi\"\u003E2\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"mi\"\u003E100\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E;\u003C\u002Fspan\u003E\n\u003Cspan class=\"n\"\u003Etensor\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Ecoord\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"mi\"\u003E200\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E;\u003C\u002Fspan\u003E\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Cp data-pid=\"Zd-1jxaA\"\u003E也可以通过\u003Ccode\u003Edata\u003C\u002Fcode\u003E函数直接获取数据存储空间的地址\u003C\u002Fp\u003E\u003Cdiv class=\"highlight\"\u003E\u003Cpre\u003E\u003Ccode class=\"language-text\"\u003ETensor::data();\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Ch2\u003ETensor的Slice\u003C\u002Fh2\u003E\u003Cp data-pid=\"XpGjz__v\"\u003E可以通过\u003Ccode\u003E_\u003C\u002Fcode\u003E来筛选（slice）特定轴，和Layout的表达形式一致，具体的代码如下：\u003C\u002Fp\u003E\u003Cdiv class=\"highlight\"\u003E\u003Cpre\u003E\u003Ccode class=\"language-cpp\"\u003E\u003Cspan class=\"n\"\u003ETensor\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Etensor\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Emake_tensor\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Eptr\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Emake_shape\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EM\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EN\u003C\u002Fspan\u003E\u003Cspan class=\"err\"\u003E，\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EK\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E));\u003C\u002Fspan\u003E \u003Cspan class=\"c1\"\u003E\u002F\u002F MxNxK\n\u003C\u002Fspan\u003E\u003Cspan class=\"c1\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003ETensor\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Etensor1\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Etensor\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003E_\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003E_\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"mi\"\u003E3\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E);\u003C\u002Fspan\u003E \u003Cspan class=\"c1\"\u003E\u002F\u002F MxN,k =3\n\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Ch2\u003ETensor的Take\u003C\u002Fh2\u003E\u003Cp data-pid=\"cLw_HiCs\"\u003E通过take函数提取take出[B, E)的轴上的数据\u003C\u002Fp\u003E\u003Cdiv class=\"highlight\"\u003E\u003Cpre\u003E\u003Ccode class=\"language-cpp\"\u003E\u003Cspan class=\"n\"\u003ETensor\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Etensor\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Emake_tensor\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Eptr\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Emake_shape\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EM\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EN\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EK\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E));\u003C\u002Fspan\u003E\n\u003Cspan class=\"n\"\u003ETensor\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Etensor1\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Etake\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\"mi\"\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"mi\"\u003E1\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&gt;\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Etensor\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E);\u003C\u002Fspan\u003E\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Ch2\u003ETensor的flatten\u003C\u002Fh2\u003E\u003Cp data-pid=\"vKyrp9Sq\"\u003E将层次的layout展开为一层（不是将M，N，K 展开为 MNK）\u003C\u002Fp\u003E\u003Cdiv class=\"highlight\"\u003E\u003Cpre\u003E\u003Ccode class=\"language-cpp\"\u003E\u003Cspan class=\"n\"\u003ETensor\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Etensor\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"p\"\u003E...;\u003C\u002Fspan\u003E  \u003Cspan class=\"c1\"\u003E\u002F\u002F M，N，K\n\u003C\u002Fspan\u003E\u003Cspan class=\"c1\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003ETensor\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Etensor1\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Eflatten\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Etensor\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E);\u003C\u002Fspan\u003E  \u003Cspan class=\"c1\"\u003E\u002F\u002F M，N，K\n\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Ch2\u003ETensor的层级合并coalesce\u003C\u002Fh2\u003E\u003Cp data-pid=\"DDUG-NnM\"\u003E层级中如果存在空间可连续的坐标，即stride意义下不存在空隙，则进行合并\u003C\u002Fp\u003E\u003Cdiv class=\"highlight\"\u003E\u003Cpre\u003E\u003Ccode class=\"language-cpp\"\u003E\u003Cspan class=\"n\"\u003ETensor\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Etensor\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Emake_tensor\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Eptr\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Emake_shape\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EM\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EN\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E));\u003C\u002Fspan\u003E\n\u003Cspan class=\"n\"\u003ETensor\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Etensor1\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Ecoalesce\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Etensor\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E);\u003C\u002Fspan\u003E\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Ch2\u003ETensor的主轴层级化group_modes\u003C\u002Fh2\u003E\u003Cp data-pid=\"-Jg_nVaF\"\u003E将[B,E)的主轴层级化为一个新的层级\u003C\u002Fp\u003E\u003Cdiv class=\"highlight\"\u003E\u003Cpre\u003E\u003Ccode class=\"language-cpp\"\u003E\u003Cspan class=\"n\"\u003ETensor\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Etensor\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"p\"\u003E...;\u003C\u002Fspan\u003E \u003Cspan class=\"c1\"\u003E\u002F\u002F 1, 2, 3, 4\n\u003C\u002Fspan\u003E\u003Cspan class=\"c1\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003ETensor\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Etensor1\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Egroup_modes\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EB\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EE\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&gt;\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Etensor\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E);\u003C\u002Fspan\u003E \u003Cspan class=\"c1\"\u003E\u002F\u002F B=1,E=3 =&gt; 1, &lt;2, 3&gt;, 4\n\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Ch2\u003ETensor的划分logical_divide\u002Ftiled_divide\u002Fzipped_divide\u003C\u002Fh2\u003E\u003Cp data-pid=\"xd-piE3p\"\u003Edivide是将tensor进行按照tile参数的大小进行划分，具体的可以参考前序文章“cute Layout代数和几何解释”中的除法的解释：\u003C\u002Fp\u003E\u003Cdiv class=\"highlight\"\u003E\u003Cpre\u003E\u003Ccode class=\"language-cpp\"\u003E\u003Cspan class=\"n\"\u003ETensor\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Etensor\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"p\"\u003E...;\u003C\u002Fspan\u003E\n\u003Cspan class=\"n\"\u003ETensor\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Etensor1\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Elogical_divide\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Etensor\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Etile\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E);\u003C\u002Fspan\u003E\n\u003Cspan class=\"n\"\u003ETensor\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Etensor2\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Ezipped_divide\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Etensor\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Etile\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E);\u003C\u002Fspan\u003E\n\u003Cspan class=\"n\"\u003ETensor\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Etensor3\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Etiled_divide\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Etensor\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Etile\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E);\u003C\u002Fspan\u003E\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Ch2\u003ELayout的乘积logical\u002Fzipped\u002Ftiled\u002Fblocked\u002Fraked\u003C\u002Fh2\u003E\u003Cp data-pid=\"fG8M4BWW\"\u003ETensor上没有定义乘法，只有Layout上有乘法，其表达了\u003Cb\u003E重复\u003C\u002Fb\u003E的语义：\u003C\u002Fp\u003E\u003Cdiv class=\"highlight\"\u003E\u003Cpre\u003E\u003Ccode class=\"language-cpp\"\u003E\u003Cspan class=\"n\"\u003ELayout\u003C\u002Fspan\u003E  \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"p\"\u003E..;\u003C\u002Fspan\u003E\n\u003Cspan class=\"n\"\u003ETile\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Etile\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"p\"\u003E...;\u003C\u002Fspan\u003E\n\u003Cspan class=\"n\"\u003ELayout\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Etensor1\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Elogical_product\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Elayout\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Etile\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E);\u003C\u002Fspan\u003E\n\u003Cspan class=\"n\"\u003ELayout\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Etensor2\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Ezipped_product\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Elayout\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Etile\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E);\u003C\u002Fspan\u003E\n\u003Cspan class=\"n\"\u003ELayout\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Etensor3\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Etiled_product\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Elayout\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Etile\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E);\u003C\u002Fspan\u003E\n\u003Cspan class=\"n\"\u003ELayout\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Etensor4\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Eblocked_product\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Elayout\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Etile\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E);\u003C\u002Fspan\u003E\n\u003Cspan class=\"n\"\u003ELayout\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Etensor5\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Eraked_product\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Elayout\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Etile\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E);\u003C\u002Fspan\u003E\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Ch2\u003ETensor的局部化切块local_tile\u003C\u002Fh2\u003E\u003Cp data-pid=\"XHQNX6cz\"\u003E该函数是Tensor中用户可以使用到的重要的函数，可以通过tile方法对tensor进行分块，通过local_tile可以实现从大的tensor中切取tile块，并且通过coord进行块的选取，以下代码展示了将维度为MNK的张量按照\u003Ccode\u003E2x3x4\u003C\u002Fcode\u003E的小块进行划分，取出其中的第\u003Ccode\u003E(1, 2, 3)\u003C\u002Fcode\u003E块。\u003C\u002Fp\u003E\u003Cdiv class=\"highlight\"\u003E\u003Cpre\u003E\u003Ccode class=\"language-cpp\"\u003E\u003Cspan class=\"n\"\u003ETensor\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Etensor\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Emake_tensor\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Eptr\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Emake_shape\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EM\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EN\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EK\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E));\u003C\u002Fspan\u003E\n\u003Cspan class=\"n\"\u003ETensor\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Etensor1\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Elocal_tile\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Etensor\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Emake_shape\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"mi\"\u003E2\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"mi\"\u003E3\u003C\u002Fspan\u003E\u003Cspan class=\"err\"\u003E，\u003C\u002Fspan\u003E\u003Cspan class=\"mi\"\u003E4\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E),\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Emake_coord\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"mi\"\u003E1\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"mi\"\u003E2\u003C\u002Fspan\u003E\u003Cspan class=\"err\"\u003E，\u003C\u002Fspan\u003E\u003Cspan class=\"mi\"\u003E3\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E));\u003C\u002Fspan\u003E\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Cfigure data-size=\"normal\"\u003E\u003Cnoscript\u003E\u003Cimg src=\"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-97d7483ee5a4ca0d5fb5657d0754c194_b.jpg\" data-size=\"normal\" data-rawwidth=\"1687\" data-rawheight=\"882\" class=\"origin_image zh-lightbox-thumb\" width=\"1687\" data-original=\"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-97d7483ee5a4ca0d5fb5657d0754c194_r.jpg\"\u002F\u003E\u003C\u002Fnoscript\u003E\u003Cimg src=\"data:image\u002Fsvg+xml;utf8,&lt;svg xmlns=&#39;http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg&#39; width=&#39;1687&#39; height=&#39;882&#39;&gt;&lt;\u002Fsvg&gt;\" data-size=\"normal\" data-rawwidth=\"1687\" data-rawheight=\"882\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"1687\" data-original=\"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-97d7483ee5a4ca0d5fb5657d0754c194_r.jpg\" data-actualsrc=\"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-97d7483ee5a4ca0d5fb5657d0754c194_b.jpg\" data-original-token=\"v2-7fc05e3a5603c600955729c5e2e4134c\"\u002F\u003E\u003Cfigcaption\u003EFigure 1. local tile的几何解释\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Cp data-pid=\"dUupOyRC\"\u003E如上图1所示，A Tensor表达了4行6列的行优先的数据，分块的tile大小为2x2, local_tile会将A矩阵按照tile的单位进行分块，然后根据坐标选取出(1, 1)位置的分块，如图则取出了（1，1）位置的tensor得到右下角的结果。\u003C\u002Fp\u003E\u003Ch2\u003ETensor的局部数据提取local_partition\u003C\u002Fh2\u003E\u003Cp data-pid=\"AVCKBFCX\"\u003Elocal  partition和local tile类似，现将大的Tensor按照tile大小进行分块，分块后每一块取出coordinate指定的元素形成新的块，代码形式和具体实例参考图2:\u003C\u002Fp\u003E\u003Cdiv class=\"highlight\"\u003E\u003Cpre\u003E\u003Ccode class=\"language-cpp\"\u003E\u003Cspan class=\"n\"\u003ETensor\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Etensor\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Emake_tensor\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Eptr\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"p\"\u003E...);\u003C\u002Fspan\u003E\n\u003Cspan class=\"n\"\u003ETensor\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Etensor1\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Elocal_partition\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Etensor\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Etile\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E);\u003C\u002Fspan\u003E\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Cfigure data-size=\"normal\"\u003E\u003Cnoscript\u003E\u003Cimg src=\"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-940f54c0095cfc2860f772d985cbb726_b.jpg\" data-size=\"normal\" data-rawwidth=\"1687\" data-rawheight=\"888\" class=\"origin_image zh-lightbox-thumb\" width=\"1687\" data-original=\"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-940f54c0095cfc2860f772d985cbb726_r.jpg\"\u002F\u003E\u003C\u002Fnoscript\u003E\u003Cimg src=\"data:image\u002Fsvg+xml;utf8,&lt;svg xmlns=&#39;http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg&#39; width=&#39;1687&#39; height=&#39;888&#39;&gt;&lt;\u002Fsvg&gt;\" data-size=\"normal\" data-rawwidth=\"1687\" data-rawheight=\"888\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"1687\" data-original=\"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-940f54c0095cfc2860f772d985cbb726_r.jpg\" data-actualsrc=\"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-940f54c0095cfc2860f772d985cbb726_b.jpg\" data-original-token=\"v2-f04a8382e2589cae2d56bcecfc049a6e\"\u002F\u003E\u003Cfigcaption\u003EFigure 2. local partition的几何解释\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Ch2\u003ETensor数据类型转换recast\u003C\u002Fh2\u003E\u003Cp data-pid=\"PEcJ-q0_\"\u003ETensor表达了特定的数据类型的数据，可以对其进行数据类型的重新解释，然后形成新的tensor，类似于C++中的reinterpret_cast语义，代码形式如下：\u003C\u002Fp\u003E\u003Cdiv class=\"highlight\"\u003E\u003Cpre\u003E\u003Ccode class=\"language-cpp\"\u003E\u003Cspan class=\"n\"\u003ETensor\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Etensor\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Emake_tensor\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\"kt\"\u003Efloat\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&gt;\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Emake_shape\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(...));\u003C\u002Fspan\u003E\n\u003Cspan class=\"n\"\u003ETensor\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Etensor1\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Erecast\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003ENewType\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&gt;\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Etensor\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E);\u003C\u002Fspan\u003E\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Ch2\u003ETensor内容的填充fill和清除clear\u003C\u002Fh2\u003E\u003Cp data-pid=\"RMZrGJ3J\"\u003E\u003Ccode\u003Eclear()\u003C\u002Fcode\u003E, \u003Ccode\u003Efill()\u003C\u002Fcode\u003E 可以对tensor进行元素级别的清除和填充操作\u003C\u002Fp\u003E\u003Cdiv class=\"highlight\"\u003E\u003Cpre\u003E\u003Ccode class=\"language-cpp\"\u003E\u003Cspan class=\"n\"\u003ETensor\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Etensor\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Emake_tensor\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(...);\u003C\u002Fspan\u003E\n\n\u003Cspan class=\"n\"\u003Eclear\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003ETensor\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E);\u003C\u002Fspan\u003E  \u003Cspan class=\"c1\"\u003E\u002F\u002F 使用T{}类型的默认构造函数对tensor进行赋值\n\u003C\u002Fspan\u003E\u003Cspan class=\"c1\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Efill\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003ETensor\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Etensor\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003ET\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Evalue\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E);\u003C\u002Fspan\u003E  \u003Cspan class=\"c1\"\u003E\u002F\u002F 将Tensor中的值填充为value值。\n\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Ch2\u003ETensor的线性组合axpby\u003C\u002Fh2\u003E\u003Cp data-pid=\"UZyeu9JS\"\u003E对两个tensor进行线性组合运算\u003Ccode\u003Ey = a*x + b*y\u003C\u002Fcode\u003E：\u003C\u002Fp\u003E\u003Cdiv class=\"highlight\"\u003E\u003Cpre\u003E\u003Ccode class=\"language-cpp\"\u003E\u003Cspan class=\"n\"\u003ETensor\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Ex\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Emake_tensor\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(...);\u003C\u002Fspan\u003E\n\u003Cspan class=\"n\"\u003ETensor\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Ey\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Emake_tensor_like\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Ex\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E);\u003C\u002Fspan\u003E\n\n\u003Cspan class=\"n\"\u003Eaxpby\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Ea\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Ex\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Eb\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Ey\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E);\u003C\u002Fspan\u003E\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Ch2\u003ETensor的打印print\u003C\u002Fh2\u003E\u003Cp data-pid=\"Ikp-bmeq\"\u003E可以通过全局print方法来完成对tensor的打印来debug和展示Tensor的信息，print会打印tensor存储空间所在的位置和shape、stride信息，而print_tensor除了以上信息还会打印Tensor中具体的每一个数值：\u003C\u002Fp\u003E\u003Cdiv class=\"highlight\"\u003E\u003Cpre\u003E\u003Ccode class=\"language-cpp\"\u003E\u003Cspan class=\"n\"\u003ETensor\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Etensor\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Emake_tensor\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(...);\u003C\u002Fspan\u003E\n\u003Cspan class=\"n\"\u003Eprint\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Etensor\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E);\u003C\u002Fspan\u003E\n\u003Cspan class=\"n\"\u003Eprint_tensor\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Etensor\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E);\u003C\u002Fspan\u003E\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Ch2\u003E特殊矩阵\u003C\u002Fh2\u003E\u003Cp data-pid=\"gC2x_5mK\"\u003E构造只有形状没有类型的tensor，用于一些特定变换：\u003C\u002Fp\u003E\u003Cdiv class=\"highlight\"\u003E\u003Cpre\u003E\u003Ccode class=\"language-cpp\"\u003E\u003Cspan class=\"n\"\u003ETensor\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Etensor\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Emake_identity_tensor\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Eshape\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E);\u003C\u002Fspan\u003E\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Ch2\u003E使用Tensor实现Vector Add示例：\u003C\u002Fh2\u003E\u003Cp data-pid=\"NZEMwcYS\"\u003E以上回顾了Tensor的常用操作和方法，下面我们通过具体的实例展示如何使用Tensor工具实现CUDA kernel来完成针对half类型数据的向量化的z = ax + by + c的计算。\u003C\u002Fp\u003E\u003Cp data-pid=\"RW_1hQVc\"\u003E对于该向量类问题，如果有丰富的CUDA 开发的经验，我们可以通过如下优化手段提供高效的实现：\u003C\u002Fp\u003E\u003Cul\u003E\u003Cli data-pid=\"pNxwPy7U\"\u003E单个线程处理多个数据，通过数据预取和指令并行，提升数据读取销量、提升执行单元的流水线效率；\u003C\u002Fli\u003E\u003Cli data-pid=\"p9g1-Ciw\"\u003E对global内存进行大字长读写，减少数据IO所需要的指令数目，减少调度开销，提升程序运行效率；\u003C\u002Fli\u003E\u003Cli data-pid=\"rE9nqHMh\"\u003E使用Half2类型，减少half类型引入的PRMT指令的转换和开销；\u003C\u002Fli\u003E\u003Cli data-pid=\"ALt-uO8x\"\u003E使用FMA（fused multiply accumulate）指令完成计算，减少FMUL、FADD指令数，提升计算精度；\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cp data-pid=\"cJr1s-iZ\"\u003E具体地，我们实现了如下函数，\u003C\u002Fp\u003E\u003Cdiv class=\"highlight\"\u003E\u003Cpre\u003E\u003Ccode class=\"language-cpp\"\u003E\u003Cspan class=\"c1\"\u003E\u002F\u002F z = ax + by + c\n\u003C\u002Fspan\u003E\u003Cspan class=\"c1\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\"k\"\u003Etemplate\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\"kt\"\u003Eint\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EkNumElemPerThread\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"mi\"\u003E8\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&gt;\u003C\u002Fspan\u003E\n\u003Cspan class=\"n\"\u003E__global__\u003C\u002Fspan\u003E \u003Cspan class=\"kt\"\u003Evoid\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Evector_add_local_tile_multi_elem_per_thread_half\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\n    \u003Cspan class=\"n\"\u003Ehalf\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E*\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Ez\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"kt\"\u003Eint\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Enum\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"k\"\u003Econst\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Ehalf\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E*\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Ex\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"k\"\u003Econst\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Ehalf\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E*\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Ey\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"k\"\u003Econst\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Ehalf\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Ea\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"k\"\u003Econst\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Ehalf\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Eb\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"k\"\u003Econst\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Ehalf\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Ec\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"p\"\u003E{\u003C\u002Fspan\u003E\n  \u003Cspan class=\"k\"\u003Eusing\u003C\u002Fspan\u003E \u003Cspan class=\"k\"\u003Enamespace\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Ecute\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E;\u003C\u002Fspan\u003E\n\n  \u003Cspan class=\"kt\"\u003Eint\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Eidx\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EthreadIdx\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Ex\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E+\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EblockIdx\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Ex\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E*\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EblockDim\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Ex\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E;\u003C\u002Fspan\u003E\n  \u003Cspan class=\"k\"\u003Eif\u003C\u002Fspan\u003E \u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Eidx\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E&gt;=\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Enum\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E\u002F\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EkNumElemPerThread\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"p\"\u003E{\u003C\u002Fspan\u003E \u003Cspan class=\"c1\"\u003E\u002F\u002F 未处理非对齐问题\n\u003C\u002Fspan\u003E\u003Cspan class=\"c1\"\u003E\u003C\u002Fspan\u003E    \u003Cspan class=\"k\"\u003Ereturn\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E;\u003C\u002Fspan\u003E\n  \u003Cspan class=\"p\"\u003E}\u003C\u002Fspan\u003E\n\n  \u003Cspan class=\"n\"\u003ETensor\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Etz\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Emake_tensor\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Emake_gmem_ptr\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Ez\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E),\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Emake_shape\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Enum\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E));\u003C\u002Fspan\u003E\n  \u003Cspan class=\"n\"\u003ETensor\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Etx\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Emake_tensor\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Emake_gmem_ptr\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Ex\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E),\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Emake_shape\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Enum\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E));\u003C\u002Fspan\u003E\n  \u003Cspan class=\"n\"\u003ETensor\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Ety\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Emake_tensor\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Emake_gmem_ptr\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Ey\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E),\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Emake_shape\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Enum\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E));\u003C\u002Fspan\u003E\n\n  \u003Cspan class=\"n\"\u003ETensor\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Etzr\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Elocal_tile\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Etz\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Emake_shape\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EInt\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EkNumElemPerThread\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&gt;\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E{}),\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Emake_coord\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Eidx\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E));\u003C\u002Fspan\u003E\n  \u003Cspan class=\"n\"\u003ETensor\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Etxr\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Elocal_tile\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Etx\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Emake_shape\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EInt\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EkNumElemPerThread\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&gt;\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E{}),\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Emake_coord\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Eidx\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E));\u003C\u002Fspan\u003E\n  \u003Cspan class=\"n\"\u003ETensor\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Etyr\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Elocal_tile\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Ety\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Emake_shape\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EInt\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EkNumElemPerThread\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&gt;\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E{}),\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Emake_coord\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Eidx\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E));\u003C\u002Fspan\u003E\n\n  \u003Cspan class=\"n\"\u003ETensor\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EtxR\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Emake_tensor_like\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Etxr\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E);\u003C\u002Fspan\u003E\n  \u003Cspan class=\"n\"\u003ETensor\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EtyR\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Emake_tensor_like\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Etyr\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E);\u003C\u002Fspan\u003E\n  \u003Cspan class=\"n\"\u003ETensor\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EtzR\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Emake_tensor_like\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Etzr\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E);\u003C\u002Fspan\u003E\n\n  \u003Cspan class=\"c1\"\u003E\u002F\u002F LDG.128\n\u003C\u002Fspan\u003E\u003Cspan class=\"c1\"\u003E\u003C\u002Fspan\u003E  \u003Cspan class=\"n\"\u003Ecopy\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Etxr\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EtxR\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E);\u003C\u002Fspan\u003E\n  \u003Cspan class=\"n\"\u003Ecopy\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Etyr\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EtyR\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E);\u003C\u002Fspan\u003E\n\n  \u003Cspan class=\"n\"\u003Ehalf2\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Ea2\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"p\"\u003E{\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Ea\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Ea\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E};\u003C\u002Fspan\u003E\n  \u003Cspan class=\"n\"\u003Ehalf2\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Eb2\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"p\"\u003E{\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Eb\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Eb\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E};\u003C\u002Fspan\u003E\n  \u003Cspan class=\"n\"\u003Ehalf2\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Ec2\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"p\"\u003E{\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Ec\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Ec\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E};\u003C\u002Fspan\u003E\n\n  \u003Cspan class=\"k\"\u003Eauto\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EtzR2\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Erecast\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Ehalf2\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&gt;\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EtzR\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E);\u003C\u002Fspan\u003E\n  \u003Cspan class=\"k\"\u003Eauto\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EtxR2\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Erecast\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Ehalf2\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&gt;\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EtxR\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E);\u003C\u002Fspan\u003E\n  \u003Cspan class=\"k\"\u003Eauto\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EtyR2\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Erecast\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Ehalf2\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&gt;\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EtyR\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E);\u003C\u002Fspan\u003E\n\n\u003Cspan class=\"cp\"\u003E#pragma unroll\n\u003C\u002Fspan\u003E\u003Cspan class=\"cp\"\u003E\u003C\u002Fspan\u003E  \u003Cspan class=\"k\"\u003Efor\u003C\u002Fspan\u003E \u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"kt\"\u003Eint\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Ei\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"mi\"\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E;\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Ei\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E&lt;\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Esize\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EtzR2\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E);\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E++\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Ei\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"p\"\u003E{\u003C\u002Fspan\u003E\n    \u003Cspan class=\"c1\"\u003E\u002F\u002F two hfma2 instruction\n\u003C\u002Fspan\u003E\u003Cspan class=\"c1\"\u003E\u003C\u002Fspan\u003E    \u003Cspan class=\"n\"\u003EtzR2\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Ei\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EtxR2\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Ei\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E*\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Ea2\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E+\u003C\u002Fspan\u003E \u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EtyR2\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Ei\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E*\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Eb2\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E+\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Ec2\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E);\u003C\u002Fspan\u003E\n  \u003Cspan class=\"p\"\u003E}\u003C\u002Fspan\u003E\n\n  \u003Cspan class=\"k\"\u003Eauto\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EtzRx\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Erecast\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Ehalf\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&gt;\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EtzR2\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E);\u003C\u002Fspan\u003E\n\n  \u003Cspan class=\"c1\"\u003E\u002F\u002F STG.128\n\u003C\u002Fspan\u003E\u003Cspan class=\"c1\"\u003E\u003C\u002Fspan\u003E  \u003Cspan class=\"n\"\u003Ecopy\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EtzRx\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Etzr\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E);\u003C\u002Fspan\u003E\n\u003Cspan class=\"p\"\u003E}\u003C\u002Fspan\u003E\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Cp data-pid=\"jtm9kkm-\"\u003E其中template行通过编译时常量指定每个线程处理8个数据，避免运行时常量不能利用寄存器（寄存器不可以寻址）所带来的Local Memory问题。由于一个线程处理8个元素，并且单个数据的大小为sizeof(half) = 2, 这样一个线程所需要的数据量为8 x 2 = 16byte，该大小的数据可以通过LDG.128指令实现一条指令完成对数据从全局内存到寄存器到加载；\u003C\u002Fp\u003E\u003Cp data-pid=\"g9YpTrMf\"\u003E其中函数声明行通过 __global__ 关键字指明该函数为cuda kernel函数，且通过const等信息提示了输入输出数据；\u003C\u002Fp\u003E\u003Cp data-pid=\"2rJkx4Zv\"\u003Eusing行引入cute的名字空间，以便使用cute名字空间中的Tensor工具和其他函数；\u003C\u002Fp\u003E\u003Cp data-pid=\"olQkHvzQ\"\u003Eidx和if判断行，通过使用cuda提供的内建threadIdx、blockIdx、blockDim变量来定位线程在网格中的位置；\u003C\u002Fp\u003E\u003Cp data-pid=\"LHG5hwym\"\u003ETensor tz、tx、ty行，通过利用make_tensor 接口将kernel参数中的裸指针和维度信息包装成tensor表达；\u003C\u002Fp\u003E\u003Cp data-pid=\"Ul9aRNbc\"\u003ETensor tzr、txr、tyr行，通过local_tile方法实现对tz\u002Ftx\u002Fty Tensor的分块和选择（利用idx），在这之后我们只需要关注我们需要处理的局部的tensor即可，无需关注大的全局的tensor。同时在进行局部切块的时候，我们使用Int&lt;&gt;{}形式实现形状的编译常量表示，避免了运行时的量及其会引入的local memory；\u003C\u002Fp\u003E\u003Cp data-pid=\"MrZMpBcw\"\u003ETensor txR、tyR、tzR行通过make_tensor_like接口实现栈上tensor的定义（GPU表现为寄存器空间）；\u003C\u002Fp\u003E\u003Cp data-pid=\"pA7GtlyJ\"\u003Ecopy行通过调用cute提供的copy函数实现全局内存数据读入到寄存器空间，此处会生成LDG.128指令；\u003C\u002Fp\u003E\u003Cp data-pid=\"uInSdXBC\"\u003Ehalf2 a2、b2、c2行，重复系数a、b、c构造half2类型的系数，以利用的HFMA2的指令完成后续计算；\u003C\u002Fp\u003E\u003Cp data-pid=\"H7azI1Wt\"\u003Eauto tzR2等行通过recast指令实现连续的half类型到half2类型的转换，以便能利用更高效的HFMA2指令；\u003C\u002Fp\u003E\u003Cp data-pid=\"HzAxWDD8\"\u003Epragma 及后续for行实现了多个元素的z = ax + by + c的计算，并且通过括号将该计算通过两个HFMA2指令实现，如果没有括号，则其会生成 HMUL2 + HMUL2 + HADD2 + HADD2指令（由于乘法不满足结合律，且IEEE规定了浮点数计算的顺序需按照代码书写顺序）；\u003C\u002Fp\u003E\u003Cp data-pid=\"slR9KzAl\"\u003E最后我们将结果cast回来并通过copy接口将计算结果存储到全局内存；\u003C\u002Fp\u003E\u003Cp data-pid=\"djvB6IeT\"\u003E值得注意的是，Tensor tz; Tensor tzr; 行看似是生成Tensor但实际其并没有涉及到全局内存到读写（并没有Tensor被拷贝），只是利用Layout进行tensor的表达和变换数，数据实体没有移动，只有在copy的时候才有实际的数据读写。这也回应了文章开头的对cute中Tensor和深度学习框架中的Tensor不一样，大部分时间，我们在cute中使用Tensor只是使用Tensor的逻辑语义和变换，并没有实质的触发Tensor的搬运。同时我们也看到我们使用Tensor语义和工具能够更形象化的表达我们的逻辑，方便我们的思考，而CUDA的优化思路和技巧并不会因为Tensor的引入而变简单或困难。Tensor只是工具，可以方便我们的表达，至于深层次的优化思路那还是对经验的挑战。\u003C\u002Fp\u003E\u003Ch2\u003E总结与讨论\u003C\u002Fh2\u003E\u003Cp data-pid=\"el4OM3_m\"\u003E本文介绍cute中Tensor常用的方法，并通过该Tensor工具完成了向量乘加法运算。Tensor是对数据表达的一种很好的抽象，我们可以利用这些抽象简化我们的思考模型（使我们的思考可以更抽象），降低编程困难，cute中提供的Tensor更多的是对Tensor的表达和变换，由Tensor生成Tensor只是Layout表达的变换并不产生数据实体的搬运（如local_tile）。Tensor表达虽然提供了很多方便，但也只限于表达的高效和便捷，如何对程序进行优化，Tensor表达的引入并没有提供额外帮助，它仍然需要我们从别的途径来获得。\u003C\u002Fp\u003E\u003Cp data-pid=\"AJ4z8RJ5\"\u003E即便如此，“表达和抽象”依然无比重要，那正如：伽罗瓦如果没有群这一表达工具，就难以解决多项式根的问题；杨振宁没有群这一工具就难以构思举世的杨-米尔斯理论。\u003C\u002Fp\u003E\u003Cp data-pid=\"s8XNPfmV\"\u003E抽象和工具让我们可以在更高的维度上思考。在后续文章中我们将基于Tensor（Layout）这种抽象进行MMA（matrix multiply accumulate）和COPY的介绍。\u003C\u002Fp\u003E","contentNeedTruncated":false,"adminClosedComment":false,"topics":[{"url":"https:\u002F\u002Fwww.zhihu.com\u002Fapi\u002Fv4\u002Ftopics\u002F19597236","type":"topic","id":"19597236","name":"CUDA"},{"url":"https:\u002F\u002Fwww.zhihu.com\u002Fapi\u002Fv4\u002Ftopics\u002F19570902","type":"topic","id":"19570902","name":"GPU 通用计算"},{"url":"https:\u002F\u002Fwww.zhihu.com\u002Fapi\u002Fv4\u002Ftopics\u002F19570894","type":"topic","id":"19570894","name":"图形处理器（GPU）"}],"voteupCount":86,"voting":1,"heavyUpStatus":"allow_heavy_up","column":{"description":"","canManage":false,"intro":"高性能计算中CUDA软硬件体系","isFollowing":false,"urlToken":"c_1696937812497235968","id":"c_1696937812497235968","articlesCount":14,"acceptSubmission":false,"title":"CUDA高性能编程","url":"https:\u002F\u002Fzhuanlan.zhihu.com\u002Fc_1696937812497235968","commentPermission":"all","created":1697361502,"updated":1697361502,"imageUrl":"https:\u002F\u002Fpic1.zhimg.com\u002F4b70deef7_720w.jpg?source=172ae18b","author":{"isFollowed":false,"avatarUrlTemplate":"https:\u002F\u002Fpicx.zhimg.com\u002Fv2-e9c299bcbb6d098601ce529e9a358d82.jpg?source=172ae18b","uid":"1064511094718017536","userType":"people","isFollowing":false,"urlToken":"reed-84-49","id":"2600b0313c76a175aa9e09a235382b79","description":"https:\u002F\u002Freed-lau.github.io","name":"reed","isAdvertiser":false,"headline":"从科学计算到高性能计算系统","gender":1,"url":"\u002Fpeople\u002F2600b0313c76a175aa9e09a235382b79","avatarUrl":"https:\u002F\u002Fpica.zhimg.com\u002Fv2-e9c299bcbb6d098601ce529e9a358d82_l.jpg?source=172ae18b","isOrg":false,"type":"people","badgeV2":{"title":"","mergedBadges":[],"detailBadges":[],"icon":"","nightIcon":""}},"followers":1,"type":"column"},"commentCount":17,"contributions":[{"id":46911553,"state":"accepted","type":"first_publish","column":{"description":"","canManage":false,"intro":"高性能计算中CUDA软硬件体系","isFollowing":false,"urlToken":"c_1696937812497235968","id":"c_1696937812497235968","articlesCount":14,"acceptSubmission":false,"title":"CUDA高性能编程","url":"https:\u002F\u002Fzhuanlan.zhihu.com\u002Fc_1696937812497235968","commentPermission":"all","created":1697361502,"updated":1697361502,"imageUrl":"https:\u002F\u002Fpic1.zhimg.com\u002F4b70deef7_720w.jpg?source=172ae18b","author":{"isFollowed":false,"avatarUrlTemplate":"https:\u002F\u002Fpicx.zhimg.com\u002Fv2-e9c299bcbb6d098601ce529e9a358d82.jpg?source=172ae18b","uid":"1064511094718017536","userType":"people","isFollowing":false,"urlToken":"reed-84-49","id":"2600b0313c76a175aa9e09a235382b79","description":"https:\u002F\u002Freed-lau.github.io","name":"reed","isAdvertiser":false,"headline":"从科学计算到高性能计算系统","gender":1,"url":"\u002Fpeople\u002F2600b0313c76a175aa9e09a235382b79","avatarUrl":"https:\u002F\u002Fpica.zhimg.com\u002Fv2-e9c299bcbb6d098601ce529e9a358d82_l.jpg?source=172ae18b","isOrg":false,"type":"people","badgeV2":{"title":"","mergedBadges":[],"detailBadges":[],"icon":"","nightIcon":""}},"followers":1,"type":"column"}}],"isTitleImageFullScreen":false,"upvotedFollowees":[],"commercialInfo":{"isCommercial":false,"plugin":{}},"suggestEdit":{"status":false,"reason":"","tip":"","url":"","title":""},"reason":"","annotationAction":[],"canTip":false,"tipjarorsCount":0,"isLabeled":true,"hasPublishingDraft":false,"isFavorited":true,"favlistsCount":114,"isNormal":true,"status":0,"activityToppingInfo":{"state":"untopped"},"shareText":"cute 之 Tensor - 来自知乎专栏「CUDA高性能编程」，作者: reed https:\u002F\u002Fzhuanlan.zhihu.com\u002Fp\u002F663093816 （想看更多？下载 @知乎 App：http:\u002F\u002Fweibo.com\u002Fp\u002F100404711598 ）","canComment":{"status":true,"reason":""},"mcnFpShow":-1,"isVisible":true,"isLiked":true,"likedCount":14,"hasColumn":true,"republishers":[],"isNewLinkCard":true,"emojiReaction":{"likeCount":14,"likeHasSet":true},"abParam":{"pnNbtoolbar":"0","qaFotoolbar":"1","qaHiddenVoteup":"1","qaNewdownvote":"1","rsInterest1":"","zpZhiStyle":""},"attachedInfo":"kgIkCgkyMzU0ODMwNzESCTY2MzA5MzgxNhgHIgpJTUFHRV9URVhU","shareGuide":{"hasPositiveBubble":false,"hasTimeBubble":false,"hitShareGuideCluster":false},"settings":{"tableOfContents":{"enabled":true}},"canReference":false,"reactionInstruction":{},"reaction":{"statistics":{"upVoteCount":86,"downVoteCount":0,"likeCount":14,"commentCount":17,"shareCount":0,"playCount":0,"interestPlayCount":0,"favorites":114,"pvCount":0,"bulletCount":0,"applaudCount":0,"questionFollowerCount":0,"questionAnswerCount":0,"plaincontentVoteUpCount":0,"plaincontentLikeCount":0,"imgLikeCount":{"v27fc05e3a5603c600955729c5e2e4134c":0,"v28db31200d4ae0956591ceb309d19962a":0,"v2F04a8382e2589cae2d56bcecfc049a6e":0}},"relation":{"isAuthor":false,"vote":"UP","liked":true,"imgLiked":{"v27fc05e3a5603c600955729c5e2e4134c":false,"v28db31200d4ae0956591ceb309d19962a":false,"v2F04a8382e2589cae2d56bcecfc049a6e":false},"faved":true},"imageReactions":{"v27fc05e3a5603c600955729c5e2e4134c":{"likeCount":0,"isLiked":false},"v28db31200d4ae0956591ceb309d19962a":{"likeCount":0,"isLiked":false},"v2F04a8382e2589cae2d56bcecfc049a6e":{"likeCount":0,"isLiked":false}}},"interactionBarPlugins":[{"type":"comment","comment":{"enable":true,"placeholder":"发条带图评论"}}],"barPluginsFlipTime":3000}},"columns":{"c_1696937812497235968":{"description":"","canManage":false,"intro":"高性能计算中CUDA软硬件体系","isFollowing":false,"urlToken":"c_1696937812497235968","id":"c_1696937812497235968","articlesCount":14,"acceptSubmission":false,"title":"CUDA高性能编程","url":"https:\u002F\u002Fzhuanlan.zhihu.com\u002Fc_1696937812497235968","commentPermission":"all","created":1697361502,"updated":1697361502,"imageUrl":"https:\u002F\u002Fpic1.zhimg.com\u002F4b70deef7_720w.jpg?source=172ae18b","author":{"isFollowed":false,"avatarUrlTemplate":"https:\u002F\u002Fpicx.zhimg.com\u002Fv2-e9c299bcbb6d098601ce529e9a358d82.jpg?source=172ae18b","uid":"1064511094718017536","userType":"people","isFollowing":false,"urlToken":"reed-84-49","id":"2600b0313c76a175aa9e09a235382b79","description":"https:\u002F\u002Freed-lau.github.io","name":"reed","isAdvertiser":false,"headline":"从科学计算到高性能计算系统","gender":1,"url":"\u002Fpeople\u002F2600b0313c76a175aa9e09a235382b79","avatarUrl":"https:\u002F\u002Fpica.zhimg.com\u002Fv2-e9c299bcbb6d098601ce529e9a358d82_l.jpg?source=172ae18b","isOrg":false,"type":"people","badgeV2":{"title":"","mergedBadges":[],"detailBadges":[],"icon":"","nightIcon":""}},"followers":1,"type":"column"}},"topics":{},"roundtables":{},"favlists":{},"comments":{},"notifications":{},"ebooks":{},"activities":{},"feeds":{},"pins":{},"promotions":{},"drafts":{},"chats":{},"posts":{},"zvideos":{},"zvideoContributions":{},"eduCourses":{}},"currentUser":"d4901200cbf4b641d3bc073c37356443","account":{"unlockTicketStatus":false,"unlockTicket":null,"challenge":[],"errorStatus":false,"message":"","isFetching":false,"accountInfo":{},"urlToken":{"loading":false},"cardUserInfo":{"vipInfo":{}},"handleWidget":{},"widgetList":[],"userWidgetId":""},"settings":{"socialBind":null,"inboxMsg":null,"notification":{},"email":{},"privacyFlag":null,"blockedUsers":{"isFetching":false,"paging":{"pageNo":1,"pageSize":6},"data":[]},"blockedFollowees":{"isFetching":false,"paging":{"pageNo":1,"pageSize":6},"data":[]},"ignoredTopics":{"isFetching":false,"paging":{"pageNo":1,"pageSize":6},"data":[]},"restrictedTopics":null,"laboratory":{}},"notification":{},"people":{"profileStatus":{},"activitiesByUser":{},"answersByUser":{},"answersSortByVotesByUser":{},"answersIncludedByUser":{},"votedAnswersByUser":{},"thankedAnswersByUser":{},"voteAnswersByUser":{},"thankAnswersByUser":{},"topicAnswersByUser":{},"zvideosByUser":{},"articlesByUser":{},"articlesSortByVotesByUser":{},"articlesIncludedByUser":{},"pinsByUser":{},"questionsByUser":{},"commercialQuestionsByUser":{},"favlistsByUser":{},"followingByUser":{},"followersByUser":{},"mutualsByUser":{},"followingColumnsByUser":{},"followingQuestionsByUser":{},"followingFavlistsByUser":{},"followingTopicsByUser":{},"publicationsByUser":{},"columnsByUser":{},"allFavlistsByUser":{},"brands":null,"creationsByUser":{},"creationsSortByVotesByUser":{},"creationsFeed":{},"infinity":{},"batchUsers":{},"profileInfinity":null},"env":{"abV2":{"config":{"paramMap":{"ws_qiangzhisafe":{"value":"1","abId":"rl-qiangzhisafe_copy-1"},"ws_must_login":{"value":"0","abId":"must_login-0"},"ws_publish_answer":{"value":"1","abId":"rl-pc_pub_answer_2-1"},"ws_publish_post":{"value":"1","abId":"rl-publish_article-1"},"pc_mou_cre_remove":{"value":"1","abId":"rl-mou_create_remove-1"},"ws_platform_new":{"value":"1","abId":"author_platform-1"},"ws_video_publish":{"value":"1","abId":"rl-video_contentpub-1"},"ws_group":{"value":"0"},"ws_publish_ask":{"value":"1","abId":"rl-pc_publish_ask-1"},"ws_is_show":{"value":"0"}},"abMap":{"rl-qiangzhisafe_copy-1":{"abId":"rl-qiangzhisafe_copy-1","layerId":"rl-qiangzhisafe_copy"},"must_login-0":{"abId":"must_login-0","layerId":"web_standard_domain_layer2"},"rl-pc_pub_answer_2-1":{"abId":"rl-pc_pub_answer_2-1","layerId":"rl-pc_pub_answer_2","diversionType":2},"rl-publish_article-1":{"abId":"rl-publish_article-1","layerId":"rl-publish_article","diversionType":2},"rl-mou_create_remove-1":{"abId":"rl-mou_create_remove-1","layerId":"rl-mou_create_remove","diversionType":2},"author_platform-1":{"abId":"author_platform-1","layerId":"author_platform_layer","diversionType":2},"rl-video_contentpub-1":{"abId":"rl-video_contentpub-1","layerId":"rl-video_contentpub","diversionType":2},"rl-pc_publish_ask-1":{"abId":"rl-pc_publish_ask-1","layerId":"rl-pc_publish_ask","diversionType":2}}},"triggers":{}},"userAgent":{"Edge":false,"IE":false,"Wechat":false,"Weibo":false,"QQ":false,"MQQBrowser":false,"Qzone":false,"Mobile":false,"Android":false,"HarmonyOS":false,"iOS":false,"isAppleDevice":true,"Zhihu":false,"ZhihuHybrid":false,"isBot":false,"Tablet":false,"UC":false,"Quark":false,"Sogou":false,"Qihoo":false,"Baidu":false,"BaiduApp":false,"Safari":false,"GoogleBot":false,"AndroidDaily":false,"iOSDaily":false,"WxMiniProgram":false,"BaiduMiniProgram":false,"QQMiniProgram":false,"JDMiniProgram":false,"isWebView":false,"isMiniProgram":false,"origin":"Mozilla\u002F5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit\u002F537.36 (KHTML, like Gecko) Chrome\u002F126.0.0.0 Safari\u002F537.36"},"appViewConfig":{},"ctx":{"path":"\u002Fp\u002F663093816","query":{},"href":"http:\u002F\u002Fzhuanlan.zhihu.com\u002Fp\u002F663093816","host":"zhuanlan.zhihu.com"},"trafficSource":"production","edition":{"beijing":false,"baidu":false,"sogou":false,"baiduBeijing":false,"sogouBeijing":false,"sogouInput":false,"oppoSearch":false,"baiduSearch":false,"googleSearch":false,"shenma":false,"miniProgram":false,"xiaomi":false,"huaweiSearch":false},"theme":"light","appHeaderTheme":{"current":"normal","disable":true,"normal":{"bgColor":"GBK99A"},"custom":{"bgColor":"GBK99A"}},"enableShortcut":true,"referer":"","xUDId":"AGAQrYF5yRiPTg-1l2ERiyXvjJVrbIJnf3U=","mode":"ssr","conf":{},"xTrafficFreeOrigin":"","ipInfo":{"cityName":"广州","countryName":"中国","regionName":"广东","countryCode":"CN"},"logged":true,"vars":{"passThroughHeaders":{}}},"me":{"columnContributions":[]},"label":{},"ecommerce":{},"comments":{"pagination":{},"collapsed":{},"reverse":{},"reviewing":{},"conversation":{},"parent":{}},"commentsV2":{"stickers":[],"commentWithPicPermission":{},"notificationsComments":{},"pagination":{},"collapsed":{},"reverse":{},"reviewing":{},"conversation":{},"conversationMore":{},"parent":{}},"pushNotifications":{"default":{"isFetching":false,"isDrained":false,"ids":[]},"follow":{"isFetching":false,"isDrained":false,"ids":[]},"vote_thank":{"isFetching":false,"isDrained":false,"ids":[]},"currentTab":"default","notificationsCount":{"default":0,"follow":0,"vote_thank":0}},"messages":{"data":{},"currentTab":"common","messageCount":0},"register":{"registerValidateSucceeded":null,"registerValidateErrors":{},"registerConfirmError":null,"sendDigitsError":null,"registerConfirmSucceeded":null},"login":{"loginUnregisteredError":false,"loginBindWechatError":false,"loginConfirmError":null,"sendDigitsError":null,"needSMSIdentify":false,"validateDigitsError":false,"loginConfirmSucceeded":null,"qrcodeLoginToken":"","qrcodeLoginScanStatus":0,"qrcodeLoginError":null,"qrcodeLoginReturnNewToken":false},"switches":{},"captcha":{"captchaNeeded":false,"captchaValidated":false},"sms":{"supportedCountries":[]},"chat":{"chats":{},"inbox":{"recents":{"isFetching":false,"isDrained":false,"isPrevDrained":false,"result":[],"next":null,"key":null},"strangers":{"isFetching":false,"isDrained":false,"isPrevDrained":false,"result":[],"next":null,"key":null},"friends":{"isFetching":false,"isDrained":false,"isPrevDrained":false,"result":[],"next":null,"key":null},"search":{"isFetching":false,"isDrained":false,"isPrevDrained":false,"result":[],"next":null,"key":null},"config":{"newCount":0,"strangerMessageSwitch":false,"strangerMessageUnread":false,"friendCount":0}},"global":{"isChatMqttExisted":false}},"emoticons":{"emoticonGroupList":[],"emoticonGroupDetail":{}},"creator":{"tools":{"question":{"invitationCount":{"questionFolloweeCount":0,"questionTotalCount":0}},"recommend":{"recommendTimes":{}}},"explore":{},"levelUpperLimit":10,"mcn":{},"mcnManage":{},"tasks":{},"announcement":{},"creatorsRecommendInfo":{}},"creators":{"common":{"applyStatus":{},"rightsStatus":{}},"bayesDomains":{"status":{},"options":{"topDomains":null,"allDomains":null,"editable":0},"contents":null},"school":{"tabs":[],"contents":[],"banner":null,"entities":{}},"faq":{"tabs":[],"article":{}},"knowledgeIncome":{},"safeguardRights":{},"analytics":{"all":{},"answer":{},"zvideo":{},"article":{},"pin":{},"singleContent":{}},"account":{"growthLevel":{}},"KMResource":{},"training":{},"ToolsQuestion":{"goodatTopics":[]},"ToolsHotspot":{"domains":[]},"ToolsRecommend":{},"ToolsCustomPromotion":{"itemLists":{},"baseInfo":{}},"ToolsSearchQuestion":{},"editorSetting":{},"MCNManage":{},"knowledgeTasks":{},"incomeAnalysis":{"income":{"aggregation":{}}},"creationManage":{"editModal":{"status":false}},"activity":{},"announcement":{},"home":{"currentCreatorUrlToken":null,"rights":[],"newRights":[],"scoreInfo":{},"menusShowControlByServer":{"bVipRecomend":false,"creationRelationship":false},"newTasks":{"creatorTask":{"tasks":[],"des":[]}},"bannerList":[],"recentlyCreated":[],"homecard":{},"homeData":{}},"videoSupport":{"textBenefit":{}},"videoDistribution":{},"profilePoster":{"creatorPosterConfig":{},"creatorPosterData":{}}},"answers":{"voters":{},"upvoters":{},"copyrightApplicants":{},"favlists":{},"newAnswer":{},"entityWords":{},"paidContent":{},"settings":{},"relationEndorsement":{},"interests":{}},"recommendation":{"homeRecommendations":[]},"shareTexts":{},"articles":{"voters":{},"upvoters":{},"relationEndorsement":{}},"previewPost":{},"favlists":{"relations":{}},"columns":{"voters":{}},"reward":{"answer":{},"article":{},"question":{}},"video":{"data":{},"shareVideoDetail":{},"last":{}},"topstory":{"recommend":{"isFetching":false,"isDrained":false,"afterId":0,"items":[],"next":null},"follow":{"isFetching":false,"isDrained":false,"afterId":0,"items":[],"next":null},"followWonderful":{"isFetching":false,"isDrained":false,"afterId":0,"items":[],"next":null},"sidebar":null,"announcement":{},"hotList":[],"hotListHeadZone":[],"guestFeeds":{"isFetching":false,"isDrained":false,"afterId":0,"items":[],"next":null},"followExtra":{"isNewUser":null,"isFetched":false,"followCount":0,"followers":[]},"hotDaily":{"data":[],"paging":{}},"hotHighlight":{"isFetching":false,"isDrained":false,"data":[],"paging":{}},"banner":{},"commercialBanner":{"show":false,"banner":{},"trackData":{}},"video":{"items":[],"next":null,"isLoading":false,"isDrained":false}},"readStatus":{},"column":{},"requestColumn":{"categories":[],"error":null},"articleContribution":{"contributeRequests":[],"deleteContributeIdList":[],"handledContributeIdList":[],"recommendedColumns":[],"pinnedColumns":[],"sentContributeRequestsIdList":[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"c_1696937812497235968"]},"columnContribution":{"contributeRequests":[],"autoInviteEnabled":false,"recommendedContributors":[]},"draftHistory":{"history":{},"drafts":{}},"upload":{},"articleDraft":{"titleImage":"","titleImageSize":{},"isTitleImageFullScreen":false,"canTitleImageFullScreen":false,"title":"","titleImageUploading":false,"error":"","content":"","draftLoading":false,"updating":false,"globalLoading":false,"pendingVideo":{"resource":null,"error":null},"deleteFail":{"fail":false},"recommendTopics":[],"selectedColumn":0,"articleDisclaimers":[]},"articleDrafts":{"isDrained":false,"isLoading":false,"items":[]},"columnAutocomplete":{"users":[],"friends":[]},"columnCollection":{},"userProfit":{"permission":{"permissionStatus":{"zhiZixuan":0,"recommend":-1,"task":0,"plugin":0,"infinity":0},"visible":false},"linkCardLimit":0},"mcn":{"bindInfo":{},"memberCategoryList":[],"producerList":[],"categoryList":[],"lists":{},"banners":{},"protocolStatus":{"isAgreedNew":true,"isAgreedOld":true},"probationCountdownDays":0},"zvideos":{"campaignVideoList":{},"campaigns":{},"tagoreCategory":[],"recommendations":{},"insertable":{},"recruit":{"form":{"platform":"","nickname":"","followerCount":"","domain":"","contact":""},"submited":false,"ranking":[]},"qyActivityData":{},"talkActivityData":{},"party2022ActivityData":{},"batchVideos":{},"contribution":{"selectedContribution":null,"campaign":null,"configs":{},"contributionLists":{},"recommendQuestions":{"isLoading":true,"paging":{"isEnd":false,"isStart":true,"totals":0},"data":[]},"questionSearchResults":{"isLoading":true,"paging":{"isEnd":false,"isStart":true,"totals":0},"data":[]}},"creationReferences":{},"zvideoCollection":{},"zvideoGrant":{},"collectData":{"isFetching":false,"list":[]},"videoSource":{"isLoaded":false}},"republish":{},"commentPermission":{},"creatorRightStatus":{"list":[]},"adPromotion":{"answer":{},"article":{}}},"fetchHost":"www.zhihu.com","subAppName":"column","spanName":"Post","canaryConfig":{"test_canary":"0","use_new_player":"0","player_vendor":"0","use_hevc":"1","upload_use_signature":"1","use_backdrop_blur":"1","article_title_imagex":"1","play_station":"1","use_cached_supported_countries":"1"}}</script><script crossorigin="" src="./cute 之 Tensor - 知乎_files/vendor.b2043823c211547b094b.js"></script><script crossorigin="" src="./cute 之 Tensor - 知乎_files/react.production.min.js"></script><script crossorigin="" src="./cute 之 Tensor - 知乎_files/react-dom.production.min.js"></script><script crossorigin="" src="./cute 之 Tensor - 知乎_files/react-dom-server.browser.production.min.js"></script><script crossorigin="" src="./cute 之 Tensor - 知乎_files/runtime.app.5bd37fc1293b7bf52664.js"></script><script crossorigin="" src="./cute 之 Tensor - 知乎_files/lib-75fc9c18.app.3db651c252e14ef6658e.js"></script><script crossorigin="" src="./cute 之 Tensor - 知乎_files/lib-29107295.app.42d07f814b7b05187671.js"></script><script crossorigin="" src="./cute 之 Tensor - 知乎_files/lib-79b5cf47.app.8b6b6bf4b6d894db9b07.js"></script><script crossorigin="" src="./cute 之 Tensor - 知乎_files/lib-330004dc.app.7437cf54ac28fca0e302.js"></script><script crossorigin="" src="./cute 之 Tensor - 知乎_files/lib-f3572862.app.d7ec7e2db90ddb91c8f1.js"></script><script crossorigin="" src="./cute 之 Tensor - 知乎_files/lib-0e5ce61e.app.b22b78c2be57c983262f.js"></script><script crossorigin="" src="./cute 之 Tensor - 知乎_files/lib-83b0f42f.app.e34e650850a4762e3d73.js"></script><script crossorigin="" src="./cute 之 Tensor - 知乎_files/lib-38cf5c11.app.0ef475c02226ac0ff291.js"></script><script crossorigin="" src="./cute 之 Tensor - 知乎_files/lib-2ec050f6.app.3130baf54e01ef0a8956.js"></script><script crossorigin="" src="./cute 之 Tensor - 知乎_files/lib-9b20c40c.app.e400308f4969b7849daf.js"></script><script crossorigin="" src="./cute 之 Tensor - 知乎_files/1907.app.d9386c63ba90d5e0d998.js"></script><script crossorigin="" src="./cute 之 Tensor - 知乎_files/column.app.b14fe13639a65f8c96c4.js"></script><script defer="" src="./cute 之 Tensor - 知乎_files/aria.js" id="ariascripts" wapforceoldfixed="false" loaddata="false"></script><script src="./cute 之 Tensor - 知乎_files/hm.js" async=""></script><script crossorigin="" src="./cute 之 Tensor - 知乎_files/zap.js"></script><div><div style="display: none;"><i>想来知乎工作？请发送邮件到 jobs@zhihu.com</i></div></div><script src="./cute 之 Tensor - 知乎_files/push.js"></script><div><div><div class="css-8pdeid"></div></div></div><script crossorigin="" src="./cute 之 Tensor - 知乎_files/emoticon.js"></script><div><div><div class="Editable-languageSuggestions" style="left: -1179px; top: -999px;"><div><div class="Popover"><label class="Editable-languageSuggestionsInput Input-wrapper"><input autocomplete="off" role="combobox" aria-expanded="false" aria-autocomplete="list" aria-activedescendant="AutoComplete8-0" id="Popover7-toggle" aria-haspopup="true" class="Input" placeholder="选择语言" value=""><svg width="24" height="24" viewBox="0 0 24 24" fill="#afbdcf" class="Zi Zi--Select" data-darkreader-inline-fill="" style="--darkreader-inline-fill: #a7baca;"><path fill-rule="evenodd" d="M12.53 3.47a.75.75 0 0 0-1.06 0l-5 5a.75.75 0 0 0 1.06 1.06L12 5.06l4.47 4.47a.75.75 0 1 0 1.06-1.06l-5-5Zm-5 11a.75.75 0 0 0-1.06 1.06l5 5a.75.75 0 0 0 1.06 0l5-5a.75.75 0 1 0-1.06-1.06L12 18.94l-4.47-4.47Z" clip-rule="evenodd"></path></svg></label></div></div></div></div></div><div><div><div class="Editable-languageSuggestions" style="left: -1179px; top: -999px;"><div><div class="Popover"><label class="Editable-languageSuggestionsInput Input-wrapper"><input autocomplete="off" role="combobox" aria-expanded="false" aria-autocomplete="list" aria-activedescendant="AutoComplete10-0" id="Popover9-toggle" aria-haspopup="true" class="Input" placeholder="选择语言" value=""><svg width="24" height="24" viewBox="0 0 24 24" fill="#afbdcf" class="Zi Zi--Select" data-darkreader-inline-fill="" style="--darkreader-inline-fill: #a7baca;"><path fill-rule="evenodd" d="M12.53 3.47a.75.75 0 0 0-1.06 0l-5 5a.75.75 0 0 0 1.06 1.06L12 5.06l4.47 4.47a.75.75 0 1 0 1.06-1.06l-5-5Zm-5 11a.75.75 0 0 0-1.06 1.06l5 5a.75.75 0 0 0 1.06 0l5-5a.75.75 0 1 0-1.06-1.06L12 18.94l-4.47-4.47Z" clip-rule="evenodd"></path></svg></label></div></div></div></div></div></body></html>